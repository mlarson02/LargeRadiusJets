#include "analysisHelperFunctions.h"

using namespace std;

int colors[] = {            
    kRed,          // strong red
    kGreen+2,         // deep blue
    kBlue,      // vivid green
    kMagenta,      // purple-pink
    kOrange+7,     // light orange

    kCyan+1,       // bright cyan
    kViolet+1,     // light violet
    kAzure+2,      // soft blue
    kPink+3,       // light pink
    kSpring+5      // light green-yellow
};

std::map<std::string, std::string> legendMap = {
    {"Seeds2_r2Cut0p64_maxObj128_back_noecut_ecutVal4", 
        "R^{2}_{cut} = 0.64, N_{IO} = 128, No IO E_{cut}"},

    {"Seeds2_r2Cut0p81_maxObj128_1p5back",
        "R^{2}_{cut} = 0.81, N_{IO} = 128, rMergeCut = 1.5"},
    
    {"Seeds2_r2Cut0p81_maxObj256_1p5back",
        "R^{2}_{cut} = 0.81, N_{IO} = 256, rMergeCut = 1.5"},

    {"Seeds2_r2Cut1p0_maxObj128_0p01back",
        "R^{2}_{cut} = 1.0, N_{IO} = 128, rMergeCut Disabled"},

    {"Seeds2_r2Cut1p0_maxObj64_0p001back",
        "R^{2}_{cut} = 1.0, N_{IO} = 64"},

    {"Seeds2_r2Cut1p0_maxObj128_0p001back",
        "R^{2}_{cut} = 1.0, N_{IO} = 128"},

    {"Seeds2_r2Cut1p0_maxObj256_0p001back",
        "R^{2}_{cut} = 1.0, N_{IO} = 256"},


    {"Seeds2_r2Cut1p0_maxObj128_0p001back_SeedPosRecalcWeighted",
    "R^{2}_{cut} = 1.0, N_{IO} = 128, rMergeCut Disabled"},

    {"Seeds2_r2Cut1p0_maxObj128_1p5back_SeedPosRecalcWeighted",
    "R^{2}_{cut} = 1.0, N_{IO} = 128, rMergeCut  = 1.5"},

    {"Seeds2_r2Cut1p0_maxObj128_2p0back_SeedPosRecalcWeighted",
    "R^{2}_{cut} = 1.0, N_{IO} = 128, rMergeCut  = 2.5"},

    {"Seeds2_r2Cut1p0_maxObj128_2p5back_SeedPosRecalcWeighted",
    "R^{2}_{cut} = 1.0, N_{IO} = 128, rMergeCut  = 2.5"},

    {"Seeds2_r2Cut1p0_maxObj128_3p0back_SeedPosRecalcWeighted",
    "R^{2}_{cut} = 1.0, N_{IO} = 128, rMergeCut  = 3.5"},

    {"Seeds2_r2Cut1p0_maxObj128_3p5back_SeedPosRecalcWeighted",
    "R^{2}_{cut} = 1.0, N_{IO} = 128, rMergeCut  = 3.5"},

    {"Seeds2_r2Cut1p0_maxObj256_0p001back_SeedPosRecalcWeighted",
    "R^{2}_{cut} = 1.0, N_{IO} = 256, rMergeCut Disabled"},

    {"Seeds2_r2Cut1p0_maxObj256_1p5back_SeedPosRecalcWeighted",
    "R^{2}_{cut} = 1.0, N_{IO} = 256, rMergeCut  = 1.5"},

    {"Seeds2_r2Cut1p0_maxObj256_2p5back_SeedPosRecalcWeighted",
    "R^{2}_{cut} = 1.0, N_{IO} = 256, rMergeCut  = 2.5"},

    {"Seeds2_r2Cut1p0_maxObj256_3p5back_SeedPosRecalcWeighted",
    "R^{2}_{cut} = 1.0, N_{IO} = 256, rMergeCut  = 3.5"},

    {"Seeds2_r2Cut1p0_maxObj128_1p25back",
        "R^{2}_{cut} = 1.0, N_{IO} = 128, rMergeCut = 1.25"},

    {"Seeds2_r2Cut1p0_maxObj128_1p5back",
        "R^{2}_{cut} = 1.0, N_{IO} = 128, rMergeCut = 1.5"},

    {"Seeds2_r2Cut1p0_maxObj128_1p75back",
        "R^{2}_{cut} = 1.0, N_{IO} = 128, rMergeCut = 1.75"},
    
    {"Seeds2_r2Cut1p0_maxObj256_1p5back",
        "R^{2}_{cut} = 1.0, N_{IO} = 256, rMergeCut = 1.5"},

    {"Seeds2_r2Cut1p44_maxObj128_1p5back",
        "R^{2}_{cut} = 1.44, N_{IO} = 128, rMergeCut = 1.5"},
    
    {"Seeds2_r2Cut1p44_maxObj256_1p5back",
        "R^{2}_{cut} = 1.44, N_{IO} = 256, rMergeCut = 1.5"},

    {"Seeds2_r2Cut0p81_maxObj128_2p0back",
        "R^{2}_{cut} = 0.81, N_{IO} = 128, rMergeCut = 2.0"},
    
    {"Seeds2_r2Cut0p81_maxObj256_2p0back",
        "R^{2}_{cut} = 0.81, N_{IO} = 256, rMergeCut = 2.0"},

    {"Seeds2_r2Cut1p0_maxObj128_2p0back",
        "R^{2}_{cut} = 1.0, N_{IO} = 128, rMergeCut = 2.0"},
    
    {"Seeds2_r2Cut1p0_maxObj256_2p0back",
        "R^{2}_{cut} = 1.0, N_{IO} = 256, rMergeCut = 2.0"},

    {"Seeds2_r2Cut1p44_maxObj128_2p0back",
        "R^{2}_{cut} = 1.44, N_{IO} = 128, rMergeCut = 2.0"},
    
    {"Seeds2_r2Cut1p44_maxObj256_2p0back",
        "R^{2}_{cut} = 1.44, N_{IO} = 256, rMergeCut = 2.0"},

    {"Seeds2_r2Cut0p81_maxObj128_2p5back",
        "R^{2}_{cut} = 0.81, N_{IO} = 128, rMergeCut = 2.5"},
    
    {"Seeds2_r2Cut0p81_maxObj256_2p5back",
        "R^{2}_{cut} = 0.81, N_{IO} = 256, rMergeCut = 2.5"},

    {"Seeds2_r2Cut1p0_maxObj128_2p5back",
        "R^{2}_{cut} = 1.0, N_{IO} = 128, rMergeCut = 2.5"},
    
    {"Seeds2_r2Cut1p0_maxObj256_2p5back",
        "R^{2}_{cut} = 1.0, N_{IO} = 256, rMergeCut = 2.5"},

    {"Seeds2_r2Cut1p44_maxObj128_2p5back",
        "R^{2}_{cut} = 1.44, N_{IO} = 128, rMergeCut = 2.5"},
    
    {"Seeds2_r2Cut1p44_maxObj256_2p5back",
        "R^{2}_{cut} = 1.44, N_{IO} = 256, rMergeCut = 2.5"},

    {"Seeds2_r2Cut0p81_maxObj128_3p0back",
        "R^{2}_{cut} = 0.81, N_{IO} = 128, rMergeCut = 3.0"},
    
    {"Seeds2_r2Cut0p81_maxObj256_3p0back",
        "R^{2}_{cut} = 0.81, N_{IO} = 256, rMergeCut = 3.0"},

    {"Seeds2_r2Cut1p0_maxObj128_3p0back",
        "R^{2}_{cut} = 1.0, N_{IO} = 128, rMergeCut = 3.0"},
    
    {"Seeds2_r2Cut1p0_maxObj256_3p0back",
        "R^{2}_{cut} = 1.0, N_{IO} = 256, rMergeCut = 3.0"},

    {"Seeds2_r2Cut1p44_maxObj128_3p0back",
        "R^{2}_{cut} = 1.44, N_{IO} = 128, rMergeCut = 3.0"},
    
    {"Seeds2_r2Cut1p44_maxObj256_3p0back",
        "R^{2}_{cut} = 1.44, N_{IO} = 256, rMergeCut = 3.0"},

    {"Seeds2_r2Cut0p81_maxObj128_3p5back",
        "R^{2}_{cut} = 0.81, N_{IO} = 128, rMergeCut = 3.5"},
    
    {"Seeds2_r2Cut0p81_maxObj256_3p5back",
        "R^{2}_{cut} = 0.81, N_{IO} = 256, rMergeCut = 3.5"},

    {"Seeds2_r2Cut1p0_maxObj128_3p5back",
        "R^{2}_{cut} = 1.0, N_{IO} = 128, rMergeCut = 3.5"},
    
    {"Seeds2_r2Cut1p0_maxObj256_3p5back",
        "R^{2}_{cut} = 1.0, N_{IO} = 256, rMergeCut = 3.5"},

    {"Seeds2_r2Cut1p44_maxObj128_3p5back",
        "R^{2}_{cut} = 1.44, N_{IO} = 128, rMergeCut = 3.5"},
    
    {"Seeds2_r2Cut1p44_maxObj256_3p5back",
        "R^{2}_{cut} = 1.44, N_{IO} = 256, rMergeCut = 3.5"},

    {"Seeds2_r2Cut0p81_maxObj128_4p0back",
        "R^{2}_{cut} = 0.81, N_{IO} = 128, rMergeCut = 4.0"},
    
    {"Seeds2_r2Cut0p81_maxObj256_4p0back",
        "R^{2}_{cut} = 0.81, N_{IO} = 256, rMergeCut = 4.0"},

    {"Seeds2_r2Cut1p0_maxObj128_4p0back",
        "R^{2}_{cut} = 1.0, N_{IO} = 128, rMergeCut = 4.0"},
    
    {"Seeds2_r2Cut1p0_maxObj256_4p0back",
        "R^{2}_{cut} = 1.0, N_{IO} = 256, rMergeCut = 4.0"},

    {"Seeds2_r2Cut1p44_maxObj128_4p0back",
        "R^{2}_{cut} = 1.44, N_{IO} = 128, rMergeCut = 4.0"},
    
    {"Seeds2_r2Cut1p44_maxObj256_4p0back",
        "R^{2}_{cut} = 1.44, N_{IO} = 256, rMergeCut = 4.0"},

    {"Seeds2_r2Cut0p81_maxObj128_4p5back",
        "R^{2}_{cut} = 0.81, N_{IO} = 128, rMergeCut = 4.5"},
    
    {"Seeds2_r2Cut0p81_maxObj256_4p5back",
        "R^{2}_{cut} = 0.81, N_{IO} = 256, rMergeCut = 4.5"},

    {"Seeds2_r2Cut1p0_maxObj128_4p5back",
        "R^{2}_{cut} = 1.0, N_{IO} = 128, rMergeCut = 4.5"},
    
    {"Seeds2_r2Cut1p0_maxObj256_4p5back",
        "R^{2}_{cut} = 1.0, N_{IO} = 256, rMergeCut = 4.5"},

    {"Seeds2_r2Cut1p44_maxObj128_4p5back",
        "R^{2}_{cut} = 1.44, N_{IO} = 128, rMergeCut = 4.5"},
    
    {"Seeds2_r2Cut1p44_maxObj256_4p5back",
        "R^{2}_{cut} = 1.44, N_{IO} = 256, rMergeCut = 4.5"},

    {"Seeds2_r2Cut0p81_maxObj128_back_noecut_ecutVal4", 
        "R^{2}_{cut} = 0.81, N_{IO} = 128, No IO E_{cut}"},

    {"Seeds2_r2Cut0p81_maxObj256_back_noecut_ecutVal4", 
        "R^{2}_{cut} = 0.81, N_{IO} = 256, No IO E_{cut}"},

    {"Seeds2_r2Cut1p21_maxObj256_back_noecut_ecutVal4", 
        "R^{2}_{cut} = 1.21, N_{IO} = 256, No IO E_{cut}"},

    {"Seeds2_r2Cut1p44_maxObj256_back_noecut_ecutVal4", 
        "R^{2}_{cut} = 1.44, N_{IO} = 256, No IO E_{cut}"},

    {"Seeds2_r2Cut1p69_maxObj256_back_noecut_ecutVal4", 
        "R^{2}_{cut} = 1.69, N_{IO} = 256, No IO E_{cut}"},

    {"Seeds2_r2Cut1p96_maxObj256_back_noecut_ecutVal4", 
        "R^{2}_{cut} = 1.96, N_{IO} = 256, No IO E_{cut}"},

    {"Seeds2_r2Cut1p21_maxObj128_back_noecut_ecutVal4", 
        "R^{2}_{cut} = 1.21, N_{IO} = 128, No IO E_{cut}"},

    {"Seeds2_r2Cut1p44_maxObj128_back_noecut_ecutVal4", 
        "R^{2}_{cut} = 1.44, N_{IO} = 128, No IO E_{cut}"},

    {"Seeds2_r2Cut1p69_maxObj128_back_noecut_ecutVal4", 
        "R^{2}_{cut} = 1.69, N_{IO} = 128, No IO E_{cut}"},

    {"Seeds2_r2Cut1p96_maxObj128_back_noecut_ecutVal4", 
        "R^{2}_{cut} = 1.96, N_{IO} = 128, No IO E_{cut}"},

    {"Seeds2_r2Cut0p64_maxObj128_back_noecut_ecutVal4", 
        "R^{2}_{cut} = 0.64, N_{IO} = 128, No IO E_{cut}"},

    {"Seeds2_r2Cut0p64_maxObj128_back_ecut_ecutVal4", 
    "R^{2}_{cut} = 0.64, N_{IO} = 128, IO E_{cut}"},

    {"Seeds2_r2Cut1p0_maxObj128_back_noecut_ecutVal4", 
        "R^{2}_{cut} = 1.0, N_{IO} = 128, No IO E_{cut}"},

    {"Seeds2_r2Cut1p44_maxObj128_back_noecut_ecutVal4", 
        "R^{2}_{cut} = 1.44, N_{IO} = 128, No IO E_{cut}"},

    {"Seeds2_r2Cut1p0_maxObj256_back_ecut_ecutVal4", 
        "R^{2}_{cut} = 1.0, N_{IO} = 256, IO E_{cut}"},
        
    {"Seeds2_r2Cut1p0_maxObj256_back_noecut_ecutVal4", 
        "R^{2}_{cut} = 1.0, N_{IO} = 256, No IO E_{cut}"},

    {"Seeds2_r2Cut1p0_maxObj512_back_noecut_ecutVal4", 
        "R^{2}_{cut} = 1.0, N_{IO} = 512, No IO E_{cut}"},

    {"Seeds2_r2Cut1p44_maxObj512_back_noecut_ecutVal4", 
    "R^{2}_{cut} = 1.44, N_{IO} = 512, No IO E_{cut}"}
};

void analyze_files(std::vector<std::string > signalRootFileNames, std::vector<std::string > backgroundRootFileNames, TString overlayOutputFileDir, bool overlayThreeFiles, double subjetEtThreshold, bool categorySubjetEtScan_8, bool substructure5CategoryScan = false, bool leadingLRJSubjetScan = false) {
SetPlotStyle();

// Vectors to hold per-file histograms
std::vector<TH1F*> sig_num100, sig_denom100;
std::vector<TH1F*> sig_num250, sig_denom250;
std::vector<TH1F*> sig_num400, sig_denom400;

std::vector<TH1F*> back_num100, back_denom100;
std::vector<TH1F*> back_num200, back_denom200;
std::vector<TH1F*> back_num300, back_denom300;

// Efficiency histograms per file (only keep these)
std::vector<TH1F*> back_eff_100, back_eff_200, back_eff_300;
std::vector<TH1F*> sig_eff_100,  sig_eff_250,  sig_eff_400;

// Additional Histograms to be overlayed across multiple files:

std::vector<TH1F* > sig_h_leading_LRJ_Et_vec; // These will later be filled with clones of the original histograms
std::vector<TH1F* > sig_h_subleading_LRJ_Et_vec;
std::vector<TH1F* > sig_h_leading_offline_LRJ_Et_vec; 
std::vector<TH1F* > sig_h_subleading_offline_LRJ_Et_vec;
std::vector<TH1F* > back_h_leading_offline_LRJ_Et_vec; 
std::vector<TH1F* > back_h_subleading_offline_LRJ_Et_vec;
std::vector<TH1F* > sig_h_leading_offline_LRJ_Mass_vec; 
std::vector<TH1F* > sig_h_subleading_offline_LRJ_Mass_vec;
std::vector<TH1F* > back_h_leading_offline_LRJ_Mass_vec; 
std::vector<TH1F* > back_h_subleading_offline_LRJ_Mass_vec;
std::vector<TH1F* > back_h_leading_LRJ_Et_vec;
std::vector<TH1F* > back_h_subleading_LRJ_Et_vec;
std::vector<TH1F* > sig_h_leading_LRJ_psi_R_vec;
std::vector<TH1F* > sig_h_LRJ_psi_R_squared_vec;
std::vector<TH1F* > sig_h_LRJ_psi_R_12_vec;
std::vector<TH1F* > sig_h_subleading_LRJ_psi_R_vec;
std::vector<TH1F* > sig_h_leading_LRJ_psi_R2_vec;
std::vector<TH1F* > sig_h_LRJ_psi_R2_squared_vec;
std::vector<TH1F* > sig_h_LRJ_psi_R2_12_vec;
std::vector<TH1F* > sig_h_subleading_LRJ_psi_R2_vec;
std::vector<TH1F* > back_h_leading_LRJ_psi_R_vec;
std::vector<TH1F* > back_h_LRJ_psi_R_squared_vec;
std::vector<TH1F* > back_h_LRJ_psi_R_12_vec;
std::vector<TH1F* > back_h_subleading_LRJ_psi_R_vec;
std::vector<TH1F* > back_h_leading_LRJ_psi_R2_vec;
std::vector<TH1F* > back_h_LRJ_psi_R2_squared_vec;
std::vector<TH1F* > back_h_LRJ_psi_R2_12_vec;
std::vector<TH1F* > back_h_subleading_LRJ_psi_R2_vec;

std::vector<TH1F* > sig_eff_offlineLRJ10kHz_vec;
std::vector<TH1F* > sig_eff_offlineLRJ10kHz_HiggsMassWindow_vec;
std::vector<TH1F* > sig_eff_offlineLRJ10kHz_1Subjet_vec;
std::vector<TH1F* > sig_eff_offlineLRJ10kHz_GrEq2Subjets_vec;

std::vector<TH1F* > sig_eff_offlineLRJ10kHz_Subleading_vec;
std::vector<TH1F* > sig_eff_offlineLRJ10kHz_HiggsMassWindow_Subleading_vec;
std::vector<TH1F* > sig_eff_offlineLRJ10kHz_1Subjet_Subleading_vec;
std::vector<TH1F* > sig_eff_offlineLRJ10kHz_GrEq2Subjets_Subleading_vec;

std::vector<TGraph* > lead_ET_Scan_RatesVsEff_vec;
std::vector<TGraph* > sublead_ET_Scan_RatesVsEff_vec;
std::vector<TH1* > lead_ET_Scan_EffVsThresh_vec;
std::vector<TH1* > sublead_ET_Scan_EffVsThresh_vec;
std::vector<TH1* > lead_ET_Scan_RateVsThresh_vec;
std::vector<TH1* > sublead_ET_Scan_RateVsThresh_vec;
std::vector<TGraphErrors* > lead_ET_Pmax_Scan_RatesVsEff_vec;
std::vector<TGraphErrors* > lead_ET_Pmin_Scan_RatesVsEff_vec;
std::vector<TGraphErrors* > sublead_ET_Pmax_Scan_RatesVsEff_vec;

// for subjet-based selection overlay
std::vector<TGraphErrors* > subjetBased_ET_Scan_RatesVsEff_vec;



TH1F* sig_h_leading_offlineLRJ_Et = new TH1F("sig_h_leading_offlineLRJ_Et", "Leading LRJ Et Distribution;E_{T} [GeV];% of Leading Offline LRJs / 50 GeV", 16, 0, 800); // moved outside scope of file loop for use afterwards
TH1F* sig_h_subleading_offlineLRJ_Et = new TH1F("sig_h_subleading_offlineLRJ_Et", "Subleading LRJ Et Distribution;E_{T} [GeV];% of Subleading Offline LRJs / 50 GeV", 16, 0, 800); // now will only fill for first file as is same for each

// ROC and efficiency curve declarations
vector<vector<double> > roc_curve_points_x(backgroundRootFileNames.size());
vector<vector<double> > roc_curve_points_y(backgroundRootFileNames.size());
vector<vector<double> > roc_curve_points_x2(backgroundRootFileNames.size());
vector<vector<double> > roc_curve_points_y2(backgroundRootFileNames.size());
vector<vector<double> > maxSignalToBackgroundRatio(backgroundRootFileNames.size());
vector<vector<double> > maxSignalToBackgroundRatioTPR0p1(backgroundRootFileNames.size());

vector<vector<double> > maxSignalToBackgroundRatio2(backgroundRootFileNames.size());
vector<vector<double> > maxSignalToBackgroundRatio2TPR0p1(backgroundRootFileNames.size());

vector<vector<double> > efficiency_curve_points_x(backgroundRootFileNames.size());
vector<vector<double> > efficiency_curve_points_y(backgroundRootFileNames.size());
vector<vector<double> > efficiency_curve_points_y2(backgroundRootFileNames.size());
vector<double > tprMinMaxCut(backgroundRootFileNames.size());
vector<double > fprMinMaxCut(backgroundRootFileNames.size());
std::cout << "Processing : " << backgroundRootFileNames.size() << " files. " << "\n";
std::vector<std::string > algorithmConfigurations;







std::vector<double > jetTagger_10kHz_Threshold_Leading_vec;
std::vector<double > jetTagger_10kHz_Threshold_Subleading_vec;
for (unsigned int fileIt = 0; fileIt < backgroundRootFileNames.size(); ++fileIt){
    double sumOfBackgroundEventWeight = 0;
    // Parse file info (input object type & seed object type from ntuple file name)
    std::string inputObjectType = ParseFileName(backgroundRootFileNames[fileIt]).inputObjectType;

    double jetRadius = sqrt(ParseFileName(backgroundRootFileNames[fileIt]).jetRadiusSquared);

    const unsigned int variableIOCutOff_2 = 2;
    const unsigned int variableIOCutOff_3 = 3;
    const unsigned int variableIOCutOff_4 = 4;
    const unsigned int variableIOCutOff_5 = 5;
    unsigned int nInputObjectsAlgorithmConfiguration = 0;
    std::regex re("_IOs_(\\d+)_");
    std::smatch match;

    if (std::regex_search(signalRootFileNames[fileIt], match, re)) {
        nInputObjectsAlgorithmConfiguration = std::stoi(match[1]);  // Convert to integer
        std::cout << "Extracted number of input objects for this algorithm configuration: " << nInputObjectsAlgorithmConfiguration << std::endl;
    } else {
        std::cout << "No match found." << std::endl;
    }

    // Open input ROOT file
    TFile* signalInputFile = TFile::Open(signalRootFileNames[fileIt].c_str(), "READ");
    TFile* backgroundInputFile = TFile::Open(backgroundRootFileNames[fileIt].c_str(), "READ");
    if ((!signalInputFile || signalInputFile->IsZombie()) || (!backgroundInputFile || backgroundInputFile->IsZombie())) {
        std::cerr << "Error: Could not open file " << signalRootFileNames[fileIt] << std::endl;
        return;
    }

    TTree* jetTaggerLRJsSignal = (TTree*)signalInputFile->Get("jetTaggerLRJsTree");
    TTree* jetTaggerLeadingLRJsSignal = (TTree*)signalInputFile->Get("jetTaggerLeadingLRJsTree");
    TTree* jetTaggerSubleadingLRJsSignal = (TTree*)signalInputFile->Get("jetTaggerSubleadingLRJsTree");
    TTree* eventInfoTreeSignal = (TTree*)signalInputFile->Get("eventInfoTree");
    TTree* truthbTreeSignal = (TTree*)signalInputFile->Get("truthbTree");
    TTree* truthHiggsTreeSignal = (TTree*)signalInputFile->Get("truthHiggsTree");
    TTree* caloTopoTowerTreeSignal = (TTree*)signalInputFile->Get("caloTopoTowerTree");
    TTree* topo422TreeSignal = (TTree*)signalInputFile->Get("topo422Tree");
    TTree* gepBasicClustersTreeSignal = (TTree*)signalInputFile->Get("gepBasicClustersTree");
    TTree* gepCellsTowersTreeSignal = (TTree*)signalInputFile->Get("gepCellsTowersTree");
    TTree* gepBasicClustersSKTreeSignal = (TTree*)signalInputFile->Get("gepBasicClustersSKTree"); 
    TTree* gepCellsTowersSKTreeSignal = (TTree*)signalInputFile->Get("gepCellsTowersSKTree");
    TTree* gepWTAConeCellsTowersJetsTreeSignal = (TTree*)signalInputFile->Get("gepWTAConeCellsTowersJetsTree");
    TTree* gepWTAConeBasicClustersJetsTreeSignal = (TTree*)signalInputFile->Get("gepWTAConeBasicClustersJetsTree");
    TTree* gepLeadingWTAConeCellsTowersJetsTreeSignal = (TTree*)signalInputFile->Get("gepLeadingWTAConeCellsTowersJetsTree");
    TTree* gepLeadingWTAConeBasicClustersJetsTreeSignal = (TTree*)signalInputFile->Get("gepLeadingWTAConeBasicClustersJetsTree");
    TTree* gepSubleadingWTAConeCellsTowersJetsTreeSignal = (TTree*)signalInputFile->Get("gepSubleadingWTAConeCellsTowersJetsTree");
    TTree* gepSubleadingWTAConeBasicClustersJetsTreeSignal = (TTree*)signalInputFile->Get("gepSubleadingWTAConeBasicClustersJetsTree");
    TTree* gepWTAConeCellsTowersSKJetsTreeSignal = (TTree*)signalInputFile->Get("gepWTAConeCellsTowersSKJetsTree");
    TTree* gepWTAConeBasicClustersSKJetsTreeSignal = (TTree*)signalInputFile->Get("gepWTAConeBasicClustersSKJetsTree");
    TTree* gepLeadingWTAConeCellsTowersSKJetsTreeSignal = (TTree*)signalInputFile->Get("gepLeadingWTAConeCellsTowersSKJetsTree");
    TTree* gepLeadingWTAConeBasicClustersSKJetsTreeSignal = (TTree*)signalInputFile->Get("gepLeadingWTAConeBasicClustersSKJetsTree");
    TTree* gepSubleadingWTAConeCellsTowersSKJetsTreeSignal = (TTree*)signalInputFile->Get("gepSubleadingWTAConeCellsTowersSKJetsTree");
    TTree* gepSubleadingWTAConeBasicClustersSKJetsTreeSignal = (TTree*)signalInputFile->Get("gepSubleadingWTAConeBasicClustersSKJetsTree");
    TTree* gFexSRJTreeSignal = (TTree*)signalInputFile->Get("gFexSRJTree");
    TTree* gFexLeadingSRJTreeSignal = (TTree*)signalInputFile->Get("gFexLeadingSRJTree");
    TTree* gFexSubleadingSRJTreeSignal = (TTree*)signalInputFile->Get("gFexSubleadingSRJTree");
    TTree* gFexLRJTreeSignal = (TTree*)signalInputFile->Get("gFexLRJTree");
    TTree* gFexLeadingLRJTreeSignal = (TTree*)signalInputFile->Get("gFexLeadingLRJTree");
    TTree* gFexSubleadingLRJTreeSignal = (TTree*)signalInputFile->Get("gFexSubleadingLRJTree");
    TTree* inTimeAntiKt4TruthJetsTreeSignal = (TTree*)signalInputFile->Get("inTimeAntiKt4TruthJetsTree");
    TTree* leadingInTimeAntiKt4TruthJetsTreeSignal = (TTree*)signalInputFile->Get("leadingInTimeAntiKt4TruthJetsTree");
    TTree* subleadingInTimeAntiKt4TruthJetsTreeSignal = (TTree*)signalInputFile->Get("subleadingInTimeAntiKt4TruthJetsTree");
    TTree* jFexSRJTreeSignal = (TTree*)signalInputFile->Get("jFexSRJTree");
    TTree* jFexLeadingSRJTreeSignal = (TTree*)signalInputFile->Get("jFexLeadingSRJTree");
    TTree* jFexSubleadingSRJTreeSignal = (TTree*)signalInputFile->Get("jFexSubleadingSRJTree");
    TTree* jFexLRJTreeSignal = (TTree*)signalInputFile->Get("jFexLRJTree");
    TTree* jFexLeadingLRJTreeSignal = (TTree*)signalInputFile->Get("jFexLeadingLRJTree");
    TTree* jFexSubleadingLRJTreeSignal = (TTree*)signalInputFile->Get("jFexSubleadingLRJTree");
    TTree* hltAntiKt4EMTopoJetsTreeSignal = (TTree*)signalInputFile->Get("hltAntiKt4EMTopoJetsTree");
    TTree* leadingHltAntiKt4EMTopoJetsTreeSignal = (TTree*)signalInputFile->Get("leadingHltAntiKt4EMTopoJetsTree");
    TTree* subleadingHltAntiKt4EMTopoJetsTreeSignal = (TTree*)signalInputFile->Get("subleadingHltAntiKt4EMTopoJetsTree");
    TTree* recoAntiKt10UFOCSSKJetsSignal = (TTree*)signalInputFile->Get("recoAntiKt10UFOCSSKJets");
    TTree* leadingRecoAntiKt10UFOCSSKJetsSignal = (TTree*)signalInputFile->Get("leadingRecoAntiKt10UFOCSSKJets");
    TTree* subleadingRecoAntiKt10UFOCSSKJetsSignal = (TTree*)signalInputFile->Get("subleadingRecoAntiKt10UFOCSSKJets");
    TTree* truthAntiKt4TruthDressedWZJetsSignal = (TTree*)signalInputFile->Get("truthAntiKt4TruthDressedWZJets");
    TTree* leadingTruthAntiKt4TruthDressedWZJetsSignal = (TTree*)signalInputFile->Get("leadingTruthAntiKt4TruthDressedWZJets");
    TTree* subleadingTruthAntiKt4TruthDressedWZJetsSignal = (TTree*)signalInputFile->Get("subleadingTruthAntiKt4TruthDressedWZJets");

    TTree* jetTaggerLRJsBack = (TTree*)backgroundInputFile->Get("jetTaggerLRJsTree");
    TTree* jetTaggerLeadingLRJsBack = (TTree*)backgroundInputFile->Get("jetTaggerLeadingLRJsTree");
    TTree* jetTaggerSubleadingLRJsBack = (TTree*)backgroundInputFile->Get("jetTaggerSubleadingLRJsTree");
    TTree* eventInfoTreeBack = (TTree*)backgroundInputFile->Get("eventInfoTree");
    TTree* caloTopoTowerTreeBack = (TTree*)backgroundInputFile->Get("caloTopoTowerTree");
    TTree* topo422TreeBack = (TTree*)backgroundInputFile->Get("topo422Tree");
    TTree* gepBasicClustersTreeBack = (TTree*)backgroundInputFile->Get("gepBasicClustersTree");
    TTree* gepCellsTowersTreeBack = (TTree*)backgroundInputFile->Get("gepCellsTowersTree");
    TTree* gepBasicClustersSKTreeBack = (TTree*)backgroundInputFile->Get("gepBasicClustersSKTree");
    TTree* gepCellsTowersSKTreeBack = (TTree*)backgroundInputFile->Get("gepCellsTowersSKTree");
    TTree* gepWTAConeCellsTowersJetsTreeBack = (TTree*)backgroundInputFile->Get("gepWTAConeCellsTowersJetsTree");
    TTree* gepWTAConeBasicClustersJetsTreeBack = (TTree*)backgroundInputFile->Get("gepWTAConeBasicClustersJetsTree");
    TTree* gepLeadingWTAConeCellsTowersJetsTreeBack = (TTree*)backgroundInputFile->Get("gepLeadingWTAConeCellsTowersJetsTree");
    TTree* gepLeadingWTAConeBasicClustersJetsTreeBack = (TTree*)backgroundInputFile->Get("gepLeadingWTAConeBasicClustersJetsTree");
    TTree* gepSubleadingWTAConeCellsTowersJetsTreeBack = (TTree*)backgroundInputFile->Get("gepSubleadingWTAConeCellsTowersJetsTree");
    TTree* gepSubleadingWTAConeBasicClustersJetsTreeBack = (TTree*)backgroundInputFile->Get("gepSubleadingWTAConeBasicClustersJetsTree");
    TTree* gepWTAConeCellsTowersSKJetsTreeBack = (TTree*)backgroundInputFile->Get("gepWTAConeCellsTowersSKJetsTree");
    TTree* gepWTAConeBasicClustersSKJetsTreeBack = (TTree*)backgroundInputFile->Get("gepWTAConeBasicClustersSKJetsTree");
    TTree* gepLeadingWTAConeCellsTowersSKJetsTreeBack = (TTree*)backgroundInputFile->Get("gepLeadingWTAConeCellsTowersSKJetsTree");
    TTree* gepLeadingWTAConeBasicClustersSKJetsTreeBack = (TTree*)backgroundInputFile->Get("gepLeadingWTAConeBasicClustersSKJetsTree");
    TTree* gepSubleadingWTAConeCellsTowersSKJetsTreeBack = (TTree*)backgroundInputFile->Get("gepSubleadingWTAConeCellsTowersSKJetsTree");
    TTree* gepSubleadingWTAConeBasicClustersSKJetsTreeBack = (TTree*)backgroundInputFile->Get("gepSubleadingWTAConeBasicClustersSKJetsTree");
    TTree* gFexSRJTreeBack = (TTree*)backgroundInputFile->Get("gFexSRJTree");
    TTree* gFexLeadingSRJTreeBack = (TTree*)backgroundInputFile->Get("gFexLeadingSRJTree");
    TTree* gFexSubleadingSRJTreeBack = (TTree*)backgroundInputFile->Get("gFexSubleadingSRJTree");
    TTree* gFexLRJTreeBack = (TTree*)backgroundInputFile->Get("gFexLRJTree");
    TTree* gFexLeadingLRJTreeBack = (TTree*)backgroundInputFile->Get("gFexLeadingLRJTree");
    TTree* gFexSubleadingLRJTreeBack = (TTree*)backgroundInputFile->Get("gFexSubleadingLRJTree");
    TTree* inTimeAntiKt4TruthJetsTreeBack = (TTree*)backgroundInputFile->Get("inTimeAntiKt4TruthJetsTree");
    TTree* leadingInTimeAntiKt4TruthJetsTreeBack = (TTree*)backgroundInputFile->Get("leadingInTimeAntiKt4TruthJetsTree");
    TTree* subleadingInTimeAntiKt4TruthJetsTreeBack = (TTree*)backgroundInputFile->Get("subleadingInTimeAntiKt4TruthJetsTree");
    TTree* jFexSRJTreeBack = (TTree*)backgroundInputFile->Get("jFexSRJTree");
    TTree* jFexLeadingSRJTreeBack = (TTree*)backgroundInputFile->Get("jFexLeadingSRJTree");
    TTree* jFexSubleadingSRJTreeBack = (TTree*)backgroundInputFile->Get("jFexSubleadingSRJTree");
    TTree* jFexLRJTreeBack = (TTree*)backgroundInputFile->Get("jFexLRJTree");
    TTree* jFexLeadingLRJTreeBack = (TTree*)backgroundInputFile->Get("jFexLeadingLRJTree");
    TTree* jFexSubleadingLRJTreeBack = (TTree*)backgroundInputFile->Get("jFexSubleadingLRJTree");
    TTree* hltAntiKt4EMTopoJetsTreeBack = (TTree*)backgroundInputFile->Get("hltAntiKt4EMTopoJetsTree");
    TTree* leadingHltAntiKt4EMTopoJetsTreeBack = (TTree*)backgroundInputFile->Get("leadingHltAntiKt4EMTopoJetsTree");
    TTree* subleadingHltAntiKt4EMTopoJetsTreeBack = (TTree*)backgroundInputFile->Get("subleadingHltAntiKt4EMTopoJetsTree");
    TTree* recoAntiKt10UFOCSSKJetsBack = (TTree*)backgroundInputFile->Get("recoAntiKt10UFOCSSKJets");
    TTree* leadingRecoAntiKt10UFOCSSKJetsBack = (TTree*)backgroundInputFile->Get("leadingRecoAntiKt10UFOCSSKJets");
    TTree* subleadingRecoAntiKt10UFOCSSKJetsBack = (TTree*)backgroundInputFile->Get("subleadingRecoAntiKt10UFOCSSKJets");
    TTree* truthAntiKt4TruthDressedWZJetsBack = (TTree*)backgroundInputFile->Get("truthAntiKt4TruthDressedWZJets");
    TTree* leadingTruthAntiKt4TruthDressedWZJetsBack = (TTree*)backgroundInputFile->Get("leadingTruthAntiKt4TruthDressedWZJets");
    TTree* subleadingTruthAntiKt4TruthDressedWZJetsBack = (TTree*)backgroundInputFile->Get("subleadingTruthAntiKt4TruthDressedWZJets");

    std::vector<double>* mcEventWeightsValuesSignal = nullptr;
    double* sumOfWeightsForSampleValuesSignal = nullptr;
    std::vector<double>* eventWeightsValuesSignal = nullptr;
    int* sampleJZSliceValuesSignal = nullptr;
    std::vector<double>* jetTaggerLRJPsi_RValuesSignal = nullptr;
    std::vector<unsigned int>* jetTaggerLRJMergedIndicesValuesSignal = nullptr;
    std::vector<double>* jetTaggerLRJEtValuesSignal = nullptr;
    std::vector<double>* jetTaggerLRJEtaValuesSignal = nullptr;
    std::vector<double>* jetTaggerLRJPhiValuesSignal = nullptr;
    std::vector<double>* jetTaggerLeadingLRJPsi_RValuesSignal = nullptr;
    std::vector<unsigned int>* jetTaggerLeadingLRJMergedIndicesValuesSignal = nullptr;
    std::vector<double>* jetTaggerLeadingLRJEtValuesSignal = nullptr;
    std::vector<double>* jetTaggerLeadingLRJEtaValuesSignal = nullptr;
    std::vector<double>* jetTaggerLeadingLRJPhiValuesSignal = nullptr;
    std::vector<double>* jetTaggerSubleadingLRJPsi_RValuesSignal = nullptr;
    std::vector<unsigned int>* jetTaggerSubleadingLRJMergedIndicesValuesSignal = nullptr;
    std::vector<double>* jetTaggerSubleadingLRJEtValuesSignal = nullptr;
    std::vector<double>* jetTaggerSubleadingLRJEtaValuesSignal = nullptr;
    std::vector<double>* jetTaggerSubleadingLRJPhiValuesSignal = nullptr;
    std::vector<unsigned int>* higgsIndexValuesSignal = nullptr;
    std::vector<unsigned int>* indexOfHiggsValuesSignal = nullptr;
    std::vector<double>* truthbquarksEtValuesSignal = nullptr;
    std::vector<double>* truthbquarksEnergyValuesSignal = nullptr;
    std::vector<double>* truthbquarkspTValuesSignal = nullptr;
    std::vector<double>* truthbquarkspxValuesSignal = nullptr;
    std::vector<double>* truthbquarkspyValuesSignal = nullptr;
    std::vector<double>* truthbquarkspzValuesSignal = nullptr;
    std::vector<double>* truthbquarksEtaValuesSignal = nullptr;
    std::vector<double>* truthbquarksPhiValuesSignal = nullptr;
    std::vector<double>* truthHiggsEtValuesSignal = nullptr;
    std::vector<double>* truthHiggsEnergyValuesSignal = nullptr;
    std::vector<double>* truthHiggspTValuesSignal = nullptr;
    std::vector<double>* truthHiggspxValuesSignal = nullptr;
    std::vector<double>* truthHiggspyValuesSignal = nullptr;
    std::vector<double>* truthHiggspzValuesSignal = nullptr;
    std::vector<double>* truthHiggsEtaValuesSignal = nullptr;
    std::vector<double>* truthHiggsPhiValuesSignal = nullptr;
    std::vector<double>* truthHiggsInvMassValuesSignal = nullptr;
    std::vector<double>* caloTopoTowerEtValuesSignal = nullptr;
    std::vector<double>* caloTopoTowerEtaValuesSignal = nullptr;
    std::vector<double>* caloTopoTowerPhiValuesSignal = nullptr;
    std::vector<double>* topo422EtValuesSignal = nullptr;
    std::vector<double>* topo422EtaValuesSignal = nullptr;
    std::vector<double>* topo422PhiValuesSignal = nullptr;
    std::vector<double>* gepBasicClustersEtValuesSignal = nullptr;
    std::vector<double>* gepBasicClustersEtaValuesSignal = nullptr;
    std::vector<double>* gepBasicClustersPhiValuesSignal = nullptr;
    std::vector<double>* gepCellsTowersEtValuesSignal = nullptr;
    std::vector<double>* gepCellsTowersEtaValuesSignal = nullptr;
    std::vector<double>* gepCellsTowersPhiValuesSignal = nullptr;
    std::vector<double>* gepBasicClustersSKEtValuesSignal = nullptr;
    std::vector<double>* gepBasicClustersSKEtaValuesSignal = nullptr;
    std::vector<double>* gepBasicClustersSKPhiValuesSignal = nullptr;
    std::vector<double>* gepCellsTowersSKEtValuesSignal = nullptr;
    std::vector<double>* gepCellsTowersSKEtaValuesSignal = nullptr;
    std::vector<double>* gepCellsTowersSKPhiValuesSignal = nullptr;
    std::vector<double>* gepWTAConeCellsTowersJetspTValuesSignal = nullptr;
    std::vector<double>* gepWTAConeCellsTowersJetsEtaValuesSignal = nullptr;
    std::vector<double>* gepWTAConeCellsTowersJetsPhiValuesSignal = nullptr;
    std::vector<unsigned int >* gepWTAConeCellsTowersJetsNConstituentsValuesSignal = nullptr;
    std::vector<double>* gepLeadingWTAConeCellsTowersJetspTValuesSignal = nullptr;
    std::vector<double>* gepLeadingWTAConeCellsTowersJetsEtaValuesSignal = nullptr;
    std::vector<double>* gepLeadingWTAConeCellsTowersJetsPhiValuesSignal = nullptr;
    std::vector<unsigned int >* gepLeadingWTAConeCellsTowersJetsNConstituentsValuesSignal = nullptr;
    std::vector<double>* gepSubleadingWTAConeCellsTowersJetspTValuesSignal = nullptr;
    std::vector<double>* gepSubleadingWTAConeCellsTowersJetsEtaValuesSignal = nullptr;
    std::vector<double>* gepSubleadingWTAConeCellsTowersJetsPhiValuesSignal = nullptr;
    std::vector<unsigned int >* gepSubleadingWTAConeCellsTowersJetsNConstituentsValuesSignal = nullptr;
    std::vector<double>* gepWTAConeGEPBasicClustersJetspTValuesSignal = nullptr;
    std::vector<double>* gepWTAConeGEPBasicClustersJetsEtaValuesSignal = nullptr;
    std::vector<double>* gepWTAConeGEPBasicClustersJetsPhiValuesSignal = nullptr;
    std::vector<unsigned int >* gepWTAConeGEPBasicClustersJetsNConstituentsValuesSignal = nullptr;
    std::vector<double>* gepLeadingWTAConeGEPBasicClustersJetspTValuesSignal = nullptr;
    std::vector<double>* gepLeadingWTAConeGEPBasicClustersJetsEtaValuesSignal = nullptr;
    std::vector<double>* gepLeadingWTAConeGEPBasicClustersJetsPhiValuesSignal = nullptr;
    std::vector<unsigned int >* gepLeadingWTAConeGEPBasicClustersJetsNConstituentsValuesSignal = nullptr;
    std::vector<double>* gepSubleadingWTAConeGEPBasicClustersJetspTValuesSignal = nullptr;
    std::vector<double>* gepSubleadingWTAConeGEPBasicClustersJetsEtaValuesSignal = nullptr;
    std::vector<double>* gepSubleadingWTAConeGEPBasicClustersJetsPhiValuesSignal = nullptr;
    std::vector<unsigned int >* gepSubleadingWTAConeGEPBasicClustersJetsNConstituentsValuesSignal = nullptr;
    // ------- SK PU Suppressed ------
    std::vector<double>* gepWTAConeCellsTowersSKJetspTValuesSignal = nullptr;
    std::vector<double>* gepWTAConeCellsTowersSKJetsEtaValuesSignal = nullptr;
    std::vector<double>* gepWTAConeCellsTowersSKJetsPhiValuesSignal = nullptr;
    std::vector<unsigned int >* gepWTAConeCellsTowersSKJetsNConstituentsValuesSignal = nullptr;
    std::vector<double>* gepLeadingWTAConeCellsTowersSKJetspTValuesSignal = nullptr;
    std::vector<double>* gepLeadingWTAConeCellsTowersSKJetsEtaValuesSignal = nullptr;
    std::vector<double>* gepLeadingWTAConeCellsTowersSKJetsPhiValuesSignal = nullptr;
    std::vector<unsigned int >* gepLeadingWTAConeCellsTowersSKJetsNConstituentsValuesSignal = nullptr;
    std::vector<double>* gepSubleadingWTAConeCellsTowersSKJetspTValuesSignal = nullptr;
    std::vector<double>* gepSubleadingWTAConeCellsTowersSKJetsEtaValuesSignal = nullptr;
    std::vector<double>* gepSubleadingWTAConeCellsTowersSKJetsPhiValuesSignal = nullptr;
    std::vector<unsigned int >* gepSubleadingWTAConeCellsTowersSKJetsNConstituentsValuesSignal = nullptr;
    std::vector<double>* gepWTAConeGEPBasicClustersSKJetspTValuesSignal = nullptr;
    std::vector<double>* gepWTAConeGEPBasicClustersSKJetsEtaValuesSignal = nullptr;
    std::vector<double>* gepWTAConeGEPBasicClustersSKJetsPhiValuesSignal = nullptr;
    std::vector<unsigned int >* gepWTAConeGEPBasicClustersSKJetsNConstituentsValuesSignal = nullptr;
    std::vector<double>* gepLeadingWTAConeGEPBasicClustersSKJetspTValuesSignal = nullptr;
    std::vector<double>* gepLeadingWTAConeGEPBasicClustersSKJetsEtaValuesSignal = nullptr;
    std::vector<double>* gepLeadingWTAConeGEPBasicClustersSKJetsPhiValuesSignal = nullptr;
    std::vector<unsigned int >* gepLeadingWTAConeGEPBasicClustersSKJetsNConstituentsValuesSignal = nullptr;
    std::vector<double>* gepSubleadingWTAConeGEPBasicClustersSKJetspTValuesSignal = nullptr;
    std::vector<double>* gepSubleadingWTAConeGEPBasicClustersSKJetsEtaValuesSignal = nullptr;
    std::vector<double>* gepSubleadingWTAConeGEPBasicClustersSKJetsPhiValuesSignal = nullptr;
    std::vector<unsigned int >* gepSubleadingWTAConeGEPBasicClustersSKJetsNConstituentsValuesSignal = nullptr;
    // ---------------------
    std::vector<unsigned int>* gFexSRJEtIndexValuesSignal = nullptr;
    std::vector<double>* gFexSRJEtValuesSignal = nullptr;
    std::vector<double>* gFexSRJEtaValuesSignal = nullptr;
    std::vector<double>* gFexSRJPhiValuesSignal = nullptr;
    std::vector<double>* gFexSRJLeadingEtValuesSignal = nullptr;
    std::vector<double>* gFexSRJLeadingEtaValuesSignal = nullptr;
    std::vector<double>* gFexSRJLeadingPhiValuesSignal = nullptr;
    std::vector<double>* gFexSRJSubleadingEtValuesSignal = nullptr;
    std::vector<double>* gFexSRJSubleadingEtaValuesSignal = nullptr;
    std::vector<double>* gFexSRJSubleadingPhiValuesSignal = nullptr;
    std::vector<unsigned int>* gFexLRJEtIndexValuesSignal = nullptr;
    std::vector<double>* gFexLRJEtValuesSignal = nullptr;
    std::vector<double>* gFexLRJEtaValuesSignal = nullptr;
    std::vector<double>* gFexLRJPhiValuesSignal = nullptr;
    std::vector<double>* gFexLRJLeadingEtValuesSignal = nullptr;
    std::vector<double>* gFexLRJLeadingEtaValuesSignal = nullptr;
    std::vector<double>* gFexLRJLeadingPhiValuesSignal = nullptr;
    std::vector<double>* gFexLRJSubleadingEtValuesSignal = nullptr;
    std::vector<double>* gFexLRJSubleadingEtaValuesSignal = nullptr;
    std::vector<double>* gFexLRJSubleadingPhiValuesSignal = nullptr;
    std::vector<unsigned int>* jFexSRJEtIndexValuesSignal = nullptr;
    std::vector<double>* jFexSRJEtValuesSignal = nullptr;
    std::vector<double>* jFexSRJEtaValuesSignal = nullptr;
    std::vector<double>* jFexSRJPhiValuesSignal = nullptr;
    std::vector<double>* jFexSRJLeadingEtValuesSignal = nullptr;
    std::vector<double>* jFexSRJLeadingEtaValuesSignal = nullptr;
    std::vector<double>* jFexSRJLeadingPhiValuesSignal = nullptr;
    std::vector<double>* jFexSRJSubleadingEtValuesSignal = nullptr;
    std::vector<double>* jFexSRJSubleadingEtaValuesSignal = nullptr;
    std::vector<double>* jFexSRJSubleadingPhiValuesSignal = nullptr;
    std::vector<unsigned int>* jFexLRJEtIndexValuesSignal = nullptr;
    std::vector<double>* jFexLRJEtValuesSignal = nullptr;
    std::vector<double>* jFexLRJEtaValuesSignal = nullptr;
    std::vector<double>* jFexLRJPhiValuesSignal = nullptr;
    std::vector<double>* jFexLRJLeadingEtValuesSignal = nullptr;
    std::vector<double>* jFexLRJLeadingEtaValuesSignal = nullptr;
    std::vector<double>* jFexLRJLeadingPhiValuesSignal = nullptr;
    std::vector<double>* jFexLRJSubleadingEtValuesSignal = nullptr;
    std::vector<double>* jFexLRJSubleadingEtaValuesSignal = nullptr;
    std::vector<double>* jFexLRJSubleadingPhiValuesSignal = nullptr;
    std::vector<unsigned int>* hltAntiKt4SRJEtIndexValuesSignal = nullptr;
    std::vector<double>* hltAntiKt4SRJEtValuesSignal = nullptr;
    std::vector<double>* hltAntiKt4SRJEtaValuesSignal = nullptr;
    std::vector<double>* hltAntiKt4SRJPhiValuesSignal = nullptr;
    std::vector<double>* hltAntiKt4SRJLeadingEtValuesSignal = nullptr;
    std::vector<double>* hltAntiKt4SRJLeadingEtaValuesSignal = nullptr;
    std::vector<double>* hltAntiKt4SRJLeadingPhiValuesSignal = nullptr;
    std::vector<double>* hltAntiKt4SRJSubleadingEtValuesSignal = nullptr;
    std::vector<double>* hltAntiKt4SRJSubleadingEtaValuesSignal = nullptr;
    std::vector<double>* hltAntiKt4SRJSubleadingPhiValuesSignal = nullptr;
    std::vector<unsigned int>* recoAntiKt10LRJEtIndexValuesSignal = nullptr;
    std::vector<double>* recoAntiKt10LRJEtValuesSignal = nullptr;
    std::vector<double>* recoAntiKt10LRJEtaValuesSignal = nullptr;
    std::vector<double>* recoAntiKt10LRJPhiValuesSignal = nullptr;
    std::vector<double>* recoAntiKt10LRJMassValuesSignal = nullptr;
    std::vector<double>* recoAntiKt10LRJLeadingEtValuesSignal = nullptr;
    std::vector<double>* recoAntiKt10LRJLeadingEtaValuesSignal = nullptr;
    std::vector<double>* recoAntiKt10LRJLeadingPhiValuesSignal = nullptr;
    std::vector<double>* recoAntiKt10LRJLeadingMassValuesSignal = nullptr;
    std::vector<double>* recoAntiKt10LRJSubleadingEtValuesSignal = nullptr;
    std::vector<double>* recoAntiKt10LRJSubleadingEtaValuesSignal = nullptr;
    std::vector<double>* recoAntiKt10LRJSubleadingPhiValuesSignal = nullptr;
    std::vector<double>* recoAntiKt10LRJSubleadingMassValuesSignal = nullptr;
    std::vector<unsigned int>* truthAntiKt4WZSRJEtIndexValuesSignal = nullptr;
    std::vector<double>* truthAntiKt4WZSRJEtValuesSignal = nullptr;
    std::vector<double>* truthAntiKt4WZSRJEtaValuesSignal = nullptr;
    std::vector<double>* truthAntiKt4WZSRJPhiValuesSignal = nullptr;
    std::vector<double>* truthAntiKt4WZSRJMassValuesSignal = nullptr;
    std::vector<double>* truthAntiKt4WZSRJLeadingEtValuesSignal = nullptr;
    std::vector<double>* truthAntiKt4WZSRJLeadingEtaValuesSignal = nullptr;
    std::vector<double>* truthAntiKt4WZSRJLeadingPhiValuesSignal = nullptr;
    std::vector<double>* truthAntiKt4WZSRJLeadingMassValuesSignal = nullptr;
    std::vector<double>* truthAntiKt4WZSRJSubleadingEtValuesSignal = nullptr;
    std::vector<double>* truthAntiKt4WZSRJSubleadingEtaValuesSignal = nullptr;
    std::vector<double>* truthAntiKt4WZSRJSubleadingPhiValuesSignal = nullptr;
    std::vector<double>* truthAntiKt4WZSRJSubleadingMassValuesSignal = nullptr;
    std::vector<unsigned int>* inTimeAntiKt4TruthSRJEtIndexValuesSignal = nullptr;
    std::vector<double>* inTimeAntiKt4TruthSRJEtValuesSignal = nullptr;
    std::vector<double>* inTimeAntiKt4TruthSRJEtaValuesSignal = nullptr;
    std::vector<double>* inTimeAntiKt4TruthSRJPhiValuesSignal = nullptr;
    std::vector<double>* inTimeAntiKt4TruthSRJLeadingEtValuesSignal = nullptr;
    std::vector<double>* inTimeAntiKt4TruthSRJLeadingEtaValuesSignal = nullptr;
    std::vector<double>* inTimeAntiKt4TruthSRJLeadingPhiValuesSignal = nullptr;
    std::vector<double>* inTimeAntiKt4TruthSRJSubleadingEtValuesSignal = nullptr;
    std::vector<double>* inTimeAntiKt4TruthSRJSubleadingEtaValuesSignal = nullptr;
    std::vector<double>* inTimeAntiKt4TruthSRJSubleadingPhiValuesSignal = nullptr;

    std::vector<unsigned int>* higgsIndexValuesBack = nullptr;
    std::vector<unsigned int>* indexOfHiggsValuesBack = nullptr;
    std::vector<double>* truthbquarksEtValuesBack = nullptr;
    std::vector<double>* truthbquarksEnergyValuesBack = nullptr;
    std::vector<double>* truthbquarkspTValuesBack = nullptr;
    std::vector<double>* truthbquarkspxValuesBack = nullptr;
    std::vector<double>* truthbquarkspyValuesBack = nullptr;
    std::vector<double>* truthbquarkspzValuesBack = nullptr;
    std::vector<double>* truthbquarksEtaValuesBack = nullptr;
    std::vector<double>* truthbquarksPhiValuesBack = nullptr;
    std::vector<double>* truthHiggsEtValuesBack = nullptr;
    std::vector<double>* truthHiggsEnergyValuesBack = nullptr;
    std::vector<double>* truthHiggspTValuesBack = nullptr;
    std::vector<double>* truthHiggspxValuesBack = nullptr;
    std::vector<double>* truthHiggspyValuesBack = nullptr;
    std::vector<double>* truthHiggspzValuesBack = nullptr;
    std::vector<double>* truthHiggsEtaValuesBack = nullptr;
    std::vector<double>* truthHiggsPhiValuesBack = nullptr;
    std::vector<double>* truthHiggsInvMassValuesBack = nullptr;
    std::vector<double>* mcEventWeightsValuesBack = nullptr;
    double sumOfWeightsForSampleValuesBack = 0.0;
    std::vector<double>* eventWeightsValuesBack = nullptr;
    int sampleJZSliceValuesBack = -1;
    std::vector<double>* jetTaggerLRJPsi_RValuesBack = nullptr;
    std::vector<unsigned int>* jetTaggerLRJMergedIndicesValuesBack = nullptr;
    std::vector<double>* jetTaggerLRJEtValuesBack = nullptr;
    std::vector<double>* jetTaggerLRJEtaValuesBack = nullptr;
    std::vector<double>* jetTaggerLRJPhiValuesBack = nullptr;
    std::vector<double>* jetTaggerLeadingLRJPsi_RValuesBack = nullptr;
    std::vector<double>* jetTaggerLeadingLRJMergedIndicesValuesBack = nullptr;
    std::vector<double>* jetTaggerLeadingLRJEtValuesBack = nullptr;
    std::vector<double>* jetTaggerLeadingLRJEtaValuesBack = nullptr;
    std::vector<double>* jetTaggerLeadingLRJPhiValuesBack = nullptr;
    std::vector<double>* jetTaggerSubleadingLRJPsi_RValuesBack = nullptr;
    std::vector<double>* jetTaggerSubleadingLRJMergedIndicesValuesBack = nullptr;
    std::vector<double>* jetTaggerSubleadingLRJEtValuesBack = nullptr;
    std::vector<double>* jetTaggerSubleadingLRJEtaValuesBack = nullptr;
    std::vector<double>* jetTaggerSubleadingLRJPhiValuesBack = nullptr;
    std::vector<double>* caloTopoTowerEtValuesBack = nullptr;
    std::vector<double>* caloTopoTowerEtaValuesBack = nullptr;
    std::vector<double>* caloTopoTowerPhiValuesBack = nullptr;
    std::vector<double>* topo422EtValuesBack = nullptr;
    std::vector<double>* topo422EtaValuesBack = nullptr;
    std::vector<double>* topo422PhiValuesBack = nullptr;
    std::vector<double>* gepBasicClustersEtValuesBack = nullptr;
    std::vector<double>* gepBasicClustersEtaValuesBack = nullptr;
    std::vector<double>* gepBasicClustersPhiValuesBack = nullptr;
    std::vector<double>* gepCellsTowersEtValuesBack = nullptr;
    std::vector<double>* gepCellsTowersEtaValuesBack = nullptr;
    std::vector<double>* gepCellsTowersPhiValuesBack = nullptr;
    std::vector<double>* gepBasicClustersSKEtValuesBack = nullptr;
    std::vector<double>* gepBasicClustersSKEtaValuesBack = nullptr;
    std::vector<double>* gepBasicClustersSKPhiValuesBack = nullptr;
    std::vector<double>* gepCellsTowersSKEtValuesBack = nullptr;
    std::vector<double>* gepCellsTowersSKEtaValuesBack = nullptr;
    std::vector<double>* gepCellsTowersSKPhiValuesBack = nullptr;
    std::vector<double>* gepWTAConeCellsTowersJetspTValuesBack = nullptr;
    std::vector<double>* gepWTAConeCellsTowersJetsEtaValuesBack = nullptr;
    std::vector<double>* gepWTAConeCellsTowersJetsPhiValuesBack = nullptr;
    std::vector<unsigned int >* gepWTAConeCellsTowersJetsNConstituentsValuesBack = nullptr;
    std::vector<double>* gepLeadingWTAConeCellsTowersJetspTValuesBack = nullptr;
    std::vector<double>* gepLeadingWTAConeCellsTowersJetsEtaValuesBack = nullptr;
    std::vector<double>* gepLeadingWTAConeCellsTowersJetsPhiValuesBack = nullptr;
    std::vector<unsigned int >* gepLeadingWTAConeCellsTowersJetsNConstituentsValuesBack = nullptr;
    std::vector<double>* gepSubleadingWTAConeCellsTowersJetspTValuesBack = nullptr;
    std::vector<double>* gepSubleadingWTAConeCellsTowersJetsEtaValuesBack = nullptr;
    std::vector<double>* gepSubleadingWTAConeCellsTowersJetsPhiValuesBack = nullptr;
    std::vector<unsigned int >* gepSubleadingWTAConeCellsTowersJetsNConstituentsValuesBack = nullptr;
    std::vector<double>* gepWTAConeGEPBasicClustersJetspTValuesBack = nullptr;
    std::vector<double>* gepWTAConeGEPBasicClustersJetsEtaValuesBack = nullptr;
    std::vector<double>* gepWTAConeGEPBasicClustersJetsPhiValuesBack = nullptr;
    std::vector<unsigned int >* gepWTAConeGEPBasicClustersJetsNConstituentsValuesBack = nullptr;
    std::vector<double>* gepLeadingWTAConeGEPBasicClustersJetspTValuesBack = nullptr;
    std::vector<double>* gepLeadingWTAConeGEPBasicClustersJetsEtaValuesBack = nullptr;
    std::vector<double>* gepLeadingWTAConeGEPBasicClustersJetsPhiValuesBack = nullptr;
    std::vector<unsigned int >* gepLeadingWTAConeGEPBasicClustersJetsNConstituentsValuesBack = nullptr;
    std::vector<double>* gepSubleadingWTAConeGEPBasicClustersJetspTValuesBack = nullptr;
    std::vector<double>* gepSubleadingWTAConeGEPBasicClustersJetsEtaValuesBack = nullptr;
    std::vector<double>* gepSubleadingWTAConeGEPBasicClustersJetsPhiValuesBack = nullptr;
    std::vector<unsigned int >* gepSubleadingWTAConeGEPBasicClustersJetsNConstituentsValuesBack = nullptr;
    // --------------------- SK ----------------------------
    std::vector<double>* gepWTAConeCellsTowersSKJetspTValuesBack = nullptr;
    std::vector<double>* gepWTAConeCellsTowersSKJetsEtaValuesBack = nullptr;
    std::vector<double>* gepWTAConeCellsTowersSKJetsPhiValuesBack = nullptr;
    std::vector<unsigned int >* gepWTAConeCellsTowersSKJetsNConstituentsValuesBack = nullptr;
    std::vector<double>* gepLeadingWTAConeCellsTowersSKJetspTValuesBack = nullptr;
    std::vector<double>* gepLeadingWTAConeCellsTowersSKJetsEtaValuesBack = nullptr;
    std::vector<double>* gepLeadingWTAConeCellsTowersSKJetsPhiValuesBack = nullptr;
    std::vector<unsigned int >* gepLeadingWTAConeCellsTowersSKJetsNConstituentsValuesBack = nullptr;
    std::vector<double>* gepSubleadingWTAConeCellsTowersSKJetspTValuesBack = nullptr;
    std::vector<double>* gepSubleadingWTAConeCellsTowersSKJetsEtaValuesBack = nullptr;
    std::vector<double>* gepSubleadingWTAConeCellsTowersSKJetsPhiValuesBack = nullptr;
    std::vector<unsigned int >* gepSubleadingWTAConeCellsTowersSKJetsNConstituentsValuesBack = nullptr;
    std::vector<double>* gepWTAConeGEPBasicClustersSKJetspTValuesBack = nullptr;
    std::vector<double>* gepWTAConeGEPBasicClustersSKJetsEtaValuesBack = nullptr;
    std::vector<double>* gepWTAConeGEPBasicClustersSKJetsPhiValuesBack = nullptr;
    std::vector<unsigned int >* gepWTAConeGEPBasicClustersSKJetsNConstituentsValuesBack = nullptr;
    std::vector<double>* gepLeadingWTAConeGEPBasicClustersSKJetspTValuesBack = nullptr;
    std::vector<double>* gepLeadingWTAConeGEPBasicClustersSKJetsEtaValuesBack = nullptr;
    std::vector<double>* gepLeadingWTAConeGEPBasicClustersSKJetsPhiValuesBack = nullptr;
    std::vector<unsigned int >* gepLeadingWTAConeGEPBasicClustersSKJetsNConstituentsValuesBack = nullptr;
    std::vector<double>* gepSubleadingWTAConeGEPBasicClustersSKJetspTValuesBack = nullptr;
    std::vector<double>* gepSubleadingWTAConeGEPBasicClustersSKJetsEtaValuesBack = nullptr;
    std::vector<double>* gepSubleadingWTAConeGEPBasicClustersSKJetsPhiValuesBack = nullptr;
    std::vector<unsigned int >* gepSubleadingWTAConeGEPBasicClustersSKJetsNConstituentsValuesBack = nullptr;
    // ---------------------- SK --------------------
    std::vector<unsigned int>* gFexSRJEtIndexValuesBack = nullptr;
    std::vector<double>* gFexSRJEtValuesBack = nullptr;
    std::vector<double>* gFexSRJEtaValuesBack = nullptr;
    std::vector<double>* gFexSRJPhiValuesBack = nullptr;
    std::vector<double>* gFexSRJLeadingEtValuesBack = nullptr;
    std::vector<double>* gFexSRJLeadingEtaValuesBack = nullptr;
    std::vector<double>* gFexSRJLeadingPhiValuesBack = nullptr;
    std::vector<double>* gFexSRJSubleadingEtValuesBack = nullptr;
    std::vector<double>* gFexSRJSubleadingEtaValuesBack = nullptr;
    std::vector<double>* gFexSRJSubleadingPhiValuesBack = nullptr;
    std::vector<unsigned int>* gFexLRJEtIndexValuesBack = nullptr;
    std::vector<double>* gFexLRJEtValuesBack = nullptr;
    std::vector<double>* gFexLRJEtaValuesBack = nullptr;
    std::vector<double>* gFexLRJPhiValuesBack = nullptr;
    std::vector<double>* gFexLRJLeadingEtValuesBack = nullptr;
    std::vector<double>* gFexLRJLeadingEtaValuesBack = nullptr;
    std::vector<double>* gFexLRJLeadingPhiValuesBack = nullptr;
    std::vector<double>* gFexLRJSubleadingEtValuesBack = nullptr;
    std::vector<double>* gFexLRJSubleadingEtaValuesBack = nullptr;
    std::vector<double>* gFexLRJSubleadingPhiValuesBack = nullptr;
    std::vector<unsigned int>* jFexSRJEtIndexValuesBack = nullptr;
    std::vector<double>* jFexSRJEtValuesBack = nullptr;
    std::vector<double>* jFexSRJEtaValuesBack = nullptr;
    std::vector<double>* jFexSRJPhiValuesBack = nullptr;
    std::vector<double>* jFexSRJLeadingEtValuesBack = nullptr;
    std::vector<double>* jFexSRJLeadingEtaValuesBack = nullptr;
    std::vector<double>* jFexSRJLeadingPhiValuesBack = nullptr;
    std::vector<double>* jFexSRJSubleadingEtValuesBack = nullptr;
    std::vector<double>* jFexSRJSubleadingEtaValuesBack = nullptr;
    std::vector<double>* jFexSRJSubleadingPhiValuesBack = nullptr;
    std::vector<unsigned int>* jFexLRJEtIndexValuesBack = nullptr;
    std::vector<double>* jFexLRJEtValuesBack = nullptr;
    std::vector<double>* jFexLRJEtaValuesBack = nullptr;
    std::vector<double>* jFexLRJPhiValuesBack = nullptr;
    std::vector<double>* jFexLRJLeadingEtValuesBack = nullptr;
    std::vector<double>* jFexLRJLeadingEtaValuesBack = nullptr;
    std::vector<double>* jFexLRJLeadingPhiValuesBack = nullptr;
    std::vector<double>* jFexLRJSubleadingEtValuesBack = nullptr;
    std::vector<double>* jFexLRJSubleadingEtaValuesBack = nullptr;
    std::vector<double>* jFexLRJSubleadingPhiValuesBack = nullptr;
    std::vector<unsigned int>* hltAntiKt4SRJEtIndexValuesBack = nullptr;
    std::vector<double>* hltAntiKt4SRJEtValuesBack = nullptr;
    std::vector<double>* hltAntiKt4SRJEtaValuesBack = nullptr;
    std::vector<double>* hltAntiKt4SRJPhiValuesBack = nullptr;
    std::vector<double>* hltAntiKt4SRJLeadingEtValuesBack = nullptr;
    std::vector<double>* hltAntiKt4SRJLeadingEtaValuesBack = nullptr;
    std::vector<double>* hltAntiKt4SRJLeadingPhiValuesBack = nullptr;
    std::vector<double>* hltAntiKt4SRJSubleadingEtValuesBack = nullptr;
    std::vector<double>* hltAntiKt4SRJSubleadingEtaValuesBack = nullptr;
    std::vector<double>* hltAntiKt4SRJSubleadingPhiValuesBack = nullptr;
    std::vector<unsigned int>* recoAntiKt10LRJEtIndexValuesBack = nullptr;
    std::vector<double>* recoAntiKt10LRJEtValuesBack = nullptr;
    std::vector<double>* recoAntiKt10LRJEtaValuesBack = nullptr;
    std::vector<double>* recoAntiKt10LRJPhiValuesBack = nullptr;
    std::vector<double>* recoAntiKt10LRJMassValuesBack = nullptr;
    std::vector<double>* recoAntiKt10LRJLeadingEtValuesBack = nullptr;
    std::vector<double>* recoAntiKt10LRJLeadingEtaValuesBack = nullptr;
    std::vector<double>* recoAntiKt10LRJLeadingPhiValuesBack = nullptr;
    std::vector<double>* recoAntiKt10LRJLeadingMassValuesBack = nullptr;
    std::vector<double>* recoAntiKt10LRJSubleadingEtValuesBack = nullptr;
    std::vector<double>* recoAntiKt10LRJSubleadingEtaValuesBack = nullptr;
    std::vector<double>* recoAntiKt10LRJSubleadingPhiValuesBack = nullptr;
    std::vector<double>* recoAntiKt10LRJSubleadingMassValuesBack = nullptr;
    std::vector<unsigned int>* truthAntiKt4WZSRJEtIndexValuesBack = nullptr;
    std::vector<double>* truthAntiKt4WZSRJEtValuesBack = nullptr;
    std::vector<double>* truthAntiKt4WZSRJEtaValuesBack = nullptr;
    std::vector<double>* truthAntiKt4WZSRJPhiValuesBack = nullptr;
    std::vector<double>* truthAntiKt4WZSRJLeadingEtValuesBack = nullptr;
    std::vector<double>* truthAntiKt4WZSRJLeadingEtaValuesBack = nullptr;
    std::vector<double>* truthAntiKt4WZSRJLeadingPhiValuesBack = nullptr;
    std::vector<double>* truthAntiKt4WZSRJSubleadingEtValuesBack = nullptr;
    std::vector<double>* truthAntiKt4WZSRJSubleadingEtaValuesBack = nullptr;
    std::vector<double>* truthAntiKt4WZSRJSubleadingPhiValuesBack = nullptr;
    std::vector<unsigned int>* inTimeAntiKt4TruthSRJEtIndexValuesBack = nullptr;
    std::vector<double>* inTimeAntiKt4TruthSRJEtValuesBack = nullptr;
    std::vector<double>* inTimeAntiKt4TruthSRJEtaValuesBack = nullptr;
    std::vector<double>* inTimeAntiKt4TruthSRJPhiValuesBack = nullptr;
    std::vector<double>* inTimeAntiKt4TruthSRJLeadingEtValuesBack = nullptr;
    std::vector<double>* inTimeAntiKt4TruthSRJLeadingEtaValuesBack = nullptr;
    std::vector<double>* inTimeAntiKt4TruthSRJLeadingPhiValuesBack = nullptr;
    std::vector<double>* inTimeAntiKt4TruthSRJSubleadingEtValuesBack = nullptr;
    std::vector<double>* inTimeAntiKt4TruthSRJSubleadingEtaValuesBack = nullptr;
    std::vector<double>* inTimeAntiKt4TruthSRJSubleadingPhiValuesBack = nullptr;

    // === eventInfoTreeSignal ===
    eventInfoTreeSignal->SetBranchAddress("mcEventWeight", &mcEventWeightsValuesSignal);
    eventInfoTreeSignal->SetBranchAddress("sumOfWeightsForSample", &sumOfWeightsForSampleValuesSignal);
    eventInfoTreeSignal->SetBranchAddress("eventWeights", &eventWeightsValuesSignal);
    eventInfoTreeSignal->SetBranchAddress("sampleJZSlice", &sampleJZSliceValuesSignal);

    // === jetTaggerLRJsSignal ===
    jetTaggerLRJsSignal->SetBranchAddress("Psi_R", &jetTaggerLRJPsi_RValuesSignal);
    jetTaggerLRJsSignal->SetBranchAddress("MergedIndices", &jetTaggerLRJMergedIndicesValuesSignal);
    jetTaggerLRJsSignal->SetBranchAddress("Et", &jetTaggerLRJEtValuesSignal);
    jetTaggerLRJsSignal->SetBranchAddress("Eta", &jetTaggerLRJEtaValuesSignal);
    jetTaggerLRJsSignal->SetBranchAddress("Phi", &jetTaggerLRJPhiValuesSignal);

    // === jetTaggerLeadingLRJsSignal ===
    jetTaggerLeadingLRJsSignal->SetBranchAddress("Psi_R", &jetTaggerLeadingLRJPsi_RValuesSignal);
    jetTaggerLeadingLRJsSignal->SetBranchAddress("MergedIndices", &jetTaggerLeadingLRJMergedIndicesValuesSignal);
    jetTaggerLeadingLRJsSignal->SetBranchAddress("Et", &jetTaggerLeadingLRJEtValuesSignal);
    jetTaggerLeadingLRJsSignal->SetBranchAddress("Eta", &jetTaggerLeadingLRJEtaValuesSignal);
    jetTaggerLeadingLRJsSignal->SetBranchAddress("Phi", &jetTaggerLeadingLRJPhiValuesSignal);

    // === jetTaggerSubleadingLRJsSignal ===
    jetTaggerSubleadingLRJsSignal->SetBranchAddress("Psi_R", &jetTaggerSubleadingLRJPsi_RValuesSignal);
    jetTaggerSubleadingLRJsSignal->SetBranchAddress("MergedIndices", &jetTaggerSubleadingLRJMergedIndicesValuesSignal);
    jetTaggerSubleadingLRJsSignal->SetBranchAddress("Et", &jetTaggerSubleadingLRJEtValuesSignal);
    jetTaggerSubleadingLRJsSignal->SetBranchAddress("Eta", &jetTaggerSubleadingLRJEtaValuesSignal);
    jetTaggerSubleadingLRJsSignal->SetBranchAddress("Phi", &jetTaggerSubleadingLRJPhiValuesSignal);

    // === truthbTreeSignal ===
    truthbTreeSignal->SetBranchAddress("higgsIndex", &higgsIndexValuesSignal);
    truthbTreeSignal->SetBranchAddress("Et", &truthbquarksEtValuesSignal);
    truthbTreeSignal->SetBranchAddress("Energy", &truthbquarksEnergyValuesSignal);
    truthbTreeSignal->SetBranchAddress("pT", &truthbquarkspTValuesSignal);
    truthbTreeSignal->SetBranchAddress("px", &truthbquarkspxValuesSignal);
    truthbTreeSignal->SetBranchAddress("py", &truthbquarkspyValuesSignal);
    truthbTreeSignal->SetBranchAddress("pz", &truthbquarkspzValuesSignal);
    truthbTreeSignal->SetBranchAddress("Eta", &truthbquarksEtaValuesSignal);
    truthbTreeSignal->SetBranchAddress("Phi", &truthbquarksPhiValuesSignal);

    // === truthHiggsTreeSignal ===
    truthHiggsTreeSignal->SetBranchAddress("indexOfHiggs", &indexOfHiggsValuesSignal);
    truthHiggsTreeSignal->SetBranchAddress("invMass", &truthHiggsInvMassValuesSignal);
    truthHiggsTreeSignal->SetBranchAddress("Et", &truthHiggsEtValuesSignal);
    truthHiggsTreeSignal->SetBranchAddress("Energy", &truthHiggsEnergyValuesSignal);
    truthHiggsTreeSignal->SetBranchAddress("pT", &truthHiggspTValuesSignal);
    truthHiggsTreeSignal->SetBranchAddress("px", &truthHiggspxValuesSignal);
    truthHiggsTreeSignal->SetBranchAddress("py", &truthHiggspyValuesSignal);
    truthHiggsTreeSignal->SetBranchAddress("pz", &truthHiggspzValuesSignal);
    truthHiggsTreeSignal->SetBranchAddress("Eta", &truthHiggsEtaValuesSignal);
    truthHiggsTreeSignal->SetBranchAddress("Phi", &truthHiggsPhiValuesSignal);

    // === caloTopoTowerTreeSignal ===
    caloTopoTowerTreeSignal->SetBranchAddress("Et", &caloTopoTowerEtValuesSignal);
    caloTopoTowerTreeSignal->SetBranchAddress("Eta", &caloTopoTowerEtaValuesSignal);
    caloTopoTowerTreeSignal->SetBranchAddress("Phi", &caloTopoTowerPhiValuesSignal);

    // === topo422TreeSignal ===
    topo422TreeSignal->SetBranchAddress("Et", &topo422EtValuesSignal);
    topo422TreeSignal->SetBranchAddress("Eta", &topo422EtaValuesSignal);
    topo422TreeSignal->SetBranchAddress("Phi", &topo422PhiValuesSignal);

    // === gepBasicClustersTree ===
    gepBasicClustersTreeSignal->SetBranchAddress("Et", &gepBasicClustersEtValuesSignal);
    gepBasicClustersTreeSignal->SetBranchAddress("Eta", &gepBasicClustersEtaValuesSignal);
    gepBasicClustersTreeSignal->SetBranchAddress("Phi", &gepBasicClustersPhiValuesSignal);

    // === gepCellsTowersTree ===
    gepCellsTowersTreeSignal->SetBranchAddress("Et", &gepCellsTowersEtValuesSignal);
    gepCellsTowersTreeSignal->SetBranchAddress("Eta", &gepCellsTowersEtaValuesSignal);
    gepCellsTowersTreeSignal->SetBranchAddress("Phi", &gepCellsTowersPhiValuesSignal);

    // === gepBasicClustersSKTree SK ===
    gepBasicClustersSKTreeSignal->SetBranchAddress("Et", &gepBasicClustersSKEtValuesSignal);
    gepBasicClustersSKTreeSignal->SetBranchAddress("Eta", &gepBasicClustersSKEtaValuesSignal);
    gepBasicClustersSKTreeSignal->SetBranchAddress("Phi", &gepBasicClustersSKPhiValuesSignal);

    // === gepCellsTowersSKTree ===
    gepCellsTowersSKTreeSignal->SetBranchAddress("Et", &gepCellsTowersSKEtValuesSignal);
    gepCellsTowersSKTreeSignal->SetBranchAddress("Eta", &gepCellsTowersSKEtaValuesSignal);
    gepCellsTowersSKTreeSignal->SetBranchAddress("Phi", &gepCellsTowersSKPhiValuesSignal);


    // gep wta cone cells towers jets
    gepWTAConeCellsTowersJetsTreeSignal->SetBranchAddress("pT", &gepWTAConeCellsTowersJetspTValuesSignal);
    gepWTAConeCellsTowersJetsTreeSignal->SetBranchAddress("Eta", &gepWTAConeCellsTowersJetsEtaValuesSignal);
    gepWTAConeCellsTowersJetsTreeSignal->SetBranchAddress("Phi", &gepWTAConeCellsTowersJetsPhiValuesSignal);
    gepWTAConeCellsTowersJetsTreeSignal->SetBranchAddress("NConstituents", &gepWTAConeCellsTowersJetsNConstituentsValuesSignal);

    // leading gep wta cone cells towers jets
    gepLeadingWTAConeCellsTowersJetsTreeSignal->SetBranchAddress("pT", &gepLeadingWTAConeCellsTowersJetspTValuesSignal);
    gepLeadingWTAConeCellsTowersJetsTreeSignal->SetBranchAddress("Eta", &gepLeadingWTAConeCellsTowersJetsEtaValuesSignal);
    gepLeadingWTAConeCellsTowersJetsTreeSignal->SetBranchAddress("Phi", &gepLeadingWTAConeCellsTowersJetsPhiValuesSignal);
    gepLeadingWTAConeCellsTowersJetsTreeSignal->SetBranchAddress("NConstituents", &gepLeadingWTAConeCellsTowersJetsNConstituentsValuesSignal);

    // subleading gep wta cone cells towers jets
    gepSubleadingWTAConeCellsTowersJetsTreeSignal->SetBranchAddress("pT", &gepSubleadingWTAConeCellsTowersJetspTValuesSignal);
    gepSubleadingWTAConeCellsTowersJetsTreeSignal->SetBranchAddress("Eta", &gepSubleadingWTAConeCellsTowersJetsEtaValuesSignal);
    gepSubleadingWTAConeCellsTowersJetsTreeSignal->SetBranchAddress("Phi", &gepSubleadingWTAConeCellsTowersJetsPhiValuesSignal);
    gepSubleadingWTAConeCellsTowersJetsTreeSignal->SetBranchAddress("NConstituents", &gepSubleadingWTAConeCellsTowersJetsNConstituentsValuesSignal);

    // gep wta cone basic clusters jets
    gepWTAConeBasicClustersJetsTreeSignal->SetBranchAddress("pT", &gepWTAConeGEPBasicClustersJetspTValuesSignal);
    gepWTAConeBasicClustersJetsTreeSignal->SetBranchAddress("Eta", &gepWTAConeGEPBasicClustersJetsEtaValuesSignal);
    gepWTAConeBasicClustersJetsTreeSignal->SetBranchAddress("Phi", &gepWTAConeGEPBasicClustersJetsPhiValuesSignal);
    gepWTAConeBasicClustersJetsTreeSignal->SetBranchAddress("NConstituents", &gepWTAConeGEPBasicClustersJetsNConstituentsValuesSignal);

    // leading gep wta cone basic clusters jets
    gepLeadingWTAConeBasicClustersJetsTreeSignal->SetBranchAddress("pT", &gepLeadingWTAConeGEPBasicClustersJetspTValuesSignal);
    gepLeadingWTAConeBasicClustersJetsTreeSignal->SetBranchAddress("Eta", &gepLeadingWTAConeGEPBasicClustersJetsEtaValuesSignal);
    gepLeadingWTAConeBasicClustersJetsTreeSignal->SetBranchAddress("Phi", &gepLeadingWTAConeGEPBasicClustersJetsPhiValuesSignal);
    gepLeadingWTAConeBasicClustersJetsTreeSignal->SetBranchAddress("NConstituents", &gepLeadingWTAConeGEPBasicClustersJetsNConstituentsValuesSignal);

    // subleading gep wta cone basic clusters jets
    gepSubleadingWTAConeBasicClustersJetsTreeSignal->SetBranchAddress("pT", &gepSubleadingWTAConeGEPBasicClustersJetspTValuesSignal);
    gepSubleadingWTAConeBasicClustersJetsTreeSignal->SetBranchAddress("Eta", &gepSubleadingWTAConeGEPBasicClustersJetsEtaValuesSignal);
    gepSubleadingWTAConeBasicClustersJetsTreeSignal->SetBranchAddress("Phi", &gepSubleadingWTAConeGEPBasicClustersJetsPhiValuesSignal);
    gepSubleadingWTAConeBasicClustersJetsTreeSignal->SetBranchAddress("NConstituents", &gepSubleadingWTAConeGEPBasicClustersJetsNConstituentsValuesSignal);
    
    // ------------ SK PU Suppressed cone jets -------------

    // SK gep wta cone cells towers jets
    gepWTAConeCellsTowersSKJetsTreeSignal->SetBranchAddress("pT", &gepWTAConeCellsTowersSKJetspTValuesSignal);
    gepWTAConeCellsTowersSKJetsTreeSignal->SetBranchAddress("Eta", &gepWTAConeCellsTowersSKJetsEtaValuesSignal);
    gepWTAConeCellsTowersSKJetsTreeSignal->SetBranchAddress("Phi", &gepWTAConeCellsTowersSKJetsPhiValuesSignal);
    gepWTAConeCellsTowersSKJetsTreeSignal->SetBranchAddress("NConstituents", &gepWTAConeCellsTowersSKJetsNConstituentsValuesSignal);

    // leading SK gep wta cone cells towers jets
    gepLeadingWTAConeCellsTowersSKJetsTreeSignal->SetBranchAddress("pT", &gepLeadingWTAConeCellsTowersSKJetspTValuesSignal);
    gepLeadingWTAConeCellsTowersSKJetsTreeSignal->SetBranchAddress("Eta", &gepLeadingWTAConeCellsTowersSKJetsEtaValuesSignal);
    gepLeadingWTAConeCellsTowersSKJetsTreeSignal->SetBranchAddress("Phi", &gepLeadingWTAConeCellsTowersSKJetsPhiValuesSignal);
    gepLeadingWTAConeCellsTowersSKJetsTreeSignal->SetBranchAddress("NConstituents", &gepLeadingWTAConeCellsTowersSKJetsNConstituentsValuesSignal);

    // subleading SK gep wta cone cells towers jets
    gepSubleadingWTAConeCellsTowersSKJetsTreeSignal->SetBranchAddress("pT", &gepSubleadingWTAConeCellsTowersSKJetspTValuesSignal);
    gepSubleadingWTAConeCellsTowersSKJetsTreeSignal->SetBranchAddress("Eta", &gepSubleadingWTAConeCellsTowersSKJetsEtaValuesSignal);
    gepSubleadingWTAConeCellsTowersSKJetsTreeSignal->SetBranchAddress("Phi", &gepSubleadingWTAConeCellsTowersSKJetsPhiValuesSignal);
    gepSubleadingWTAConeCellsTowersSKJetsTreeSignal->SetBranchAddress("NConstituents", &gepSubleadingWTAConeCellsTowersSKJetsNConstituentsValuesSignal);

    // SK gep wta cone basic clusters jets
    gepWTAConeBasicClustersSKJetsTreeSignal->SetBranchAddress("pT", &gepWTAConeGEPBasicClustersSKJetspTValuesSignal);
    gepWTAConeBasicClustersSKJetsTreeSignal->SetBranchAddress("Eta", &gepWTAConeGEPBasicClustersSKJetsEtaValuesSignal);
    gepWTAConeBasicClustersSKJetsTreeSignal->SetBranchAddress("Phi", &gepWTAConeGEPBasicClustersSKJetsPhiValuesSignal);
    gepWTAConeBasicClustersSKJetsTreeSignal->SetBranchAddress("NConstituents", &gepWTAConeGEPBasicClustersSKJetsNConstituentsValuesSignal);

    // SK leading gep wta cone basic clusters jets
    gepLeadingWTAConeBasicClustersSKJetsTreeSignal->SetBranchAddress("pT", &gepLeadingWTAConeGEPBasicClustersSKJetspTValuesSignal);
    gepLeadingWTAConeBasicClustersSKJetsTreeSignal->SetBranchAddress("Eta", &gepLeadingWTAConeGEPBasicClustersSKJetsEtaValuesSignal);
    gepLeadingWTAConeBasicClustersSKJetsTreeSignal->SetBranchAddress("Phi", &gepLeadingWTAConeGEPBasicClustersSKJetsPhiValuesSignal);
    gepLeadingWTAConeBasicClustersSKJetsTreeSignal->SetBranchAddress("NConstituents", &gepLeadingWTAConeGEPBasicClustersSKJetsNConstituentsValuesSignal);

    // SK subleading gep wta cone basic clusters jets
    gepSubleadingWTAConeBasicClustersSKJetsTreeSignal->SetBranchAddress("pT", &gepSubleadingWTAConeGEPBasicClustersSKJetspTValuesSignal);
    gepSubleadingWTAConeBasicClustersSKJetsTreeSignal->SetBranchAddress("Eta", &gepSubleadingWTAConeGEPBasicClustersSKJetsEtaValuesSignal);
    gepSubleadingWTAConeBasicClustersSKJetsTreeSignal->SetBranchAddress("Phi", &gepSubleadingWTAConeGEPBasicClustersSKJetsPhiValuesSignal);
    gepSubleadingWTAConeBasicClustersSKJetsTreeSignal->SetBranchAddress("NConstituents", &gepSubleadingWTAConeGEPBasicClustersSKJetsNConstituentsValuesSignal);

    // === gFexSRJTreeSignal ===
    gFexSRJTreeSignal->SetBranchAddress("EtIndex", &gFexSRJEtIndexValuesSignal);
    gFexSRJTreeSignal->SetBranchAddress("Et", &gFexSRJEtValuesSignal);
    gFexSRJTreeSignal->SetBranchAddress("Eta", &gFexSRJEtaValuesSignal);
    gFexSRJTreeSignal->SetBranchAddress("Phi", &gFexSRJPhiValuesSignal);

    // === gFexLeadingSRJTreeSignal ===
    gFexLeadingSRJTreeSignal->SetBranchAddress("Et", &gFexSRJLeadingEtValuesSignal);
    gFexLeadingSRJTreeSignal->SetBranchAddress("Eta", &gFexSRJLeadingEtaValuesSignal);
    gFexLeadingSRJTreeSignal->SetBranchAddress("Phi", &gFexSRJLeadingPhiValuesSignal);

    // === gFexSubleadingSRJTreeSignal ===
    gFexSubleadingSRJTreeSignal->SetBranchAddress("Et", &gFexSRJSubleadingEtValuesSignal);
    gFexSubleadingSRJTreeSignal->SetBranchAddress("Eta", &gFexSRJSubleadingEtaValuesSignal);
    gFexSubleadingSRJTreeSignal->SetBranchAddress("Phi", &gFexSRJSubleadingPhiValuesSignal);

    // === gFexLRJTreeSignal ===
    gFexLRJTreeSignal->SetBranchAddress("EtIndex", &gFexLRJEtIndexValuesSignal);
    gFexLRJTreeSignal->SetBranchAddress("Et", &gFexLRJEtValuesSignal);
    gFexLRJTreeSignal->SetBranchAddress("Eta", &gFexLRJEtaValuesSignal);
    gFexLRJTreeSignal->SetBranchAddress("Phi", &gFexLRJPhiValuesSignal);

    // === gFexLeadingLRJTreeSignal ===
    gFexLeadingLRJTreeSignal->SetBranchAddress("Et", &gFexLRJLeadingEtValuesSignal);
    gFexLeadingLRJTreeSignal->SetBranchAddress("Eta", &gFexLRJLeadingEtaValuesSignal);
    gFexLeadingLRJTreeSignal->SetBranchAddress("Phi", &gFexLRJLeadingPhiValuesSignal);

    // === gFexSubleadingLRJTreeSignal ===
    gFexSubleadingLRJTreeSignal->SetBranchAddress("Et", &gFexLRJSubleadingEtValuesSignal);
    gFexSubleadingLRJTreeSignal->SetBranchAddress("Eta", &gFexLRJSubleadingEtaValuesSignal);
    gFexSubleadingLRJTreeSignal->SetBranchAddress("Phi", &gFexLRJSubleadingPhiValuesSignal);

    // === jFexSRJTreeSignal ===
    jFexSRJTreeSignal->SetBranchAddress("EtIndex", &jFexSRJEtIndexValuesSignal);
    jFexSRJTreeSignal->SetBranchAddress("Et", &jFexSRJEtValuesSignal);
    jFexSRJTreeSignal->SetBranchAddress("Eta", &jFexSRJEtaValuesSignal);
    jFexSRJTreeSignal->SetBranchAddress("Phi", &jFexSRJPhiValuesSignal);

    // === jFexLeadingSRJTreeSignal ===
    jFexLeadingSRJTreeSignal->SetBranchAddress("Et", &jFexSRJLeadingEtValuesSignal);
    jFexLeadingSRJTreeSignal->SetBranchAddress("Eta", &jFexSRJLeadingEtaValuesSignal);
    jFexLeadingSRJTreeSignal->SetBranchAddress("Phi", &jFexSRJLeadingPhiValuesSignal);

    // === jFexSubleadingSRJTreeSignal ===
    jFexSubleadingSRJTreeSignal->SetBranchAddress("Et", &jFexSRJSubleadingEtValuesSignal);
    jFexSubleadingSRJTreeSignal->SetBranchAddress("Eta", &jFexSRJSubleadingEtaValuesSignal);
    jFexSubleadingSRJTreeSignal->SetBranchAddress("Phi", &jFexSRJSubleadingPhiValuesSignal);

    // === jFexLRJTreeSignal ===
    jFexLRJTreeSignal->SetBranchAddress("EtIndex", &jFexLRJEtIndexValuesSignal);
    jFexLRJTreeSignal->SetBranchAddress("Et", &jFexLRJEtValuesSignal);
    jFexLRJTreeSignal->SetBranchAddress("Eta", &jFexLRJEtaValuesSignal);
    jFexLRJTreeSignal->SetBranchAddress("Phi", &jFexLRJPhiValuesSignal);

    // === jFexLeadingLRJTreeSignal ===
    jFexLeadingLRJTreeSignal->SetBranchAddress("Et", &jFexLRJLeadingEtValuesSignal);
    jFexLeadingLRJTreeSignal->SetBranchAddress("Eta", &jFexLRJLeadingEtaValuesSignal);
    jFexLeadingLRJTreeSignal->SetBranchAddress("Phi", &jFexLRJLeadingPhiValuesSignal);

    // === jFexSubleadingLRJTreeSignal ===
    jFexSubleadingLRJTreeSignal->SetBranchAddress("Et", &jFexLRJSubleadingEtValuesSignal);
    jFexSubleadingLRJTreeSignal->SetBranchAddress("Eta", &jFexLRJSubleadingEtaValuesSignal);
    jFexSubleadingLRJTreeSignal->SetBranchAddress("Phi", &jFexLRJSubleadingPhiValuesSignal);

    // === hltAntiKt4EMTopoJetsTreeSignal ===
    hltAntiKt4EMTopoJetsTreeSignal->SetBranchAddress("EtIndex", &hltAntiKt4SRJEtIndexValuesSignal);
    hltAntiKt4EMTopoJetsTreeSignal->SetBranchAddress("Et", &hltAntiKt4SRJEtValuesSignal);
    hltAntiKt4EMTopoJetsTreeSignal->SetBranchAddress("Eta", &hltAntiKt4SRJEtaValuesSignal);
    hltAntiKt4EMTopoJetsTreeSignal->SetBranchAddress("Phi", &hltAntiKt4SRJPhiValuesSignal);

    // === leadingHltAntiKt4EMTopoJetsTreeSignal ===
    leadingHltAntiKt4EMTopoJetsTreeSignal->SetBranchAddress("Et", &hltAntiKt4SRJLeadingEtValuesSignal);
    leadingHltAntiKt4EMTopoJetsTreeSignal->SetBranchAddress("Eta", &hltAntiKt4SRJLeadingEtaValuesSignal);
    leadingHltAntiKt4EMTopoJetsTreeSignal->SetBranchAddress("Phi", &hltAntiKt4SRJLeadingPhiValuesSignal);

    // === subleadingHltAntiKt4EMTopoJetsTreeSignal ===
    subleadingHltAntiKt4EMTopoJetsTreeSignal->SetBranchAddress("Et", &hltAntiKt4SRJSubleadingEtValuesSignal);
    subleadingHltAntiKt4EMTopoJetsTreeSignal->SetBranchAddress("Eta", &hltAntiKt4SRJSubleadingEtaValuesSignal);
    subleadingHltAntiKt4EMTopoJetsTreeSignal->SetBranchAddress("Phi", &hltAntiKt4SRJSubleadingPhiValuesSignal);

    // === recoAntiKt10UFOCSSKJetsSignal ===
    recoAntiKt10UFOCSSKJetsSignal->SetBranchAddress("EtIndex", &recoAntiKt10LRJEtIndexValuesSignal);
    recoAntiKt10UFOCSSKJetsSignal->SetBranchAddress("Et", &recoAntiKt10LRJEtValuesSignal);
    recoAntiKt10UFOCSSKJetsSignal->SetBranchAddress("Eta", &recoAntiKt10LRJEtaValuesSignal);
    recoAntiKt10UFOCSSKJetsSignal->SetBranchAddress("Phi", &recoAntiKt10LRJPhiValuesSignal);
    recoAntiKt10UFOCSSKJetsSignal->SetBranchAddress("Phi", &recoAntiKt10LRJMassValuesSignal);

    // === leadingRecoAntiKt10UFOCSSKJetsSignal ===
    leadingRecoAntiKt10UFOCSSKJetsSignal->SetBranchAddress("Et", &recoAntiKt10LRJLeadingEtValuesSignal);
    leadingRecoAntiKt10UFOCSSKJetsSignal->SetBranchAddress("Eta", &recoAntiKt10LRJLeadingEtaValuesSignal);
    leadingRecoAntiKt10UFOCSSKJetsSignal->SetBranchAddress("Phi", &recoAntiKt10LRJLeadingPhiValuesSignal);
    leadingRecoAntiKt10UFOCSSKJetsSignal->SetBranchAddress("Mass", &recoAntiKt10LRJLeadingMassValuesSignal);

    // === subleadingRecoAntiKt10UFOCSSKJetsSignal ===
    subleadingRecoAntiKt10UFOCSSKJetsSignal->SetBranchAddress("Et", &recoAntiKt10LRJSubleadingEtValuesSignal);
    subleadingRecoAntiKt10UFOCSSKJetsSignal->SetBranchAddress("Eta", &recoAntiKt10LRJSubleadingEtaValuesSignal);
    subleadingRecoAntiKt10UFOCSSKJetsSignal->SetBranchAddress("Phi", &recoAntiKt10LRJSubleadingPhiValuesSignal);
    subleadingRecoAntiKt10UFOCSSKJetsSignal->SetBranchAddress("Mass", &recoAntiKt10LRJSubleadingMassValuesSignal);

    // === truthAntiKt4TruthDressedWZJetsSignal ===
    truthAntiKt4TruthDressedWZJetsSignal->SetBranchAddress("EtIndex", &truthAntiKt4WZSRJEtIndexValuesSignal);
    truthAntiKt4TruthDressedWZJetsSignal->SetBranchAddress("Et", &truthAntiKt4WZSRJEtValuesSignal);
    truthAntiKt4TruthDressedWZJetsSignal->SetBranchAddress("Eta", &truthAntiKt4WZSRJEtaValuesSignal);
    truthAntiKt4TruthDressedWZJetsSignal->SetBranchAddress("Phi", &truthAntiKt4WZSRJPhiValuesSignal);
    truthAntiKt4TruthDressedWZJetsSignal->SetBranchAddress("Mass", &truthAntiKt4WZSRJMassValuesSignal);

    // === leadingTruthAntiKt4TruthDressedWZJetsSignal ===
    leadingTruthAntiKt4TruthDressedWZJetsSignal->SetBranchAddress("Et", &truthAntiKt4WZSRJLeadingEtValuesSignal);
    leadingTruthAntiKt4TruthDressedWZJetsSignal->SetBranchAddress("Eta", &truthAntiKt4WZSRJLeadingEtaValuesSignal);
    leadingTruthAntiKt4TruthDressedWZJetsSignal->SetBranchAddress("Phi", &truthAntiKt4WZSRJLeadingPhiValuesSignal);
    leadingTruthAntiKt4TruthDressedWZJetsSignal->SetBranchAddress("Mass", &truthAntiKt4WZSRJLeadingMassValuesSignal);

    // === subleadingTruthAntiKt4TruthDressedWZJetsSignal ===
    subleadingTruthAntiKt4TruthDressedWZJetsSignal->SetBranchAddress("Et", &truthAntiKt4WZSRJSubleadingEtValuesSignal);
    subleadingTruthAntiKt4TruthDressedWZJetsSignal->SetBranchAddress("Eta", &truthAntiKt4WZSRJSubleadingEtaValuesSignal);
    subleadingTruthAntiKt4TruthDressedWZJetsSignal->SetBranchAddress("Phi", &truthAntiKt4WZSRJSubleadingPhiValuesSignal);
    subleadingTruthAntiKt4TruthDressedWZJetsSignal->SetBranchAddress("Mass", &truthAntiKt4WZSRJSubleadingMassValuesSignal);

    // === inTimeAntiKt4TruthJetsTreeSignal ===
    inTimeAntiKt4TruthJetsTreeSignal->SetBranchAddress("EtIndex", &inTimeAntiKt4TruthSRJEtIndexValuesSignal);
    inTimeAntiKt4TruthJetsTreeSignal->SetBranchAddress("Et", &inTimeAntiKt4TruthSRJEtValuesSignal);
    inTimeAntiKt4TruthJetsTreeSignal->SetBranchAddress("Eta", &inTimeAntiKt4TruthSRJEtaValuesSignal);
    inTimeAntiKt4TruthJetsTreeSignal->SetBranchAddress("Phi", &inTimeAntiKt4TruthSRJPhiValuesSignal);

    // === leadingInTimeAntiKt4TruthJetsTreeSignal ===
    leadingInTimeAntiKt4TruthJetsTreeSignal->SetBranchAddress("Et", &inTimeAntiKt4TruthSRJLeadingEtValuesSignal);
    leadingInTimeAntiKt4TruthJetsTreeSignal->SetBranchAddress("Eta", &inTimeAntiKt4TruthSRJLeadingEtaValuesSignal);
    leadingInTimeAntiKt4TruthJetsTreeSignal->SetBranchAddress("Phi", &inTimeAntiKt4TruthSRJLeadingPhiValuesSignal);

    // === subleadingInTimeAntiKt4TruthJetsTreeSignal ===
    subleadingInTimeAntiKt4TruthJetsTreeSignal->SetBranchAddress("Et", &inTimeAntiKt4TruthSRJSubleadingEtValuesSignal);
    subleadingInTimeAntiKt4TruthJetsTreeSignal->SetBranchAddress("Eta", &inTimeAntiKt4TruthSRJSubleadingEtaValuesSignal);
    subleadingInTimeAntiKt4TruthJetsTreeSignal->SetBranchAddress("Phi", &inTimeAntiKt4TruthSRJSubleadingPhiValuesSignal);

    // BACKGROUND TREES
    // === eventInfoTreeBack ===
    eventInfoTreeBack->SetBranchAddress("mcEventWeight", &mcEventWeightsValuesBack);
    eventInfoTreeBack->SetBranchAddress("sumOfWeightsForSample", &sumOfWeightsForSampleValuesBack);
    eventInfoTreeBack->SetBranchAddress("eventWeights", &eventWeightsValuesBack);
    eventInfoTreeBack->SetBranchAddress("sampleJZSlice", &sampleJZSliceValuesBack);

    // === jetTaggerLRJsBack ===
    jetTaggerLRJsBack->SetBranchAddress("Psi_R", &jetTaggerLRJPsi_RValuesBack);
    jetTaggerLRJsBack->SetBranchAddress("MergedIndices", &jetTaggerLRJMergedIndicesValuesBack);
    jetTaggerLRJsBack->SetBranchAddress("Et", &jetTaggerLRJEtValuesBack);
    jetTaggerLRJsBack->SetBranchAddress("Eta", &jetTaggerLRJEtaValuesBack);
    jetTaggerLRJsBack->SetBranchAddress("Phi", &jetTaggerLRJPhiValuesBack);

    // === jetTaggerLeadingLRJsBack ===
    jetTaggerLeadingLRJsBack->SetBranchAddress("Psi_R", &jetTaggerLeadingLRJPsi_RValuesBack);
    jetTaggerLeadingLRJsBack->SetBranchAddress("MergedIndices", &jetTaggerLeadingLRJMergedIndicesValuesBack);
    jetTaggerLeadingLRJsBack->SetBranchAddress("Et", &jetTaggerLeadingLRJEtValuesBack);
    jetTaggerLeadingLRJsBack->SetBranchAddress("Eta", &jetTaggerLeadingLRJEtaValuesBack);
    jetTaggerLeadingLRJsBack->SetBranchAddress("Phi", &jetTaggerLeadingLRJPhiValuesBack);

    // === jetTaggerSubleadingLRJsBack ===
    jetTaggerSubleadingLRJsBack->SetBranchAddress("Psi_R", &jetTaggerSubleadingLRJPsi_RValuesBack);
    jetTaggerSubleadingLRJsBack->SetBranchAddress("MergedIndices", &jetTaggerSubleadingLRJMergedIndicesValuesBack);
    jetTaggerSubleadingLRJsBack->SetBranchAddress("Et", &jetTaggerSubleadingLRJEtValuesBack);
    jetTaggerSubleadingLRJsBack->SetBranchAddress("Eta", &jetTaggerSubleadingLRJEtaValuesBack);
    jetTaggerSubleadingLRJsBack->SetBranchAddress("Phi", &jetTaggerSubleadingLRJPhiValuesBack);

    // === caloTopoTowerTreeBack ===
    caloTopoTowerTreeBack->SetBranchAddress("Et", &caloTopoTowerEtValuesBack);
    caloTopoTowerTreeBack->SetBranchAddress("Eta", &caloTopoTowerEtaValuesBack);
    caloTopoTowerTreeBack->SetBranchAddress("Phi", &caloTopoTowerPhiValuesBack);

    // === topo422TreeBack ===
    topo422TreeBack->SetBranchAddress("Et", &topo422EtValuesBack);
    topo422TreeBack->SetBranchAddress("Eta", &topo422EtaValuesBack);
    topo422TreeBack->SetBranchAddress("Phi", &topo422PhiValuesBack);

    // === gepBasicClustersTreeBack ===
    gepBasicClustersTreeBack->SetBranchAddress("Et", &gepBasicClustersEtValuesBack);
    gepBasicClustersTreeBack->SetBranchAddress("Eta", &gepBasicClustersEtaValuesBack);
    gepBasicClustersTreeBack->SetBranchAddress("Phi", &gepBasicClustersPhiValuesBack);

    // === gepCellsTowersTreeBack ===
    gepCellsTowersTreeBack->SetBranchAddress("Et", &gepCellsTowersEtValuesBack);
    gepCellsTowersTreeBack->SetBranchAddress("Eta", &gepCellsTowersEtaValuesBack);
    gepCellsTowersTreeBack->SetBranchAddress("Phi", &gepCellsTowersPhiValuesBack);

    // === gepBasicClustersSKTreeBack ===
    gepBasicClustersSKTreeBack->SetBranchAddress("Et", &gepBasicClustersSKEtValuesBack);
    gepBasicClustersSKTreeBack->SetBranchAddress("Eta", &gepBasicClustersSKEtaValuesBack);
    gepBasicClustersSKTreeBack->SetBranchAddress("Phi", &gepBasicClustersSKPhiValuesBack);

    // === gepCellsTowersSKTreeBack ===
    gepCellsTowersSKTreeBack->SetBranchAddress("Et", &gepCellsTowersSKEtValuesBack);
    gepCellsTowersSKTreeBack->SetBranchAddress("Eta", &gepCellsTowersSKEtaValuesBack);
    gepCellsTowersSKTreeBack->SetBranchAddress("Phi", &gepCellsTowersSKPhiValuesBack);

    // gep wta cone cells towers jets
    gepWTAConeCellsTowersJetsTreeBack->SetBranchAddress("pT", &gepWTAConeCellsTowersJetspTValuesBack);
    gepWTAConeCellsTowersJetsTreeBack->SetBranchAddress("Eta", &gepWTAConeCellsTowersJetsEtaValuesBack);
    gepWTAConeCellsTowersJetsTreeBack->SetBranchAddress("Phi", &gepWTAConeCellsTowersJetsPhiValuesBack);
    gepWTAConeCellsTowersJetsTreeBack->SetBranchAddress("NConstituents", &gepWTAConeCellsTowersJetsNConstituentsValuesBack);

    // leading gep wta cone cells towers jets
    gepLeadingWTAConeCellsTowersJetsTreeBack->SetBranchAddress("pT", &gepLeadingWTAConeCellsTowersJetspTValuesBack);
    gepLeadingWTAConeCellsTowersJetsTreeBack->SetBranchAddress("Eta", &gepLeadingWTAConeCellsTowersJetsEtaValuesBack);
    gepLeadingWTAConeCellsTowersJetsTreeBack->SetBranchAddress("Phi", &gepLeadingWTAConeCellsTowersJetsPhiValuesBack);
    gepLeadingWTAConeCellsTowersJetsTreeBack->SetBranchAddress("NConstituents", &gepLeadingWTAConeCellsTowersJetsNConstituentsValuesBack);

    // subleading gep wta cone cells towers jets
    gepSubleadingWTAConeCellsTowersJetsTreeBack->SetBranchAddress("pT", &gepSubleadingWTAConeCellsTowersJetspTValuesBack);
    gepSubleadingWTAConeCellsTowersJetsTreeBack->SetBranchAddress("Eta", &gepSubleadingWTAConeCellsTowersJetsEtaValuesBack);
    gepSubleadingWTAConeCellsTowersJetsTreeBack->SetBranchAddress("Phi", &gepSubleadingWTAConeCellsTowersJetsPhiValuesBack);
    gepSubleadingWTAConeCellsTowersJetsTreeBack->SetBranchAddress("NConstituents", &gepSubleadingWTAConeCellsTowersJetsNConstituentsValuesBack);

    // gep wta cone basic clusters jets
    gepWTAConeBasicClustersJetsTreeBack->SetBranchAddress("pT", &gepWTAConeGEPBasicClustersJetspTValuesBack);
    gepWTAConeBasicClustersJetsTreeBack->SetBranchAddress("Eta", &gepWTAConeGEPBasicClustersJetsEtaValuesBack);
    gepWTAConeBasicClustersJetsTreeBack->SetBranchAddress("Phi", &gepWTAConeGEPBasicClustersJetsPhiValuesBack);
    gepWTAConeBasicClustersJetsTreeBack->SetBranchAddress("NConstituents", &gepWTAConeGEPBasicClustersJetsNConstituentsValuesBack);

    // leading gep wta cone basic clusters jets
    gepLeadingWTAConeBasicClustersJetsTreeBack->SetBranchAddress("pT", &gepLeadingWTAConeGEPBasicClustersJetspTValuesBack);
    gepLeadingWTAConeBasicClustersJetsTreeBack->SetBranchAddress("Eta", &gepLeadingWTAConeGEPBasicClustersJetsEtaValuesBack);
    gepLeadingWTAConeBasicClustersJetsTreeBack->SetBranchAddress("Phi", &gepLeadingWTAConeGEPBasicClustersJetsPhiValuesBack);
    gepLeadingWTAConeBasicClustersJetsTreeBack->SetBranchAddress("NConstituents", &gepLeadingWTAConeGEPBasicClustersJetsNConstituentsValuesBack);

    // subleading gep wta cone basic clusters jets
    gepSubleadingWTAConeBasicClustersJetsTreeBack->SetBranchAddress("pT", &gepSubleadingWTAConeGEPBasicClustersJetspTValuesBack);
    gepSubleadingWTAConeBasicClustersJetsTreeBack->SetBranchAddress("Eta", &gepSubleadingWTAConeGEPBasicClustersJetsEtaValuesBack);
    gepSubleadingWTAConeBasicClustersJetsTreeBack->SetBranchAddress("Phi", &gepSubleadingWTAConeGEPBasicClustersJetsPhiValuesBack);
    gepSubleadingWTAConeBasicClustersJetsTreeBack->SetBranchAddress("NConstituents", &gepSubleadingWTAConeGEPBasicClustersJetsNConstituentsValuesBack);

    // ------- SK PU Suppressed cone jets ---------- 

    // SK gep wta cone cells towers jets
    gepWTAConeCellsTowersSKJetsTreeBack->SetBranchAddress("pT", &gepWTAConeCellsTowersSKJetspTValuesBack);
    gepWTAConeCellsTowersSKJetsTreeBack->SetBranchAddress("Eta", &gepWTAConeCellsTowersSKJetsEtaValuesBack);
    gepWTAConeCellsTowersSKJetsTreeBack->SetBranchAddress("Phi", &gepWTAConeCellsTowersSKJetsPhiValuesBack);
    gepWTAConeCellsTowersSKJetsTreeBack->SetBranchAddress("NConstituents", &gepWTAConeCellsTowersSKJetsNConstituentsValuesBack);

    // SK leading gep wta cone cells towers jets
    gepLeadingWTAConeCellsTowersSKJetsTreeBack->SetBranchAddress("pT", &gepLeadingWTAConeCellsTowersSKJetspTValuesBack);
    gepLeadingWTAConeCellsTowersSKJetsTreeBack->SetBranchAddress("Eta", &gepLeadingWTAConeCellsTowersSKJetsEtaValuesBack);
    gepLeadingWTAConeCellsTowersSKJetsTreeBack->SetBranchAddress("Phi", &gepLeadingWTAConeCellsTowersSKJetsPhiValuesBack);
    gepLeadingWTAConeCellsTowersSKJetsTreeBack->SetBranchAddress("NConstituents", &gepLeadingWTAConeCellsTowersSKJetsNConstituentsValuesBack);

    // SK subleading gep wta cone cells towers jets
    gepSubleadingWTAConeCellsTowersSKJetsTreeBack->SetBranchAddress("pT", &gepSubleadingWTAConeCellsTowersSKJetspTValuesBack);
    gepSubleadingWTAConeCellsTowersSKJetsTreeBack->SetBranchAddress("Eta", &gepSubleadingWTAConeCellsTowersSKJetsEtaValuesBack);
    gepSubleadingWTAConeCellsTowersSKJetsTreeBack->SetBranchAddress("Phi", &gepSubleadingWTAConeCellsTowersSKJetsPhiValuesBack);
    gepSubleadingWTAConeCellsTowersSKJetsTreeBack->SetBranchAddress("NConstituents", &gepSubleadingWTAConeCellsTowersSKJetsNConstituentsValuesBack);

    // SK gep wta cone basic clusters jets
    gepWTAConeBasicClustersSKJetsTreeBack->SetBranchAddress("pT", &gepWTAConeGEPBasicClustersSKJetspTValuesBack);
    gepWTAConeBasicClustersSKJetsTreeBack->SetBranchAddress("Eta", &gepWTAConeGEPBasicClustersSKJetsEtaValuesBack);
    gepWTAConeBasicClustersSKJetsTreeBack->SetBranchAddress("Phi", &gepWTAConeGEPBasicClustersSKJetsPhiValuesBack);
    gepWTAConeBasicClustersSKJetsTreeBack->SetBranchAddress("NConstituents", &gepWTAConeGEPBasicClustersSKJetsNConstituentsValuesBack);

    // SK leading gep wta cone basic clusters jets
    gepLeadingWTAConeBasicClustersSKJetsTreeBack->SetBranchAddress("pT", &gepLeadingWTAConeGEPBasicClustersSKJetspTValuesBack);
    gepLeadingWTAConeBasicClustersSKJetsTreeBack->SetBranchAddress("Eta", &gepLeadingWTAConeGEPBasicClustersSKJetsEtaValuesBack);
    gepLeadingWTAConeBasicClustersSKJetsTreeBack->SetBranchAddress("Phi", &gepLeadingWTAConeGEPBasicClustersSKJetsPhiValuesBack);
    gepLeadingWTAConeBasicClustersSKJetsTreeBack->SetBranchAddress("NConstituents", &gepLeadingWTAConeGEPBasicClustersSKJetsNConstituentsValuesBack);

    // SK subleading gep wta cone basic clusters jets
    gepSubleadingWTAConeBasicClustersSKJetsTreeBack->SetBranchAddress("pT", &gepSubleadingWTAConeGEPBasicClustersSKJetspTValuesBack);
    gepSubleadingWTAConeBasicClustersSKJetsTreeBack->SetBranchAddress("Eta", &gepSubleadingWTAConeGEPBasicClustersSKJetsEtaValuesBack);
    gepSubleadingWTAConeBasicClustersSKJetsTreeBack->SetBranchAddress("Phi", &gepSubleadingWTAConeGEPBasicClustersSKJetsPhiValuesBack);
    gepSubleadingWTAConeBasicClustersSKJetsTreeBack->SetBranchAddress("NConstituents", &gepSubleadingWTAConeGEPBasicClustersSKJetsNConstituentsValuesBack);

    // === gFexSRJTreeBack ===
    gFexSRJTreeBack->SetBranchAddress("EtIndex", &gFexSRJEtIndexValuesBack);
    gFexSRJTreeBack->SetBranchAddress("Et", &gFexSRJEtValuesBack);
    gFexSRJTreeBack->SetBranchAddress("Eta", &gFexSRJEtaValuesBack);
    gFexSRJTreeBack->SetBranchAddress("Phi", &gFexSRJPhiValuesBack);

    // === gFexLeadingSRJTreeBack ===
    gFexLeadingSRJTreeBack->SetBranchAddress("Et", &gFexSRJLeadingEtValuesBack);
    gFexLeadingSRJTreeBack->SetBranchAddress("Eta", &gFexSRJLeadingEtaValuesBack);
    gFexLeadingSRJTreeBack->SetBranchAddress("Phi", &gFexSRJLeadingPhiValuesBack);

    // === gFexSubleadingSRJTreeBack ===
    gFexSubleadingSRJTreeBack->SetBranchAddress("Et", &gFexSRJSubleadingEtValuesBack);
    gFexSubleadingSRJTreeBack->SetBranchAddress("Eta", &gFexSRJSubleadingEtaValuesBack);
    gFexSubleadingSRJTreeBack->SetBranchAddress("Phi", &gFexSRJSubleadingPhiValuesBack);

    // === gFexLRJTreeBack ===
    gFexLRJTreeBack->SetBranchAddress("EtIndex", &gFexLRJEtIndexValuesBack);
    gFexLRJTreeBack->SetBranchAddress("Et", &gFexLRJEtValuesBack);
    gFexLRJTreeBack->SetBranchAddress("Eta", &gFexLRJEtaValuesBack);
    gFexLRJTreeBack->SetBranchAddress("Phi", &gFexLRJPhiValuesBack);

    // === gFexLeadingLRJTreeBack ===
    gFexLeadingLRJTreeBack->SetBranchAddress("Et", &gFexLRJLeadingEtValuesBack);
    gFexLeadingLRJTreeBack->SetBranchAddress("Eta", &gFexLRJLeadingEtaValuesBack);
    gFexLeadingLRJTreeBack->SetBranchAddress("Phi", &gFexLRJLeadingPhiValuesBack);

    // === gFexSubleadingLRJTreeBack ===
    gFexSubleadingLRJTreeBack->SetBranchAddress("Et", &gFexLRJSubleadingEtValuesBack);
    gFexSubleadingLRJTreeBack->SetBranchAddress("Eta", &gFexLRJSubleadingEtaValuesBack);
    gFexSubleadingLRJTreeBack->SetBranchAddress("Phi", &gFexLRJSubleadingPhiValuesBack);

    // === jFexSRJTreeBack ===
    jFexSRJTreeBack->SetBranchAddress("EtIndex", &jFexSRJEtIndexValuesBack);
    jFexSRJTreeBack->SetBranchAddress("Et", &jFexSRJEtValuesBack);
    jFexSRJTreeBack->SetBranchAddress("Eta", &jFexSRJEtaValuesBack);
    jFexSRJTreeBack->SetBranchAddress("Phi", &jFexSRJPhiValuesBack);

    // === jFexLeadingSRJTreeBack ===
    jFexLeadingSRJTreeBack->SetBranchAddress("Et", &jFexSRJLeadingEtValuesBack);
    jFexLeadingSRJTreeBack->SetBranchAddress("Eta", &jFexSRJLeadingEtaValuesBack);
    jFexLeadingSRJTreeBack->SetBranchAddress("Phi", &jFexSRJLeadingPhiValuesBack);

    // === jFexSubleadingSRJTreeBack ===
    jFexSubleadingSRJTreeBack->SetBranchAddress("Et", &jFexSRJSubleadingEtValuesBack);
    jFexSubleadingSRJTreeBack->SetBranchAddress("Eta", &jFexSRJSubleadingEtaValuesBack);
    jFexSubleadingSRJTreeBack->SetBranchAddress("Phi", &jFexSRJSubleadingPhiValuesBack);

    // === jFexLRJTreeBack ===
    jFexLRJTreeBack->SetBranchAddress("EtIndex", &jFexLRJEtIndexValuesBack);
    jFexLRJTreeBack->SetBranchAddress("Et", &jFexLRJEtValuesBack);
    jFexLRJTreeBack->SetBranchAddress("Eta", &jFexLRJEtaValuesBack);
    jFexLRJTreeBack->SetBranchAddress("Phi", &jFexLRJPhiValuesBack);

    // === jFexLeadingLRJTreeBack ===
    jFexLeadingLRJTreeBack->SetBranchAddress("Et", &jFexLRJLeadingEtValuesBack);
    jFexLeadingLRJTreeBack->SetBranchAddress("Eta", &jFexLRJLeadingEtaValuesBack);
    jFexLeadingLRJTreeBack->SetBranchAddress("Phi", &jFexLRJLeadingPhiValuesBack);

    // === jFexSubleadingLRJTreeBack ===
    jFexSubleadingLRJTreeBack->SetBranchAddress("Et", &jFexLRJSubleadingEtValuesBack);
    jFexSubleadingLRJTreeBack->SetBranchAddress("Eta", &jFexLRJSubleadingEtaValuesBack);
    jFexSubleadingLRJTreeBack->SetBranchAddress("Phi", &jFexLRJSubleadingPhiValuesBack);

    // === hltAntiKt4EMTopoJetsTreeBack ===
    hltAntiKt4EMTopoJetsTreeBack->SetBranchAddress("EtIndex", &hltAntiKt4SRJEtIndexValuesBack);
    hltAntiKt4EMTopoJetsTreeBack->SetBranchAddress("Et", &hltAntiKt4SRJEtValuesBack);
    hltAntiKt4EMTopoJetsTreeBack->SetBranchAddress("Eta", &hltAntiKt4SRJEtaValuesBack);
    hltAntiKt4EMTopoJetsTreeBack->SetBranchAddress("Phi", &hltAntiKt4SRJPhiValuesBack);

    // === leadingHltAntiKt4EMTopoJetsTreeBack ===
    leadingHltAntiKt4EMTopoJetsTreeBack->SetBranchAddress("Et", &hltAntiKt4SRJLeadingEtValuesBack);
    leadingHltAntiKt4EMTopoJetsTreeBack->SetBranchAddress("Eta", &hltAntiKt4SRJLeadingEtaValuesBack);
    leadingHltAntiKt4EMTopoJetsTreeBack->SetBranchAddress("Phi", &hltAntiKt4SRJLeadingPhiValuesBack);

    // === subleadingHltAntiKt4EMTopoJetsTreeBack ===
    subleadingHltAntiKt4EMTopoJetsTreeBack->SetBranchAddress("Et", &hltAntiKt4SRJSubleadingEtValuesBack);
    subleadingHltAntiKt4EMTopoJetsTreeBack->SetBranchAddress("Eta", &hltAntiKt4SRJSubleadingEtaValuesBack);
    subleadingHltAntiKt4EMTopoJetsTreeBack->SetBranchAddress("Phi", &hltAntiKt4SRJSubleadingPhiValuesBack);

    // === recoAntiKt10UFOCSSKJetsBack ===
    recoAntiKt10UFOCSSKJetsBack->SetBranchAddress("EtIndex", &recoAntiKt10LRJEtIndexValuesBack);
    recoAntiKt10UFOCSSKJetsBack->SetBranchAddress("Et", &recoAntiKt10LRJEtValuesBack);
    recoAntiKt10UFOCSSKJetsBack->SetBranchAddress("Eta", &recoAntiKt10LRJEtaValuesBack);
    recoAntiKt10UFOCSSKJetsBack->SetBranchAddress("Phi", &recoAntiKt10LRJPhiValuesBack);
    recoAntiKt10UFOCSSKJetsBack->SetBranchAddress("Mass", &recoAntiKt10LRJMassValuesBack);

    // === leadingRecoAntiKt10UFOCSSKJetsBack ===
    leadingRecoAntiKt10UFOCSSKJetsBack->SetBranchAddress("Et", &recoAntiKt10LRJLeadingEtValuesBack);
    leadingRecoAntiKt10UFOCSSKJetsBack->SetBranchAddress("Eta", &recoAntiKt10LRJLeadingEtaValuesBack);
    leadingRecoAntiKt10UFOCSSKJetsBack->SetBranchAddress("Phi", &recoAntiKt10LRJLeadingPhiValuesBack);
    leadingRecoAntiKt10UFOCSSKJetsBack->SetBranchAddress("Mass", &recoAntiKt10LRJLeadingMassValuesBack);

    // === subleadingRecoAntiKt10UFOCSSKJetsBack ===
    subleadingRecoAntiKt10UFOCSSKJetsBack->SetBranchAddress("Et", &recoAntiKt10LRJSubleadingEtValuesBack);
    subleadingRecoAntiKt10UFOCSSKJetsBack->SetBranchAddress("Eta", &recoAntiKt10LRJSubleadingEtaValuesBack);
    subleadingRecoAntiKt10UFOCSSKJetsBack->SetBranchAddress("Phi", &recoAntiKt10LRJSubleadingPhiValuesBack);
    subleadingRecoAntiKt10UFOCSSKJetsBack->SetBranchAddress("Mass", &recoAntiKt10LRJSubleadingMassValuesBack);

    // === truthAntiKt4TruthDressedWZJetsBack ===
    truthAntiKt4TruthDressedWZJetsBack->SetBranchAddress("EtIndex", &truthAntiKt4WZSRJEtIndexValuesBack);
    truthAntiKt4TruthDressedWZJetsBack->SetBranchAddress("Et", &truthAntiKt4WZSRJEtValuesBack);
    truthAntiKt4TruthDressedWZJetsBack->SetBranchAddress("Eta", &truthAntiKt4WZSRJEtaValuesBack);
    truthAntiKt4TruthDressedWZJetsBack->SetBranchAddress("Phi", &truthAntiKt4WZSRJPhiValuesBack);

    // === leadingTruthAntiKt4TruthDressedWZJetsBack ===
    leadingTruthAntiKt4TruthDressedWZJetsBack->SetBranchAddress("Et", &truthAntiKt4WZSRJLeadingEtValuesBack);
    leadingTruthAntiKt4TruthDressedWZJetsBack->SetBranchAddress("Eta", &truthAntiKt4WZSRJLeadingEtaValuesBack);
    leadingTruthAntiKt4TruthDressedWZJetsBack->SetBranchAddress("Phi", &truthAntiKt4WZSRJLeadingPhiValuesBack);

    // === subleadingTruthAntiKt4TruthDressedWZJetsBack ===
    subleadingTruthAntiKt4TruthDressedWZJetsBack->SetBranchAddress("Et", &truthAntiKt4WZSRJSubleadingEtValuesBack);
    subleadingTruthAntiKt4TruthDressedWZJetsBack->SetBranchAddress("Eta", &truthAntiKt4WZSRJSubleadingEtaValuesBack);
    subleadingTruthAntiKt4TruthDressedWZJetsBack->SetBranchAddress("Phi", &truthAntiKt4WZSRJSubleadingPhiValuesBack);

    // === inTimeAntiKt4TruthJetsTreeBack ===
    inTimeAntiKt4TruthJetsTreeBack->SetBranchAddress("EtIndex", &inTimeAntiKt4TruthSRJEtIndexValuesBack);
    inTimeAntiKt4TruthJetsTreeBack->SetBranchAddress("Et", &inTimeAntiKt4TruthSRJEtValuesBack);
    inTimeAntiKt4TruthJetsTreeBack->SetBranchAddress("Eta", &inTimeAntiKt4TruthSRJEtaValuesBack);
    inTimeAntiKt4TruthJetsTreeBack->SetBranchAddress("Phi", &inTimeAntiKt4TruthSRJPhiValuesBack);

    // === leadingInTimeAntiKt4TruthJetsTreeBack ===
    leadingInTimeAntiKt4TruthJetsTreeBack->SetBranchAddress("Et", &inTimeAntiKt4TruthSRJLeadingEtValuesBack);
    leadingInTimeAntiKt4TruthJetsTreeBack->SetBranchAddress("Eta", &inTimeAntiKt4TruthSRJLeadingEtaValuesBack);
    leadingInTimeAntiKt4TruthJetsTreeBack->SetBranchAddress("Phi", &inTimeAntiKt4TruthSRJLeadingPhiValuesBack);

    // === subleadingInTimeAntiKt4TruthJetsTreeBack ===
    subleadingInTimeAntiKt4TruthJetsTreeBack->SetBranchAddress("Et", &inTimeAntiKt4TruthSRJSubleadingEtValuesBack);
    subleadingInTimeAntiKt4TruthJetsTreeBack->SetBranchAddress("Eta", &inTimeAntiKt4TruthSRJSubleadingEtaValuesBack);
    subleadingInTimeAntiKt4TruthJetsTreeBack->SetBranchAddress("Phi", &inTimeAntiKt4TruthSRJSubleadingPhiValuesBack);

    //gSystem->RedirectOutput("debug.log", "w");
    const unsigned int num_processed_events_background = eventInfoTreeBack->GetEntries();
    const unsigned int num_processed_events_signal = eventInfoTreeSignal->GetEntries();
    std::cout << "num_processed_events_background: " << num_processed_events_background << "\n";
    std::cout << "num_processed_events_signal: " <<  num_processed_events_signal << "\n";

    // Variables to store data
    std::vector<double> backgroundEtValues, backgroundEtaValues, backgroundPhiValues;
    std::vector<double> signalEtValues, signalEtaValues, signalPhiValues;

    // Open input file

    int current_event = -1;
    std::string sig_line;
    std::string back_line;
    
    // Bools determining which file being processed


    // Histograms for making overlaid plots between multiple files.
    // make unique names so ROOT doesn't overwrite
    auto h_sig_num100 = new TH1F(Form("sig_h_offlineLRJ_Et_num100_%d", fileIt),
        "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)",
        100, 0, 1000);
    auto h_sig_denom100 = new TH1F(Form("sig_h_offlineLRJ_Et_denom100_%d", fileIt),
        "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)",
        100, 0, 1000);

    auto h_sig_num250 = new TH1F(Form("sig_h_offlineLRJ_Et_num250_%d", fileIt),
        "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)",
        100, 0, 1000);
    auto h_sig_denom250 = new TH1F(Form("sig_h_offlineLRJ_Et_denom250_%d", fileIt),
        "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)",
        100, 0, 1000);

    auto h_sig_num400 = new TH1F(Form("sig_h_offlineLRJ_Et_num400_%d", fileIt),
        "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)",
        100, 0, 1000);
    auto h_sig_denom400 = new TH1F(Form("sig_h_offlineLRJ_Et_denom400_%d", fileIt),
        "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)",
        100, 0, 1000);

    auto h_back_num100 = new TH1F(Form("back_h_offlineLRJ_Et_num100_%d", fileIt),
        "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)",
        45, 50, 500);
    auto h_back_denom100 = new TH1F(Form("back_h_offlineLRJ_Et_denom100_%d", fileIt),
        "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)",
        45, 50, 500);

    auto h_back_num200 = new TH1F(Form("back_h_offlineLRJ_Et_num200_%d", fileIt),
        "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)",
        45, 50, 500);
    auto h_back_denom200 = new TH1F(Form("back_h_offlineLRJ_Et_denom200_%d", fileIt),
        "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)",
        45, 50, 500);

    auto h_back_num300 = new TH1F(Form("back_h_offlineLRJ_Et_num300_%d", fileIt),
        "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)",
        45, 50, 500);
    auto h_back_denom300 = new TH1F(Form("back_h_offlineLRJ_Et_denom300_%d", fileIt),
        "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)",
        45, 50, 500);

    // detach from any TFile so they survive after closing
    h_sig_num100->SetDirectory(nullptr);
    h_sig_denom100->SetDirectory(nullptr);
    h_sig_num250->SetDirectory(nullptr);
    h_sig_denom250->SetDirectory(nullptr);
    h_sig_num400->SetDirectory(nullptr);
    h_sig_denom400->SetDirectory(nullptr);

    h_back_num100->SetDirectory(nullptr);
    h_back_denom100->SetDirectory(nullptr);
    h_back_num200->SetDirectory(nullptr);
    h_back_denom200->SetDirectory(nullptr);
    h_back_num300->SetDirectory(nullptr);
    h_back_denom300->SetDirectory(nullptr);

    // push into vectors
    sig_num100.push_back(h_sig_num100);
    sig_denom100.push_back(h_sig_denom100);
    sig_num250.push_back(h_sig_num250);
    sig_denom250.push_back(h_sig_denom250);
    sig_num400.push_back(h_sig_num400);
    sig_denom400.push_back(h_sig_denom400);

    back_num100.push_back(h_back_num100);
    back_denom100.push_back(h_back_denom100);
    back_num200.push_back(h_back_num200);
    back_denom200.push_back(h_back_denom200);
    back_num300.push_back(h_back_num300);
    back_denom300.push_back(h_back_denom300);


    // Arrays to store JZ slice copies of histograms:
    TH1F* back_h_leading_LRJ_Et_arr[nJZSlices_];
    TH1F* back_h_subleading_LRJ_Et_arr[nJZSlices_];
    TH1F* back_h_gFEX_leading_LRJ_Et_arr[nJZSlices_];
    TH1F* back_h_gFEX_subleading_LRJ_Et_arr[nJZSlices_];
    TH1F* back_h_jFEX_leading_LRJ_Et_arr[nJZSlices_];
    TH1F* back_h_jFEX_subleading_LRJ_Et_arr[nJZSlices_];
    TH1F* back_h_gFEX_leading_SRJ_Et_arr[nJZSlices_];
    TH1F* back_h_gFEX_subleading_SRJ_Et_arr[nJZSlices_];
    TH1F* back_h_jFEX_leading_SRJ_Et_arr[nJZSlices_];
    TH1F* back_h_jFEX_subleading_SRJ_Et_arr[nJZSlices_];
    TH1F* back_h_leading_offlineLRJ_Et_arr[nJZSlices_];
    TH1F* back_h_subleading_offlineLRJ_Et_arr[nJZSlices_];
    TH1F* back_h_leading_truthSRJs_Et_arr[nJZSlices_];
    TH1F* back_h_subleading_truthSRJs_Et_arr[nJZSlices_];
    TH1F* back_h_leading_conejets_cellstowers_pT_arr[nJZSlices_];
    TH1F* back_h_subleading_conejets_cellstowers_pT_arr[nJZSlices_];
    TH1F* back_h_leading_WTA_conejets_cellstowers_pT_arr[nJZSlices_];
    TH1F* back_h_subleading_WTA_conejets_cellstowers_pT_arr[nJZSlices_];
    TH1F* back_h_leading_conejets_basicclusters_pT_arr[nJZSlices_];
    TH1F* back_h_subleading_conejets_basicclusters_pT_arr[nJZSlices_];
    TH1F* back_h_leading_WTA_conejets_basicclusters_pT_arr[nJZSlices_];
    TH1F* back_h_subleading_WTA_conejets_basicclusters_pT_arr[nJZSlices_];

    for (unsigned int i = 0; i < nJZSlices_; ++i) {
        back_h_leading_LRJ_Et_arr[i] = new TH1F(
            Form("back_h_leading_LRJ_Et_%d", i),
            "Leading LRJ Et Distribution; Leading JetTagger LRJ E_{T} [GeV]; Events / 10 GeV",
            110, 0, 1100);

        back_h_subleading_LRJ_Et_arr[i] = new TH1F(
            Form("back_h_subleading_LRJ_Et_%d", i),
            "Subleading LRJ Et Distribution;Subleading JetTagger LRJ E_{T} [GeV]; Events / 10 GeV",
            110, 0, 1100);

        back_h_gFEX_leading_LRJ_Et_arr[i] = new TH1F(
            Form("back_h_gFEX_leading_LRJ_Et_%d", i),
            "Leading gFEX LRJ Et Distribution;Leading gFEX LRJ E_{T} [GeV]; Events / 10 GeV",
            85, 0, 850);

        back_h_gFEX_subleading_LRJ_Et_arr[i] = new TH1F(
            Form("back_h_gFEX_subleading_LRJ_Et_%d", i),
            "Subleading gFEX LRJ Et Distribution;Subleading gFEX LRJ E_{T} [GeV]; Events / 10 GeV",
            85, 0, 850);

        back_h_gFEX_leading_SRJ_Et_arr[i] = new TH1F(
            Form("back_h_gFEX_leading_SRJ_Et_%d", i),
            "Leading gFEX SRJ Et Distribution;Leading gFEX SRJ E_{T} [GeV]; Events / 10 GeV",
            85, 0, 850);

        back_h_gFEX_subleading_SRJ_Et_arr[i] = new TH1F(
            Form("back_h_gFEX_subleading_SRJ_Et_%d", i),
            "Subleading gFEX SRJ Et Distribution;Subleading gFEX SRJ E_{T} [GeV]; Events / 10 GeV",
            85, 0, 850);

        back_h_jFEX_leading_LRJ_Et_arr[i] = new TH1F(
            Form("back_h_jFEX_leading_LRJ_Et_%d", i),
            "Leading jFEX LRJ Et Distribution;Leading jFEX LRJ E_{T} [GeV]; Events / 10 GeV",
            170, 0, 1700);

        back_h_jFEX_subleading_LRJ_Et_arr[i] = new TH1F(
            Form("back_h_jFEX_subleading_LRJ_Et_%d", i),
            "Subleading jFEX LRJ Et Distribution;Subleading jFEX LRJ E_{T} [GeV]; Events / 10 GeV",
            170, 0, 1700);

        back_h_jFEX_leading_SRJ_Et_arr[i] = new TH1F(
            Form("back_h_jFEX_leading_SRJ_Et_%d", i),
            "Leading jFEX SRJ Et Distribution;Leading jFEX SRJ E_{T} [GeV]; Events / 10 GeV",
            50, 0, 500);

        back_h_jFEX_subleading_SRJ_Et_arr[i] = new TH1F(
            Form("back_h_jFEX_subleading_SRJ_Et_%d", i),
            "Subleading jFEX SRJ Et Distribution;Subleading jFEX SRJ E_{T} [GeV]; Events / 10 GeV",
            50, 0, 500);

        back_h_leading_offlineLRJ_Et_arr[i] = new TH1F(
            Form("back_h_leading_offlineLRJ_Et_%d", i),
            "Leading Offline LRJ Et Distribution;Leading Offline LRJ E_{T} [GeV]; Events / 25 GeV",
            160, 0, 4000);

        back_h_subleading_offlineLRJ_Et_arr[i] = new TH1F(
            Form("back_h_subleading_offlineLRJ_Et_%d", i),
            "Subleading Offline LRJ Et Distribution;Subleading Offline LRJ E_{T} [GeV]; Events / 25 GeV",
            160, 0, 4000);

        back_h_leading_truthSRJs_Et_arr[i] = new TH1F(
            Form("back_h_leading_truthSRJs_Et_%d", i),
            "Leading Truth Small-R Jet Et Distribution;Leading Truth SRJ E_{T} [GeV]; Events / 25 GeV",
            160, 0, 4000);

        back_h_subleading_truthSRJs_Et_arr[i] = new TH1F(
            Form("back_h_subleading_truthSRJs_Et_%d", i),
            "Subleading Truth Small-R Jet Et Distribution;Subleading Truth SRJ E_{T} [GeV];Subleading Truth SRJs / 25 GeV",
            160, 0, 4000);

        back_h_leading_conejets_cellstowers_pT_arr[i] = new TH1F(
            Form("back_h_leading_conejets_cellstowers_pT_%d", i),
            "Leading Offline LRJ Et Distribution;Leading CellsTowers Cone Jet p_{T} [GeV]; Events / 25 GeV",
            120, 0, 3000);

        back_h_subleading_conejets_cellstowers_pT_arr[i] = new TH1F(
            Form("back_h_subleading_conejets_cellstowers_pT_%d", i),
            "Subleading Offline LRJ Et Distribution;Subleading CellsTowers Cone Jet p_{T} [GeV];Events / 25 GeV",
            120, 0, 3000);

        back_h_leading_WTA_conejets_cellstowers_pT_arr[i] = new TH1F(
            Form("back_h_leading_WTA_conejets_cellstowers_pT_%d", i),
            "Leading Offline LRJ Et Distribution;Leading WTA CellsTowers Cone Jet p_{T} [GeV]; Events / 25 GeV",
            120, 0, 3000);

        back_h_subleading_WTA_conejets_cellstowers_pT_arr[i] = new TH1F(
            Form("back_h_subleading_WTA_conejets_cellstowers_pT_%d", i),
            "Subleading Offline LRJ Et Distribution;Subleading WTA CellsTowers Cone Jet p_{T} [GeV];Events / 25 GeV",
            120, 0, 3000);

        back_h_leading_conejets_basicclusters_pT_arr[i] = new TH1F(
            Form("back_h_leading_conejets_basicclusters_pT_%d", i),
            "Leading Offline LRJ Et Distribution;Leading BasicClusters Cone Jet p_{T} [GeV]; Events / 25 GeV",
            120, 0, 3000);

        back_h_subleading_conejets_basicclusters_pT_arr[i] = new TH1F(
            Form("back_h_subleading_conejets_basicclusters_pT_%d", i),
            "Subleading Offline LRJ Et Distribution;Subleading BasicClusters Cone Jet p_{T} [GeV];Events / 25 GeV",
            120, 0, 3000);

        back_h_leading_WTA_conejets_basicclusters_pT_arr[i] = new TH1F(
            Form("back_h_leading_WTA_conejets_basicclusters_pT_%d", i),
            "Leading Offline LRJ Et Distribution;Leading WTA BasicClusters Cone Jet p_{T} [GeV]; Events / 25 GeV",
            120, 0, 3000);

        back_h_subleading_WTA_conejets_basicclusters_pT_arr[i] = new TH1F(
            Form("back_h_subleading_WTA_conejets_basicclusters_pT_%d", i),
            "Subleading Offline LRJ Et Distribution;Subleading WTA BasicClusters Cone Jet p_{T} [GeV];Events / 25 GeV",
            120, 0, 3000);
    }

    // Variable binning: 0400 GeV in 10 GeV steps, 400800 GeV in 25 GeV steps
    std::vector<Double_t> rateVsEffBins;

    // 0  400 GeV in 10 GeV steps
    for (int i = 0; i <= 40; ++i) rateVsEffBins.push_back(i * 10.0);

    // 425  800 GeV in 25 GeV steps
    //for (int i = 17; i <= 32; ++i) rateVsEffBins.push_back(400.0 + (i - 16) * 50.0);
    // (above loop adds 425, 450, , 800; total continuous sequence)

    
    // 450  1200 GeV in 50 GeV steps
    for (int i = 1; i <= 13; ++i)
        rateVsEffBins.push_back(400.0 + i * 50.0);  // 450, 500, ..., 800

    // ---------------- Histograms / Profiles ----------------
    const double ptMin = 25., ptMax = 500.;
    const int    nPtBins = 19;   // 20 GeV per bin like the screenshot

    TProfile* prof_AvgDR_vs_HpT =
    new TProfile("prof_AvgDR_vs_HpT",
                "Average #DeltaR(b,b) vs Higgs p_{T};Higgs p_{T} [GeV];Average #DeltaR(b,#bar{b})",
                nPtBins, ptMin, ptMax);

    TH2F* h2_DR_vs_HpT =
    new TH2F("h2_DR_vs_HpT",
            "#DeltaR(b,b) vs Higgs p_{T};Higgs p_{T} [GeV];#DeltaR(b,#bar{b})",
            nPtBins, ptMin, ptMax,
            30, 0.0, 6.0);    // y-range wide enough for low-pt cases

    // style
    prof_AvgDR_vs_HpT->SetMarkerStyle(20);
    prof_AvgDR_vs_HpT->SetMarkerSize(0.9);
    prof_AvgDR_vs_HpT->SetLineColor(kBlack);
    prof_AvgDR_vs_HpT->SetMarkerColor(kBlack);

    TH1F* sig_h_leading_offlineLRJ_Et_byfile = new TH1F("sig_h_leading_offlineLRJ_Et_byfile", "Leading LRJ Et Distribution;Leading Offline LRJ E_{T} [GeV];Fraction of Events / 50 GeV", 19, 50, 1000); // moved outside scope of file loop for use afterwards
    TH1F* sig_h_subleading_offlineLRJ_Et_byfile = new TH1F("sig_h_subleading_offlineLRJ_Et_byfile", "Subleading LRJ Et Distribution;Leading Offline LRJ E_{T} [GeV];Fraction of Events / 50 GeV", 19, 50, 1000); // now will only fill for first file as is same for each

    TH1F* sig_h_leading_offlineLRJ_Mass_byfile = new TH1F("sig_h_leading_offlineLRJ_Mass_byfile", "Leading LRJ Et Distribution;Leading Offline LRJ Mass [GeV];Fraction of Events / 10 GeV", 30, 0, 300); // moved outside scope of file loop for use afterwards
    TH1F* sig_h_subleading_offlineLRJ_Mass_byfile = new TH1F("sig_h_subleading_offlineLRJ_Mass_byfile", "Subleading LRJ Et Distribution;Leading Offline LRJ Mass [GeV];Fraction of Events / 10 GeV", 30, 0, 300); // now will only fill for first file as is same for each
    
    TH1F* back_h_leading_offlineLRJ_Et_byfile = new TH1F("back_h_leading_offlineLRJ_Et_byfile", "Leading LRJ Et Distribution;Leading Offline LRJ E_{T} [GeV];Fraction of Events / 50 GeV", 19, 50, 1000); // moved outside scope of file loop for use afterwards
    TH1F* back_h_subleading_offlineLRJ_Et_byfile = new TH1F("back_h_subleading_offlineLRJ_Et_byfile", "Subleading LRJ Et Distribution;Leading Offline LRJ E_{T} [GeV];Fraction of Events / 50 GeV", 19, 50, 1000); // now will only fill for first file as is same for each

    TH1F* back_h_leading_offlineLRJ_Mass_byfile = new TH1F("back_h_leading_offlineLRJ_Et_byfile", "Leading LRJ Et Distribution;Leading Offline LRJ Mass [GeV];Fraction of Events / 10 GeV", 30, 0, 300); // moved outside scope of file loop for use afterwards
    TH1F* back_h_subleading_offlineLRJ_Mass_byfile = new TH1F("back_h_subleading_offlineLRJ_Et_byfile", "Subleading LRJ Et Distribution;Leading Offline LRJ Mass [GeV];Fraction of Events / 10 GeV", 30, 0, 300); // now will only fill for first file as is same for each

    TH2F *leadingHiggsVsSubleadingHiggspT = new TH2F("leadingHiggsVsSubleadingHiggspT", "Sum of Topo422 E_{T} in Each Bin; Leading Higgs p_{T} [GeV]; Subleading Higgs p_{T}", 
                        60, 0, 1000,  
                        60, 0, 1000);  

    TH2F *leadingbVsSubleadingbpT_LeadingHiggs = new TH2F("leadingbVsSubleadingbpT_LeadingHiggs", "Sum of Topo422 E_{T} in Each Bin; Leading b p_{T} [GeV] [Leading Higgs]; Subleading b p_{T} [Leading Higgs]", 
                        50, 0, 1000,
                        50, 0, 1000); 

    TH2F *leadingbVsSubleadingbpT_SubleadingHiggs = new TH2F("leadingbVsSubleadingbpT_SubleadingHiggs", "Sum of Topo422 E_{T} in Each Bin; Leading b p_{T} [GeV] [Leading Higgs]; Subleading b p_{T} [Subleading Higgs]", 
                        50, 0, 1000, 
                        50, 0, 1000); 

    TH1F* sig_h_LRJ_substruct = new TH1F("sig_h_LRJ_substruct", "LRJ 'Diameter';LRJ 'Diameter';% of LRJs / ~0.03", 32, 0, 1);
    TH2F *sigDiamvsEt = new TH2F("sigDiamvsEt", "Sum of Topo422 E_{T} in Each Bin; LRJ E_{T} [GeV];LRJ 'Diameter'", 
                        20, 0, 800,  
                        32, 0, 1.0);

    TH2F *sigOfflineLeadingLRJMassvsEt = new TH2F("sigOfflineLeadingLRJMassvsEt", "Sum of Topo422 E_{T} in Each Bin; Offline Leading LRJ E_{T} [GeV];Offline Leading LRJ Mass [GeV]", 
                        60, 0, 3000,   
                        50, 0, 500);  

    TH2F *sigOfflineSubleadingLRJMassvsEt = new TH2F("sigOfflineSubleadingLRJMassvsEt", "Sum of Topo422 E_{T} in Each Bin; Offline Leading LRJ E_{T} [GeV];Offline Subleading LRJ Mass [GeV]", 
                        60, 0, 1200,   
                        25, 0, 250);  

    TH2F *sigOfflineSubleadingLRJMassvsLeadingLRJMass = new TH2F("sigOfflineSubleadingLRJMassvsLeadingLRJMass", "Sum of Topo422 E_{T} in Each Bin; Offline Leading LRJ Mass [GeV];Offline Subleading LRJ Mass [GeV]", 
                        25, 0, 250,   
                        25, 0, 250);  

    TH2F *backOfflineLeadingLRJMassvsEt = new TH2F("backOfflineLeadingLRJMassvsEt", "Sum of Topo422 E_{T} in Each Bin; Offline Leading LRJ E_{T} [GeV];Offline Leading LRJ Mass [GeV]", 
                        60, 0, 1200,   
                        25, 0, 250);  

    TH2F *backOfflineSubleadingLRJMassvsEt = new TH2F("backOfflineSubleadingLRJMassvsEt", "Sum of Topo422 E_{T} in Each Bin; Offline Leading LRJ E_{T} [GeV];Offline Subleading LRJ Mass [GeV]", 
                        60, 0, 1200,   
                        25, 0, 250);  
    
    TH2F *backOfflineSubleadingLRJMassvsLeadingLRJMass = new TH2F("backOfflineSubleadingLRJMassvsLeadingLRJMass", "Sum of Topo422 E_{T} in Each Bin; Offline Leading LRJ Mass [GeV];Offline Subleading LRJ Mass [GeV]", 
                        25, 0, 250,   
                        25, 0, 250);  


    TH2F *sigOfflineLeadingLRJMassvsSubjetMult = new TH2F("sigOfflineLeadingLRJMassvsSubjetMult", "Sum of Topo422 E_{T} in Each Bin; Number of Subjets; Offline Leading LRJ Mass [GeV]", 
                        4, 0, 4, // x axis
                        25, 0, 250 ); //y axis
    TH2F *backOfflineLeadingLRJMassvsSubjetMult = new TH2F("backOfflineLeadingLRJMassvsSubjetMult", "Sum of Topo422 E_{T} in Each Bin; Number of Subjets; Offline Leading LRJ Mass [GeV]", 
                        4, 0, 4, // x axis
                        25, 0, 250 ); //y axis
                        

    TH2F *sigOfflineLeadingLRJEtvsSubjetMult = new TH2F("sigOfflineLeadingLRJEtvsSubjetMult", "Sum of Topo422 E_{T} in Each Bin; Offline Leading LRJ E_{T} [GeV]; Number of Subjets", 
                        40, 0, 800,  //x axis
                        4, 0, 4 );  // y axis
    TH2F *backOfflineLeadingLRJEtvsSubjetMult = new TH2F("backOfflineLeadingLRJEtvsSubjetMult", "Sum of Topo422 E_{T} in Each Bin; Offline Leading LRJ E_{T} [GeV]; Number of Subjets", 
                        40, 0, 800,// x axis
                        4, 0, 4 ); //y axis

    TH2F *sigJetTaggerLeadingLRJEtvsSubleadingLRJEt = new TH2F("sigJetTaggerLeadingLRJEtvsSubleadingLRJEt", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; JetTagger Subleading LRJ E_{T} [GeV]", 
                        52, 0, 1040,  //x axis
                        52, 0, 1040);  // y axis
    TH2F *backJetTaggerLeadingLRJEtvsSubleadingLRJEt = new TH2F("backJetTaggerLeadingLRJEtvsSubleadingLRJEt", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; JetTagger Subleading LRJ E_{T} [GeV]", 
                        40, 0, 800,// x axis
                        40, 0, 800); //y axis

    TH1F* sigOfflineLeadingLRJMass = new TH1F("sigOfflineLeadingLRJMass", "LRJ Et Distribution;Offline Leading LRJ Mass [GeV];% of Leading LRJs / 10 GeV", 20, 0, 200);
    TH1F* backOfflineLeadingLRJMass = new TH1F("backOfflineLeadingLRJMass", "LRJ Et Distribution;Offline Leading LRJ Mass [GeV];% of Leading LRJs / 10 GeV", 20, 0, 200);

    TH1F* sigOfflineSubleadingLRJMass = new TH1F("sigOfflineSubleadingLRJMass", "LRJ Et Distribution;Offline Subleading LRJ Mass [GeV];% of Leading LRJs / 10 GeV", 25, 0, 250);
    TH1F* backOfflineSubleadingLRJMass = new TH1F("backOfflineSubleadingLRJMass", "LRJ Et Distribution;Offline Subleading LRJ Mass [GeV];% of Leading LRJs / 10 GeV", 25, 0, 250);

    TH1F* sigDeltaRLeadingSubleadingTruthJets = new TH1F("sigDeltaRLeadingSubleadingTruthJets", "LRJ Et Distribution;#Delta R Leading, Subleading Truth Jets / 0.2", 50, 0, 10);
    TH1F* backDeltaRLeadingSubleadingTruthJets = new TH1F("backDeltaRLeadingSubleadingTruthJets", "LRJ Et Distribution;#Delta R Leading, Subleading Truth Jets / 0.2", 50, 0, 10);

    TH1F* sig_h_LeadingOfflineLRJ_SubjetMultiplicity = new TH1F("sig_h_LeadingOfflineLRJ_SubjetMultiplicity", "LRJ Et Distribution;Number of Subjets;% of Leading LRJs", 4, 0, 4);
    TH1F* back_h_LeadingOfflineLRJ_SubjetMultiplicity = new TH1F("back_h_LeadingOfflineLRJ_SubjetMultiplicity", "LRJ Et Distribution;Number of Subjets;% of Leading LRJs", 4, 0, 4);

    TH1F* sig_h_SubleadingOfflineLRJ_SubjetMultiplicity = new TH1F("sig_h_SubleadingOfflineLRJ_SubjetMultiplicity", "LRJ Et Distribution;Number of Subjets;% of Subleading LRJs", 4, 0, 4);
    TH1F* back_h_SubleadingOfflineLRJ_SubjetMultiplicity = new TH1F("back_h_SubleadingOfflineLRJ_SubjetMultiplicity", "LRJ Et Distribution;Number of Subjets;% of Subleading LRJs", 4, 0, 4);

    TH1F* sig_h_JetTagger_CellTowerSK_Multiplicity = new TH1F("sig_h_JetTagger_CellTowerSK_Multiplicity", "LRJ Et Distribution;Number of CellTowers (SK Applied);Normalized Events / 5 Towers", 40, 0, 200);
    TH1F* back_h_JetTagger_CellTowerSK_Multiplicity = new TH1F("back_h_JetTagger_CellTowerSK_Multiplicity", "LRJ Et Distribution;Number of CellTowers (SK Applied);Normalized Events / 5 Towers", 40, 0, 200);

    TH1F* sig_h_JetTagger_Leading_MergedIO_Multiplicity = new TH1F("sig_h_JetTagger_Leading_MergedIO_Multiplicity", "LRJ Et Distribution;Number of Merged IOs;% of Leading JetTagger Jets / 2 IOs", 32, 0, 64);
    TH1F* back_h_JetTagger_Leading_MergedIO_Multiplicity = new TH1F("back_h_JetTagger_Leading_MergedIO_Multiplicity", "LRJ Et Distribution;Number of Merged IOs;% of Leading JetTagger Jets / 2 IOs", 32, 0, 64);

    TH1F* sig_h_JetTagger_Subleading_MergedIO_Multiplicity = new TH1F("sig_h_JetTagger_Subleading_MergedIO_Multiplicity", "LRJ Et Distribution;Number of Merged IOs;% of Subleading JetTagger Jets / 2 IOs", 32, 0, 64);
    TH1F* back_h_JetTagger_Subleading_MergedIO_Multiplicity = new TH1F("back_h_JetTagger_Subleading_MergedIO_Multiplicity", "LRJ Et Distribution;Number of Merged IOs;% of Subleading JetTagger Jets / 2 IOs", 32, 0, 64);

    const double inputObjectEtBinsEdges[] = {0.1, 1, 2, 5, 10, 25, 50, 100, 200, 400, 1000};
    const int inputObjectNBins = (int)(sizeof(inputObjectEtBinsEdges)/sizeof(inputObjectEtBinsEdges[0])) - 1;

    TH1F* sig_h_JetTagger_CellsTowersEt = new TH1F("sig_h_JetTagger_CellsTowersEt", "LRJ Et Distribution;CellsTowers E_{T}; CellsTowers / Bin / Event", inputObjectNBins, inputObjectEtBinsEdges);
    TH1F* back_h_JetTagger_CellsTowersEt = new TH1F("back_h_JetTagger_CellsTowersEt", "LRJ Et Distribution;CellsTowers E_{T};CellsTowers / Bin / Event", inputObjectNBins, inputObjectEtBinsEdges);

    TH1F* sig_h_JetTagger_Considered_CellsTowersEt = new TH1F("sig_h_JetTagger_Considered_CellsTowersEt", "LRJ Et Distribution;CellsTowers E_{T} [Considered]; CellsTowers / Bin / Event", inputObjectNBins, inputObjectEtBinsEdges);
    TH1F* back_h_JetTagger_Considered_CellsTowersEt = new TH1F("back_h_JetTagger_Considered_CellsTowersEt", "LRJ Et Distribution;CellsTowers E_{T} [Considered];CellsTowers / Bin / Event", inputObjectNBins, inputObjectEtBinsEdges);

    TH1F* sig_h_JetTagger_Leading_MergedIO_Et = new TH1F("sig_h_JetTagger_Leading_MergedIO_Et", "LRJ Et Distribution;Merged IOs E_{T}; Merged IOs [Leading Jet] / Bin / Event", inputObjectNBins, inputObjectEtBinsEdges);
    TH1F* back_h_JetTagger_Leading_MergedIO_Et = new TH1F("back_h_JetTagger_Leading_MergedIO_Et", "LRJ Et Distribution;Merged IOs E_{T};Merged IOs [Leading Jet] / Bin / Event", inputObjectNBins, inputObjectEtBinsEdges);

    TH1F* sig_h_JetTagger_Subleading_MergedIO_Et = new TH1F("sig_h_JetTagger_Subleading_MergedIO_Et", "LRJ Et Distribution;Merged IOs E_{T};Merged IOs [Sublead. Jet] / Bin / Event", inputObjectNBins, inputObjectEtBinsEdges);
    TH1F* back_h_JetTagger_Subleading_MergedIO_Et = new TH1F("back_h_JetTagger_Subleading_MergedIO_Et", "LRJ Et Distribution;Merged IOs E_{T};Merged IOs [Sublead. Jet] / Bin / Event", inputObjectNBins, inputObjectEtBinsEdges);

    TH1F* sig_h_LeadingJetTaggerLRJ_jFEX_SubjetMultiplicity = new TH1F("sig_h_LeadingJetTaggerLRJ_jFEX_SubjetMultiplicity", "LRJ Et Distribution;Number of Subjets [jFEX SRJs];% of Leading LRJs", 4, 0, 4);
    TH1F* back_h_LeadingJetTaggerLRJ_jFEX_SubjetMultiplicity = new TH1F("back_h_LeadingJetTaggerLRJ_jFEX_SubjetMultiplicity", "LRJ Et Distribution;Number of Subjets [jFEX SRJs];% of Leading LRJs", 4, 0, 4);

    TH1F* sig_h_LeadingJetTaggerLRJ_ConeCellsTowers_SubjetMultiplicity = new TH1F("sig_h_LeadingJetTaggerLRJ_ConeCellsTowers_SubjetMultiplicity", "LRJ Et Distribution;Number of Subjets [Cone CellsTowers Jets];% of Leading LRJs", 4, 0, 4);
    TH1F* back_h_LeadingJetTaggerLRJ_ConeCellsTowers_SubjetMultiplicity = new TH1F("back_h_LeadingJetTaggerLRJ_ConeCellsTowers_SubjetMultiplicity", "LRJ Et Distribution;Number of Subjets [Cone CellsTowers Jets];% of Leading LRJs", 4, 0, 4);

    TH1F* sig_h_SubleadingJetTaggerLRJ_jFEX_SubjetMultiplicity = new TH1F("sig_h_SubleadingJetTaggerLRJ_jFEX_SubjetMultiplicity", "LRJ Et Distribution;Number of Subjets [jFEX SRJs];% of Leading LRJs", 4, 0, 4);
    TH1F* back_h_SubleadingJetTaggerLRJ_jFEX_SubjetMultiplicity = new TH1F("back_h_SubleadingJetTaggerLRJ_jFEX_SubjetMultiplicity", "LRJ Et Distribution;Number of Subjets [jFEX SRJs];% of Leading LRJs", 4, 0, 4);

    TH1F* sig_h_SubleadingJetTaggerLRJ_ConeCellsTowers_SubjetMultiplicity = new TH1F("sig_h_SubleadingJetTaggerLRJ_ConeCellsTowers_SubjetMultiplicity", "LRJ Et Distribution;Number of Subjets [Cone CellsTowers Jets];% of Leading LRJs", 4, 0, 4);
    TH1F* back_h_SubleadingJetTaggerLRJ_ConeCellsTowers_SubjetMultiplicity = new TH1F("back_h_SubleadingJetTaggerLRJ_ConeCellsTowers_SubjetMultiplicity", "LRJ Et Distribution;Number of Subjets [Cone CellsTowers Jets];% of Leading LRJs", 4, 0, 4);

    TH1F* sig_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_1 = new TH1F("sig_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_1", "LRJ Et Distribution;#tau_{1, Lead. JetTag LRJ} [jFEX SRJs as Subjets];% of Events / 0.05", 20, 0, 1);
    TH1F* back_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_1 = new TH1F("back_h_LeadingJetTaggerLRJ_jFEX_Tau_1", "LRJ Et Distribution;#tau_{1, Lead. JetTag LRJ} [jFEX SRJs as Subjets];% of Events / 0.05", 20, 0, 1);

    TH1F* sig_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_2 = new TH1F("sig_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_2", "LRJ Et Distribution;#tau_{2, Lead. JetTag LRJ} [jFEX SRJs as Subjets];% of Events / 0.05", 20, 0, 1);
    TH1F* back_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_2 = new TH1F("back_h_LeadingJetTaggerLRJ_jFEX_Tau_2", "LRJ Et Distribution;tau_{2, Lead. JetTag LRJ} [jFEX SRJs as Subjets];% of Events / 0.05", 20, 0, 1);

    TH1F* sig_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_12 = new TH1F("sig_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_12", "LRJ Et Distribution;#tau_{2} / #tau_{1}  [jFEX SRJs as Subjets];% of Events / 0.05", 20, 0, 1);
    TH1F* back_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_12 = new TH1F("back_h_LeadingJetTaggerLRJ_jFEX_Tau_12", "LRJ Et Distribution;#tau_{2} / #tau_{1} [jFEX SRJs as Subjets];% of Events / 0.05", 20, 0, 1);

    TH1F* sig_h_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_12 = new TH1F("sig_h_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_12", "LRJ Et Distribution;#tau_{2} / #tau_{1}  [jFEX SRJs as Subjets];% of Events / 0.05", 20, 0, 1);
    TH1F* back_h_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_12 = new TH1F("back_h_SubleadingJetTaggerLRJ_jFEX_Tau_12", "LRJ Et Distribution;#tau_{2} / #tau_{1} [jFEX SRJs as Subjets];% of Events / 0.05", 20, 0, 1);

    TH1F* sig_h_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_1 = new TH1F("sig_h_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_1", "LRJ Et Distribution;#tau_{1, Lead. JetTag LRJ} [jFEX SRJs as Subjets];% of Events / 0.05", 20, 0, 1);
    TH1F* back_h_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_1 = new TH1F("back_h_SubleadingJetTaggerLRJ_jFEX_Tau_1", "LRJ Et Distribution;#tau_{1, Lead. JetTag LRJ} [jFEX SRJs as Subjets];% of Events / 0.05", 20, 0, 1);

    TH1F* sig_h_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_2 = new TH1F("sig_h_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_2", "LRJ Et Distribution;#tau_{2, Lead. JetTag LRJ} [jFEX SRJs as Subjets];% of Events / 0.05", 20, 0, 1);
    TH1F* back_h_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_2 = new TH1F("back_h_SubleadingJetTaggerLRJ_jFEX_Tau_2", "LRJ Et Distribution;tau_{2, Lead. JetTag LRJ} [jFEX SRJs as Subjets];% of Events / 0.05", 20, 0, 1);

    TH1F* sig_h_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1 = new TH1F("sig_h_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1", "LRJ Et Distribution;#tau_{1, Lead. JetTag LRJ} [ConeCellsTowers as Subjets];% of Events / 0.05", 20, 0, 1);
    TH1F* back_h_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1 = new TH1F("back_h_LeadingJetTaggerLRJ_ConeCellsTowers_Tau_1", "LRJ Et Distribution;#tau_{1, Lead. JetTag LRJ} [ConeCellsTowers as Subjets];% of Events / 0.05", 20, 0, 1);

    TH1F* sig_h_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_12 = new TH1F("sig_h_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_12", "LRJ Et Distribution;#tau_{2} / #tau_{1} [ConeCellsTowers as Subjets];% of Events / 0.05", 20, 0, 1);
    TH1F* back_h_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_12 = new TH1F("back_h_LeadingJetTaggerLRJ_ConeCellsTowers_Tau_12", "LRJ Et Distribution;#tau_{2} / #tau_{1} [ConeCellsTowers as Subjets];% of Events / 0.05", 20, 0, 1);

    TH1F* sig_h_JetTaggerLRJ_ConeCellsTowers_Subjet_Tau_21_Product = new TH1F("sig_h_JetTaggerLRJ_ConeCellsTowers_Subjet_Tau_21_Product", "LRJ Et Distribution;#tau_{2} / #tau_{1} (Leading) #times #tau_{2} / #tau_{1} (Subleading)  [ConeCellsTowers Subjets];% of Events / 0.05", 20, 0, 1);
    TH1F* back_h_JetTaggerLRJ_ConeCellsTowers_Subjet_Tau_21_Product = new TH1F("back_h_JetTaggerLRJ_ConeCellsTowers_Subjet_Tau_21_Product", "LRJ Et Distribution;#tau_{2} / #tau_{1} (Leading) #times #tau_{2} / #tau_{1} (Subleading)  [ConeCellsTowers Subjets];% of Events / 0.05", 20, 0, 1);

    TH1F* sig_h_JetTaggerLRJ_jFEX_Subjet_Tau_21_Product = new TH1F("sig_h_JetTaggerLRJ_jFEX_Subjet_Tau_21_Product", "LRJ Et Distribution;#tau_{2} / #tau_{1} (Leading) #times #tau_{2} / #tau_{1} (Subleading)  [jFEX Subjets];% of Events / 0.05", 20, 0, 1);
    TH1F* back_h_JetTaggerLRJ_jFEX_Subjet_Tau_21_Product = new TH1F("back_h_JetTaggerLRJ_jFEX_Subjet_Tau_21_Product", "LRJ Et Distribution;#tau_{2} / #tau_{1} (Leading) #times #tau_{2} / #tau_{1} (Subleading)  [jFEX Subjets];% of Events / 0.05", 20, 0, 1);

    TH1F* sig_h_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_2 = new TH1F("sig_h_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_2", "LRJ Et Distribution;#tau_{2, Lead. JetTag LRJ} [ConeCellsTowers as Subjets];% of Events / 0.05", 20, 0, 1);
    TH1F* back_h_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_2 = new TH1F("back_h_LeadingJetTaggerLRJ_ConeCellsTowers_Tau_2", "LRJ Et Distribution;tau_{2, Lead. JetTag LRJ} [ConeCellsTowers as Subjets];% of Events / 0.05", 20, 0, 1);

    TH1F* sig_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1 = new TH1F("sig_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1", "LRJ Et Distribution;#tau_{1, Lead. JetTag LRJ} [ConeCellsTowers as Subjets];% of Events / 0.05", 20, 0, 1);
    TH1F* back_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1 = new TH1F("back_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Tau_1", "LRJ Et Distribution;#tau_{1, Lead. JetTag LRJ} [ConeCellsTowers as Subjets];% of Events / 0.05", 20, 0, 1);

    TH1F* sig_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_12 = new TH1F("sig_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_12", "LRJ Et Distribution;#tau_{2} / #tau_{1} [ConeCellsTowers as Subjets];% of Events / 0.05", 20, 0, 1);
    TH1F* back_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_12 = new TH1F("back_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_12", "LRJ Et Distribution;#tau_{2} / #tau_{1} [ConeCellsTowers as Subjets];% of Events / 0.05", 20, 0, 1);

    TH1F* sig_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_2 = new TH1F("sig_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_2", "LRJ Et Distribution;#tau_{2, Lead. JetTag LRJ} [ConeCellsTowers as Subjets];% of Events / 0.05", 20, 0, 1);
    TH1F* back_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_2 = new TH1F("back_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Tau_2", "LRJ Et Distribution;tau_{2, Lead. JetTag LRJ} [ConeCellsTowers as Subjets];% of Events / 0.05", 20, 0, 1);

    TH2F *sig_h_JetTaggerLRJ_ConeCellsTowers_Subjet_Tau_21_Product_vsLeadingLRJEt = new TH2F("sig_h_JetTaggerLRJ_ConeCellsTowers_Subjet_Tau_21_Product_vsLeadingLRJEt", "Sum of Topo422 E_{T} in Each Bin; Leading JetTagger LRJ E_{T} [GeV]; #tau_{2} / #tau_{1} (Leading) #times #tau_{2} / #tau_{1} (Subleading)  [Cone Subjets]", 
                        52, 0, 1040,// x axis
                        20, 0, 1 ); //y axis

    TH2F *back_h_JetTaggerLRJ_ConeCellsTowers_Subjet_Tau_21_Product_vsLeadingLRJEt = new TH2F("back_h_JetTaggerLRJ_ConeCellsTowers_Subjet_Tau_21_Product_vsLeadingLRJEt", "Sum of Topo422 E_{T} in Each Bin; Leading JetTagger LRJ E_{T} [GeV]; #tau_{2} / #tau_{1} (Leading) #times #tau_{2} / #tau_{1} (Subleading)  [Cone Subjets]", 
                        52, 0, 1040,// x axis
                        20, 0, 1 ); //y axis

    TH2F *sig_h_JetTaggerLRJ_jFEX_Subjet_Tau_21_Product_vsLeadingLRJEt = new TH2F("sig_h_JetTaggerLRJ_jFEX_Subjet_Tau_21_Product_vsLeadingLRJEt", "Sum of Topo422 E_{T} in Each Bin; Leading JetTagger LRJ E_{T} [GeV]; #tau_{2} / #tau_{1} (Leading) #times #tau_{2} / #tau_{1} (Subleading)  [jFEX Subjets]", 
                        52, 0, 1040,// x axis
                        20, 0, 1 ); //y axis

    TH2F *back_h_JetTaggerLRJ_jFEX_Subjet_Tau_21_Product_vsLeadingLRJEt = new TH2F("back_h_JetTaggerLRJ_jFEX_Subjet_Tau_21_Product_vsLeadingLRJEt", "Sum of Topo422 E_{T} in Each Bin; Leading JetTagger LRJ E_{T} [GeV]; #tau_{2} / #tau_{1} (Leading) #times #tau_{2} / #tau_{1} (Subleading)  [jFEX Subjets]", 
                        52, 0, 1040,// x axis
                        20, 0, 1 ); //y axis
    
    TH2F *sig_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_1_vs_Tau_2 = new TH2F("sig_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_1_vs_Tau_2", "Sum of Topo422 E_{T} in Each Bin; #tau_{1, Lead. JetTag LRJ} [jFEX SRJs as Subjets]; #tau_{2, Lead. JetTag LRJ} [ConeCellsTowers as Subjets]", 
                        20, 0, 1,// x axis
                        20, 0, 1 ); //y axis

    TH2F *sig_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_1_vs_Tau_2 = new TH2F("sig_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_1_vs_Tau_2", "Sum of Topo422 E_{T} in Each Bin; #tau_{1, Lead. JetTag LRJ} [jFEX SRJs as Subjets]; #tau_{2, Lead. JetTag LRJ} [ConeCellsTowers as Subjets]", 
                        20, 0, 1,// x axis
                        20, 0, 1 ); //y axis

    TH2F *sig_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1_vs_Tau_2 = new TH2F("sig_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1_vs_Tau_2", "Sum of Topo422 E_{T} in Each Bin; #tau_{1, Lead. JetTag LRJ} [ConeCellsTowers as Subjets]; #tau_{2, Lead. JetTag LRJ} [ConeCellsTowers as Subjets]", 
                        20, 0, 1,// x axis
                        20, 0, 1 ); //y axis

    TH2F *sig_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1_vs_Tau_2 = new TH2F("sig_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1_vs_Tau_2", "Sum of Topo422 E_{T} in Each Bin; #tau_{1, Lead. JetTag LRJ} [ConeCellsTowers as Subjets]; #tau_{2, Lead. JetTag LRJ} [ConeCellsTowers as Subjets]", 
                        20, 0, 1,// x axis
                        20, 0, 1 ); //y axis

    TH2F *sig_JetTaggerLRJ_jFEX_Subjet_LeadingTau_12_vs_SubleadingTau12 = new TH2F("sig_JetTaggerLRJ_jFEX_Subjet_LeadingTau_12_vs_SubleadingTau12", "Sum of Topo422 E_{T} in Each Bin; #tau_{2} / #tau_{1} (Lead.) [jFEX SRJs as Subjets]; #tau_{2} / #tau_{1} (Sublead.) [jFEX SRJs as Subjets]", 
                        20, 0, 1,// x axis
                        20, 0, 1 ); //y axis

    TH2F *sig_JetTaggerLRJ_ConeCellsTowers_Subjet_LeadingTau_12_vs_SubleadingTau12 = new TH2F("sig_JetTaggerLRJ_ConeCellsTowers_Subjet_LeadingTau_12_vs_SubleadingTau12", "Sum of Topo422 E_{T} in Each Bin; #tau_{2} / #tau_{1} (Lead.) [ConeCellsTowers as Subjets]; #tau_{2} / #tau_{1} (Sublead.) [ConeCellsTowers as Subjets]", 
                        20, 0, 1,// x axis
                        20, 0, 1 ); //y axis

    TH2F *sig_JetTaggerLRJ_jFEX_Subjet_LeadingTau_12_vs_LeadingJetTaggerEt = new TH2F("sig_JetTaggerLRJ_jFEX_Subjet_LeadingTau_12_vs_LeadingJetTaggerEt", "Sum of Topo422 E_{T} in Each Bin;  Leading JetTagger LRJ E_{T} [GeV]; #tau_{2} / #tau_{1} (Lead.) [jFEX SRJs as Subjets]", 
                        20, 0, 800,// x axis
                        20, 0, 1 ); //y axis

    TH2F *sig_JetTaggerLRJ_ConeCellsTowers_Subjet_LeadingTau_12_vs_LeadingJetTaggerEt = new TH2F("sig_JetTaggerLRJ_ConeCellsTowers_Subjet_LeadingTau_12_vs_LeadingJetTaggerEt", "Sum of Topo422 E_{T} in Each Bin; Leading JetTagger LRJ E_{T} [GeV]; #tau_{2} / #tau_{1} (Sublead.) [ConeCellsTowers as Subjets]", 
                        20, 0, 800,// x axis
                        20, 0, 1 ); //y axis

    TH2F *back_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_1_vs_Tau_2 = new TH2F("back_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_1_vs_Tau_2", "Sum of Topo422 E_{T} in Each Bin; #tau_{1, Lead. JetTag LRJ} [jFEX SRJs as Subjets]; #tau_{2, Lead. JetTag LRJ} [ConeCellsTowers as Subjets]", 
                        20, 0, 1,// x axis
                        20, 0, 1 ); //y axis

    TH2F *back_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_1_vs_Tau_2 = new TH2F("back_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_1_vs_Tau_2", "Sum of Topo422 E_{T} in Each Bin; #tau_{1, Lead. JetTag LRJ} [jFEX SRJs as Subjets]; #tau_{2, Lead. JetTag LRJ} [ConeCellsTowers as Subjets]", 
                        20, 0, 1,// x axis
                        20, 0, 1 ); //y axis

    TH2F *back_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1_vs_Tau_2 = new TH2F("back_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1_vs_Tau_2", "Sum of Topo422 E_{T} in Each Bin; #tau_{1, Lead. JetTag LRJ} [ConeCellsTowers as Subjets]; #tau_{2, Lead. JetTag LRJ} [ConeCellsTowers as Subjets]", 
                        20, 0, 1,// x axis
                        20, 0, 1 ); //y axis

    TH2F *back_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1_vs_Tau_2 = new TH2F("back_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1_vs_Tau_2", "Sum of Topo422 E_{T} in Each Bin; #tau_{1, Lead. JetTag LRJ} [ConeCellsTowers as Subjets]; #tau_{2, Lead. JetTag LRJ} [ConeCellsTowers as Subjets]", 
                        20, 0, 1,// x axis
                        20, 0, 1 ); //y axis

    TH2F *back_JetTaggerLRJ_jFEX_Subjet_LeadingTau_12_vs_SubleadingTau12 = new TH2F("back_JetTaggerLRJ_jFEX_Subjet_LeadingTau_12_vs_SubleadingTau12", "Sum of Topo422 E_{T} in Each Bin; #tau_{2} / #tau_{1} (Lead.) [jFEX SRJs as Subjets]; #tau_{2} / #tau_{1} (Sublead.) [jFEX SRJs as Subjets]", 
                        20, 0, 1,// x axis
                        20, 0, 1 ); //y axis
    TH2F *back_JetTaggerLRJ_ConeCellsTowers_Subjet_LeadingTau_12_vs_SubleadingTau12 = new TH2F("back_JetTaggerLRJ_ConeCellsTowers_Subjet_LeadingTau_12_vs_SubleadingTau12", "Sum of Topo422 E_{T} in Each Bin; #tau_{2} / #tau_{1} (Lead.) [ConeCellsTowers as Subjets]; #tau_{2} / #tau_{1} (Sublead.) [ConeCellsTowers as Subjets]", 
                        20, 0, 1,// x axis
                        20, 0, 1 ); //y axis

    TH2F *back_JetTaggerLRJ_jFEX_Subjet_LeadingTau_12_vs_LeadingJetTaggerEt = new TH2F("back_JetTaggerLRJ_jFEX_Subjet_LeadingTau_12_vs_LeadingJetTaggerEt", "Sum of Topo422 E_{T} in Each Bin;  Leading JetTagger LRJ E_{T} [GeV]; #tau_{2} / #tau_{1} (Lead.) [jFEX SRJs as Subjets]", 
                        20, 0, 800,// x axis
                        20, 0, 1 ); //y axis

    TH2F *back_JetTaggerLRJ_ConeCellsTowers_Subjet_LeadingTau_12_vs_LeadingJetTaggerEt = new TH2F("back_JetTaggerLRJ_ConeCellsTowers_Subjet_LeadingTau_12_vs_LeadingJetTaggerEt", "Sum of Topo422 E_{T} in Each Bin; Leading JetTagger LRJ E_{T} [GeV]; #tau_{2} / #tau_{1} (Sublead.) [ConeCellsTowers as Subjets]", 
                        20, 0, 800,// x axis
                        20, 0, 1 ); //y axis


    TH1F* sig_h_LeadingOfflineLRJ_SubjetEt = new TH1F("sig_h_LeadingOfflineLRJ_SubjetEt", "LRJ Et Distribution;Subjet E_{T}; (# of Leading Offline LRJs Subjets / Event) / 20 GeV", 20, 0, 400);
    TH1F* back_h_LeadingOfflineLRJ_SubjetEt = new TH1F("back_h_LeadingOfflineLRJ_SubjetEt", "LRJ Et Distribution;Subjet E_{T}; (# of Leading Offline LRJs Subjets / Event) / 20 GeV", 20, 0, 400);
    
    TH1F* sig_h_SubleadingOfflineLRJ_SubjetEt = new TH1F("sig_h_SubleadingOfflineLRJ_SubjetEt", "LRJ Et Distribution;Subjet E_{T}; (# of Subleading Offline LRJs Subjets / Event) / 20 GeV", 20, 0, 400);
    TH1F* back_h_SubleadingOfflineLRJ_SubjetEt = new TH1F("back_h_SubleadingOfflineLRJ_SubjetEt", "LRJ Et Distribution;Subjet E_{T}; (# of Subleading Offline LRJs Subjets / Event) / 20 GeV", 20, 0, 400);

    TH1F* sig_h_LRJ_Et = new TH1F("sig_h_LRJ_Et", "LRJ Et Distribution;E_{T} [GeV];% of LRJs / 50 GeV", 16, 0, 800);
    TH1F* sig_h_leading_LRJ_Et = new TH1F("sig_h_leading_LRJ_Et", "Leading LRJ Et Distribution;E_{T} [GeV];% of Leading LRJs", rateVsEffBins.size() - 1, rateVsEffBins.data());
    TH1F* sig_h_subleading_LRJ_Et = new TH1F("sig_h_subleading_LRJ_Et", "Subleading LRJ Et Distribution;E_{T} [GeV];% of Subleading LRJs", rateVsEffBins.size() - 1, rateVsEffBins.data());

    TH1F* sig_h_leading_LRJ_Et_normalbinning = new TH1F("sig_h_leading_LRJ_Et_normalbinning", "Leading LRJ Et Distribution;E_{T} [GeV];% of Leading LRJs / 25 GeV", 41, 0, 1025);
    TH1F* sig_h_subleading_LRJ_Et_normalbinning = new TH1F("sig_h_subleading_LRJ_Et_normalbinning", "Subleading LRJ Et Distribution;E_{T} [GeV];% of Subleading LRJs / 25 GeV", 41, 0, 1025);


    TH1F* sig_h_gFEX_leading_LRJ_Et = new TH1F("sig_h_gFEX_leading_LRJ_Et", "Leading LRJ Et Distribution;E_{T} [GeV];% of Leading LRJs / 25 GeV", rateVsEffBins.size() - 1, rateVsEffBins.data());
    TH1F* sig_h_gFEX_subleading_LRJ_Et = new TH1F("sig_h_gFEX_subleading_LRJ_Et", "Subleading LRJ Et Distribution;E_{T} [GeV];% of Subleading LRJs / 25 GeV", rateVsEffBins.size() - 1, rateVsEffBins.data());

    TH1F* sig_h_jFEX_leading_LRJ_Et = new TH1F("sig_h_jFEX_leading_LRJ_Et", "Leading LRJ Et Distribution;E_{T} [GeV];% of Leading LRJs / 25 GeV", rateVsEffBins.size() - 1, rateVsEffBins.data());
    TH1F* sig_h_jFEX_subleading_LRJ_Et = new TH1F("sig_h_jFEX_subleading_LRJ_Et", "Subleading LRJ Et Distribution;E_{T} [GeV];% of Subleading LRJs / 25 GeV", rateVsEffBins.size() - 1, rateVsEffBins.data());

    // with deltaR metric
    TH2F *sigJetTaggerLeadingLRJEtvsPsi_R = new TH2F("sigJetTaggerLeadingLRJEtvsPsi_R", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; Leading JetTagger LRJ #Psi_{R}", 
                        52, 0, 1040, // x axis
                        20, 0, 1 ); //y axis

    TH2F *sigOfflineLeadingLRJMassvsPsi_R = new TH2F("sigOfflineLeadingLRJMassvsPsi_R", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ Mass [GeV]; Leading JetTagger LRJ #Psi_{R}", 
                        25, 0, 250, // x axis
                        20, 0, 1 ); //y axis

    TH2F *sigJetTaggerLeadingLRJPsi_RvsSubleadingPsi_R = new TH2F("sigJetTaggerLeadingLRJPsi_RvsSubleadingPsi_R", "Sum of Topo422 E_{T} in Each Bin; #Psi_{R} [Subleading Jet]; #Psi_{R} [Leading Jet]", 
                        20, 0, 1, // x axis
                        20, 0, 1 ); //y axis
    TH2F *backJetTaggerLeadingLRJEtvsPsi_R = new TH2F("backJetTaggerLeadingLRJEtvsPsi_R", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R}", 
                        52, 0, 1040, // x axis
                        20, 0, 1 ); //y axis
    TH2F *backOfflineLeadingLRJMassvsPsi_R = new TH2F("backOfflineLeadingLRJMassvsPsi_R", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ Mass [GeV]; Leading JetTagger LRJ #Psi_{R}", 
                        25, 0, 250, // x axis
                        20, 0, 1 ); //y axis
    TH2F *backJetTaggerLeadingLRJPsi_RvsSubleadingPsi_R = new TH2F("backJetTaggerLeadingLRJPsi_RvsSubleadingPsi_R", "Sum of Topo422 E_{T} in Each Bin; #Psi_{R} [Subleading Jet]; #Psi_{R} [Leading Jet]", 
                        20, 0, 1, // x axis
                        20, 0, 1 ); //y axis

    TH2F *sigJetTaggerSubleadingLRJEtvsPsi_R = new TH2F("sigJetTaggerSubleadingLRJEtvsPsi_R", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; #Psi_{R}", 
                        52, 0, 1040, // x axis
                        20, 0, 1 ); //y axis
    TH2F *backJetTaggerSubleadingLRJEtvsPsi_R = new TH2F("backJetTaggerSubleadingLRJEtvsPsi_R", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; #Psi_{R}", 
                        52, 0, 1040, // x axis
                        20, 0, 1 ); //y axis
    
    TH2F *sigJetTaggerLeadingLRJEtvsPsi_R_squared = new TH2F("sigJetTaggerLeadingLRJEtvsPsi_R_squared", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R, Leading} #times #Psi_{R, Subleading}", 
                        52, 0, 1040, // x axis
                        35, 0, 0.7); //y axis
    TH2F *backJetTaggerLeadingLRJEtvsPsi_R_squared = new TH2F("backJetTaggerLeadingLRJEtvsPsi_R_squared", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R, Leading} #times #Psi_{R, Subleading}", 
                        52, 0, 1040, // x axis
                        35, 0, 0.7); //y axis                    
    TH2F *sigJetTaggerSubleadingLRJEtvsPsi_R_squared = new TH2F("sigJetTaggerSubleadingLRJEtvsPsi_R_squared", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; #Psi_{R, Leading} #times #Psi_{R, Subleading}", 
                        52, 0, 1040, // x axis
                        35, 0, 0.7); //y axis
    TH2F *backJetTaggerSubleadingLRJEtvsPsi_R_squared = new TH2F("backJetTaggerSubleadingLRJEtvsPsi_R_squared", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; #Psi_{R, Leading} #times #Psi_{R, Subleading}", 
                        52, 0, 1040, // x axis
                        35, 0, 0.7); //y axis

    /// TH3F of Psi_R_squared + Leading LRJ E_T + Tau_2 / Tau_1 (Leading) * Tau_2 / Tau_1 (Subleading)
    TH3F *sigJetTaggerLeadingLRJEtvsPsi_R_squaredvsTau21jFEXProduct = new TH3F("sigJetTaggerLeadingLRJEtvsPsi_R_squaredvsTau21jFEXProduct", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R, Leading} #times #Psi_{R, Subleading};#tau_{2} / #tau_{1} (Leading) #times #tau_{2} / #tau_{1} (Subleading)  [jFEX Subjets]",
                        52, 0, 1040, // x axis
                        35, 0, 0.7,
                        20, 0, 1); //y axis

    TH3F *backJetTaggerLeadingLRJEtvsPsi_R_squaredvsTau21jFEXProduct = new TH3F("backJetTaggerLeadingLRJEtvsPsi_R_squaredvsTau21jFEXProduct", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R, Leading} #times #Psi_{R, Subleading};#tau_{2} / #tau_{1} (Leading) #times #tau_{2} / #tau_{1} (Subleading)  [jFEX Subjets]",
                        52, 0, 1040, // x axis
                        35, 0, 0.7,
                        20, 0, 1); //y axis
    
    TH2F *sigJetTaggerLeadingLRJvsPsi_R_squaredvsTau21jFEXProduct = new TH2F("sigJetTaggerLeadingLRJvsPsi_R_squaredvsTau21jFEXProduct", "Sum of Topo422 E_{T} in Each Bin;#Psi_{R, Leading} #times #Psi_{R, Subleading};#tau_{2} / #tau_{1} (Leading) #times #tau_{2} / #tau_{1} (Subleading)  [jFEX Subjets]",
                        35, 0, 0.7,
                        20, 0, 1); //y axis

    TH2F *backJetTaggerLeadingLRJvsPsi_R_squaredvsTau21jFEXProduct = new TH2F("backJetTaggerLeadingLRJvsPsi_R_squaredvsTau21jFEXProduct", "Sum of Topo422 E_{T} in Each Bin;#Psi_{R, Leading} #times #Psi_{R, Subleading};#tau_{2} / #tau_{1} (Leading) #times #tau_{2} / #tau_{1} (Subleading)  [jFEX Subjets]",
                        35, 0, 0.7,
                        20, 0, 1); //y axis

    TH3F *sigJetTaggerLeadingLRJEtvsPsi_R_squaredvsTau21ConeProduct = new TH3F("sigJetTaggerLeadingLRJEtvsPsi_R_squaredvsTau21ConeProduct", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R, Leading} #times #Psi_{R, Subleading};#tau_{2} / #tau_{1} (Leading) #times #tau_{2} / #tau_{1} (Subleading)  [Cone Subjets]",
                        52, 0, 1040, // x axis
                        35, 0, 0.7,
                        20, 0, 1); //y axis

    TH3F *backJetTaggerLeadingLRJEtvsPsi_R_squaredvsTau21ConeProduct = new TH3F("backJetTaggerLeadingLRJEtvsPsi_R_squaredvsTau21ConeProduct", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R, Leading} #times #Psi_{R, Subleading};#tau_{2} / #tau_{1} (Leading) #times #tau_{2} / #tau_{1} (Subleading)  [Cone Subjets]",
                        52, 0, 1040, // x axis
                        35, 0, 0.7,
                        20, 0, 1); //y axis
    
    TH2F *sigJetTaggerLeadingLRJvsPsi_R_squaredvsTau21ConeProduct = new TH2F("sigJetTaggerLeadingLRJvsPsi_R_squaredvsTau21ConeProduct", "Sum of Topo422 E_{T} in Each Bin;#Psi_{R, Leading} #times #Psi_{R, Subleading};#tau_{2} / #tau_{1} (Leading) #times #tau_{2} / #tau_{1} (Subleading)  [Cone Subjets]",
                        35, 0, 0.7,
                        20, 0, 1); //y axis

    TH2F *backJetTaggerLeadingLRJvsPsi_R_squaredvsTau21ConeProduct = new TH2F("backJetTaggerLeadingLRJvsPsi_R_squaredvsTau21ConeProduct", "Sum of Topo422 E_{T} in Each Bin;#Psi_{R, Leading} #times #Psi_{R, Subleading};#tau_{2} / #tau_{1} (Leading) #times #tau_{2} / #tau_{1} (Subleading)  [Cone Subjets]",
                        35, 0, 0.7,
                        20, 0, 1); //y axis

    TH1F* sig_h_leading_LRJ_psi_R_squared_NoConeSubjets = new TH1F("sig_h_leading_LRJ_psi_R_squared_NoConeSubjets", "Leading LRJ Et Distribution;#Psi_{R, lead.} #times #Psi_{R, subl.} [No Cone Subjets];% of Leading LRJs / 0.02", 35, 0, 0.7);
    TH1F* back_h_leading_LRJ_psi_R_squared_NoConeSubjets = new TH1F("back_h_leading_LRJ_psi_R_squared_NoConeSubjets", "Leading LRJ Et Distribution;#Psi_{R, lead.} #times #Psi_{R, subl.} [No Cone Subjets];% of Leading LRJs / 0.02", 35, 0, 0.7);
    
    TH1F* sig_h_leading_LRJ_psi_R_squared_NojFEXSubjets = new TH1F("sig_h_leading_LRJ_psi_R_squared_NojFEXSubjets", "Leading LRJ Et Distribution;#Psi_{R, lead.} #times #Psi_{R, subl.} [No jFEX Subjets];% of Leading LRJs / 0.02", 35, 0, 0.7);
    TH1F* back_h_leading_LRJ_psi_R_squared_NojFEXSubjets = new TH1F("back_h_leading_LRJ_psi_R_squared_NojFEXSubjets", "Leading LRJ Et Distribution;#Psi_{R, lead.} #times #Psi_{R, subl.} [No jFEX Subjets];% of Leading LRJs / 0.02", 35, 0, 0.7);

    TH1F* sig_h_leading_LRJ_Et_NoConeSubjets = new TH1F("sig_h_leading_LRJ_Et_NoConeSubjets", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [No Cone Subjets];% of Leading LRJs / 10 GeV", 52, 0, 1040);
    TH1F* back_h_leading_LRJ_Et_NoConeSubjets = new TH1F("back_h_leading_LRJ_Et_squared_NoConeSubjets", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [No Cone Subjets];% of Leading LRJs / 10 GeV", 52, 0, 1040);
    
    TH1F* sig_h_leading_LRJ_Et_NojFEXSubjets = new TH1F("sig_h_leading_LRJ_Et_NojFEXSubjets", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [No jFEX Subjets];% of Leading LRJs / 10 GeV", 52, 0, 1040);
    TH1F* back_h_leading_LRJ_Et_NojFEXSubjets = new TH1F("back_h_leading_LRJ_Et_NojFEXSubjets", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [No jFEX Subjets];% of Leading LRJs / 10 GeV", 52, 0, 1040);

    TH2F *sigJetTaggerLeadingLRJEtvsPsi_R_squared_NoConeSubjets = new TH2F("sigJetTaggerLeadingLRJEtvsPsi_R_squared_NoConeSubjets", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R, lead.} #times #Psi_{R, subl.} [No Cone Subjets]", 
                        52, 0, 1040, // x axis
                        35, 0, 0.7 ); //y axis

    TH2F *backJetTaggerLeadingLRJEtvsPsi_R_squared_NoConeSubjets = new TH2F("backJetTaggerLeadingLRJEtvsPsi_R_squared_NoConeSubjets", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R, lead.} #times #Psi_{R, subl.} [No Cone Subjets]", 
                        52, 0, 1040, // x axis
                        35, 0, 0.7 ); //y axis

    TH2F *sigJetTaggerLeadingLRJEtvsPsi_R_squared_NojFEXSubjets = new TH2F("sigJetTaggerLeadingLRJEtvsPsi_R_squared_NojFEXSubjets", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R, lead.} #times #Psi_{R, subl.} [No jFEX Subjets]", 
                        52, 0, 1040, // x axis
                        35, 0, 0.7 ); //y axis

    TH2F *backJetTaggerLeadingLRJEtvsPsi_R_squared_NojFEXSubjets = new TH2F("backJetTaggerLeadingLRJEtvsPsi_R_squared_NojFEXSubjets", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R, lead.} #times #Psi_{R, subl.} [No jFEX Subjets]", 
                        52, 0, 1040, // x axis
                        35, 0, 0.7 ); //y axis

    TH2F *sigJetTaggerLeadingLRJEtvsPsi_R_NoConeSubjets = new TH2F("sigJetTaggerLeadingLRJEtvsPsi_R_NoConeSubjets", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R, lead.} [No Cone Subjets]", 
                        52, 0, 1040, // x axis
                        50, 0, 1); //y axis

    TH2F *backJetTaggerLeadingLRJEtvsPsi_R_NoConeSubjets = new TH2F("backJetTaggerLeadingLRJEtvsPsi_R_NoConeSubjets", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R, lead.} [No Cone Subjets]", 
                        52, 0, 1040, // x axis
                        50, 0, 1); //y axis

    TH2F *sigJetTaggerLeadingLRJEtvsPsi_R_NojFEXSubjets = new TH2F("sigJetTaggerLeadingLRJEtvsPsi_R_NojFEXSubjets", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R, lead.} [No jFEX Subjets]", 
                        52, 0, 1040, // x axis
                        50, 0, 1); //y axis

    TH2F *backJetTaggerLeadingLRJEtvsPsi_R_NojFEXSubjets = new TH2F("backJetTaggerLeadingLRJEtvsPsi_R_NojFEXSubjets", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R, lead.} [No jFEX Subjets]", 
                        52, 0, 1040, // x axis
                        50, 0, 1); //y axis

    TH1F* sig_h_leading_LRJ_psi_R_squared_With1ConeSubjet = new TH1F("sig_h_leading_LRJ_psi_R_squared_With1ConeSubjet", "Leading LRJ Et Distribution;#Psi_{R, lead.} #times #Psi_{R, subl.} [1 Cone Subjets];% of Leading LRJs / 0.02", 35, 0, 0.7);
    TH1F* back_h_leading_LRJ_psi_R_squared_With1ConeSubjet = new TH1F("back_h_leading_LRJ_psi_R_squared_With1ConeSubjet", "Leading LRJ Et Distribution;#Psi_{R, lead.} #times #Psi_{R, subl.} [1 Cone Subjets];% of Leading LRJs / 0.02", 35, 0, 0.7);
    
    TH1F* sig_h_leading_LRJ_psi_R_squared_With1jFEXSubjet = new TH1F("sig_h_leading_LRJ_psi_R_squared_With1jFEXSubjet", "Leading LRJ Et Distribution;#Psi_{R, lead.} #times #Psi_{R, subl.} [1 jFEX Subjets];% of Leading LRJs / 0.02", 35, 0, 0.7);
    TH1F* back_h_leading_LRJ_psi_R_squared_With1jFEXSubjet = new TH1F("back_h_leading_LRJ_psi_R_squared_With1jFEXSubjet", "Leading LRJ Et Distribution;#Psi_{R, lead.} #times #Psi_{R, subl.} [1 jFEX Subjets];% of Leading LRJs / 0.02", 35, 0, 0.7);

    TH1F* sig_h_leading_LRJ_Et_With1ConeSubjet = new TH1F("sig_h_leading_LRJ_Et_With1ConeSubjet", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [1 Cone Subjets];% of Leading LRJs / 10 GeV", 52, 0, 1040);
    TH1F* back_h_leading_LRJ_Et_With1ConeSubjet = new TH1F("back_h_leading_LRJ_Et_With1ConeSubjet", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [1 Cone Subjets];% of Leading LRJs / 10 GeV", 52, 0, 1040);
    
    TH1F* sig_h_leading_LRJ_Et_With1jFEXSubjet = new TH1F("sig_h_leading_LRJ_Et_With1jFEXSubjet", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [1 jFEX Subjets];% of Leading LRJs / 10 GeV", 52, 0, 1040);
    TH1F* back_h_leading_LRJ_Et_With1jFEXSubjet = new TH1F("back_h_leading_LRJ_Et_With1jFEXSubjet", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [1 jFEX Subjets];% of Leading LRJs / 10 GeV", 52, 0, 1040);

    TH2F *sigJetTaggerLeadingLRJEtvsPsi_R_squared_With1ConeSubjet = new TH2F("sigJetTaggerLeadingLRJEtvsPsi_R_squared_With1ConeSubjet", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R, lead.} #times #Psi_{R, subl.} [1 Cone Subjets]", 
                        52, 0, 1040, // x axis
                        35, 0, 0.7 ); //y axis

    TH2F *backJetTaggerLeadingLRJEtvsPsi_R_squared_With1ConeSubjet = new TH2F("backJetTaggerLeadingLRJEtvsPsi_R_squared_With1ConeSubjet", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R, lead.} #times #Psi_{R, subl.} [1 Cone Subjets]", 
                        52, 0, 1040, // x axis
                        35, 0, 0.7 ); //y axis

    TH2F *sigJetTaggerLeadingLRJEtvsPsi_R_squared_With1jFEXSubjet = new TH2F("sigJetTaggerLeadingLRJEtvsPsi_R_squared_With1jFEXSubjet", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R, lead.} #times #Psi_{R, subl.} [1 jFEX Subjets]", 
                        52, 0, 1040, // x axis
                        35, 0, 0.7 ); //y axis

    TH2F *backJetTaggerLeadingLRJEtvsPsi_R_squared_With1jFEXSubjet = new TH2F("backJetTaggerLeadingLRJEtvsPsi_R_squared_With1jFEXSubjet", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R, lead.} #times #Psi_{R, subl.} [1 jFEX Subjets]", 
                        52, 0, 1040, // x axis
                        35, 0, 0.7 ); //y axis

    TH2F *sigJetTaggerLeadingLRJEtvsPsi_R_With1ConeSubjet = new TH2F("sigJetTaggerLeadingLRJEtvsPsi_R_With1ConeSubjet", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R, lead.} [1 Cone Subjets]", 
                        52, 0, 1040, // x axis
                        50, 0, 1.0); //y axis

    TH2F *backJetTaggerLeadingLRJEtvsPsi_R_With1ConeSubjet = new TH2F("backJetTaggerLeadingLRJEtvsPsi_R_With1ConeSubjet", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R, lead.} [1 Cone Subjets]", 
                        52, 0, 1040, // x axis
                        50, 0, 1.0); //y axis

    TH2F *sigJetTaggerLeadingLRJEtvsZ_With1ConeSubjet = new TH2F("sigJetTaggerLeadingLRJEtvsZ_With1ConeSubjet", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; Lead Subjet E_{T} / Total E_{T}", 
                        52, 0, 1040, // x axis
                        25, 0, 1.0); //y axis

    TH2F *backJetTaggerLeadingLRJEtvsZ_With1ConeSubjet = new TH2F("backJetTaggerLeadingLRJEtvsZ_With1ConeSubjet", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; Lead Subjet E_{T} / Total E_{T}", 
                        52, 0, 1040, // x axis
                        25, 0, 1.0); //y axis

    TH2F *sigJetTaggerLeadingLRJEtvsPsi_R_With1jFEXSubjet = new TH2F("sigJetTaggerLeadingLRJEtvsPsi_R_With1jFEXSubjet", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R, lead.} [1 jFEX Subjets]", 
                        52, 0, 1040, // x axis
                        50, 0, 1.0); //y axis

    TH2F *backJetTaggerLeadingLRJEtvsPsi_R_With1jFEXSubjet = new TH2F("backJetTaggerLeadingLRJEtvsPsi_R_With1jFEXSubjet", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R, lead.} [1 jFEX Subjets]", 
                        52, 0, 1040, // x axis
                        50, 0, 1.0); //y axis

    TH1F* sig_h_leading_LRJ_psi_R_squared_WithGrEq2ConeSubjet = new TH1F("sig_h_leading_LRJ_psi_R_squared_WithGrEq2ConeSubjet", "Leading LRJ Et Distribution;#Psi_{R, lead.} #times #Psi_{R, subl.} [>= 2 cone subjets];% of Leading LRJs / 0.02", 35, 0, 0.7);
    TH1F* back_h_leading_LRJ_psi_R_squared_WithGrEq2ConeSubjet = new TH1F("back_h_leading_LRJ_psi_R_squared_WithGrEq2ConeSubjet", "Leading LRJ Et Distribution;#Psi_{R, lead.} #times #Psi_{R, subl.} [>= 2 cone subjets];% of Leading LRJs / 0.02", 35, 0, 0.7);

    TH1F* sig_h_leading_LRJ_psi_R_SubleadingSubjet_WithGrEq2ConeSubjet = new TH1F("sig_h_leading_LRJ_psi_R_SubleadingSubjet_WithGrEq2ConeSubjet", "Leading LRJ Et Distribution; #Psi_{R, subl. subjet} [>= 2 cone subjets];% of Leading LRJs / 0.02", 50, 0, 1.0);
    TH1F* back_h_leading_LRJ_psi_R_SubleadingSubjet_WithGrEq2ConeSubjet = new TH1F("back_h_leading_LRJ_psi_R_SubleadingSubjet_WithGrEq2ConeSubjet", "Leading LRJ Et Distribution;#Psi_{R, subl. subjet} [>= 2 cone subjets];% of Leading LRJs / 0.02", 50, 0, 1.0);
    
    TH1F* sig_h_leading_LRJ_psi_R_squared_WithGrEq2jFEXSubjet = new TH1F("sig_h_leading_LRJ_psi_R_squared_WithGrEq2jFEXSubjet", "Leading LRJ Et Distribution;#Psi_{R, lead.} #times #Psi_{R, subl.} [>= 2 jFEX Subjets];% of Leading LRJs / 0.02", 35, 0, 0.7);
    TH1F* back_h_leading_LRJ_psi_R_squared_WithGrEq2jFEXSubjet = new TH1F("back_h_leading_LRJ_psi_R_squared_WithGrEq2jFEXSubjet", "Leading LRJ Et Distribution;#Psi_{R, lead.} #times #Psi_{R, subl.} [>= 2 jFEX Subjets];% of Leading LRJs / 0.02", 35, 0, 0.7);

    TH1F* sig_h_leading_LRJ_Et_WithGrEq2ConeSubjet = new TH1F("sig_h_leading_LRJ_Et_WithGrEq2ConeSubjet", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [>= 2 cone subjets];% of Leading LRJs / 20 GeV", 52, 0, 1040);
    TH1F* back_h_leading_LRJ_Et_WithGrEq2ConeSubjet = new TH1F("back_h_leading_LRJ_Et_WithGrEq2ConeSubjet", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [>= 2 cone subjets];% of Leading LRJs / 20 GeV", 52, 0, 1040);

    TH1F* sig_h_leading_LRJ_DeltaRSubjetsTimesSubjetEtRatio_WithGrEq2ConeSubjet = new TH1F("sig_h_leading_LRJ_DeltaRSubjetsTimesSubjetEtRatio_WithGrEq2ConeSubjet", "Leading LRJ Et Distribution;#Delta R #times r_{E_{T}} [>= 2 cone subjets];% of Leading LRJs / 0.5 GeV", 38, 1, 20);
    TH1F* back_h_leading_LRJ_DeltaRSubjetsTimesSubjetEtRatio_WithGrEq2ConeSubjet = new TH1F("back_h_leading_LRJ_DeltaRSubjetsTimesSubjetEtRatio_WithGrEq2ConeSubjet", "Leading LRJ Et Distribution;#Delta R #times r_{E_{T}} [>= 2 cone subjets];% of Leading LRJs / 0.5 GeV", 38, 1, 20);
    
    TH1F* sig_h_leading_LRJ_Et_WithGrEq2jFEXSubjet = new TH1F("sig_h_leading_LRJ_Et_WithGrEq2jFEXSubjet", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [>= 2 jFEX Subjets];% of Leading LRJs / 20 GeV", 52, 0, 1040);
    TH1F* back_h_leading_LRJ_Et_WithGrEq2jFEXSubjet = new TH1F("back_h_leading_LRJ_Et_WithGrEq2jFEXSubjet", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [>= 2 jFEX Subjets];% of Leading LRJs / 20 GeV", 52, 0, 1040);
    
    TH2F *sigJetTaggerLeadingLRJEtvspsi_R_SubleadingSubjet_WithGrEq2ConeSubjet = new TH2F("sigJetTaggerLeadingLRJEtvspsi_R_SubleadingSubjet_WithGrEq2ConeSubjet", "Sum of Topo422 E_{T} in Each Bin; Lead. LRJ E_{T}; #Psi_{R, subl. subjet} [>= 2 cone subjets]", 
                        70, 0, 700, // x axis
                        25, 0, 1); //y axis

    TH2F *backJetTaggerLeadingLRJEtvspsi_R_SubleadingSubjet_WithGrEq2ConeSubjet = new TH2F("backJetTaggerLeadingLRJEtvspsi_R_SubleadingSubjet_WithGrEq2ConeSubjet", "Sum of Topo422 E_{T} in Each Bin Lead. LRJ E_{T}; #Psi_{R, subl. subjet} [>= 2 cone subjets]", 
                        70, 0, 700, // x axis
                        25, 0, 1); //y axis

    TH2F *sigJetTaggerLeadingLRJDeltaRSubjetsvsSubjetEtRatio_WithGrEq2ConeSubjet = new TH2F("sigJetTaggerLeadingLRJDeltaRSubjetsvsSubjetEtRatio_WithGrEq2ConeSubjet", "Sum of Topo422 E_{T} in Each Bin; #Delta R Lead., Subl. Subjets; Subjet E_{T} Ratio (Lead. / Subl.) [>= 2 cone subjets]", 
                        50, 0, 2.5, // x axis
                        38, 1, 20); //y axis

    TH2F *backJetTaggerLeadingLRJDeltaRSubjetsvsSubjetEtRatio_WithGrEq2ConeSubjet = new TH2F("backJetTaggerLeadingLRJDeltaRSubjetsvsSubjetEtRatio_WithGrEq2ConeSubjet", "Sum of Topo422 E_{T} in Each Bin; #Delta R Lead., Subl. Subjets; Subjet E_{T} Ratio (Lead. / Subl.) [>= 2 cone subjets]", 
                        50, 0, 2.5, // x axis
                        38, 1, 20); //y axis

    TH2F *sigJetTaggerLeadingLRJEtvsSubjetEtRatioTimesDeltaRSubjets_WithGrEq2ConeSubjet = new TH2F("sigJetTaggerLeadingLRJEtvsSubjetEtRatioTimesDeltaRSubjets_WithGrEq2ConeSubjet", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Delta R #times r_{E_{T}} [>= 2 cone subjets]", 
                        52, 0, 1040, // x axis
                        50, 0, 50); //y axis

    TH2F *backJetTaggerLeadingLRJEtvsSubjetEtRatioTimesDeltaRSubjets_WithGrEq2ConeSubjet = new TH2F("backJetTaggerLeadingLRJEtvsSubjetEtRatioTimesDeltaRSubjets_WithGrEq2ConeSubjet", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Delta R #times r_{E_{T}} [>= 2 cone subjets]", 
                        52, 0, 1040, // x axis
                        50, 0, 50); //y axis

    TH2F *sigJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet = new TH2F("sigJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R, lead.} #times #Psi_{R, subl.} [>= 2 cone subjets]", 
                        52, 0, 1040, // x axis
                        35, 0, 0.7 ); //y axis

    TH2F *backJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet = new TH2F("backJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R, lead.} #times #Psi_{R, subl.} [>= 2 cone subjets]", 
                        52, 0, 1040, // x axis
                        35, 0, 0.7 ); //y axis

    TH2F *sigJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2jFEXSubjet = new TH2F("sigJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2jFEXSubjet", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R, lead.} #times #Psi_{R, subl.} [>= 2 jFEX Subjets]", 
                        52, 0, 1040, // x axis
                        35, 0, 0.7 ); //y axis

    TH2F *backJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2jFEXSubjet = new TH2F("backJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2jFEXSubjet", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R, lead.} #times #Psi_{R, subl.} [>= 2 jFEX Subjets]", 
                        52, 0, 1040, // x axis
                        35, 0, 0.7 ); //y axis

    TH2F *sigJetTaggerLeadingLRJEtvsPsi_R_WithGrEq2ConeSubjet = new TH2F("sigJetTaggerLeadingLRJEtvsPsi_R_WithGrEq2ConeSubjet", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R, lead.} [>= 2 cone subjets]", 
                        52, 0, 1040, // x axis
                        50, 0, 1.0); //y axis

    TH2F *backJetTaggerLeadingLRJEtvsPsi_R_WithGrEq2ConeSubjet = new TH2F("backJetTaggerLeadingLRJEtvsPsi_R_WithGrEq2ConeSubjet", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R, lead.} [>= 2 cone subjets]", 
                        52, 0, 1040, // x axis
                        50, 0, 1.0); //y axis

    TH2F *sigJetTaggerLeadingLRJEtvsPsi_R_WithGrEq2jFEXSubjet = new TH2F("sigJetTaggerLeadingLRJEtvsPsi_R_WithGrEq2jFEXSubjet", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R, lead.} [>= 2 jFEX Subjets]", 
                        52, 0, 1040, // x axis
                        50, 0, 1.0); //y axis

    TH2F *backJetTaggerLeadingLRJEtvsPsi_R_WithGrEq2jFEXSubjet = new TH2F("backJetTaggerLeadingLRJEtvsPsi_R_WithGrEq2jFEXSubjet", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R, lead.} [>= 2 jFEX Subjets]", 
                        52, 0, 1040, // x axis
                        50, 0, 1.0); //y axis

    // Mass approx (deltaR(subjets) * E_T) 
    TH1F* sig_h_leading_LRJ_MassApprox_WithGrEq2ConeSubjet = new TH1F("sig_h_leading_LRJ_MassApprox_WithGrEq2ConeSubjet", "Leading LRJ Et Distribution; #Delta(R) [Lead., Subl. Cone Subjets] #times E_{T, lead.};% of Leading JetTagger LRJs / 10 GeV", 103, 0, 2060);
    TH1F* back_h_leading_LRJ_MassApprox_WithGrEq2ConeSubjet = new TH1F("back_h_leading_LRJ_MassApprox_WithGrEq2ConeSubjet", "Leading LRJ Et Distribution; #Delta(R) [Lead., Subl. Cone Subjets] #times E_{T, lead.};% of Leading JetTagger LRJs / 10 GeV", 103, 0, 2060);

    TH1F* sig_h_leading_LRJ_Z = new TH1F("sig_h_leading_LRJ_Z", "Leading LRJ Et Distribution; Lead Subjet E_{T} / Jet E_{T};% of Leading JetTagger LRJs / 0.04", 25, 0, 1);
    TH1F* back_h_leading_LRJ_Z = new TH1F("back_h_leading_LRJ_Z", "Leading LRJ Et Distribution; Lead Subjet E_{T} / Jet E_{T};% of Leading JetTagger LRJs / 0.04", 25, 0, 1);

    TH1F* sig_h_subleading_LRJ_Z = new TH1F("sig_h_subleading_LRJ_Z", "Leading LRJ Et Distribution; Lead. Subjet E_{T} / Jet E_{T};% of Subleading JetTagger LRJs / 0.04", 25, 0, 1);
    TH1F* back_h_subleading_LRJ_Z = new TH1F("back_h_subleading_LRJ_Z", "Leading LRJ Et Distribution; Lead. Subjet E_{T} / Jet E_{T};% of Subleading JetTagger LRJs / 0.04", 25, 0, 1);

    TH2F *sigJetTaggerLeadingLRJEtvsZ = new TH2F("sigJetTaggerLeadingLRJEtvsZ", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; Lead. Subjet E_{T} / Jet E_{T}", 
                        35, 0, 700,
                        25, 0, 1); //y axis

    TH2F *backJetTaggerLeadingLRJEtvsZ = new TH2F("backJetTaggerLeadingLRJEtvsZ", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; Lead. Subjet E_{T} / Jet E_{T}", 
                        35, 0, 700,
                        25, 0, 1); //y axis

    TH2F *sigJetTaggerSubleadingLRJEtvsZ = new TH2F("sigJetTaggerSubleadingLRJEtvsZ", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; Lead. Subjet E_{T} / Jet E_{T}", 
                        35, 0, 700,
                        25, 0, 1); //y axis

    TH2F *backJetTaggerSubleadingLRJEtvsZ = new TH2F("backJetTaggerSubleadingLRJEtvsZ", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; Lead. Subjet E_{T} / Jet E_{T}", 
                        35, 0, 700,
                        25, 0, 1); //y axis

    TH2F *sigJetTaggerLeadingLRJEtvs1MinusZ = new TH2F("sigJetTaggerLeadingLRJEtvs1MinusZ", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; Lead. Subjet E_{T} / Jet E_{T}", 
                        35, 0, 700,
                        25, 0, 1); //y axis

    TH2F *backJetTaggerLeadingLRJEtvs1MinusZ = new TH2F("backJetTaggerLeadingLRJEtvs1MinusZ", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; Lead. Subjet E_{T} / Jet E_{T}", 
                        35, 0, 700,
                        25, 0, 1); //y axis

    TH2F *sigJetTaggerSubleadingLRJEtvs1MinusZ = new TH2F("sigJetTaggerSubleadingLRJEtvs1MinusZ", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; Lead. Subjet E_{T} / Jet E_{T}", 
                        35, 0, 700,
                        25, 0, 1); //y axis

    TH2F *backJetTaggerSubleadingLRJEtvs1MinusZ = new TH2F("backJetTaggerSubleadingLRJEtvs1MinusZ", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; Lead. Subjet E_{T} / Jet E_{T}", 
                        35, 0, 700,
                        25, 0, 1); //y axis

    TH2F *sigJetTaggerLeadingLRJEtvsEtOutsideSubjets = new TH2F("sigJetTaggerLeadingLRJEtvsEtOutsideSubjets", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; 1 - (Lead. + Subl. Subjets E_{T}) / Jet E_{T}", 
                        35, 0, 700,
                        25, 0, 1); //y axis

    TH2F *backJetTaggerLeadingLRJEtvsEtOutsideSubjets = new TH2F("backJetTaggerLeadingLRJEtvsEtOutsideSubjets", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; 1 - (Lead. + Subl. Subjets E_{T}) / Jet E_{T}", 
                        35, 0, 700,
                        25, 0, 1); //y axis

    TH2F *sigJetTaggerSubleadingLRJEtvsEtOutsideSubjets = new TH2F("sigJetTaggerSubleadingLRJEtvsEtOutsideSubjets", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; 1 - (Lead. + Subl. Subjets E_{T}) / Jet E_{T}", 
                        35, 0, 700,
                        25, 0, 1); //y axis

    TH2F *backJetTaggerSubleadingLRJEtvsEtOutsideSubjets = new TH2F("backJetTaggerSubleadingLRJEtvsEtOutsideSubjets", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; 1 - (Lead. + Subl. Subjets E_{T}) / Jet E_{T}", 
                        35, 0, 700,
                        25, 0, 1); //y axis
    
    TH1F* sig_h_leading_LRJ_MassApprox_WithGrEq2jFEXSubjet = new TH1F("sig_h_leading_LRJ_MassApprox_WithGrEq2jFEXSubjet", "Leading LRJ Et Distribution; #Delta(R) [Lead., Subl. jFEX Subjets] #times E_{T, lead.};% of Leading JetTagger LRJs / 10 GeV", 103, 0, 2060);
    TH1F* back_h_leading_LRJ_MassApprox_WithGrEq2jFEXSubjet = new TH1F("back_h_leading_LRJ_MassApprox_WithGrEq2jFEXSubjet", "Leading LRJ Et Distribution; #Delta(R) [Lead., Subl. jFEX Subjets] #times E_{T, lead.};% of Leading JetTagger LRJs / 10 GeV", 103, 0, 2060);

    TH1F* sig_h_leading_LRJ_DeltaRSubjets_WithGrEq2ConeSubjet = new TH1F("sig_h_leading_LRJ_DeltaRSubjets_WithGrEq2ConeSubjet", "Leading LRJ Et Distribution; #Delta(R) [Lead., Subl. Cone Subjets];% of Leading JetTagger LRJs / 0.02", 80, 0.4, 2.0);
    TH1F* back_h_leading_LRJ_DeltaRSubjets_WithGrEq2ConeSubjet = new TH1F("back_h_leading_LRJ_DeltaRSubjets_WithGrEq2ConeSubjet", "Leading LRJ Et Distribution; #Delta(R) [Lead., Subl. Cone Subjets];% of Leading JetTagger LRJs / 0.02", 80, 0.4, 2.0);

    TH1F* sig_h_leading_LRJ_DeltaRSubjets_WithGrEq2jFEXSubjet = new TH1F("sig_h_leading_LRJ_DeltaRSubjets_WithGrEq2jFEXSubjet", "Leading LRJ Et Distribution; #Delta(R) [Lead., Subl. jFEX Subjets] #times E_{T, lead.};% of Leading JetTagger LRJs / 0.02", 80, 0.4, 2.0);
    TH1F* back_h_leading_LRJ_DeltaRSubjets_WithGrEq2jFEXSubjet = new TH1F("back_h_leading_LRJ_DeltaRSubjets_WithGrEq2jFEXSubjet", "Leading LRJ Et Distribution; #Delta(R) [Lead., Subl. jFEX Subjets] #times E_{T, lead.};% of Leading JetTagger LRJs / 0.02", 80, 0.4, 2.0);

    TH2F *sigJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult = new TH2F("sigJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult", "Sum of Topo422 E_{T} in Each Bin; Cone Subjet Multiplcity [Lead. JetTagger LRJ]; Cone Subjet Multiplcity [Subl. JetTagger LRJ]", 
                        3, 0, 3, // x axis
                        3, 0, 3); //y axis

    TH2F *backJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult = new TH2F("backJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult", "Sum of Topo422 E_{T} in Each Bin; Cone Subjet Multiplcity [Lead. JetTagger LRJ]; Cone Subjet Multiplcity [Subl. JetTagger LRJ]", 
                        3, 0, 3, // x axis
                        3, 0, 3); //y axis

    TH2F *sigJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult_3 = new TH2F("sigJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult_3", "Sum of Topo422 E_{T} in Each Bin; Cone Subjet Multiplcity [Lead. JetTagger LRJ]; Cone Subjet Multiplcity [Subl. JetTagger LRJ]", 
                        4, 0, 4, // x axis
                        4, 0, 4); //y axis

    TH2F *backJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult_3 = new TH2F("backJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult_3", "Sum of Topo422 E_{T} in Each Bin; Cone Subjet Multiplcity [Lead. JetTagger LRJ]; Cone Subjet Multiplcity [Subl. JetTagger LRJ]", 
                        4, 0, 4, // x axis
                        4, 0, 4); //y axis

    TH2F *sigJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet = new TH2F("sigJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Delta(R) [Lead., Subl. Cone Subjets] #times E_{T, lead.}", 
                        52, 0, 1040,
                        103, 0, 2060); //y axis

    TH2F *backJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet = new TH2F("backJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Delta(R) [Lead., Subl. Cone Subjets] #times E_{T, lead.}", 
                        52, 0, 1040,
                        103, 0, 2060); //y axis

    TH2F *sigJetTaggerLeadingLRJEtvsMassApprox_SubjetEt_WithGrEq2ConeSubjet = new TH2F("sigJetTaggerLeadingLRJEtvsMassApprox_SubjetEt_WithGrEq2ConeSubjet", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Delta(R) [Lead., Subl. Cone Subjets] #times E_{T, subjets}", 
                        52, 0, 1040,
                        103, 0, 2060); //y axis

    TH2F *backJetTaggerLeadingLRJEtvsMassApprox_SubjetEt_WithGrEq2ConeSubjet = new TH2F("backJetTaggerLeadingLRJEtvsMassApprox_SubjetEt_WithGrEq2ConeSubjet", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Delta(R) [Lead., Subl. Cone Subjets] #times E_{T, subjets}", 
                        52, 0, 1040,
                        103, 0, 2060); //y axis

    TH2F *sigJetTaggerLeadingLRJEtvsDeltaRSubjets_WithGrEq2ConeSubjet = new TH2F("sigJetTaggerLeadingLRJEtvsDeltaRSubjets_WithGrEq2ConeSubjet", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Delta(R) [Lead., Subl. Cone Subjets]", 
                        52, 0, 1040,
                        80, 0.4, 2.0); //y axis

    TH2F *backJetTaggerLeadingLRJEtvsDeltaRSubjets_WithGrEq2ConeSubjet = new TH2F("backJetTaggerLeadingLRJEtvsDeltaRSubjets_WithGrEq2ConeSubjet", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Delta(R) [Lead., Subl. Cone Subjets]", 
                        52, 0, 1040,
                        80, 0.4, 2.0); //y axis

    TH2F *sigJetTaggerLeadingLRJEtvsZ_WithGrEq2ConeSubjet = new TH2F("sigJetTaggerLeadingLRJEtvsZ_WithGrEq2ConeSubjet", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; Lead Subjet E_{T} / Total E_{T}", 
                        52, 0, 1040,
                        25, 0, 1.0); //y axis

    TH2F *backJetTaggerLeadingLRJEtvsZ_WithGrEq2ConeSubjet = new TH2F("backJetTaggerLeadingLRJEtvsZ_WithGrEq2ConeSubjet", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; Lead Subjet E_{T} / Total E_{T}", 
                        52, 0, 1040,
                        25, 0, 1.0); //y axis

    TH2F *sigJetTaggerLeadingLRJEtvsd12_WithGrEq2ConeSubjet = new TH2F("sigJetTaggerLeadingLRJEtvsd12_WithGrEq2ConeSubjet", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; sqrt(d_{12})", 
                        52, 0, 1040,
                        103, 0, 2060); //y axis

    TH2F *backJetTaggerLeadingLRJEtvsd12_WithGrEq2ConeSubjet = new TH2F("backJetTaggerLeadingLRJEtvsd12_WithGrEq2ConeSubjet", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; sqrt(d_{12})", 
                        52, 0, 1040,
                        103, 0, 2060); //y axis
    
    /*TH2F *sigJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet = new TH2F("sigJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Delta(R) [Lead., Subl. Cone Subjets] #times E_{T, lead.}", 
                        52, 0, 1040, // x axis
                        103, 0, 2060); //y axis

    TH2F *backJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet = new TH2F("backJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Delta(R) [Lead., Subl. Cone Subjets] #times E_{T, lead.}", 
                        52, 0, 1040, // x axis
                        103, 0, 2060); //y axis*/
    
                        
    TH2F *sigJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2jFEXSubjet = new TH2F("sigJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2jFEXSubjet", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Delta(R) [Lead., Subl. jFEX Subjets] #times E_{T, lead.}", 
                        52, 0, 1040,
                        103, 0, 2060); //y axis

    TH2F *backJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2jFEXSubjet = new TH2F("backJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2jFEXSubjet", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Delta(R) [Lead., Subl. jFEX Subjets] #times E_{T, lead.}", 
                        52, 0, 1040,
                        103, 0, 2060); //y axis

    TH2F *sigJetTaggerLeadingLRJEtvsDeltaRSubjets_WithGrEq2jFEXSubjet = new TH2F("sigJetTaggerLeadingLRJEtvsDeltaRSubjets_WithGrEq2jFEXSubjet", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Delta(R) [Lead., Subl. jFEX Subjets]", 
                        52, 0, 1040,
                        80, 0.4, 2.0); //y axis

    TH2F *backJetTaggerLeadingLRJEtvsDeltaRSubjets_WithGrEq2jFEXSubjet = new TH2F("backJetTaggerLeadingLRJEtvsDeltaRSubjets_WithGrEq2jFEXSubjet", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Delta(R) [Lead., Subl. jFEX Subjets]", 
                        52, 0, 1040,
                        80, 0.4, 2.0); //y axis

    // with deltaR^2 Metric
    TH2F *sigJetTaggerLeadingLRJEtvsPsi_R2 = new TH2F("sigJetTaggerLeadingLRJEtvsPsi_R2", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R^{2}}", 
                        52, 0, 1040, // x axis
                        20, 0, 1 ); //y axis
    TH2F *sigJetTaggerLeadingLRJPsi_R2vsSubleadingPsi_R2 = new TH2F("sigJetTaggerLeadingLRJPsi_R2vsSubleadingPsi_R2", "Sum of Topo422 E_{T} in Each Bin; #Psi_{R^{2}} [Subleading Jet]; #Psi_{R^{2}} [Leading Jet]", 
                        35, 0, 0.7, // x axis
                        35, 0, 0.7); //y axis
    TH2F *backJetTaggerLeadingLRJEtvsPsi_R2 = new TH2F("backJetTaggerLeadingLRJEtvsPsi_R2", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R^{2}}", 
                        52, 0, 1040, // x axis
                        20, 0, 1 ); //y axis
    TH2F *backJetTaggerLeadingLRJPsi_R2vsSubleadingPsi_R2 = new TH2F("backJetTaggerLeadingLRJPsi_R2vsSubleadingPsi_R2", "Sum of Topo422 E_{T} in Each Bin; #Psi_{R^{2}} [Subleading Jet]; #Psi_{R^{2}} [Leading Jet]", 
                        35, 0, 0.7, // x axis
                        35, 0, 0.7); //y axis

    TH2F *sigJetTaggerSubleadingLRJEtvsPsi_R2 = new TH2F("sigJetTaggerSubleadingLRJEtvsPsi_R2", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; #Psi_{R^{2}}", 
                        52, 0, 1040, // x axis
                        20, 0, 1 ); //y axis
    TH2F *backJetTaggerSubleadingLRJEtvsPsi_R2 = new TH2F("backJetTaggerSubleadingLRJEtvsPsi_R2", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; #Psi_{R^{2}}", 
                        52, 0, 1040, // x axis
                        20, 0, 1 ); //y axis
    
    TH2F *sigJetTaggerLeadingLRJEtvsPsi_R2_squared = new TH2F("sigJetTaggerLeadingLRJEtvsPsi_R2_squared", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R^{2}, Leading} #times #Psi_{R^{2}, Subleading}", 
                        52, 0, 1040, // x axis
                        50, 0, 1.0); //y axis
    TH2F *backJetTaggerLeadingLRJEtvsPsi_R2_squared = new TH2F("backJetTaggerLeadingLRJEtvsPsi_R2_squared", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R^{2}, Leading} #times #Psi_{R^{2}, Subleading}", 
                        52, 0, 1040, // x axis
                        50, 0, 1.0); //y axis                    
    TH2F *sigJetTaggerSubleadingLRJEtvsPsi_R2_squared = new TH2F("sigJetTaggerSubleadingLRJEtvsPsi_R2_squared", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; #Psi_{R^{2}, Leading} #times #Psi_{R^{2}, Subleading}", 
                        52, 0, 1040, // x axis
                        50, 0, 1.0); //y axis
    TH2F *backJetTaggerSubleadingLRJEtvsPsi_R2_squared = new TH2F("backJetTaggerSubleadingLRJEtvsPsi_R2_squared", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; #Psi_{R^{2}, Leading} #times #Psi_{R^{2}, Subleading}", 
                        52, 0, 1040, // x axis
                        50, 0, 1.0); //y axis
    TH2F *sigJetTaggerLeadingLRJEtvsPsi_12 = new TH2F("sigJetTaggerLeadingLRJEtvsPsi_12", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #frac{#Psi_{R, Leading}}{#Psi_{R, Subleading}}", 
                        52, 0, 1040, // x axis
                        40, 0, 4); //y axis
    TH2F *backJetTaggerLeadingLRJEtvsPsi_12 = new TH2F("backJetTaggerLeadingLRJEtvsPsi_12", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #frac{#Psi_{R, Leading}}{#Psi_{R, Subleading}}", 
                        52, 0, 1040, // x axis
                        40, 0, 4); //y axis

    TH2F *sigJetTaggerSubleadingLRJEtvsPsi_12 = new TH2F("sigJetTaggerSubleadingLRJEtvsPsi_12", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; #frac{#Psi_{R, Leading}}{#Psi_{R, Subleading}}", 
                        52, 0, 1040, // x axis
                        40, 0, 4); //y axis
    TH2F *backJetTaggerSubleadingLRJEtvsPsi_12 = new TH2F("backJetTaggerSubleadingLRJEtvsPsi_12", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; #frac{#Psi_{R, Leading}}{#Psi_{R, Subleading}}", 
                        52, 0, 1040, // x axis
                        40, 0, 4); //y axis

    TH2F *sigJetTaggerLeadingLRJEtvsPsi_R2_12 = new TH2F("sigJetTaggerLeadingLRJEtvsPsi_R2_12", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #frac{#Psi_{R^{2}, Leading}}{#Psi_{R^{2}, Subleading}}", 
                        52, 0, 1040, // x axis
                        40, 0, 4); //y axis
    TH2F *backJetTaggerLeadingLRJEtvsPsi_R2_12 = new TH2F("backJetTaggerLeadingLRJEtvsPsi_R2_12", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #frac{#Psi_{R^{2}, Leading}}{#Psi_{R^{2}, Subleading}}", 
                        52, 0, 1040, // x axis
                        40, 0, 4); //y axis
    TH2F *sigJetTaggerSubleadingLRJEtvsPsi_R2_12 = new TH2F("sigJetTaggerSubleadingLRJEtvsPsi_R2_12", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; #frac{#Psi_{R^{2}, Leading}}{#Psi_{R^{2}, Subleading}}", 
                        52, 0, 1040, // x axis
                        40, 0, 4); //y axis
    TH2F *backJetTaggerSubleadingLRJEtvsPsi_R2_12 = new TH2F("backJetTaggerSubleadingLRJEtvsPsi_R2_12", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; #frac{#Psi_{R^{2}, Leading}}{#Psi_{R^{2}, Subleading}}", 
                        52, 0, 1040, // x axis
                        40, 0, 4); //y axis

    // For new selec
    TH1F* sig_h_leading_LRJ_Et_Category0 = new TH1F("sig_h_leading_LRJ_Et_Category0", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [0 Cone Subjets Lead or Subl];% of Leading LRJs / 10 GeV", 104, 0, 1040);
    TH1F* back_h_leading_LRJ_Et_Category0 = new TH1F("back_h_leading_LRJ_Et_Category0", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [0 Cone Subjets Lead or Subl];% of Leading LRJs / 10 GeV", 104, 0, 1040);

    TH1F* sig_h_leading_LRJ_Et_Category1 = new TH1F("sig_h_leading_LRJ_Et_Category1", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [1 Subjet Lead & Subl];% of Leading LRJs / 10 GeV", 104, 0, 1040);
    TH1F* back_h_leading_LRJ_Et_Category1 = new TH1F("back_h_leading_LRJ_Et_Category1", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [1 Subjet Lead & Subl];% of Leading LRJs / 10 GeV", 104, 0, 1040);

    TH1F* sig_h_leading_LRJ_Et_Category2 = new TH1F("sig_h_leading_LRJ_Et_Category2", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [2 Subl, <= 1 Lead];% of Leading LRJs / 10 GeV", 104, 0, 1040);
    TH1F* back_h_leading_LRJ_Et_Category2 = new TH1F("back_h_leading_LRJ_Et_Category2", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [2 Subl, <= 1 Lead];% of Leading LRJs / 10 GeV", 104, 0, 1040);

    TH1F* sig_h_leading_LRJ_Et_Category3 = new TH1F("sig_h_leading_LRJ_Et_Category3", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [2 Lead, <= 1 Subl];% of Leading LRJs / 10 GeV", 104, 0, 1040);
    TH1F* back_h_leading_LRJ_Et_Category3 = new TH1F("back_h_leading_LRJ_Et_Category3", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [2 Lead, <= 1 Subl];% of Leading LRJs / 10 GeV", 104, 0, 1040);

    TH1F* sig_h_leading_LRJ_Et_Category4 = new TH1F("sig_h_leading_LRJ_Et_Category4", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [2 Lead, 2 Sublead];% of Leading LRJs / 10 GeV", 104, 0, 1040);
    TH1F* back_h_leading_LRJ_Et_Category4 = new TH1F("back_h_leading_LRJ_Et_Category4", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [2 Lead, 2 Sublead];% of Leading LRJs / 10 GeV", 104, 0, 1040);

    TH1F* sig_h_leading_LRJ_Et_Category5 = new TH1F("sig_h_leading_LRJ_Et_Category5", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [3 Subl, <= 2 Lead];% of Leading LRJs / 10 GeV", 104, 0, 1040);
    TH1F* back_h_leading_LRJ_Et_Category5 = new TH1F("back_h_leading_LRJ_Et_Category5", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [3 Subl, <= 2 Lead];% of Leading LRJs / 10 GeV", 104, 0, 1040);

    TH1F* sig_h_leading_LRJ_Et_Category6 = new TH1F("sig_h_leading_LRJ_Et_Category6", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [3 Lead, <= 2 Subl];% of Leading LRJs / 10 GeV", 104, 0, 1040);
    TH1F* back_h_leading_LRJ_Et_Category6 = new TH1F("back_h_leading_LRJ_Et_Category6", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [3 Lead, <= 2 Subl];% of Leading LRJs / 10 GeV", 104, 0, 1040);

    TH1F* sig_h_leading_LRJ_Et_Category7 = new TH1F("sig_h_leading_LRJ_Et_Category7", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [3 Lead, 3 Subl];% of Leading LRJs / 10 GeV", 104, 0, 1040);
    TH1F* back_h_leading_LRJ_Et_Category7 = new TH1F("back_h_leading_LRJ_Et_Category7", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [3 Lead, 3 Subl];% of Leading LRJs / 10 GeV", 104, 0, 1040);

    // For new selection sbased on 3x3 matrix of # of subjet selections. 
    TH1F* sig_h_leading_LRJ_Et_NoConeSubjets_Lead_or_1ConeJetLead = new TH1F("sig_h_leading_LRJ_Et_NoConeSubjets_Lead_or_1ConeJetLead", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [No Cone Subjets];% of Leading LRJs / 10 GeV", 104, 0, 1040);
    TH1F* back_h_leading_LRJ_Et_NoConeSubjets_Lead_or_1ConeJetLead = new TH1F("back_h_leading_LRJ_Et_NoConeSubjets_Lead_or_1ConeJetLead", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [No Cone Subjets];% of Leading LRJs / 10 GeV", 104, 0, 1040);

    TH1F* sig_h_subleading_LRJ_Et_1ConeSubjet_Lead_or_1ConeJetLead_Sublead = new TH1F("sig_h_subleading_LRJ_Et_1ConeSubjet_Lead_or_1ConeJetLead_Sublead", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [No Cone Subjets];% of Leading LRJs / 10 GeV", 104, 0, 1040);
    TH1F* back_h_subleading_LRJ_Et_1ConeSubjet_Lead_or_1ConeJetLead_Sublead = new TH1F("back_h_subleading_LRJ_Et_1ConeSubjet_Lead_or_1ConeJetLead_Sublead", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [No Cone Subjets];% of Leading LRJs / 10 GeV", 104, 0, 1040);

    TH1F* sig_h_leading_LRJ_Et_WithGrEq2ConeSubjet_Lead  = new TH1F("sig_h_leading_LRJ_Et_WithGrEq2ConeSubjet_Lead", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [>= 2 Cone Subjets];% of Leading LRJs / 10 GeV", 104, 0, 1040);
    TH1F* back_h_leading_LRJ_Et_WithGrEq2ConeSubjet_Lead = new TH1F("back_h_leading_LRJ_Et_WithGrEq2ConeSubjet_Lead", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [>= 2 Cone Subjets];% of Leading LRJs / 10 GeV", 104, 0, 1040);

    TH1F* sig_h_leading_LRJ_Et_WithGrEq2ConeSubjet_Sublead = new TH1F("sig_h_leading_LRJ_Et_WithGrEq2ConeSubjet_Sublead", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [>= 2 Cone Subjets];% of Leading LRJs / 10 GeV", 104, 0, 1040);
    TH1F* back_h_leading_LRJ_Et_WithGrEq2ConeSubjet_Sublead = new TH1F("back_h_leading_LRJ_Et_WithGrEq2ConeSubjet_Sublead", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [>= 2 Cone Subjets];% of Leading LRJs / 10 GeV", 104, 0, 1040);

    TH1F* sig_h_subleading_LRJ_Et_WithGrEq2ConeSubjet_Lead_Sublead = new TH1F("sig_h_subleading_LRJ_Et_WithGrEq2ConeSubjet_Lead_Sublead", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [>= 2 Cone Subjets];% of Leading LRJs / 10 GeV", 104, 0, 1040);
    TH1F* back_h_subleading_LRJ_Et_WithGrEq2ConeSubjet_Lead_Sublead = new TH1F("back_h_subleading_LRJ_Et_WithGrEq2ConeSubjet_Lead_Sublead", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [>= 2 Cone Subjets];% of Leading LRJs / 10 GeV", 104, 0, 1040);

    /*TH1F* sig_h_leading_LRJ_Et_With1ConeSubjet_Lead= new TH1F("sig_h_leading_LRJ_Et_With1ConeSubjet_Lead", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [>= 2 jFEX Subjets];% of Leading LRJs / 20 GeV", 52, 0, 1040);
    TH1F* back_h_leading_LRJ_Et_With1ConeSubjet_Lead= new TH1F("back_h_leading_LRJ_Et_With1ConeSubjet_Lead", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [>= 2 jFEX Subjets];% of Leading LRJs / 20 GeV", 52, 0, 1040);

    TH1F* sig_h_leading_LRJ_Et_With1ConeSubjet_Sublead= new TH1F("sig_h_leading_LRJ_Et_With1ConeSubjet_Sublead", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [>= 2 jFEX Subjets];% of Leading LRJs / 20 GeV", 52, 0, 1040);
    TH1F* back_h_leading_LRJ_Et_With1ConeSubjet_Sublead= new TH1F("back_h_leading_LRJ_Et_With1ConeSubjet_Sublead", "Leading LRJ Et Distribution;JetTagger Lead. LRJ E_{T} [>= 2 jFEX Subjets];% of Leading LRJs / 20 GeV", 52, 0, 1040);*/

    /*TH2F *sigJetTaggerSubleadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Lead_Sublead = new TH2F("sigJetTaggerSubleadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Lead_Sublead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; #Delta(R) [Lead., Subl. Cone Subjets] #times E_{T, Subl.}", 
                        52, 0, 1040,
                        103, 0, 2060); //y axis

    TH2F *backJetTaggerSubleadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Lead_Sublead = new TH2F("backJetTaggerSubleadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Lead_Sublead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; #Delta(R) [Lead., Subl. Cone Subjets] #times E_{T, Subl.}", 
                        52, 0, 1040,
                        103, 0, 2060); //y axis*/

    TH2F *sigJetTaggerLeadingLRJMassApproxvsSubjetEtRatio_WithGrEq2ConeSubjet_Lead = new TH2F("sigJetTaggerLeadingLRJMassApproxvsSubjetEtRatio_WithGrEq2ConeSubjet_Lead", "Sum of Topo422 E_{T} in Each Bin; #Delta(R) [Lead., Subl. Cone Subjets] #times E_{T,}; Subjet E_{T} Ratio", 
                        30, 0, 300,
                        25, 0, 25); //y axis

    TH2F *backJetTaggerLeadingLRJMassApproxvsSubjetEtRatio_WithGrEq2ConeSubjet_Lead = new TH2F("backJetTaggerLeadingLRJMassApproxvsSubjetEtRatio_WithGrEq2ConeSubjet_Lead", "Sum of Topo422 E_{T} in Each Bin; #Delta(R) [Lead., Subl. Cone Subjets] #times E_{T}; Subjet E_{T} Ratio", 
                        30, 0, 300,
                        25, 0, 25); //y axis

    TH2F *sigJetTaggerLeadingLRJEtvsSubjetEtRatio_WithGrEq2ConeSubjet_Lead = new TH2F("sigJetTaggerLeadingLRJEtApproxvsSubjetEtRatio_WithGrEq2ConeSubjet_Lead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; Subjet E_{T} Ratio", 
                        35, 0, 700,
                        25, 0, 25); //y axis

    TH2F *backJetTaggerLeadingLRJEtvsSubjetEtRatio_WithGrEq2ConeSubjet_Lead = new TH2F("backJetTaggerLeadingLRJEtApproxvsSubjetEtRatio_WithGrEq2ConeSubjet_Lead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; Subjet E_{T} Ratio", 
                        35, 0, 700,
                        25, 0, 25); //y axis

    TH2F *sigJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Lead = new TH2F("sigJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Lead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; #Delta(R) [Lead., Subl. Cone Subjets] #times E_{T, Subl.}", 
                        52, 0, 1040,
                        103, 0, 2060); //y axis

    TH2F *backJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Lead = new TH2F("backJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Lead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; #Delta(R) [Lead., Subl. Cone Subjets] #times E_{T, Subl.}", 
                        52, 0, 1040,
                        103, 0, 2060); //y axis

    TH2F *sigJetTaggerLeadingLRJEtvsd12_WithGrEq2ConeSubjet_Lead = new TH2F("sigJetTaggerLeadingLRJEtvsd12_WithGrEq2ConeSubjet_Lead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; sqrt(d_{12})", 
                        52, 0, 1040,
                        103, 0, 2060); //y axis

    TH2F *backJetTaggerLeadingLRJEtvsd12_WithGrEq2ConeSubjet_Lead = new TH2F("backJetTaggerLeadingLRJEtvsd12_WithGrEq2ConeSubjet_Lead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; sqrt(d_{12})", 
                        52, 0, 1040,
                        103, 0, 2060); //y axis

    TH2F *sigJetTaggerLeadingSubjetEtvsSubleadingSubjetEt_Lead = new TH2F("sigJetTaggerLeadingSubjetEtvsSubleadingSubjetEt_Lead", "Sum of Topo422 E_{T} in Each Bin; Leading Subjet LRJ E_{T} [GeV]; Subleading Subjet LRJ E_{T} [GeV]", 
                        40, 0, 400,
                        40, 0, 400); //y axis

    TH2F *backJetTaggerLeadingSubjetEtvsSubleadingSubjetEt_Lead = new TH2F("backJetTaggerLeadingSubjetEtvsSubleadingSubjetEt_Lead", "Sum of Topo422 E_{T} in Each Bin; Leading Subjet LRJ E_{T} [GeV]; Subleading Subjet LRJ E_{T} [GeV]", 
                        40, 0, 400,
                        40, 0, 400); //y axis

    TH2F *sigJetTaggerLeadingLRJMassApproxvsSubjetEtRatio_WithGrEq2ConeSubjet_Sublead = new TH2F("sigJetTaggerLeadingLRJMassApproxvsSubjetEtRatio_WithGrEq2ConeSubjet_Sublead", "Sum of Topo422 E_{T} in Each Bin; #Delta(R) [Lead., Subl. Cone Subjets] #times E_{T}; Subjet E_{T} Ratio", 
                        30, 0, 300,
                        25, 0, 25); //y axis

    TH2F *backJetTaggerLeadingLRJMassApproxvsSubjetEtRatio_WithGrEq2ConeSubjet_Sublead = new TH2F("backJetTaggerLeadingLRJMassApproxvsSubjetEtRatio_WithGrEq2ConeSubjet_Sublead", "Sum of Topo422 E_{T} in Each Bin; #Delta(R) [Lead., Subl. Cone Subjets] #times E_{T}; Subjet E_{T} Ratio", 
                        30, 0, 300,
                        25, 0, 25); //y axis

    TH2F *sigJetTaggerLeadingLRJEtvsSubjetEtRatio_WithGrEq2ConeSubjet_Sublead = new TH2F("sigJetTaggerLeadingLRJEtvsSubjetEtRatio_WithGrEq2ConeSubjet_Sublead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; Subjet E_{T} Ratio", 
                        35, 0, 700,
                        25, 0, 25); //y axis

    TH2F *backJetTaggerLeadingLRJEtvsSubjetEtRatio_WithGrEq2ConeSubjet_Sublead = new TH2F("backJetTaggerLeadingLRJEtvsSubjetEtRatio_WithGrEq2ConeSubjet_Sublead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; Subjet E_{T} Ratio", 
                        35, 0, 700,
                        25, 0, 25); //y axis

    TH2F *sigJetTaggerLeadingSubjetEtvsSubleadingSubjetEt_Sublead = new TH2F("sigJetTaggerLeadingSubjetEtvsSubleadingSubjetEt_Sublead", "Sum of Topo422 E_{T} in Each Bin; Leading Subjet LRJ E_{T} [GeV]; Subleading Subjet LRJ E_{T} [GeV]", 
                        40, 0, 400,
                        40, 0, 400); //y axis

    TH2F *backJetTaggerLeadingSubjetEtvsSubleadingSubjetEt_Sublead = new TH2F("backJetTaggerLeadingSubjetEtvsSubleadingSubjetEt_Sublead", "Sum of Topo422 E_{T} in Each Bin; Leading Subjet LRJ E_{T} [GeV]; Subleading Subjet LRJ E_{T} [GeV]", 
                        40, 0, 400,
                        40, 0, 400); //y axis

    TH2F *sigJetTaggerSubleadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Sublead = new TH2F("sigJetTaggerSubleadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Sublead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; #Delta(R) [Lead., Subl. Cone Subjets] #times E_{T, Subl.}", 
                        52, 0, 1040,
                        103, 0, 2060); //y axis

    TH2F *backJetTaggerSubleadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Sublead = new TH2F("backJetTaggerSubleadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Sublead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; #Delta(R) [Lead., Subl. Cone Subjets] #times E_{T, Subl.}", 
                        52, 0, 1040,
                        103, 0, 2060); //y axis // probably won't use MassApprox for now.... deltaR is better!  FIXME use variable binning for this. would reduce combinatorics greatly, don't need such fine bins for high mass

    TH2F *sigJetTaggerSubleadingLRJEtvsd12_WithGrEq2ConeSubjet_Sublead = new TH2F("sigJetTaggerSubleadingLRJEtvsd12_WithGrEq2ConeSubjet_Sublead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; sqrt(d_{12})", 
                        52, 0, 1040,
                        103, 0, 2060); //y axis

    TH2F *backJetTaggerSubleadingLRJEtvsd12_WithGrEq2ConeSubjet_Sublead = new TH2F("backJetTaggerSubleadingLRJEtvsd12_WithGrEq2ConeSubjet_Sublead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; sqrt(d_{12})", 
                        52, 0, 1040,
                        103, 0, 2060); //y axis // probably won't use MassApprox for now.... deltaR is better!  FIXME use variable binning for this. would reduce combinatorics greatly, don't need such fine bins for high mass

    TH2F *sigJetTaggerSubleadingLRJEtvsTau21_WithGrEq2ConeSubjet_Sublead = new TH2F("sigJetTaggerSubleadingLRJEtvsTau21_WithGrEq2ConeSubjet_Sublead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; #tau_{2} / #tau_{1} [Subleading JetTagger LRJ]", 
                        52, 0, 1040,
                        50, 0, 1); //y axis

    TH2F *backJetTaggerSubleadingLRJEtvsTau21_WithGrEq2ConeSubjet_Sublead = new TH2F("backJetTaggerSubleadingLRJEtvsTau21_WithGrEq2ConeSubjet_Sublead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; #tau_{2} / #tau_{1} [Subleading JetTagger LRJ]", 
                        52, 0, 1040,
                        50, 0, 1); //y axis 

    TH2F *sigJetTaggerLeadingLRJEtvsTau21_WithGrEq2ConeSubjet_Lead = new TH2F("sigJetTaggerLeadingLRJEtvsTau21_WithGrEq2ConeSubjet_Lead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #tau_{2} / #tau_{1} [Leading JetTagger LRJ]", 
                        52, 0, 1040,
                        50, 0, 1); //y axis

    TH2F *backJetTaggerLeadingLRJEtvsTau21_WithGrEq2ConeSubjet_Lead = new TH2F("backJetTaggerLeadingLRJEtvsTau21_WithGrEq2ConeSubjet_Lead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #tau_{2} / #tau_{1} [Leading JetTagger LRJ]", 
                        52, 0, 1040,
                        50, 0, 1); //y axis 

    TH2F *sigJetTaggerLeadingLRJEtvsTau21_WithGrEq2ConeSubjet_Lead_Sublead = new TH2F("sigJetTaggerLeadingLRJEtvsTau21_WithGrEq2ConeSubjet_Lead_Sublead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #tau_{2} / #tau_{1} Product [JetTagger LRJs]", 
                        52, 0, 1040,
                        50, 0, 1); //y axis

    TH2F *backJetTaggerLeadingLRJEtvsTau21_WithGrEq2ConeSubjet_Lead_Sublead = new TH2F("backJetTaggerLeadingLRJEtvsTau21_WithGrEq2ConeSubjet_Lead_Sublead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #tau_{2} / #tau_{1} Product [JetTagger LRJs]", 
                        52, 0, 1040,
                        50, 0, 1); //y axis 

    TH2F *sigJetTaggerSubleadingMassApproxvsTau21_WithGrEq2ConeSubjet_Sublead = new TH2F("sigJetTaggerSubleadingMassApproxvsTau21_WithGrEq2ConeSubjet_Sublead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ Mass Approx [GeV]; #tau_{2} / #tau_{1} [Subleading JetTagger LRJ]", 
                        103, 0, 2060,
                        50, 0, 1); //y axis

    TH2F *backJetTaggerSubleadingMassApproxvsTau21_WithGrEq2ConeSubjet_Sublead = new TH2F("backJetTaggerSubleadingMassApproxvsTau21_WithGrEq2ConeSubjet_Sublead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ Mass Approx [GeV]; #tau_{2} / #tau_{1} [Subleading JetTagger LRJ]", 
                        103, 0, 2060,
                        50, 0, 1); //y axis 

    TH2F *sigJetTaggerLeadingMassApproxvsTau21_WithGrEq2ConeSubjet_Lead = new TH2F("sigJetTaggerLeadingMassApproxvsTau21_WithGrEq2ConeSubjet_Lead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ Mass Approx [GeV]; #tau_{2} / #tau_{1} [Leading JetTagger LRJ]", 
                        103, 0, 2060,
                        50, 0, 1); //y axis

    TH2F *backJetTaggerLeadingMassApproxvsTau21_WithGrEq2ConeSubjet_Lead = new TH2F("backJetTaggerLeadingMassApproxvsTau21_WithGrEq2ConeSubjet_Lead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ Mass Approx [GeV]; #tau_{2} / #tau_{1} [Leading JetTagger LRJ]", 
                        103, 0, 2060,
                        50, 0, 1); //y axis 

    TH2F *sigJetTaggerLeadingMassApproxvsTau21Product_WithGrEq2ConeSubjet_Lead_Sublead = new TH2F("sigJetTaggerLeadingMassApproxvsTau21Product_WithGrEq2ConeSubjet_Lead_Sublead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ Mass Approx [GeV]; #tau_{2} / #tau_{1} Product [JetTagger LRJs]", 
                        103, 0, 2060,
                        50, 0, 1); //y axis

    TH2F *backJetTaggerLeadingMassApproxvsTau21Product_WithGrEq2ConeSubjet_Lead_Sublead = new TH2F("backJetTaggerLeadingMassApproxvsTau21Product_WithGrEq2ConeSubjet_Lead_Sublead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ Mass Approx [GeV]; #tau_{2} / #tau_{1} Product [JetTagger LRJs]", 
                        103, 0, 2060,
                        50, 0, 1); //y axis 

    TH2F *sigJetTaggerSubleadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet_Sublead = new TH2F("sigJetTaggerSubleadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet_Sublead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; #Psi_{R, lead} #times #Psi_{R, subl}", 
                        52, 0, 1040,
                        25, 0, 1.0); //y axis

    TH2F *backJetTaggerSubleadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet_Sublead = new TH2F("backJetTaggerSubleadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet_Sublead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; #Psi_{R, lead} #times #Psi_{R, subl}", 
                        52, 0, 1040,
                        25, 0, 1.0); //y axis // probably won't use MassApprox for now.... deltaR is better! 

    TH2F *sigJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet_Sublead = new TH2F("sigJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet_Sublead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R, lead} #times #Psi_{R, subl}", 
                        52, 0, 1040,
                        25, 0, 1.0); //y axis

    TH2F *backJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet_Sublead = new TH2F("backJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet_Sublead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R, lead} #times #Psi_{R, subl}", 
                        52, 0, 1040,
                        25, 0, 1.0); //y axis // probably won't use MassApprox for now.... deltaR is better! 

    TH3F *sigJetTaggerSubleadingLRJEtvsDeltaRSubjets_WithGrEq2ConeSubjet_Lead_Sublead = new TH3F("sigJetTaggerSubleadingLRJEtvsDeltaRSubjets_WithGrEq2ConeSubjet_Lead_Sublead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; #Delta(R) [Lead., Subl. Cone Subjets]", 
                        52, 0, 1040,
                        80, 0.4, 2.0,
                        80, 0.4, 2.0); //z axis // FIXME this should be a TH3F with mass, mass, E_T

    TH3F *backJetTaggerSubleadingLRJEtvsDeltaRSubjets_WithGrEq2ConeSubjet_Lead_Sublead = new TH3F("backJetTaggerSubleadingLRJEtvsDeltaRSubjets_WithGrEq2ConeSubjet_Lead_Sublead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; #Delta(R) [Lead., Subl. Cone Subjets]", 
                        52, 0, 1040,
                        80, 0.4, 2.0,
                        80, 0.4, 2.0); //z axis

    TH3F *sigJetTaggerSubleadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Lead_Sublead = new TH3F("sigJetTaggerSubleadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Lead_Sublead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; #Delta(R) #times E_{T, subl.}  [Lead., Subl. Cone Subjets]", 
                        52, 0, 1040,
                        103, 0, 2060,
                        103, 0, 2060); //z axis // FIXME this should be a TH3F with mass, mass, E_T

    TH3F *backJetTaggerSubleadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Lead_Sublead = new TH3F("backJetTaggerSubleadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Lead_Sublead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; #Delta(R) #times E_{T, subl.} [Lead., Subl. Cone Subjets]", 
                        52, 0, 1040,
                        103, 0, 2060,
                        103, 0, 2060); //z axis

    TH3F *sigJetTaggerSubleadingLRJEtvsd12_WithGrEq2ConeSubjet_Lead_Sublead = new TH3F("sigJetTaggerSubleadingLRJEtvsd12_WithGrEq2ConeSubjet_Lead_Sublead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; sqrt(d_{12}); sqrt(d_{12})", 
                        52, 0, 1040,
                        103, 0, 2060,
                        103, 0, 2060); //z axis // FIXME this should be a TH3F with mass, mass, E_T

    TH3F *backJetTaggerSubleadingLRJEtvsd12_WithGrEq2ConeSubjet_Lead_Sublead = new TH3F("backJetTaggerSubleadingLRJEtvsd12_WithGrEq2ConeSubjet_Lead_Sublead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; sqrt(d_{12}); sqrt(d_{12})", 
                        52, 0, 1040,
                        103, 0, 2060,
                        103, 0, 2060); //z axis

    /*TH3F *sigJetTaggerSubleadingLRJEtvsDeltaRSubjets_WithGrEq2ConeSubjet_Lead_Sublead = new TH3F("sigJetTaggerSubleadingLRJEtvsDeltaRSubjets_WithGrEq2ConeSubjet_Lead_Sublead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; #Delta(R) [Lead., Subl. Cone Subjets]", 
                        52, 0, 1040,
                        80, 0.4, 2.0,
                        80, 0.4, 2.0); //z axis // FIXME this should be a TH3F with mass, mass, E_T

    TH3F *backJetTaggerSubleadingLRJEtvsDeltaRSubjets_WithGrEq2ConeSubjet_Lead_Sublead = new TH3F("backJetTaggerSubleadingLRJEtvsDeltaRSubjets_WithGrEq2ConeSubjet_Lead_Sublead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; #Delta(R) [Lead., Subl. Cone Subjets]", 
                        52, 0, 1040,
                        80, 0.4, 2.0,
                        80, 0.4, 2.0); //z axis*/

    /*TH2F *sigJetTaggerSubleadingLRJEtvsDeltaRSubjets_WithGrEq2ConeSubjet_Lead_1ConeJetSublead = new TH2F("sigJetTaggerSubleadingLRJEtvsDeltaRSubjets_WithGrEq2ConeSubjet_Lead_1ConeJetSublead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; #Delta(R) [Lead., Subl. Cone Subjets]", 
                        52, 0, 1040,
                        80, 0.4, 2.0); //y axis

    TH2F *backJetTaggerSubleadingLRJEtvsDeltaRSubjets_WithGrEq2ConeSubjet_Lead_1ConeJetSublead = new TH2F("backJetTaggerSubleadingLRJEtvsDeltaRSubjets_WithGrEq2ConeSubjet_Lead_1ConeJetSublead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; #Delta(R) [Lead., Subl. Cone Subjets]", 
                        52, 0, 1040,
                        80, 0.4, 2.0); //y axis

    TH2F *sigJetTaggerSubleadingLRJEtvsDeltaRSubjets_WithGrEq2ConeSubjet_Sublead_1ConeJetLead = new TH2F("sigJetTaggerSubleadingLRJEtvsDeltaRSubjets_WithGrEq2ConeSubjet_Sublead_1ConeJetLead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; #Delta(R) [Lead., Subl. Cone Subjets]", 
                        52, 0, 1040,
                        80, 0.4, 2.0); //y axis

    TH2F *backJetTaggerSubleadingLRJEtvsDeltaRSubjets_WithGrEq2ConeSubjet_Sublead_1ConeJetLead = new TH2F("backJetTaggerSubleadingLRJEtvsDeltaRSubjets_WithGrEq2ConeSubjet_Sublead_1ConeJetLead", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; #Delta(R) [Lead., Subl. Cone Subjets]", 
                        52, 0, 1040,
                        80, 0.4, 2.0); //y axis*/ // PROBBALY WONT USE DELTAR SUBEJTS FOR NOW!

    // New psi_R values - cut off after few highest E_T values have contributed. targetting jets which have 2 high energy distributions within opposite sides of cone in eta-phi plane. This would ideally take advantage of separation bewteen two highest E_T towers,
    // meant to bring back signal vs. background separation by cutting on this when using towers as input
    TH1F* sig_h_leading_LRJ_psi_R_VariableIOs_2 = new TH1F("sig_h_leading_LRJ_psi_R_VariableIOs_2", "Leading LRJ Et Distribution;#Psi_{R, Leading} [2 IOs Only];% of Leading LRJs / 0.05", 20, 0, 1);
    TH1F* sig_h_subleading_LRJ_psi_R_VariableIOs_2 = new TH1F("sig_h_subleading_LRJ_psi_R_VariableIOs_2", "Leading LRJ Et Distribution;#Psi_{R, Subleading} [2 IOs Only];% of Leading LRJs / 0.05", 20, 0, 1);
    TH1F* sig_h_LRJ_psi_R_squared_VariableIOs_2 = new TH1F("sig_h_LRJ_psi_R_squared_VariableIOs_2", "Leading LRJ Et Distribution;#Psi_{R, Leading} #times #Psi_{R, Subleading} [2 IOs Only];% of Events / 0.02", 35, 0, 0.7);     
    
    TH2F *sigJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_2 = new TH2F("sigJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_2", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R, Leading} #times #Psi_{R, Subleading}", 
                        52, 0, 1040, // x axis
                        35, 0, 0.7); //y axis
    TH2F *backJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_2 = new TH2F("backJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_2", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R, Leading} #times #Psi_{R, Subleading}", 
                        52, 0, 1040, // x axis
                        35, 0, 0.7); //y axis

    TH2F *sigJetTaggerSubleadingLRJEtvsPsi_R_VariableIOs_2 = new TH2F("sigJetTaggerSubleadingLRJEtvsPsi_R_VariableIOs_2", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; #Psi_{R, Leading} #times #Psi_{R, Subleading}", 
                        52, 0, 1040, // x axis
                        35, 0, 0.7); //y axis
    TH2F *backJetTaggerSubleadingLRJEtvsPsi_R_VariableIOs_2 = new TH2F("backJetTaggerSubleadingLRJEtvsPsi_R_VariableIOs_2", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; #Psi_{R, Leading} #times #Psi_{R, Subleading}", 
                        52, 0, 1040, // x axis
                        35, 0, 0.7); //y axis

    TH1F* back_h_leading_LRJ_psi_R_VariableIOs_2 = new TH1F("back_h_leading_LRJ_psi_R_VariableIOs_2", "Leading LRJ Et Distribution;#Psi_{R, Leading} [2 IOs Only];% of Leading LRJs / 0.05", 20, 0, 1);
    TH1F* back_h_subleading_LRJ_psi_R_VariableIOs_2 = new TH1F("back_h_subleading_LRJ_psi_R_VariableIOs_2", "Leading LRJ Et Distribution;#Psi_{R, Subleading} [2 IOs Only];% of Leading LRJs / 0.05", 20, 0, 1);
    TH1F* back_h_LRJ_psi_R_squared_VariableIOs_2 = new TH1F("back_h_LRJ_psi_R_squared_VariableIOs_2", "Leading LRJ Et Distribution;#Psi_{R, Leading} #times #Psi_{R, Subleading} [2 IOs Only];% of Events / 0.02", 35, 0, 0.7);

    TH1F* sig_h_leading_LRJ_psi_R_VariableIOs_3 = new TH1F("sig_h_leading_LRJ_psi_R_VariableIOs_3", "Leading LRJ Et Distribution;#Psi_{R, Leading} [3 IOs Only];% of Leading LRJs / 0.05", 20, 0, 1);
    TH1F* sig_h_subleading_LRJ_psi_R_VariableIOs_3 = new TH1F("sig_h_subleading_LRJ_psi_R_VariableIOs_3", "Leading LRJ Et Distribution;#Psi_{R, Subleading} [3 IOs Only];% of Leading LRJs / 0.05", 20, 0, 1);
    TH1F* sig_h_LRJ_psi_R_squared_VariableIOs_3 = new TH1F("sig_h_LRJ_psi_R_squared_VariableIOs_3", "Leading LRJ Et Distribution;#Psi_{R, Leading} #times #Psi_{R, Subleading} [3 IOs Only];% of Events / 0.02", 35, 0, 0.7);     
    
    TH2F *sigJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_3 = new TH2F("sigJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_3", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R, Leading} #times #Psi_{R, Subleading}", 
                        52, 0, 1040, // x axis
                        35, 0, 0.7); //y axis
    TH2F *backJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_3 = new TH2F("backJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_3", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R, Leading} #times #Psi_{R, Subleading}", 
                        52, 0, 1040, // x axis
                        35, 0, 0.7); //y axis

    TH2F *sigJetTaggerSubleadingLRJEtvsPsi_R_VariableIOs_3 = new TH2F("sigJetTaggerSubleadingLRJEtvsPsi_R_VariableIOs_3", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; #Psi_{R, Leading} #times #Psi_{R, Subleading}", 
                        52, 0, 1040, // x axis
                        35, 0, 0.7); //y axis
    TH2F *backJetTaggerSubleadingLRJEtvsPsi_R_VariableIOs_3 = new TH2F("backJetTaggerSubleadingLRJEtvsPsi_R_VariableIOs_3", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; #Psi_{R, Leading} #times #Psi_{R, Subleading}", 
                        52, 0, 1040, // x axis
                        35, 0, 0.7); //y axis

    TH1F* back_h_leading_LRJ_psi_R_VariableIOs_3 = new TH1F("back_h_leading_LRJ_psi_R_VariableIOs_3", "Leading LRJ Et Distribution;#Psi_{R, Leading} [3 IOs Only];% of Leading LRJs / 0.05", 20, 0, 1);
    TH1F* back_h_subleading_LRJ_psi_R_VariableIOs_3 = new TH1F("back_h_subleading_LRJ_psi_R_VariableIOs_3", "Leading LRJ Et Distribution;#Psi_{R, Subleading} [3 IOs Only];% of Leading LRJs / 0.05", 20, 0, 1);
    TH1F* back_h_LRJ_psi_R_squared_VariableIOs_3 = new TH1F("back_h_LRJ_psi_R_squared_VariableIOs_3", "Leading LRJ Et Distribution;#Psi_{R, Leading} #times #Psi_{R, Subleading} [5 IOs Only];% of Events / 0.02", 35, 0, 0.7);

    TH1F* sig_h_leading_LRJ_psi_R_VariableIOs_4 = new TH1F("sig_h_leading_LRJ_psi_R_VariableIOs_4", "Leading LRJ Et Distribution;#Psi_{R, Leading} [4 IOs Only];% of Leading LRJs / 0.05", 20, 0, 1);
    TH1F* sig_h_subleading_LRJ_psi_R_VariableIOs_4 = new TH1F("sig_h_subleading_LRJ_psi_R_VariableIOs_4", "Leading LRJ Et Distribution;#Psi_{R, Subleading} [4 IOs Only];% of Leading LRJs / 0.05", 20, 0, 1);
    TH1F* sig_h_LRJ_psi_R_squared_VariableIOs_4 = new TH1F("sig_h_LRJ_psi_R_squared_VariableIOs_4", "Leading LRJ Et Distribution;#Psi_{R, Leading} #times #Psi_{R, Subleading} [4 IOs Only];% of Events / 0.02", 35, 0, 0.7);     
    
    TH2F *sigJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_4 = new TH2F("sigJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_4", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R, Leading} #times #Psi_{R, Subleading}", 
                        52, 0, 1040, // x axis
                        35, 0, 0.7); //y axis
    TH2F *backJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_4 = new TH2F("backJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_4", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R, Leading} #times #Psi_{R, Subleading}", 
                        52, 0, 1040, // x axis
                        35, 0, 0.7); //y axis

    TH2F *sigJetTaggerSubleadingLRJEtvsPsi_R_VariableIOs_4 = new TH2F("sigJetTaggerSubleadingLRJEtvsPsi_R_VariableIOs_4", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; #Psi_{R, Leading} #times #Psi_{R, Subleading}", 
                        52, 0, 1040, // x axis
                        35, 0, 0.7); //y axis
    TH2F *backJetTaggerSubleadingLRJEtvsPsi_R_VariableIOs_4 = new TH2F("backJetTaggerSubleadingLRJEtvsPsi_R_VariableIOs_4", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; #Psi_{R, Leading} #times #Psi_{R, Subleading}", 
                        52, 0, 1040, // x axis
                        35, 0, 0.7); //y axis

    TH1F* back_h_leading_LRJ_psi_R_VariableIOs_4 = new TH1F("back_h_leading_LRJ_psi_R_VariableIOs_4", "Leading LRJ Et Distribution;#Psi_{R, Leading} [4 IOs Only];% of Leading LRJs / 0.05", 20, 0, 1);
    TH1F* back_h_subleading_LRJ_psi_R_VariableIOs_4 = new TH1F("back_h_subleading_LRJ_psi_R_VariableIOs_4", "Leading LRJ Et Distribution;#Psi_{R, Subleading} [4 IOs Only];% of Leading LRJs / 0.05", 20, 0, 1);
    TH1F* back_h_LRJ_psi_R_squared_VariableIOs_4 = new TH1F("back_h_LRJ_psi_R_squared_VariableIOs_4", "Leading LRJ Et Distribution;#Psi_{R, Leading} #times #Psi_{R, Subleading} [4 IOs Only];% of Events / 0.02", 35, 0, 0.7);

    TH1F* sig_h_leading_LRJ_psi_R_VariableIOs_5 = new TH1F("sig_h_leading_LRJ_psi_R_VariableIOs_5", "Leading LRJ Et Distribution;#Psi_{R, Leading} [5 IOs Only];% of Leading LRJs / 0.05", 20, 0, 1);
    TH1F* sig_h_subleading_LRJ_psi_R_VariableIOs_5 = new TH1F("sig_h_subleading_LRJ_psi_R_VariableIOs_5", "Leading LRJ Et Distribution;#Psi_{R, Subleading} [5 IOs Only];% of Leading LRJs / 0.05", 20, 0, 1);
    TH1F* sig_h_LRJ_psi_R_squared_VariableIOs_5 = new TH1F("sig_h_LRJ_psi_R_squared_VariableIOs_5", "Leading LRJ Et Distribution;#Psi_{R, Leading} #times #Psi_{R, Subleading} [5 IOs Only];% of Events / 0.02", 35, 0, 0.7);     

    TH1F* back_h_leading_LRJ_psi_R_VariableIOs_5 = new TH1F("back_h_leading_LRJ_psi_R_VariableIOs_5", "Leading LRJ Et Distribution;#Psi_{R, Leading} [5 IOs Only];% of Leading LRJs / 0.05", 20, 0, 1);
    TH1F* back_h_subleading_LRJ_psi_R_VariableIOs_5 = new TH1F("back_h_subleading_LRJ_psi_R_VariableIOs_5", "Leading LRJ Et Distribution;#Psi_{R, Subleading} [5 IOs Only];% of Leading LRJs / 0.05", 20, 0, 1);
    TH1F* back_h_LRJ_psi_R_squared_VariableIOs_5 = new TH1F("back_h_LRJ_psi_R_squared_VariableIOs_5", "Leading LRJ Et Distribution;#Psi_{R, Leading} #times #Psi_{R, Subleading} [5 IOs Only];% of Events / 0.02", 35, 0, 0.7);     
    
    TH2F *sigJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_5 = new TH2F("sigJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_5", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R, Leading} #times #Psi_{R, Subleading}", 
                        52, 0, 1040, // x axis
                        35, 0, 0.7); //y axis
    TH2F *backJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_5 = new TH2F("backJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_5", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R, Leading} #times #Psi_{R, Subleading}", 
                        52, 0, 1040, // x axis
                        35, 0, 0.7); //y axis

    TH2F *sigJetTaggerSubleadingLRJEtvsPsi_R_VariableIOs_5 = new TH2F("sigJetTaggerSubleadingLRJEtvsPsi_R_VariableIOs_5", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; #Psi_{R, Leading} #times #Psi_{R, Subleading}", 
                        52, 0, 1040, // x axis
                        35, 0, 0.7); //y axis
    TH2F *backJetTaggerSubleadingLRJEtvsPsi_R_VariableIOs_5 = new TH2F("backJetTaggerSubleadingLRJEtvsPsi_R_VariableIOs_5", "Sum of Topo422 E_{T} in Each Bin; JetTagger Subleading LRJ E_{T} [GeV]; #Psi_{R, Leading} #times #Psi_{R, Subleading}", 
                        52, 0, 1040, // x axis
                        35, 0, 0.7); //y axis

    TH1F* sig_h_leading_LRJ_Psi_R2_VariableIOs_2 = new TH1F("sig_h_leading_LRJ_Psi_R2_VariableIOs_2", "Leading LRJ Et Distribution;#Psi_{R^{2}, Leading} [2 IOs Only];% of Leading LRJs / 0.05", 20, 0, 1);
    TH1F* sig_h_subleading_LRJ_Psi_R2_VariableIOs_2 = new TH1F("sig_h_subleading_LRJ_Psi_R2_VariableIOs_2", "Leading LRJ Et Distribution;#Psi_{R^{2}, Subleading} [2 IOs Only];% of Leading LRJs / 0.05", 20, 0, 1);
    TH1F* sig_h_LRJ_Psi_R2_squared_VariableIOs_2 = new TH1F("sig_h_LRJ_Psi_R2_squared_VariableIOs_2", "Leading LRJ Et Distribution;#Psi_{R^{2}, Leading} #times #Psi_{R^{2}, Subleading} [2 IOs Only];% of Events / 0.02", 35, 0, 0.7);     
    
    TH2F *sigJetTaggerLeadingLRJEtvsPsi_R2_VariableIOs_2 = new TH2F("sigJetTaggerLeadingLRJEtvsPsi_R2_VariableIOs_2", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R^{2}, Leading} #times #Psi_{R^{2}, Subleading}", 
                        52, 0, 1040, // x axis
                        35, 0, 0.7); //y axis
    TH2F *backJetTaggerLeadingLRJEtvsPsi_R2_VariableIOs_2 = new TH2F("backJetTaggerLeadingLRJEtvsPsi_R2_VariableIOs_2", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R^{2}, Leading} #times #Psi_{R^{2}, Subleading}", 
                        52, 0, 1040, // x axis
                        35, 0, 0.7); //y axis

    TH1F* back_h_leading_LRJ_Psi_R2_VariableIOs_2 = new TH1F("back_h_leading_LRJ_Psi_R2_VariableIOs_2", "Leading LRJ Et Distribution;#Psi_{R^{2}, Leading} [2 IOs Only];% of Leading LRJs / 0.05", 20, 0, 1);
    TH1F* back_h_subleading_LRJ_Psi_R2_VariableIOs_2 = new TH1F("back_h_subleading_LRJ_Psi_R2_VariableIOs_2", "Leading LRJ Et Distribution;#Psi_{R^{2}, Subleading} [2 IOs Only];% of Leading LRJs / 0.05", 20, 0, 1);
    TH1F* back_h_LRJ_Psi_R2_squared_VariableIOs_2 = new TH1F("back_h_LRJ_Psi_R2_squared_VariableIOs_2", "Leading LRJ Et Distribution;#Psi_{R^{2}, Leading} #times #Psi_{R^{2}, Subleading} [2 IOs Only];% of Events / 0.02", 35, 0, 0.7);

    TH1F* sig_h_leading_LRJ_Psi_R2_VariableIOs_3 = new TH1F("sig_h_leading_LRJ_Psi_R2_VariableIOs_3", "Leading LRJ Et Distribution;#Psi_{R^{2}, Leading} [3 IOs Only];% of Leading LRJs / 0.05", 20, 0, 1);
    TH1F* sig_h_subleading_LRJ_Psi_R2_VariableIOs_3 = new TH1F("sig_h_subleading_LRJ_Psi_R2_VariableIOs_3", "Leading LRJ Et Distribution;#Psi_{R^{2}, Subleading} [3 IOs Only];% of Leading LRJs / 0.05", 20, 0, 1);
    TH1F* sig_h_LRJ_Psi_R2_squared_VariableIOs_3 = new TH1F("sig_h_LRJ_Psi_R2_squared_VariableIOs_3", "Leading LRJ Et Distribution;#Psi_{R^{2}, Leading} #times #Psi_{R^{2}, Subleading} [3 IOs Only];% of Events / 0.02", 35, 0, 0.7);     
    
    TH2F *sigJetTaggerLeadingLRJEtvsPsi_R2_VariableIOs_3 = new TH2F("sigJetTaggerLeadingLRJEtvsPsi_R2_VariableIOs_3", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R^{2}, Leading} #times #Psi_{R^{2}, Subleading}", 
                        52, 0, 1040, // x axis
                        35, 0, 0.7); //y axis
    TH2F *backJetTaggerLeadingLRJEtvsPsi_R2_VariableIOs_3 = new TH2F("backJetTaggerLeadingLRJEtvsPsi_R2_VariableIOs_3", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R^{2}, Leading} #times #Psi_{R^{2}, Subleading}", 
                        52, 0, 1040, // x axis
                        35, 0, 0.7); //y axis

    TH1F* back_h_leading_LRJ_Psi_R2_VariableIOs_3 = new TH1F("back_h_leading_LRJ_Psi_R2_VariableIOs_3", "Leading LRJ Et Distribution;#Psi_{R^{2}, Leading} [3 IOs Only];% of Leading LRJs / 0.05", 20, 0, 1);
    TH1F* back_h_subleading_LRJ_Psi_R2_VariableIOs_3 = new TH1F("back_h_subleading_LRJ_Psi_R2_VariableIOs_3", "Leading LRJ Et Distribution;#Psi_{R^{2}, Subleading} [3 IOs Only];% of Leading LRJs / 0.05", 20, 0, 1);
    TH1F* back_h_LRJ_Psi_R2_squared_VariableIOs_3 = new TH1F("back_h_LRJ_Psi_R2_squared_VariableIOs_3", "Leading LRJ Et Distribution;#Psi_{R^{2}, Leading} #times #Psi_{R^{2}, Subleading} [5 IOs Only];% of Events / 0.02", 35, 0, 0.7);

    TH1F* sig_h_leading_LRJ_Psi_R2_VariableIOs_4 = new TH1F("sig_h_leading_LRJ_Psi_R2_VariableIOs_4", "Leading LRJ Et Distribution;#Psi_{R^{2}, Leading} [4 IOs Only];% of Leading LRJs / 0.05", 20, 0, 1);
    TH1F* sig_h_subleading_LRJ_Psi_R2_VariableIOs_4 = new TH1F("sig_h_subleading_LRJ_Psi_R2_VariableIOs_4", "Leading LRJ Et Distribution;#Psi_{R^{2}, Subleading} [4 IOs Only];% of Leading LRJs / 0.05", 20, 0, 1);
    TH1F* sig_h_LRJ_Psi_R2_squared_VariableIOs_4 = new TH1F("sig_h_LRJ_Psi_R2_squared_VariableIOs_4", "Leading LRJ Et Distribution;#Psi_{R^{2}, Leading} #times #Psi_{R^{2}, Subleading} [4 IOs Only];% of Events / 0.02", 35, 0, 0.7);     
    
    TH2F *sigJetTaggerLeadingLRJEtvsPsi_R2_VariableIOs_4 = new TH2F("sigJetTaggerLeadingLRJEtvsPsi_R2_VariableIOs_4", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R^{2}, Leading} #times #Psi_{R^{2}, Subleading}", 
                        52, 0, 1040, // x axis
                        35, 0, 0.7); //y axis
    TH2F *backJetTaggerLeadingLRJEtvsPsi_R2_VariableIOs_4 = new TH2F("backJetTaggerLeadingLRJEtvsPsi_R2_VariableIOs_4", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R^{2}, Leading} #times #Psi_{R^{2}, Subleading}", 
                        52, 0, 1040, // x axis
                        35, 0, 0.7); //y axis

    TH1F* back_h_leading_LRJ_Psi_R2_VariableIOs_4 = new TH1F("back_h_leading_LRJ_Psi_R2_VariableIOs_4", "Leading LRJ Et Distribution;#Psi_{R^{2}, Leading} [4 IOs Only];% of Leading LRJs / 0.05", 20, 0, 1);
    TH1F* back_h_subleading_LRJ_Psi_R2_VariableIOs_4 = new TH1F("back_h_subleading_LRJ_Psi_R2_VariableIOs_4", "Leading LRJ Et Distribution;#Psi_{R^{2}, Subleading} [4 IOs Only];% of Leading LRJs / 0.05", 20, 0, 1);
    TH1F* back_h_LRJ_Psi_R2_squared_VariableIOs_4 = new TH1F("back_h_LRJ_Psi_R2_squared_VariableIOs_4", "Leading LRJ Et Distribution;#Psi_{R^{2}, Leading} #times #Psi_{R^{2}, Subleading} [4 IOs Only];% of Events / 0.02", 35, 0, 0.7);

    TH1F* sig_h_leading_LRJ_Psi_R2_VariableIOs_5 = new TH1F("sig_h_leading_LRJ_Psi_R2_VariableIOs_5", "Leading LRJ Et Distribution;#Psi_{R^{2}, Leading} [5 IOs Only];% of Leading LRJs / 0.05", 20, 0, 1);
    TH1F* sig_h_subleading_LRJ_Psi_R2_VariableIOs_5 = new TH1F("sig_h_subleading_LRJ_Psi_R2_VariableIOs_5", "Leading LRJ Et Distribution;#Psi_{R^{2}, Subleading} [5 IOs Only];% of Leading LRJs / 0.05", 20, 0, 1);
    TH1F* sig_h_LRJ_Psi_R2_squared_VariableIOs_5 = new TH1F("sig_h_LRJ_Psi_R2_squared_VariableIOs_5", "Leading LRJ Et Distribution;#Psi_{R^{2}, Leading} #times #Psi_{R^{2}, Subleading} [5 IOs Only];% of Events / 0.02", 35, 0, 0.7);     
    
    TH2F *sigJetTaggerLeadingLRJEtvsPsi_R2_VariableIOs_5 = new TH2F("sigJetTaggerLeadingLRJEtvsPsi_R2_VariableIOs_5", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R^{2}, Leading} #times #Psi_{R^{2}, Subleading}", 
                        52, 0, 1040, // x axis
                        35, 0, 0.7); //y axis
    TH2F *backJetTaggerLeadingLRJEtvsPsi_R2_VariableIOs_5 = new TH2F("backJetTaggerLeadingLRJEtvsPsi_R2_VariableIOs_5", "Sum of Topo422 E_{T} in Each Bin; JetTagger Leading LRJ E_{T} [GeV]; #Psi_{R^{2}, Leading} #times #Psi_{R^{2}, Subleading}", 
                        52, 0, 1040, // x axis
                        35, 0, 0.7); //y axis

    TH1F* back_h_leading_LRJ_Psi_R2_VariableIOs_5 = new TH1F("back_h_leading_LRJ_Psi_R2_VariableIOs_5", "Leading LRJ Et Distribution;#Psi_{R^{2}, Leading} [5 IOs Only];% of Leading LRJs / 0.05", 20, 0, 1);
    TH1F* back_h_subleading_LRJ_Psi_R2_VariableIOs_5 = new TH1F("back_h_subleading_LRJ_Psi_R2_VariableIOs_5", "Leading LRJ Et Distribution;#Psi_{R^{2}, Subleading} [5 IOs Only];% of Leading LRJs / 0.05", 20, 0, 1);
    TH1F* back_h_LRJ_Psi_R2_squared_VariableIOs_5 = new TH1F("back_h_LRJ_Psi_R2_squared_VariableIOs_5", "Leading LRJ Et Distribution;#Psi_{R^{2}, Leading} #times #Psi_{R^{2}, Subleading} [5 IOs Only];% of Events / 0.02", 35, 0, 0.7);

    TH1F* sig_h_leading_LRJ_psi_R = new TH1F("sig_h_leading_LRJ_psi_R", "Leading LRJ Et Distribution;#Psi_{R};% of Leading LRJs / 0.05", 20, 0, 1);
    TH1F* sig_h_leading_LRJ_psi_R_MassWindow = new TH1F("sig_h_leading_LRJ_psi_R_MassWindow", "Leading LRJ Et Distribution;#Psi_{R};% of Leading LRJs / 0.05", 20, 0, 1);
    TH1F* sig_h_leading_LRJ_psi_R_OutsideMassWindow = new TH1F("sig_h_leading_LRJ_psi_R_OutsideMassWindow", "Leading LRJ Et Distribution;#Psi_{R};% of Leading LRJs / 0.05", 20, 0, 1);
    TH1F* sig_h_LRJ_psi_R_squared = new TH1F("sig_h_LRJ_psi_R_squared", "Leading LRJ Et Distribution;#Psi_{R, Leading} #times #Psi_{R, Subleading};% of Events / 0.02", 35, 0, 0.7);
    TH1F* sig_h_LRJ_psi_R_12 = new TH1F("sig_h_LRJ_psi_R_12", "Leading LRJ Et Distribution; #frac{#Psi_{R, Leading}}{#Psi_{R, Subleading}};% of Events / 0.2", 25, 0, 5);
    TH1F* sig_h_subleading_LRJ_psi_R = new TH1F("sig_h_subleading_LRJ_psi_R", "Subleading LRJ Et Distribution;#Psi_{R};% of Subleading LRJs / 0.05 ", 20, 0, 1);
    TH1F* back_h_leading_LRJ_psi_R = new TH1F("back_h_leading_LRJ_psi_R", "Leading LRJ Et Distribution;#Psi_{R};% of Leading LRJs / 0.05", 20, 0, 1);
    TH1F* back_h_leading_LRJ_psi_R_MassWindow = new TH1F("back_h_leading_LRJ_psi_R_MassWindow", "Leading LRJ Et Distribution;#Psi_{R};% of Leading LRJs / 0.05", 20, 0, 1);
    TH1F* back_h_leading_LRJ_psi_R_OutsideMassWindow = new TH1F("back_h_leading_LRJ_psi_R_OutsideMassWindow", "Leading LRJ Et Distribution;#Psi_{R};% of Leading LRJs / 0.05", 20, 0, 1);
    TH1F* back_h_LRJ_psi_R_squared = new TH1F("back_h_LRJ_psi_R_squared", "Leading LRJ Et Distribution;#Psi_{R, Leading} #times #Psi_{R, Subleading};% of Events / 0.02", 35, 0, 0.7);
    TH1F* back_h_LRJ_psi_R_12 = new TH1F("back_h_LRJ_psi_R_12", "Leading LRJ Et Distribution; #frac{#Psi_{R, Leading}}{#Psi_{R, Subleading}};% of Events / 0.2", 25, 0, 5);
    TH1F* back_h_subleading_LRJ_psi_R = new TH1F("back_h_subleading_LRJ_psi_R", "Subleading LRJ Et Distribution;#Psi_{R};% of Subleading LRJs / 0.05", 20, 0, 1);

    TH1F* sig_h_leading_LRJ_psi_R2 = new TH1F("sig_h_leading_LRJ_psi_R2", "Leading LRJ Et Distribution;#Psi_{R^{2}};% of Leading LRJs / 0.05", 20, 0, 1);
    TH1F* sig_h_LRJ_psi_R2_squared = new TH1F("sig_h_LRJ_psi_R2_squared", "Leading LRJ Et Distribution;#Psi_{R^{2}, Leading} #times #Psi_{R^{2}, Subleading};% of Events / 0.01", 20, 0, 0.2);
    TH1F* sig_h_LRJ_psi_R2_12 = new TH1F("sig_h_LRJ_psi_R2_12", "Leading LRJ Et Distribution; #frac{#Psi_{R^{2}, Leading}}{#Psi_{R^{2}, Subleading}};% of Events / 0.2", 25, 0, 5);
    TH1F* sig_h_subleading_LRJ_psi_R2 = new TH1F("sig_h_subleading_LRJ_psi_R2", "Subleading LRJ Et Distribution;#Psi_{R^{2}};% of Subleading LRJs / 0.05 ", 20, 0, 1);
    TH1F* back_h_leading_LRJ_psi_R2 = new TH1F("back_h_leading_LRJ_psi_R2", "Leading LRJ Et Distribution;#Psi_{R^{2}};% of Leading LRJs / 0.05", 20, 0, 1);
    TH1F* back_h_LRJ_psi_R2_squared = new TH1F("back_h_LRJ_psi_R2_squared", "Leading LRJ Et Distribution;#Psi_{R^{2}, Leading} #times #Psi_{R^{2}, Subleading};% of Events / 0.01", 20, 0, 0.2);
    TH1F* back_h_LRJ_psi_R2_12 = new TH1F("back_h_LRJ_psi_R2_12", "Leading LRJ Et Distribution; #frac{#Psi_{R^{2}, Leading}}{#Psi_{R^{2}, Subleading}};% of Events / 0.2", 25, 0, 5);
    TH1F* back_h_subleading_LRJ_psi_R2 = new TH1F("back_h_subleading_LRJ_psi_R2", "Subleading LRJ Et Distribution;#Psi_{R^{2}};% of Subleading LRJs / 0.05", 20, 0, 1);

    TH1F* sig_h_LRJ1_deltaEt_digitized_double = new TH1F("sig_h_LRJ1_deltaEt_digitized_double", "LRJ Et Distribution;#Delta E_{T} (Digitized - Full-precision) [GeV];% of LRJs / 1 GeV", 40, -20, 20);
    TH1F* sig_h_LRJ2_deltaEt_digitized_double = new TH1F("sig_h_LRJ2_deltaEt_digitized_double", "LRJ Et Distribution;#Delta E_{T} (Digitized - Full-precision) [GeV];% of LRJs / 1 GeV", 40, -20, 20);

    TH1F* back_h_LRJ1_deltaEt_digitized_double = new TH1F("back_h_LRJ1_deltaEt_digitized_double", "LRJ Et Distribution;#Delta E_{T} (Digitized - Full-precision) [GeV];% of LRJs / 1 GeV", 40, -20, 20);
    TH1F* back_h_LRJ2_deltaEt_digitized_double = new TH1F("back_h_LRJ2_deltaEt_digitized_double", "LRJ Et Distribution;#Delta E_{T} (Digitized - Full-precision) [GeV];% of LRJs / 1 GeV", 40, -20, 20);

    TH1F* sig_h_leading_WTA_conecellstowers_pT = new TH1F("sig_h_leading_WTA_conecellstowers_pT", "Leading LRJ pT Distribution;Lead. WTA Cone CellsTowers Jet p_{T} [GeV];% of Leading WTA Cone CellsTowers Jets / 25 GeV", 32, 0, 800);
    TH1F* sig_h_subleading_WTA_conecellstowers_pT = new TH1F("sig_h_subleading_WTA_conecellstowers_pT", "Subleading LRJ pT Distribution;Sublead. Cone CellsTowers Jet p_{T} [GeV];% of Subleading WTACone CellsTowers Jets / 25 GeV", 32, 0, 800);

    TH1F* sig_h_leading_WTA_conebasicclusters_pT = new TH1F("sig_h_leading_WTA_conebasicclusters_pT", "Leading LRJ pT Distribution;Lead. WTA Cone BasicClusters Jet p_{T} [GeV];% of Leading WTA Cone BasicClusters Jets / 25 GeV", 32, 0, 800);
    TH1F* sig_h_subleading_WTA_conebasicclusters_pT = new TH1F("sig_h_subleading_WTA_conebasicclusters_pT", "Subleading LRJ pT Distribution;Sublead. WTA Cone BasicClusters Jet p_{T} [GeV];% of Subleading WTA Cone BasicClusters Jets / 25 GeV", 32, 0, 800);

    TH1F* sig_h_WTA_conecellstowers_multiplicity = new TH1F("sig_h_WTA_conecellstowers_multiplicity", "Leading LRJ pT Distribution;Num. Cone WTA CellsTowers Jets / Event; Fraction of Events ", 50, 0, 50);
    TH1F* sig_h_WTA_conebasicclusters_multiplicity = new TH1F("sig_h_WTA_conebasicclusters_multiplicity", "Leading LRJ pT Distribution;Num. WTA Cone BasicCluster Jets / Event; Fraction of Events ", 50, 0, 50);

    TH1F* sig_h_LRJ_E = new TH1F("sig_h_LRJ_E", "LRJ Et Distribution;Energy [GeV];% of LRJs / 10 GeV", 100, 0, 1000);
    TH1F* sig_h_LRJ_eta = new TH1F("sig_h_LRJ_eta", "LRJ Eta Distribution;#eta;Counts", 50, -5, 5);
    TH1F* sig_h_LRJ_phi = new TH1F("sig_h_LRJ_phi", "LRJ Phi Distribution;#phi;Counts", 32, -3.2, 3.2);


    TH1F* sig_h_leading_LRJ_gFexLRJ_deltaEt = new TH1F("sig_h_leading_LRJ_gFexLRJ_deltaEt", "#Delta E_{T} Leading gFex LRJ, Output LRJ, ;#Delta E_{T} (gFex - JetTagger) [GeV];% of Leading LRJs / 10 GeV", 50, -150, 150);
    TH1F* sig_h_leading_LRJ_offlineLRJ_deltaEt = new TH1F("sig_h_leading_LRJ_offlineLRJ_deltaEt", "#Delta E_{T} Leading Offline LRJ, Output LRJ, ;#Delta E_{T} (Offline - JetTagger) [GeV];% of Leading LRJs / 10 GeV", 50, -150, 350);

    TH1F* sig_h_leading_offlineLRJ_gFexLRJ_deltaEt = new TH1F("sig_h_leading_offlineLRJ_gFexLRJ_deltaEt", "#Delta E_{T} Leading gFex LRJ, Output LRJ, ;#Delta E_{T} (gFex - JetTagger) [GeV];% of Leading LRJs / 10 GeV", 50, -150, 350);
    TH1F* sig_h_leading_offlineLRJ_jFexLRJ_deltaEt = new TH1F("sig_h_leading_offlineLRJ_jFexLRJ_deltaEt", "#Delta E_{T} Leading gFex LRJ, Output LRJ, ;#Delta E_{T} (gFex - JetTagger) [GeV];% of Leading LRJs / 10 GeV", 50, -150, 350);

    TH1F* sig_h_leading_LRJ_gFexLRJ_Et_resolution = new TH1F("sig_h_leading_LRJ_gFexLRJ_Et_resolution", "#Delta E_{T} Leading gFex LRJ, Output LRJ, ;#Delta E_{T} (gFex - JetTagger) / E_{T, Offline} [GeV];% of Leading LRJs / 0.1", 40, -2, 2);
    TH1F* sig_h_leading_LRJ_offlineLRJ_Et_resolution = new TH1F("sig_h_leading_LRJ_offlineLRJ_Et_resolution", "#Delta E_{T} Leading Offline LRJ, Output LRJ, ;#Delta E_{T} (Offline - JetTagger) / E_{T, Offline} [GeV];% of Leading LRJs / 0.1", 20, -1, 1);

    TH1F* sig_h_leading_offlineLRJ_gFexLRJ_Et_resolution = new TH1F("sig_h_leading_offlineLRJ_gFexLRJ_Et_resolution", "#Delta E_{T} Leading gFEX LRJ, Output LRJ, ;#Delta E_{T} (Offline - gFEX) / E_{T, Offline} [GeV];% of Leading LRJs / 0.1", 50, -3.5, 1.5);
    TH1F* sig_h_leading_offlineLRJ_jFexLRJ_Et_resolution = new TH1F("sig_h_leading_offlineLRJ_jFexLRJ_Et_resolution", "#Delta E_{T} Leading jFEX LRJ, Output LRJ, ;#Delta E_{T} (Offline - jFEX) / E_{T, Offline} [GeV];% of Leading LRJs / 0.1", 40, -3, 1);

    TH1F* sig_h_leading_LRJ_gFexLRJ_deltaR = new TH1F("sig_h_leading_LRJ_gFexLRJ_deltaR", "#Delta R Leading gFex LRJ, Output LRJ, ;#Delta R (gFex, JetTagger);% of Leading LRJs / 0.1", 50, 0, 5);
    TH1F* sig_h_leading_LRJ_offlineLRJ_deltaR = new TH1F("sig_h_leading_LRJ_offlineLRJ_deltaR", "#Delta R Leading Offline LRJ, Output LRJ, ;#Delta R (Offline, JetTagger);% of Leading LRJs / 0.1", 50, 0, 5);

    TH1F* sig_h_first_LRJ_jFexSRJ_deltaR = new TH1F("sig_h_first_LRJ_jFexSRJ_deltaR", "#Delta R Leading jFex SRJ, Output LRJ, ;#Delta R (Lead. jFex SRJ, 1st JetTagger LRJ);% of Leading LRJs / 0.1", 50, 0, 5);
    TH1F* sig_h_second_LRJ_jFexSRJ_deltaR = new TH1F("sig_h_second_LRJ_jFexSRJ_deltaR", "#Delta R Subleading jFex SRJ, Output LRJ, ;#Delta R (Sublead. jFex SRJ, 2nd JetTagger LRJ);% of Leading LRJs / 0.1", 50, 0, 5);

    TH1F* sig_h_lead_sublead_LRJ_deltaR = new TH1F("sig_h_lead_sublead_LRJ_deltaR", "#Delta R Leading, Subleading LRJ, ;#Delta R (Lead., Sublead. Output LRJ);% of Leading LRJs / 0.1", 50, 0, 5);

    // Signal trigger efficiencies (gFex, JetTagger)
    // First equal rate thresholds
    TH1F* sig_h_offlineLRJ_Et_num10kHz = new TH1F("sig_h_offlineLRJ_Et_num10kHz", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 95, 50, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom10kHz = new TH1F("sig_h_offlineLRJ_Et_denom10kHz", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 95, 50, 1000);

    TH1F* sig_h_offlineLRJ_Et_num10kHz_HiggsMassWindow = new TH1F("sig_h_offlineLRJ_Et_num10kHz_HiggsMassWindow", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 95, 50, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom10kHz_HiggsMassWindow = new TH1F("sig_h_offlineLRJ_Et_denom10kHz_HiggsMassWindow", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 95, 50, 1000);

    TH1F* sig_h_offlineLRJ_Et_num10kHz_1Subjet = new TH1F("sig_h_offlineLRJ_Et_num10kHz_1Subjet", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 95, 50, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom10kHz_1Subjet = new TH1F("sig_h_offlineLRJ_Et_denom10kHz_1Subjet", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 95, 50, 1000);

    TH1F* sig_h_offlineLRJ_Et_num10kHz_GrEq2Subjets = new TH1F("sig_h_offlineLRJ_Et_num10kHz_GrEq2Subjets", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 95, 50, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom10kHz_GrEq2Subjets = new TH1F("sig_h_offlineLRJ_Et_denom10kHz_GrEq2Subjets", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 95, 50, 1000);

    TH1F* sig_h_offlineLRJ_Et_num10kHz_gFexLRJ = new TH1F("sig_h_offlineLRJ_Et_num10kHz_gFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 95, 50, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom10kHz_gFexLRJ = new TH1F("sig_h_offlineLRJ_Et_denom10kHz_gFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 95, 50, 1000);

    TH1F* sig_h_offlineLRJ_Et_num10kHz_gFexLRJ_HiggsMassWindow = new TH1F("sig_h_offlineLRJ_Et_num10kHz_gFexLRJ_HiggsMassWindow", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 95, 50, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom10kHz_gFexLRJ_HiggsMassWindow = new TH1F("sig_h_offlineLRJ_Et_denom10kHz_gFexLRJ_HiggsMassWindow", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 95, 50, 1000);

    TH1F* sig_h_offlineLRJ_Et_num10kHz_gFexLRJ_1Subjet = new TH1F("sig_h_offlineLRJ_Et_num10kHz_gFexLRJ_1Subjet", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 95, 50, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom10kHz_gFexLRJ_1Subjet = new TH1F("sig_h_offlineLRJ_Et_denom10kHz_gFexLRJ_1Subjet", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 95, 50, 1000);

    TH1F* sig_h_offlineLRJ_Et_num10kHz_gFexLRJ_GrEq2Subjets = new TH1F("sig_h_offlineLRJ_Et_num10kHz_gFexLRJ_GrEq2Subjets", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 95, 50, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom10kHz_gFexLRJ_GrEq2Subjets = new TH1F("sig_h_offlineLRJ_Et_denom10kHz_gFexLRJ_GrEq2Subjets", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 95, 50, 1000);

    TH1F* sig_h_offlineLRJ_Et_num10kHz_Subleading = new TH1F("sig_h_offlineLRJ_Et_num10kHz_Subleading", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 95, 50, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom10kHz_Subleading = new TH1F("sig_h_offlineLRJ_Et_denom10kHz_Subleading", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 95, 50, 1000);

    TH1F* sig_h_offlineLRJ_Et_num10kHz_HiggsMassWindow_Subleading = new TH1F("sig_h_offlineLRJ_Et_num10kHz_HiggsMassWindow_Subleading", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 95, 50, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom10kHz_HiggsMassWindow_Subleading = new TH1F("sig_h_offlineLRJ_Et_denom10kHz_HiggsMassWindow_Subleading", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 95, 50, 1000);

    TH1F* sig_h_offlineLRJ_Et_num10kHz_1Subjet_Subleading = new TH1F("sig_h_offlineLRJ_Et_num10kHz_1Subjet_Subleading", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 95, 50, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom10kHz_1Subjet_Subleading = new TH1F("sig_h_offlineLRJ_Et_denom10kHz_1Subjet_Subleading", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 95, 50, 1000);

    TH1F* sig_h_offlineLRJ_Et_num10kHz_GrEq2Subjets_Subleading = new TH1F("sig_h_offlineLRJ_Et_num10kHz_GrEq2Subjets_Subleading", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 95, 50, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom10kHz_GrEq2Subjets_Subleading = new TH1F("sig_h_offlineLRJ_Et_denom10kHz_GrEq2Subjets_Subleading", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 95, 50, 1000);

    TH1F* sig_h_offlineLRJ_Et_num10kHz_gFexLRJ_Subleading = new TH1F("sig_h_offlineLRJ_Et_num10kHz_gFexLRJ_Subleading", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 95, 50, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom10kHz_gFexLRJ_Subleading = new TH1F("sig_h_offlineLRJ_Et_denom10kHz_gFexLRJ_Subleading", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 95, 50, 1000);

    TH1F* sig_h_offlineLRJ_Et_num10kHz_gFexLRJ_HiggsMassWindow_Subleading = new TH1F("sig_h_offlineLRJ_Et_num10kHz_gFexLRJ_HiggsMassWindow_Subleading", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 95, 50, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom10kHz_gFexLRJ_HiggsMassWindow_Subleading = new TH1F("sig_h_offlineLRJ_Et_denom10kHz_gFexLRJ_HiggsMassWindow_Subleading", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 95, 50, 1000);

    TH1F* sig_h_offlineLRJ_Et_num10kHz_gFexLRJ_1Subjet_Subleading = new TH1F("sig_h_offlineLRJ_Et_num10kHz_gFexLRJ_1Subjet_Subleading", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 95, 50, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom10kHz_gFexLRJ_1Subjet_Subleading = new TH1F("sig_h_offlineLRJ_Et_denom10kHz_gFexLRJ_1Subjet_Subleading", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 95, 50, 1000);

    TH1F* sig_h_offlineLRJ_Et_num10kHz_gFexLRJ_GrEq2Subjets_Subleading = new TH1F("sig_h_offlineLRJ_Et_num10kHz_gFexLRJ_GrEq2Subjets_Subleading", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 95, 50, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom10kHz_gFexLRJ_GrEq2Subjets_Subleading = new TH1F("sig_h_offlineLRJ_Et_denom10kHz_gFexLRJ_GrEq2Subjets_Subleading", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 95, 50, 1000);

    TH1F* sig_h_offlineLRJ_Et_num10kHz_jFexLRJ = new TH1F("sig_h_offlineLRJ_Et_num10kHz_jFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 95, 50, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom10kHz_jFexLRJ = new TH1F("sig_h_offlineLRJ_Et_denom10kHz_jFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 95, 50, 1000);

    TH1F* sig_h_offlineLRJ_Et_num50 = new TH1F("sig_h_offlineLRJ_Et_num50", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom50 = new TH1F("sig_h_offlineLRJ_Et_denom50", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num50_Dijet = new TH1F("sig_h_offlineLRJ_Et_num50_Dijet", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom50_Dijet = new TH1F("sig_h_offlineLRJ_Et_denom50_Dijet", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num50_1Subjet = new TH1F("sig_h_offlineLRJ_Et_num50_1Subjet", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom50_1Subjet = new TH1F("sig_h_offlineLRJ_Et_denom50_1Subjet", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num50_GrEq2Subjets = new TH1F("sig_h_offlineLRJ_Et_num50_GrEq2Subjets", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom50_GrEq2Subjets = new TH1F("sig_h_offlineLRJ_Et_denom50_GrEq2Subjets", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num50_mass100to150 = new TH1F("sig_h_offlineLRJ_Et_num50_mass100to150", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom50_mass100to150 = new TH1F("sig_h_offlineLRJ_Et_denom50_mass100to150", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_subleading_Et_num50_mass100to150 = new TH1F("sig_h_offlineLRJ_subleading_Et_num50_mass100to150", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_subleading_Et_denom50_mass100to150 = new TH1F("sig_h_offlineLRJ_subleading_Et_denom50_mass100to150", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num50_gFexLRJ = new TH1F("sig_h_offlineLRJ_Et_num50_gFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom50_gFexLRJ = new TH1F("sig_h_offlineLRJ_Et_denom50_gFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num50_jFexLRJ = new TH1F("sig_h_offlineLRJ_Et_num50_jFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom50_jFexLRJ = new TH1F("sig_h_offlineLRJ_Et_denom50_jFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num50_gFexLRJ_Dijet = new TH1F("sig_h_offlineLRJ_Et_num50_gFexLRJ_Dijet", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom50_gFexLRJ_Dijet = new TH1F("sig_h_offlineLRJ_Et_denom50_gFexLRJ_Dijet", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_Avg_b_Et_num50 = new TH1F("sig_h_Avg_b_Et_num50", "LRJ Et Distribution;Avg. b E_{T};Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_Avg_b_Et_denom50 = new TH1F("sig_h_Avg_b_Et_denom50", "LRJ Et Distribution;Avg. b E_{T};Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num100 = new TH1F("sig_h_offlineLRJ_Et_num100", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom100 = new TH1F("sig_h_offlineLRJ_Et_denom100", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num100_Dijet = new TH1F("sig_h_offlineLRJ_Et_num100_Dijet", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom100_Dijet = new TH1F("sig_h_offlineLRJ_Et_denom100_Dijet", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num100_1Subjet = new TH1F("sig_h_offlineLRJ_Et_num100_1Subjet", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom100_1Subjet = new TH1F("sig_h_offlineLRJ_Et_denom100_1Subjet", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num100_GrEq2Subjets = new TH1F("sig_h_offlineLRJ_Et_num100_GrEq2Subjets", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom100_GrEq2Subjets = new TH1F("sig_h_offlineLRJ_Et_denom100_GrEq2Subjets", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num100_mass100to150 = new TH1F("sig_h_offlineLRJ_Et_num100_mass100to150", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom100_mass100to150 = new TH1F("sig_h_offlineLRJ_Et_denom100_mass100to150", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_subleading_Et_num100_mass100to150 = new TH1F("sig_h_offlineLRJ_subleading_Et_num100_mass100to150", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_subleading_Et_denom100_mass100to150 = new TH1F("sig_h_offlineLRJ_subleading_Et_denom100_mass100to150", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num100_gFexLRJ = new TH1F("sig_h_offlineLRJ_Et_num100_gFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom100_gFexLRJ = new TH1F("sig_h_offlineLRJ_Et_denom100_gFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num100_jFexLRJ = new TH1F("sig_h_offlineLRJ_Et_num100_jFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom100_jFexLRJ = new TH1F("sig_h_offlineLRJ_Et_denom100_jFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num100_gFexLRJ_Dijet = new TH1F("sig_h_offlineLRJ_Et_num100_gFexLRJ_Dijet", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom100_gFexLRJ_Dijet = new TH1F("sig_h_offlineLRJ_Et_denom100_gFexLRJ_Dijet", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_Avg_b_Et_num100 = new TH1F("sig_h_Avg_b_Et_num100", "LRJ Et Distribution;Avg. b E_{T};Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_Avg_b_Et_denom100 = new TH1F("sig_h_Avg_b_Et_denom100", "LRJ Et Distribution;Avg. b E_{T};Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num150 = new TH1F("sig_h_offlineLRJ_Et_num150", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom150 = new TH1F("sig_h_offlineLRJ_Et_denom150", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num150_Dijet = new TH1F("sig_h_offlineLRJ_Et_num150_Dijet", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom150_Dijet = new TH1F("sig_h_offlineLRJ_Et_denom150_Dijet", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num150_1Subjet = new TH1F("sig_h_offlineLRJ_Et_num150_1Subjet", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom150_1Subjet = new TH1F("sig_h_offlineLRJ_Et_denom150_1Subjet", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num150_GrEq2Subjets = new TH1F("sig_h_offlineLRJ_Et_num150_GrEq2Subjets", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom150_GrEq2Subjets = new TH1F("sig_h_offlineLRJ_Et_denom150_GrEq2Subjets", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num150_mass100to150 = new TH1F("sig_h_offlineLRJ_Et_num150_mass100to150", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom150_mass100to150 = new TH1F("sig_h_offlineLRJ_Et_denom150_mass100to150", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_subleading_Et_num150_mass100to150 = new TH1F("sig_h_offlineLRJ_subleading_Et_num150_mass100to150", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_subleading_Et_denom150_mass100to150 = new TH1F("sig_h_offlineLRJ_subleading_Et_denom150_mass100to150", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num150_gFexLRJ = new TH1F("sig_h_offlineLRJ_Et_num150_gFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom150_gFexLRJ = new TH1F("sig_h_offlineLRJ_Et_denom150_gFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num150_jFexLRJ = new TH1F("sig_h_offlineLRJ_Et_num150_jFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom150_jFexLRJ = new TH1F("sig_h_offlineLRJ_Et_denom150_jFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num150_gFexLRJ_Dijet = new TH1F("sig_h_offlineLRJ_Et_num150_gFexLRJ_Dijet", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom150_gFexLRJ_Dijet = new TH1F("sig_h_offlineLRJ_Et_denom150_gFexLRJ_Dijet", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_Avg_b_Et_num150 = new TH1F("sig_h_Avg_b_Et_num150", "LRJ Et Distribution;Avg. b E_{T};Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_Avg_b_Et_denom150 = new TH1F("sig_h_Avg_b_Et_denom150", "LRJ Et Distribution;Avg. b E_{T};Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num200 = new TH1F("sig_h_offlineLRJ_Et_num200", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom200 = new TH1F("sig_h_offlineLRJ_Et_denom200", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num200_Dijet = new TH1F("sig_h_offlineLRJ_Et_num200_Dijet", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom200_Dijet = new TH1F("sig_h_offlineLRJ_Et_denom200_Dijet", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num200_1Subjet = new TH1F("sig_h_offlineLRJ_Et_num200_1Subjet", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom200_1Subjet = new TH1F("sig_h_offlineLRJ_Et_denom200_1Subjet", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num200_GrEq2Subjets = new TH1F("sig_h_offlineLRJ_Et_num200_GrEq2Subjets", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom200_GrEq2Subjets = new TH1F("sig_h_offlineLRJ_Et_denom200_GrEq2Subjets", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num200_mass100to150 = new TH1F("sig_h_offlineLRJ_Et_num200_mass100to150", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom200_mass100to150 = new TH1F("sig_h_offlineLRJ_Et_denom200_mass100to150", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_subleading_Et_num200_mass100to150 = new TH1F("sig_h_offlineLRJ_subleading_Et_num200_mass100to150", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_subleading_Et_denom200_mass100to150 = new TH1F("sig_h_offlineLRJ_subleading_Et_denom200_mass100to150", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num200_gFexLRJ = new TH1F("sig_h_offlineLRJ_Et_num200_gFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom200_gFexLRJ = new TH1F("sig_h_offlineLRJ_Et_denom200_gFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num200_jFexLRJ = new TH1F("sig_h_offlineLRJ_Et_num200_jFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom200_jFexLRJ = new TH1F("sig_h_offlineLRJ_Et_denom200_jFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num200_gFexLRJ_Dijet = new TH1F("sig_h_offlineLRJ_Et_num200_gFexLRJ_Dijet", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom200_gFexLRJ_Dijet = new TH1F("sig_h_offlineLRJ_Et_denom200_gFexLRJ_Dijet", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_Avg_b_Et_num200 = new TH1F("sig_h_Avg_b_Et_num200", "LRJ Et Distribution;Avg. b E_{T};Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_Avg_b_Et_denom200 = new TH1F("sig_h_Avg_b_Et_denom200", "LRJ Et Distribution;Avg. b E_{T};Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num250 = new TH1F("sig_h_offlineLRJ_Et_num250", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom250 = new TH1F("sig_h_offlineLRJ_Et_denom250", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num250_Dijet = new TH1F("sig_h_offlineLRJ_Et_num250_Dijet", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom250_Dijet = new TH1F("sig_h_offlineLRJ_Et_denom250_Dijet", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num250_1Subjet = new TH1F("sig_h_offlineLRJ_Et_num250_1Subjet", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom250_1Subjet = new TH1F("sig_h_offlineLRJ_Et_denom250_1Subjet", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num250_GrEq2Subjets = new TH1F("sig_h_offlineLRJ_Et_num250_GrEq2Subjets", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom250_GrEq2Subjets = new TH1F("sig_h_offlineLRJ_Et_denom250_GrEq2Subjets", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num250_mass100to150 = new TH1F("sig_h_offlineLRJ_Et_num250_mass100to150", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom250_mass100to150 = new TH1F("sig_h_offlineLRJ_Et_denom250_mass100to150", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_subleading_Et_num250_mass100to150 = new TH1F("sig_h_offlineLRJ_subleading_Et_num250_mass100to150", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_subleading_Et_denom250_mass100to150 = new TH1F("sig_h_offlineLRJ_subleading_Et_denom250_mass100to150", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num250_gFexLRJ = new TH1F("sig_h_offlineLRJ_Et_num250_gFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom250_gFexLRJ = new TH1F("sig_h_offlineLRJ_Et_denom250_gFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num250_jFexLRJ = new TH1F("sig_h_offlineLRJ_Et_num250_jFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom250_jFexLRJ = new TH1F("sig_h_offlineLRJ_Et_denom250_jFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num250_gFexLRJ_Dijet = new TH1F("sig_h_offlineLRJ_Et_num250_gFexLRJ_Dijet", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom250_gFexLRJ_Dijet = new TH1F("sig_h_offlineLRJ_Et_denom250_gFexLRJ_Dijet", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_Avg_b_Et_num250 = new TH1F("sig_h_Avg_b_Et_num250", "LRJ Et Distribution;Avg. b E_{T};Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_Avg_b_Et_denom250 = new TH1F("sig_h_Avg_b_Et_denom250", "LRJ Et Distribution;Avg. b E_{T};Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num300 = new TH1F("sig_h_offlineLRJ_Et_num300", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom300 = new TH1F("sig_h_offlineLRJ_Et_denom300", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num300_Dijet = new TH1F("sig_h_offlineLRJ_Et_num300_Dijet", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom300_Dijet = new TH1F("sig_h_offlineLRJ_Et_denom300_Dijet", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num300_1Subjet = new TH1F("sig_h_offlineLRJ_Et_num300_1Subjet", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom300_1Subjet = new TH1F("sig_h_offlineLRJ_Et_denom300_1Subjet", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num300_GrEq2Subjets = new TH1F("sig_h_offlineLRJ_Et_num300_GrEq2Subjets", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom300_GrEq2Subjets = new TH1F("sig_h_offlineLRJ_Et_denom300_GrEq2Subjets", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    
    TH1F* sig_h_offlineLRJ_Et_num300_mass100to150 = new TH1F("sig_h_offlineLRJ_Et_num300_mass100to150", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom300_mass100to150 = new TH1F("sig_h_offlineLRJ_Et_denom300_mass100to150", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_subleading_Et_num300_mass100to150 = new TH1F("sig_h_offlineLRJ_subleading_Et_num300_mass100to150", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_subleading_Et_denom300_mass100to150 = new TH1F("sig_h_offlineLRJ_subleading_Et_denom300_mass100to150", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num300_gFexLRJ = new TH1F("sig_h_offlineLRJ_Et_num300_gFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom300_gFexLRJ = new TH1F("sig_h_offlineLRJ_Et_denom300_gFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num300_jFexLRJ = new TH1F("sig_h_offlineLRJ_Et_num300_jFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom300_jFexLRJ = new TH1F("sig_h_offlineLRJ_Et_denom300_jFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num300_gFexLRJ_Dijet = new TH1F("sig_h_offlineLRJ_Et_num300_gFexLRJ_Dijet", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom300_gFexLRJ_Dijet = new TH1F("sig_h_offlineLRJ_Et_denom300_gFexLRJ_Dijet", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_Avg_b_Et_num300 = new TH1F("sig_h_Avg_b_Et_num300", "LRJ Et Distribution;Avg. b E_{T};Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_Avg_b_Et_denom300 = new TH1F("sig_h_Avg_b_Et_denom300", "LRJ Et Distribution;Avg. b E_{T};Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num350 = new TH1F("sig_h_offlineLRJ_Et_num350", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom350 = new TH1F("sig_h_offlineLRJ_Et_denom350", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num350_Dijet = new TH1F("sig_h_offlineLRJ_Et_num350_Dijet", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom350_Dijet = new TH1F("sig_h_offlineLRJ_Et_denom350_Dijet", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num350_1Subjet = new TH1F("sig_h_offlineLRJ_Et_num350_1Subjet", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom350_1Subjet = new TH1F("sig_h_offlineLRJ_Et_denom350_1Subjet", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num350_GrEq2Subjets = new TH1F("sig_h_offlineLRJ_Et_num350_GrEq2Subjets", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom350_GrEq2Subjets = new TH1F("sig_h_offlineLRJ_Et_denom350_GrEq2Subjets", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num350_mass100to150 = new TH1F("sig_h_offlineLRJ_Et_num350_mass100to150", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom350_mass100to150 = new TH1F("sig_h_offlineLRJ_Et_denom350_mass100to150", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_subleading_Et_num350_mass100to150 = new TH1F("sig_h_offlineLRJ_subleading_Et_num350_mass100to150", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_subleading_Et_denom350_mass100to150 = new TH1F("sig_h_offlineLRJ_subleading_Et_denom350_mass100to150", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num350_gFexLRJ = new TH1F("sig_h_offlineLRJ_Et_num350_gFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom350_gFexLRJ = new TH1F("sig_h_offlineLRJ_Et_denom350_gFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num350_jFexLRJ = new TH1F("sig_h_offlineLRJ_Et_num350_jFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom350_jFexLRJ = new TH1F("sig_h_offlineLRJ_Et_denom350_jFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num350_gFexLRJ_Dijet = new TH1F("sig_h_offlineLRJ_Et_num350_gFexLRJ_Dijet", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom350_gFexLRJ_Dijet = new TH1F("sig_h_offlineLRJ_Et_denom350_gFexLRJ_Dijet", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_Avg_b_Et_num350 = new TH1F("sig_h_Avg_b_Et_num350", "LRJ Et Distribution;Avg. b E_{T};Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_Avg_b_Et_denom350 = new TH1F("sig_h_Avg_b_Et_denom350", "LRJ Et Distribution;Avg. b E_{T};Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num400 = new TH1F("sig_h_offlineLRJ_Et_num400", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom400 = new TH1F("sig_h_offlineLRJ_Et_denom400", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num400_Dijet = new TH1F("sig_h_offlineLRJ_Et_num400_Dijet", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom400_Dijet = new TH1F("sig_h_offlineLRJ_Et_denom400_Dijet", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num400_1Subjet = new TH1F("sig_h_offlineLRJ_Et_num400_1Subjet", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom400_1Subjet = new TH1F("sig_h_offlineLRJ_Et_denom400_1Subjet", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num400_GrEq2Subjets = new TH1F("sig_h_offlineLRJ_Et_num400_GrEq2Subjets", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom400_GrEq2Subjets = new TH1F("sig_h_offlineLRJ_Et_denom400_GrEq2Subjets", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num400_mass100to150 = new TH1F("sig_h_offlineLRJ_Et_num400_mass100to150", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom400_mass100to150 = new TH1F("sig_h_offlineLRJ_Et_denom400_mass100to150", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_subleading_Et_num400_mass100to150 = new TH1F("sig_h_offlineLRJ_subleading_Et_num400_mass100to150", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_subleading_Et_denom400_mass100to150 = new TH1F("sig_h_offlineLRJ_subleading_Et_denom400_mass100to150", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num400_gFexLRJ = new TH1F("sig_h_offlineLRJ_Et_num400_gFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom400_gFexLRJ = new TH1F("sig_h_offlineLRJ_Et_denom400_gFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num400_jFexLRJ = new TH1F("sig_h_offlineLRJ_Et_num400_jFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom400_jFexLRJ = new TH1F("sig_h_offlineLRJ_Et_denom400_jFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num400_gFexLRJ_Dijet = new TH1F("sig_h_offlineLRJ_Et_num400_gFexLRJ_Dijet", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom400_gFexLRJ_Dijet = new TH1F("sig_h_offlineLRJ_Et_denom400_gFexLRJ_Dijet", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_Avg_b_Et_num400 = new TH1F("sig_h_Avg_b_Et_num400", "LRJ Et Distribution;Avg. b E_{T};Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_Avg_b_Et_denom400 = new TH1F("sig_h_Avg_b_Et_denom400", "LRJ Et Distribution;Avg. b E_{T};Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num450 = new TH1F("sig_h_offlineLRJ_Et_num450", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom450 = new TH1F("sig_h_offlineLRJ_Et_denom450", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num450_Dijet = new TH1F("sig_h_offlineLRJ_Et_num45_Dijet0", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom450_Dijet = new TH1F("sig_h_offlineLRJ_Et_denom450_Dijet", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num450_1Subjet = new TH1F("sig_h_offlineLRJ_Et_num450_1Subjet", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom450_1Subjet = new TH1F("sig_h_offlineLRJ_Et_denom450_1Subjet", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num450_GrEq2Subjets = new TH1F("sig_h_offlineLRJ_Et_num450_GrEq2Subjets", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom450_GrEq2Subjets = new TH1F("sig_h_offlineLRJ_Et_denom450_GrEq2Subjets", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num450_mass100to150 = new TH1F("sig_h_offlineLRJ_Et_num450_mass100to150", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom450_mass100to150 = new TH1F("sig_h_offlineLRJ_Et_denom450_mass100to150", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_subleading_Et_num450_mass100to150 = new TH1F("sig_h_offlineLRJ_subleading_Et_num450_mass100to150", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_subleading_Et_denom450_mass100to150 = new TH1F("sig_h_offlineLRJ_subleading_Et_denom450_mass100to150", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num450_gFexLRJ = new TH1F("sig_h_offlineLRJ_Et_num450_gFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom450_gFexLRJ = new TH1F("sig_h_offlineLRJ_Et_denom450_gFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num450_jFexLRJ = new TH1F("sig_h_offlineLRJ_Et_num450_jFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom450_jFexLRJ = new TH1F("sig_h_offlineLRJ_Et_denom450_jFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num450_gFexLRJ_Dijet = new TH1F("sig_h_offlineLRJ_Et_num450_gFexLRJ_Dijet", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom450_gFexLRJ_Dijet = new TH1F("sig_h_offlineLRJ_Et_denom450_gFexLRJ_Dijet", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_Avg_b_Et_num450 = new TH1F("sig_h_Avg_b_Et_num450", "LRJ Et Distribution;Avg. b E_{T};Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_Avg_b_Et_denom450 = new TH1F("sig_h_Avg_b_Et_denom450", "LRJ Et Distribution;Avg. b E_{T};Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num500 = new TH1F("sig_h_offlineLRJ_Et_num500", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom500 = new TH1F("sig_h_offlineLRJ_Et_denom500", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num500_Dijet = new TH1F("sig_h_offlineLRJ_Et_num500_Dijet", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom500_Dijet = new TH1F("sig_h_offlineLRJ_Et_denom500_Dijet", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num500_1Subjet = new TH1F("sig_h_offlineLRJ_Et_num500_1Subjet", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom500_1Subjet = new TH1F("sig_h_offlineLRJ_Et_denom500_1Subjet", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num500_GrEq2Subjets = new TH1F("sig_h_offlineLRJ_Et_num500_GrEq2Subjets", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom500_GrEq2Subjets = new TH1F("sig_h_offlineLRJ_Et_denom500_GrEq2Subjets", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num500_mass100to150 = new TH1F("sig_h_offlineLRJ_Et_num500_mass100to150", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom500_mass100to150 = new TH1F("sig_h_offlineLRJ_Et_denom500_mass100to150", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_subleading_Et_num500_mass100to150 = new TH1F("sig_h_offlineLRJ_subleading_Et_num500_mass100to150", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_subleading_Et_denom500_mass100to150 = new TH1F("sig_h_offlineLRJ_subleading_Et_denom500_mass100to150", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num500_gFexLRJ = new TH1F("sig_h_offlineLRJ_Et_num500_gFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom500_gFexLRJ = new TH1F("sig_h_offlineLRJ_Et_denom500_gFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num500_jFexLRJ = new TH1F("sig_h_offlineLRJ_Et_num500_jFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom500_jFexLRJ = new TH1F("sig_h_offlineLRJ_Et_denom500_jFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_offlineLRJ_Et_num500_gFexLRJ_Dijet = new TH1F("sig_h_offlineLRJ_Et_num500_gFexLRJ_Dijet", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_offlineLRJ_Et_denom500_gFexLRJ_Dijet = new TH1F("sig_h_offlineLRJ_Et_denom500_gFexLRJ_Dijet", "LRJ Et Distribution;Offline Subleading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    TH1F* sig_h_Avg_b_Et_num500 = new TH1F("sig_h_Avg_b_Et_num500", "LRJ Et Distribution;Avg. b E_{T};Emulated Trigger Efficiency (Signal)", 100, 0, 1000);
    TH1F* sig_h_Avg_b_Et_denom500 = new TH1F("sig_h_Avg_b_Et_denom500", "LRJ Et Distribution;Avg. b E_{T};Emulated Trigger Efficiency (Signal)", 100, 0, 1000);

    // Background trigger efficiencies (gFex, JetTagger)

    TH1F* back_h_offlineLRJ_Et_num50 = new TH1F("back_h_offlineLRJ_Et_num50", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);
    TH1F* back_h_offlineLRJ_Et_denom50 = new TH1F("back_h_offlineLRJ_Et_denom50", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);

    TH1F* back_h_offlineLRJ_Et_num50_gFexLRJ = new TH1F("back_h_offlineLRJ_Et_num50_gFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);
    TH1F* back_h_offlineLRJ_Et_denom50_gFexLRJ = new TH1F("back_h_offlineLRJ_Et_denom50_gFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);

    TH1F* back_h_offlineLRJ_Et_num50_jFexLRJ = new TH1F("back_h_offlineLRJ_Et_num50_jFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);
    TH1F* back_h_offlineLRJ_Et_denom50_jFexLRJ = new TH1F("back_h_offlineLRJ_Et_denom50_jFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);

    TH1F* back_h_offlineLRJ_Et_num100 = new TH1F("back_h_offlineLRJ_Et_num100", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);
    TH1F* back_h_offlineLRJ_Et_denom100 = new TH1F("back_h_offlineLRJ_Et_denom100", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);

    TH1F* back_h_offlineLRJ_Et_num100_gFexLRJ = new TH1F("back_h_offlineLRJ_Et_num100_gFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);
    TH1F* back_h_offlineLRJ_Et_denom100_gFexLRJ = new TH1F("back_h_offlineLRJ_Et_denom100_gFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);

    TH1F* back_h_offlineLRJ_Et_num100_jFexLRJ = new TH1F("back_h_offlineLRJ_Et_num100_jFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);
    TH1F* back_h_offlineLRJ_Et_denom100_jFexLRJ = new TH1F("back_h_offlineLRJ_Et_denom100_jFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);

    TH1F* back_h_offlineLRJ_Et_num100_1Subjet = new TH1F("back_h_offlineLRJ_Et_num100_1Subjet", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);
    TH1F* back_h_offlineLRJ_Et_denom100_1Subjet = new TH1F("back_h_offlineLRJ_Et_denom100_1Subjet", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);

    TH1F* back_h_offlineLRJ_Et_num100_GrEq2Subjets = new TH1F("back_h_offlineLRJ_Et_num100_GrEq2Subjets", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);
    TH1F* back_h_offlineLRJ_Et_denom100_GrEq2Subjets = new TH1F("back_h_offlineLRJ_Et_denom100_GrEq2Subjets", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);

    TH1F* back_h_offlineLRJ_Et_num150 = new TH1F("back_h_offlineLRJ_Et_num150", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);
    TH1F* back_h_offlineLRJ_Et_denom150 = new TH1F("back_h_offlineLRJ_Et_denom150", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);

    TH1F* back_h_offlineLRJ_Et_num150_gFexLRJ = new TH1F("back_h_offlineLRJ_Et_num150_gFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);
    TH1F* back_h_offlineLRJ_Et_denom150_gFexLRJ = new TH1F("back_h_offlineLRJ_Et_denom150_gFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);

    TH1F* back_h_offlineLRJ_Et_num150_jFexLRJ = new TH1F("back_h_offlineLRJ_Et_num150_jFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);
    TH1F* back_h_offlineLRJ_Et_denom150_jFexLRJ = new TH1F("back_h_offlineLRJ_Et_denom150_jFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);

    TH1F* back_h_offlineLRJ_Et_num200 = new TH1F("back_h_offlineLRJ_Et_num200", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);
    TH1F* back_h_offlineLRJ_Et_denom200 = new TH1F("back_h_offlineLRJ_Et_denom200", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);

    TH1F* back_h_offlineLRJ_Et_num200_gFexLRJ = new TH1F("back_h_offlineLRJ_Et_num200_gFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);
    TH1F* back_h_offlineLRJ_Et_denom200_gFexLRJ = new TH1F("back_h_offlineLRJ_Et_denom200_gFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);

    TH1F* back_h_offlineLRJ_Et_num200_jFexLRJ = new TH1F("back_h_offlineLRJ_Et_num200_jFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);
    TH1F* back_h_offlineLRJ_Et_denom200_jFexLRJ = new TH1F("back_h_offlineLRJ_Et_denom200_jFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);

    TH1F* back_h_offlineLRJ_Et_num200_1Subjet = new TH1F("back_h_offlineLRJ_Et_num200_1Subjet", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);
    TH1F* back_h_offlineLRJ_Et_denom200_1Subjet = new TH1F("back_h_offlineLRJ_Et_denom200_1Subjet", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);

    TH1F* back_h_offlineLRJ_Et_num200_GrEq2Subjets = new TH1F("back_h_offlineLRJ_Et_num200_GrEq2Subjets", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);
    TH1F* back_h_offlineLRJ_Et_denom200_GrEq2Subjets = new TH1F("back_h_offlineLRJ_Et_denom200_GrEq2Subjets", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);

    TH1F* back_h_offlineLRJ_Et_num250 = new TH1F("back_h_offlineLRJ_Et_num250", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);
    TH1F* back_h_offlineLRJ_Et_denom250 = new TH1F("back_h_offlineLRJ_Et_denom250", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);

    TH1F* back_h_offlineLRJ_Et_num250_gFexLRJ = new TH1F("back_h_offlineLRJ_Et_num250_gFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);
    TH1F* back_h_offlineLRJ_Et_denom250_gFexLRJ = new TH1F("back_h_offlineLRJ_Et_denom250_gFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);

    TH1F* back_h_offlineLRJ_Et_num250_jFexLRJ = new TH1F("back_h_offlineLRJ_Et_num250_jFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);
    TH1F* back_h_offlineLRJ_Et_denom250_jFexLRJ = new TH1F("back_h_offlineLRJ_Et_denom250_jFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);

    TH1F* back_h_offlineLRJ_Et_num300 = new TH1F("back_h_offlineLRJ_Et_num300", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);
    TH1F* back_h_offlineLRJ_Et_denom300 = new TH1F("back_h_offlineLRJ_Et_denom300", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);

    TH1F* back_h_offlineLRJ_Et_num300_gFexLRJ = new TH1F("back_h_offlineLRJ_Et_num300_gFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);
    TH1F* back_h_offlineLRJ_Et_denom300_gFexLRJ = new TH1F("back_h_offlineLRJ_Et_denom300_gFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);

    TH1F* back_h_offlineLRJ_Et_num300_jFexLRJ = new TH1F("back_h_offlineLRJ_Et_num300_jFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);
    TH1F* back_h_offlineLRJ_Et_denom300_jFexLRJ = new TH1F("back_h_offlineLRJ_Et_denom300_jFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);

    TH1F* back_h_offlineLRJ_Et_num300_1Subjet = new TH1F("back_h_offlineLRJ_Et_num300_1Subjet", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);
    TH1F* back_h_offlineLRJ_Et_denom300_1Subjet = new TH1F("back_h_offlineLRJ_Et_denom300_1Subjet", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);

    TH1F* back_h_offlineLRJ_Et_num300_GrEq2Subjets = new TH1F("back_h_offlineLRJ_Et_num300_GrEq2Subjets", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);
    TH1F* back_h_offlineLRJ_Et_denom300_GrEq2Subjets = new TH1F("back_h_offlineLRJ_Et_denom300_GrEq2Subjets", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);

    TH1F* back_h_offlineLRJ_Et_num350 = new TH1F("back_h_offlineLRJ_Et_num350", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);
    TH1F* back_h_offlineLRJ_Et_denom350 = new TH1F("back_h_offlineLRJ_Et_denom350", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);

    TH1F* back_h_offlineLRJ_Et_num350_gFexLRJ = new TH1F("back_h_offlineLRJ_Et_num350_gFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);
    TH1F* back_h_offlineLRJ_Et_denom350_gFexLRJ = new TH1F("back_h_offlineLRJ_Et_denom350_gFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);

    TH1F* back_h_offlineLRJ_Et_num350_jFexLRJ = new TH1F("back_h_offlineLRJ_Et_num350_jFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);
    TH1F* back_h_offlineLRJ_Et_denom350_jFexLRJ = new TH1F("back_h_offlineLRJ_Et_denom350_jFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);

    TH1F* back_h_offlineLRJ_Et_num400 = new TH1F("back_h_offlineLRJ_Et_num400", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);
    TH1F* back_h_offlineLRJ_Et_denom400 = new TH1F("back_h_offlineLRJ_Et_denom400", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);

    TH1F* back_h_offlineLRJ_Et_num400_gFexLRJ = new TH1F("back_h_offlineLRJ_Et_num400_gFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);
    TH1F* back_h_offlineLRJ_Et_denom400_gFexLRJ = new TH1F("back_h_offlineLRJ_Et_denom400_gFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);

    TH1F* back_h_offlineLRJ_Et_num400_jFexLRJ = new TH1F("back_h_offlineLRJ_Et_num400_jFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);
    TH1F* back_h_offlineLRJ_Et_denom400_jFexLRJ = new TH1F("back_h_offlineLRJ_Et_denom400_jFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);

    TH1F* back_h_offlineLRJ_Et_num450 = new TH1F("back_h_offlineLRJ_Et_num450", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);
    TH1F* back_h_offlineLRJ_Et_denom450 = new TH1F("back_h_offlineLRJ_Et_denom450", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);

    TH1F* back_h_offlineLRJ_Et_num450_gFexLRJ = new TH1F("back_h_offlineLRJ_Et_num450_gFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);
    TH1F* back_h_offlineLRJ_Et_denom450_gFexLRJ = new TH1F("back_h_offlineLRJ_Et_denom450_gFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);

    TH1F* back_h_offlineLRJ_Et_num450_jFexLRJ = new TH1F("back_h_offlineLRJ_Et_num450_jFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);
    TH1F* back_h_offlineLRJ_Et_denom450_jFexLRJ = new TH1F("back_h_offlineLRJ_Et_denom450_jFexLRJ", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)", 45, 50, 500);

    TH1F* sig_h_Mjj = new TH1F("sig_h_Mjj", "Invariant Mass of 2 LRJs;Invariant Mass of 2 LRJs [GeV]; % Events / 20 GeV", 75, 0, 1500);

    TH2F *sigTopo422Highest128SeedPositionsEv0 = new TH2F("sigTopo422Highest128SeedPositionsEv0", "Sum of Topo422 E_{T} in Each Bin; #eta;#phi", 
                        100, -5, 5,   
                        64, -3.2, 3.2);  

    std::vector<std::pair<double, double > > jFexSeedPositionsSigEv0;
    std::vector<std::pair<double, double > > jFexAdditionalSRJPositionsSigEv0;
    std::vector<std::pair<double, double > > newSeedPositionsSigEv0;
    std::vector<std::pair<double, double  > > gFexLRJPositionSigEv0;
    std::vector<std::pair<double, double  > > offlineLRJPositionSigEv0;
    std::vector<double > sigLRJEtEv0;
    std::vector<double > sigLRJPsi_REv0;
    std::vector<double > siggFexLRJEtEv0;
    std::vector<double > sigOfflineLRJEtEv0;

    TH2F *sigTopo422Highest128SeedPositionsEv1 = new TH2F("sigTopo422Highest128SeedPositionsEv1", "Sum of Topo422 E_{T} in Each Bin; #eta;#phi", 
                        100, -5, 5,   
                        64, -3.2, 3.2);  

    std::vector<std::pair<double, double  > > jFexSeedPositionsSigEv1;
    std::vector<std::pair<double, double  > > jFexAdditionalSRJPositionsSigEv1;
    std::vector<std::pair<double, double  > > newSeedPositionsSigEv1;
    std::vector<std::pair<double, double  > > gFexLRJPositionSigEv1;
    std::vector<std::pair<double, double  > > offlineLRJPositionSigEv1;
    std::vector<double > sigLRJEtEv1;
    std::vector<double > sigLRJPsi_REv1;
    std::vector<double > siggFexLRJEtEv1;
    std::vector<double > sigOfflineLRJEtEv1;

    TH2F *sigTopo422Highest128SeedPositionsEv2 = new TH2F("sigTopo422Highest128SeedPositionsEv2", "Sum of Topo422 E_{T} in Each Bin; #eta;#phi", 
                        100, -5, 5,   
                        64, -3.2, 3.2);  
    
    std::vector<std::pair<double, double  > > jFexSeedPositionsSigEv2;
    std::vector<std::pair<double, double  > > jFexAdditionalSRJPositionsSigEv2;
    std::vector<std::pair<double, double  > > newSeedPositionsSigEv2;
    std::vector<std::pair<double, double  > > gFexLRJPositionSigEv2;
    std::vector<std::pair<double, double  > > offlineLRJPositionSigEv2;
    std::vector<double > sigLRJEtEv2;
    std::vector<double > sigLRJPsi_REv2;
    std::vector<double > siggFexLRJEtEv2;
    std::vector<double > sigOfflineLRJEtEv2;

    TH2F *sigTopo422Highest128SeedPositionsEv3 = new TH2F("sigTopo422Highest128SeedPositionsEv3", "Sum of Topo422 E_{T} in Each Bin; #eta;#phi", 
                        100, -5, 5,   
                        64, -3.2, 3.2);  

    std::vector<std::pair<double, double  > > jFexSeedPositionsSigEv3;
    std::vector<std::pair<double, double  > > jFexAdditionalSRJPositionsSigEv3;
    std::vector<std::pair<double, double  > > newSeedPositionsSigEv3;
    std::vector<std::pair<double, double  > > gFexLRJPositionSigEv3;
    std::vector<std::pair<double, double  > > offlineLRJPositionSigEv3;
    std::vector<double > sigLRJEtEv3;
    std::vector<double > sigLRJPsi_REv3;
    std::vector<double > siggFexLRJEtEv3;
    std::vector<double > sigOfflineLRJEtEv3;

    TH2F *sigTopo422Highest128SeedPositionsEv4 = new TH2F("sigTopo422Highest128SeedPositionsEv4", "Sum of Topo422 E_{T} in Each Bin; #eta;#phi", 
                        100, -5, 5,   
                        64, -3.2, 3.2);  

    std::vector<std::pair<double, double  > > jFexSeedPositionsSigEv4;
    std::vector<std::pair<double, double  > > jFexAdditionalSRJPositionsSigEv4;
    std::vector<std::pair<double, double  > > newSeedPositionsSigEv4;
    std::vector<std::pair<double, double  > > gFexLRJPositionSigEv4;
    std::vector<std::pair<double, double  > > offlineLRJPositionSigEv4;
    std::vector<double > sigLRJEtEv4;
    std::vector<double > sigLRJPsi_REv4;
    std::vector<double > siggFexLRJEtEv4;
    std::vector<double > sigOfflineLRJEtEv4;

    TH1F* back_h_LRJ_substruct = new TH1F("back_h_LRJ_substruct", "LRJ 'Diameter';LRJ 'Diameter';% of LRJs / ~0.03", 32, 0, 1);
    TH2F *backDiamvsEt = new TH2F("backDiamvsEt", "Sum of Topo422 E_{T} in Each Bin; LRJ E_{T} [GeV];LRJ 'Diameter'", 
                        20, 0, 800,   
                        32, 0, 1.0);  
    TH1F* back_h_LRJ_Et = new TH1F("back_h_LRJ_Et", "LRJ Et Distribution;E_{T} [GeV];% of LRJs / 50 GeV", 16, 0, 800);
    TH1F* back_h_leading_LRJ_Et = new TH1F("back_h_leading_LRJ_Et", "Leading LRJ Et Distribution;E_{T} [GeV];% of Leading LRJs", rateVsEffBins.size() - 1, rateVsEffBins.data());
    TH1F* back_h_subleading_LRJ_Et = new TH1F("back_h_subleading_LRJ_Et", "Subleading LRJ Et Distribution;E_{T} [GeV];% of Subleading LRJs", rateVsEffBins.size() - 1, rateVsEffBins.data());

    TH1F* back_h_leading_LRJ_Et_normalbinning = new TH1F("back_h_leading_LRJ_Et_normalbinning", "Leading LRJ Et Distribution;E_{T} [GeV];% of Leading LRJs / 25 GeV", 41, 0, 1025);
    TH1F* back_h_subleading_LRJ_Et_normalbinning = new TH1F("back_h_subleading_LRJ_Et_normalbinning", "Subleading LRJ Et Distribution;E_{T} [GeV];% of Subleading LRJs / 25 GeV", 41, 0, 1025);

    TH1F* back_h_gFEX_leading_LRJ_Et = new TH1F("back_h_gFEX_leading_LRJ_Et", "Leading LRJ Et Distribution;E_{T} [GeV];% of Leading LRJs / 25 GeV", rateVsEffBins.size() - 1, rateVsEffBins.data());
    TH1F* back_h_gFEX_subleading_LRJ_Et = new TH1F("back_h_gFEX_subleading_LRJ_Et", "Subleading LRJ Et Distribution;E_{T} [GeV];% of Subleading LRJs / 25 GeV", rateVsEffBins.size() - 1, rateVsEffBins.data());

    TH1F* back_h_jFEX_leading_LRJ_Et = new TH1F("back_h_jFEX_leading_LRJ_Et", "Leading LRJ Et Distribution;E_{T} [GeV];% of Leading LRJs / 25 GeV", rateVsEffBins.size() - 1, rateVsEffBins.data());
    TH1F* back_h_jFEX_subleading_LRJ_Et = new TH1F("back_h_jFEX_subleading_LRJ_Et", "Subleading LRJ Et Distribution;E_{T} [GeV];% of Subleading LRJs / 25 GeV", rateVsEffBins.size() - 1, rateVsEffBins.data());

    TH1F* back_h_offlineLRJ_Et = new TH1F("back_h_offlineLRJ_Et", "LRJ Et Distribution;E_{T} [GeV];% of Offline LRJs / 50 GeV", 16, 0, 800);
    TH1F* back_h_leading_offlineLRJ_Et = new TH1F("back_h_leading_offlineLRJ_Et", "Leading LRJ Et Distribution;Leading Offline LRJ E_{T} [GeV];% of Leading Offline LRJs / 50 GeV", 16, 0, 800);
    TH1F* back_h_subleading_offlineLRJ_Et = new TH1F("back_h_subleading_offlineLRJ_Et", "Subleading LRJ Et Distribution;E_{T} [GeV];% of Subleading Offline LRJs / 50 GeV", 16, 0, 800);

    TH1F* back_h_leading_WTA_conecellstowers_pT = new TH1F("back_h_leading_WTA_conecellstowers_pT", "Leading LRJ pT Distribution;Lead. WTA Cone CellsTowers Jet p_{T} [GeV];% of Leading WTA Cone CellsTowers Jets / 25 GeV", 32, 0, 800);
    TH1F* back_h_subleading_WTA_conecellstowers_pT = new TH1F("back_h_subleading_WTA_conecellstowers_pT", "Subleading LRJ pT Distribution;Sublead. Cone CellsTowers Jet p_{T} [GeV];% of Subleading WTACone CellsTowers Jets / 25 GeV", 32, 0, 800);

    TH1F* back_h_leading_WTA_conebasicclusters_pT = new TH1F("back_h_leading_WTA_conebasicclusters_pT", "Leading LRJ pT Distribution;Lead. WTA Cone BasicClusters Jet p_{T} [GeV];% of Leading WTA Cone BasicClusters Jets / 25 GeV", 32, 0, 800);
    TH1F* back_h_subleading_WTA_conebasicclusters_pT = new TH1F("back_h_subleading_WTA_conebasicclusters_pT", "Subleading LRJ pT Distribution;Sublead. WTA Cone BasicClusters Jet p_{T} [GeV];% of Subleading WTA Cone BasicClusters Jets / 25 GeV", 32, 0, 800);

    TH1F* back_h_WTA_conecellstowers_multiplicity = new TH1F("back_h_WTA_conecellstowers_multiplicity", "Leading LRJ pT Distribution;Num. Cone WTA CellsTowers Jets / Event; Fraction of Events ", 25, 0, 25);
    TH1F* back_h_WTA_conebasicclusters_multiplicity = new TH1F("back_h_WTA_conebasicclusters_multiplicity", "Leading LRJ pT Distribution;Num. WTA Cone BasicCluster Jets / Event; Fraction of Events ", 25, 0, 25);

    TH1F* back_h_LRJ_E = new TH1F("back_h_LRJ_E", "LRJ Et Distribution;Energy [GeV];% of LRJs / 10 GeV", 100, 0, 1000);
    TH1F* back_h_LRJ_eta = new TH1F("back_h_LRJ_eta", "LRJ Eta Distribution;#eta;Counts", 50, -5, 5);
    TH1F* back_h_LRJ_phi = new TH1F("back_h_LRJ_phi", "LRJ Phi Distribution;#phi;Counts", 32, -3.2, 3.2);

    TH1F* back_h_leading_LRJ_gFexLRJ_deltaEt = new TH1F("back_h_leading_LRJ_gFexLRJ_deltaEt", "#Delta E_{T} Leading gFex LRJ, Output LRJ, ;#Delta E_{T} (gFex - JetTagger) [GeV];% of Leading LRJs / 10 GeV", 50, -350, 150);
    TH1F* back_h_leading_LRJ_offlineLRJ_deltaEt = new TH1F("back_h_leading_LRJ_offlineLRJ_deltaEt", "#Delta E_{T} Leading Offline LRJ, Output LRJ, ;#Delta E_{T} (Offline - JetTagger) [GeV];% of Leading LRJs / 10 GeV",  50, -150, 350);

    TH1F* back_h_leading_offlineLRJ_gFexLRJ_deltaEt = new TH1F("back_h_leading_offlineLRJ_gFexLRJ_deltaEt", "#Delta E_{T} Leading gFex LRJ, Output LRJ, ;#Delta E_{T} (Offline - gFEX) [GeV];% of Leading LRJs / 10 GeV", 50, -150, 350);
    TH1F* back_h_leading_offlineLRJ_jFexLRJ_deltaEt = new TH1F("back_h_leading_offlineLRJ_jFexLRJ_deltaEt", "#Delta E_{T} Leading gFex LRJ, Output LRJ, ;#Delta E_{T} (Offline - gFEX) [GeV];% of Leading LRJs / 10 GeV", 50, -150, 350);

    TH1F* back_h_leading_LRJ_gFexLRJ_Et_resolution = new TH1F("back_h_leading_LRJ_gFexLRJ_Et_resolution", "#Delta E_{T} Leading gFex LRJ, Output LRJ, ;#Delta E_{T} (gFEX - JetTagger) / E_{T, gFEX} [GeV];% of Leading LRJs / 0.1", 40, -2, 2);
    TH1F* back_h_leading_LRJ_offlineLRJ_Et_resolution = new TH1F("back_h_leading_LRJ_offlineLRJ_Et_resolution", "#Delta E_{T} Leading Offline LRJ, Output LRJ, ;#Delta E_{T} (Offline - JetTagger) / E_{T, Offline} [GeV];% of Leading LRJs / 0.1", 20, -1, 1);

    TH1F* back_h_leading_offlineLRJ_gFexLRJ_Et_resolution = new TH1F("back_h_leading_offlineLRJ_gFexLRJ_Et_resolution", "#Delta E_{T} Leading gFex LRJ, Output LRJ, ;#Delta E_{T} (Offline - gFEX) / E_{T, Offline} [GeV];% of Leading LRJs / 0.1", 50, -3.5, 1.5);
    TH1F* back_h_leading_offlineLRJ_jFexLRJ_Et_resolution = new TH1F("back_h_leading_offlineLRJ_jFexLRJ_Et_resolution", "#Delta E_{T} Leading gFex LRJ, Output LRJ, ;#Delta E_{T} (Offline - jFEX) / E_{T, Offline} [GeV];% of Leading LRJs / 0.1", 40, -3, 1);

    TH1F* back_h_leading_LRJ_gFexLRJ_deltaR = new TH1F("back_h_leading_LRJ_gFexLRJ_deltaR", "#Delta R Leading gFex LRJ, Output LRJ, ;#Delta R (gFex, JetTagger);% of Leading LRJs / 0.1", 50, 0, 5);
    TH1F* back_h_leading_LRJ_offlineLRJ_deltaR = new TH1F("back_h_leading_LRJ_offlineLRJ_deltaR", "#Delta R Leading Offline LRJ, Output LRJ, ;#Delta R (Offline, JetTagger);% of Leading LRJs / 0.1", 50, 0, 5);

    TH1F* back_h_first_LRJ_jFexSRJ_deltaR = new TH1F("back_h_first_LRJ_jFexSRJ_deltaR", "#Delta R Leading jFex SRJ, Output LRJ, ;#Delta R (Lead. jFex SRJ, JetTagger LRJ);% of Leading LRJs / 0.1", 50, 0, 5);
    TH1F* back_h_second_LRJ_jFexSRJ_deltaR = new TH1F("back_h_second_LRJ_jFexSRJ_deltaR", "#Delta R Subleading jFex SRJ, Output LRJ, ;#Delta R (Sublead. jFex SRJ, JetTagger LRJ);% of Leading LRJs / 0.1", 50, 0, 5);

    TH1F* back_h_lead_sublead_LRJ_deltaR = new TH1F("back_h_lead_sublead_LRJ_deltaR", "#Delta R Leading, Subleading LRJ, ;#Delta R (Lead., Sublead. Output LRJ);% of Leading LRJs / 0.1", 50, 0, 5);

    TH1F* back_h_Mjj = new TH1F("back_h_Mjj", "Invariant Mass of 2 LRJs;Invariant Mass of 2 LRJs [GeV]; % Events / 20 GeV", 75, 0, 1500);

    TH2F *backTopo422Highest128SeedPositionsEv0 = new TH2F("backTopo422Highest128SeedPositionsEv0", "Sum of Topo422 E_{T} in Each Bin; #eta;#phi", 
                        100, -5, 5,   
                        64, -3.2, 3.2);  

    std::vector<std::pair<double, double > > jFexSeedPositionsBackEv0;
    std::vector<std::pair<double, double > > jFexAdditionalSRJPositionsBackEv0;
    std::vector<std::pair<double, double > > newSeedPositionsBackEv0;
    std::vector<double > backLRJEtEv0;
    std::vector<double > backLRJPsi_REv0;

    TH2F *backTopo422Highest128SeedPositionsEv1 = new TH2F("backTopo422Highest128SeedPositionsEv1", "Sum of Topo422 E_{T} in Each Bin; #eta;#phi", 
                        100, -5, 5,   
                        64, -3.2, 3.2);  

    std::vector<std::pair<double, double  > > jFexSeedPositionsBackEv1;
    std::vector<std::pair<double, double  > > jFexAdditionalSRJPositionsBackEv1;
    std::vector<std::pair<double, double  > > newSeedPositionsBackEv1;
    std::vector<double > backLRJEtEv1;
    std::vector<double > backLRJPsi_REv1;

    TH2F *backTopo422Highest128SeedPositionsEv2 = new TH2F("backTopo422Highest128SeedPositionsEv2", "Sum of Topo422 E_{T} in Each Bin; #eta;#phi", 
                        100, -5, 5,   
                        64, -3.2, 3.2);  
    
    std::vector<std::pair<double, double  > > jFexSeedPositionsBackEv2;
    std::vector<std::pair<double, double  > > jFexAdditionalSRJPositionsBackEv2;
    std::vector<std::pair<double, double  > > newSeedPositionsBackEv2;
    std::vector<double > backLRJEtEv2;
    std::vector<double > backLRJPsi_REv2;

    TH2F *backTopo422Highest128SeedPositionsEv3 = new TH2F("backTopo422Highest128SeedPositionsEv3", "Sum of Topo422 E_{T} in Each Bin; #eta;#phi", 
                        100, -5, 5,   
                        64, -3.2, 3.2);  

    std::vector<std::pair<double, double  > > jFexSeedPositionsBackEv3;
    std::vector<std::pair<double, double  > > jFexAdditionalSRJPositionsBackEv3;
    std::vector<std::pair<double, double  > > newSeedPositionsBackEv3;
    std::vector<double > backLRJEtEv3;
    std::vector<double > backLRJPsi_REv3;

    TH2F *backTopo422Highest128SeedPositionsEv4 = new TH2F("backTopo422Highest128SeedPositionsEv4", "Sum of Topo422 E_{T} in Each Bin; #eta;#phi", 
                        100, -5, 5,   
                        64, -3.2, 3.2);  

    std::vector<std::pair<double, double  > > jFexSeedPositionsBackEv4;
    std::vector<std::pair<double, double  > > jFexAdditionalSRJPositionsBackEv4;
    std::vector<std::pair<double, double  > > newSeedPositionsBackEv4;
    std::vector<double > backLRJEtEv4;
    std::vector<double > backLRJPsi_REv4;

    //if (fileIt > 0) break;
    std::cout << "-------------------------------------" << "\n";
    std::cout << "processing next file" << "\n";
    std::cout << "signal file name: " << signalRootFileNames[fileIt] << "\n";
    vector<vector<double> > sig_LRJ_Et(num_processed_events_signal);
    vector<vector<double> > back_LRJ_Et(num_processed_events_background);

    vector<vector<double> > sig_leading_LRJ_Et(num_processed_events_signal);
    vector<vector<double> > back_leading_LRJ_Et(num_processed_events_background);

    vector<vector<double> > sig_subleading_LRJ_Et(num_processed_events_signal);
    vector<vector<double> > back_subleading_LRJ_Et(num_processed_events_background);

    vector<vector<double> > sig_LRJ_Eta(num_processed_events_signal);
    vector<vector<double> > back_LRJ_Eta(num_processed_events_background);

    vector<vector<double> > sig_LRJ_Phi(num_processed_events_signal);
    vector<vector<double> > back_LRJ_Phi(num_processed_events_background);
    //std::cout << "fileIt : " << fileIt << "\n";
    // Find position of "largeR"
    std::string key = "14TeV_";
    size_t pos = signalRootFileNames[fileIt].find(key); // Use signal root file names to distinguish between different signals --> not overwritten

    if (pos != std::string::npos) {
        // Start after "largeR"
        size_t start = pos + key.length();
        
        // Remove .dat by finding its position
        size_t end =  signalRootFileNames[fileIt].rfind(".root");

        if (end != std::string::npos && end > start) {
            algorithmConfigurations.push_back( signalRootFileNames[fileIt].substr(start, end - start));
            //std::cout << "Extracted string: " << backgroundRootFileNames[fileIt].substr(start, end - start) << std::endl;
        } else {
            std::cerr << ".root not found or too early in string.\n";
        }
    } else {
        std::cerr << "\"16130_\" not found in string.\n";
    }

    /// FILEIT LOOP HERE

    std::ifstream sig_infile(signalRootFileNames[fileIt]);
    std::ifstream back_infile(backgroundRootFileNames[fileIt]);
    //std::cout << "processing: " << signalRootFileNames[fileIt] << " and: " << backgroundRootFileNames[fileIt] << "\n";
    if (!sig_infile.is_open()) { 
        std::cerr << "Error: Could not open file " << signalRootFileNames[fileIt] << std::endl;
        return;
    }
    if (!back_infile.is_open()){
        std::cerr << "Error: Could not open file " << backgroundRootFileNames[fileIt] << std::endl;
        return;
    }
    
    for(unsigned int iEvt = 0; iEvt < num_processed_events_signal; iEvt ++ ){
        jetTaggerLRJsSignal->GetEntry(iEvt);
        jetTaggerLeadingLRJsSignal->GetEntry(iEvt);
        jetTaggerSubleadingLRJsSignal->GetEntry(iEvt);
        gFexLeadingLRJTreeSignal->GetEntry(iEvt);
        gFexSubleadingLRJTreeSignal->GetEntry(iEvt);
        jFexLeadingLRJTreeSignal->GetEntry(iEvt);
        jFexSubleadingLRJTreeSignal->GetEntry(iEvt);


        sig_h_leading_LRJ_Et->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0));
        sig_h_subleading_LRJ_Et->Fill(jetTaggerSubleadingLRJEtValuesSignal->at(0));

        sig_h_leading_LRJ_Et_normalbinning->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0));
        sig_h_subleading_LRJ_Et_normalbinning->Fill(jetTaggerSubleadingLRJEtValuesSignal->at(0));

        sig_h_gFEX_leading_LRJ_Et->Fill(gFexLRJLeadingEtValuesSignal->at(0)); 
        sig_h_gFEX_subleading_LRJ_Et->Fill(gFexLRJSubleadingEtValuesSignal->at(0)); 

        if(jFexLRJLeadingEtValuesSignal->size() > 0) sig_h_jFEX_leading_LRJ_Et->Fill(jFexLRJLeadingEtValuesSignal->at(0)); 
        if(jFexLRJSubleadingEtValuesSignal->size() > 0) sig_h_jFEX_subleading_LRJ_Et->Fill(jFexLRJSubleadingEtValuesSignal->at(0));
        
        for(unsigned int iSigLRJ = 0; iSigLRJ < jetTaggerLRJPsi_RValuesSignal->size(); iSigLRJ++){
            sig_h_LRJ_substruct->Fill(jetTaggerLRJPsi_RValuesSignal->at(iSigLRJ)); 
            sigDiamvsEt->Fill(jetTaggerLRJEtValuesSignal->at(iSigLRJ), jetTaggerLRJPsi_RValuesSignal->at(iSigLRJ));
            sig_h_LRJ_Et->Fill(jetTaggerLRJEtValuesSignal->at(iSigLRJ));
            sig_h_LRJ_E->Fill(jetTaggerLRJEtValuesSignal->at(iSigLRJ) * cosh(jetTaggerLRJEtaValuesSignal->at(iSigLRJ)));
            sig_LRJ_Et[iEvt].push_back(jetTaggerLRJEtValuesSignal->at(iSigLRJ));
            sig_LRJ_Eta[iEvt].push_back(jetTaggerLRJEtaValuesSignal->at(iSigLRJ));
            sig_LRJ_Phi[iEvt].push_back(jetTaggerLRJPhiValuesSignal->at(iSigLRJ));
            sig_h_LRJ_eta->Fill(jetTaggerLRJEtaValuesSignal->at(iSigLRJ));
            sig_h_LRJ_phi->Fill(jetTaggerLRJPhiValuesSignal->at(iSigLRJ));
        }
    }

    
    for(unsigned int iEvt = 0; iEvt < num_processed_events_background; iEvt ++ ){ 
        jetTaggerLRJsBack->GetEntry(iEvt);
        jetTaggerLeadingLRJsBack->GetEntry(iEvt);
        jetTaggerSubleadingLRJsBack->GetEntry(iEvt);
        gFexLeadingLRJTreeBack->GetEntry(iEvt);
        gFexSubleadingLRJTreeBack->GetEntry(iEvt);
        jFexLeadingLRJTreeBack->GetEntry(iEvt);
        jFexSubleadingLRJTreeBack->GetEntry(iEvt);

        eventInfoTreeBack->GetEntry(iEvt);

        double backgroundEventWeight = eventWeightsValuesBack->at(0);

        sumOfBackgroundEventWeight += backgroundEventWeight;

        back_h_leading_LRJ_Et->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), backgroundEventWeight); 
        back_h_subleading_LRJ_Et->Fill(jetTaggerSubleadingLRJEtValuesBack->at(0), backgroundEventWeight);

        back_h_leading_LRJ_Et_normalbinning->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), backgroundEventWeight); 
        back_h_subleading_LRJ_Et_normalbinning->Fill(jetTaggerSubleadingLRJEtValuesBack->at(0), backgroundEventWeight);

        back_h_gFEX_leading_LRJ_Et->Fill(gFexLRJLeadingEtValuesBack->at(0), backgroundEventWeight); 
        back_h_gFEX_subleading_LRJ_Et->Fill(gFexLRJSubleadingEtValuesBack->at(0), backgroundEventWeight); 

        if(jFexLRJLeadingEtValuesBack->size() > 0) back_h_jFEX_leading_LRJ_Et->Fill(jFexLRJLeadingEtValuesBack->at(0), backgroundEventWeight); 
        if(jFexLRJSubleadingEtValuesBack->size() > 0) back_h_jFEX_subleading_LRJ_Et->Fill(jFexLRJSubleadingEtValuesBack->at(0), backgroundEventWeight); 

        for(unsigned int iBackLRJ = 0; iBackLRJ < jetTaggerLRJPsi_RValuesBack->size(); iBackLRJ++){
            back_h_LRJ_substruct->Fill(jetTaggerLRJPsi_RValuesBack->at(iBackLRJ), backgroundEventWeight);
            backDiamvsEt->Fill(jetTaggerLRJEtValuesBack->at(iBackLRJ), jetTaggerLRJPsi_RValuesBack->at(iBackLRJ), backgroundEventWeight);
            back_h_LRJ_Et->Fill(jetTaggerLRJEtValuesBack->at(iBackLRJ), backgroundEventWeight);
            back_h_LRJ_E->Fill(jetTaggerLRJEtValuesBack->at(iBackLRJ) * cosh(jetTaggerLRJEtaValuesBack->at(iBackLRJ)), backgroundEventWeight);
            back_LRJ_Et[iEvt].push_back(jetTaggerLRJEtValuesBack->at(iBackLRJ));
            back_LRJ_Eta[iEvt].push_back(jetTaggerLRJEtaValuesBack->at(iBackLRJ));
            back_LRJ_Phi[iEvt].push_back(jetTaggerLRJPhiValuesBack->at(iBackLRJ));
            back_h_LRJ_eta->Fill(jetTaggerLRJPhiValuesBack->at(iBackLRJ), backgroundEventWeight);
            back_h_LRJ_phi->Fill(jetTaggerLRJEtaValuesBack->at(iBackLRJ), backgroundEventWeight);
        }
    }
        
    // ---- helpers --------------------------------------------------------------
    auto SetAxes = [](TAxis* ax, const char* title) {
    ax->SetTitle(title);
    ax->SetTitleFont(42);
    ax->SetLabelFont(42);
    ax->SetTitleSize(0.05);
    ax->SetLabelSize(0.05);
    ax->SetTitleColor(kBlack);
    ax->SetLabelColor(kBlack);
    ax->SetNdivisions(510);
    ax->SetTitleOffset(1.25);
    };
    std::string subjetEtString;
    if(subjetEtThreshold == 15.0) subjetEtString = "_15GeVSubjets/";
    else if(subjetEtThreshold == 10.0) subjetEtString = "_10GeVSubjets/";
    else if(subjetEtThreshold == 20.0) subjetEtString = "_20GeVSubjets/";
    else if(subjetEtThreshold == 25.0) subjetEtString = "_25GeVSubjets/";
    else if(subjetEtThreshold == 30.0) subjetEtString = "_30GeVSubjets/";
    else if(subjetEtThreshold == 35.0) subjetEtString = "_35GeVSubjets/";
    TString rateVsEffFileDir = "rateVsEff/" + algorithmConfigurations[fileIt] + subjetEtString;

    gSystem->mkdir(rateVsEffFileDir);

    // ---- LEADING --------------------------------------------------------------
    auto out = MakeRateVsEff(sig_h_leading_LRJ_Et, back_h_leading_LRJ_Et);

    // Titles & colors for TH1s
    SetAxes(out.hEff_vsThr ->GetXaxis(), "Leading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out.hEff_vsThr ->GetYaxis(), "Signal (hh#rightarrow4b) Efficiency");
    SetAxes(out.hRate_vsThr->GetXaxis(), "Leading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out.hRate_vsThr->GetYaxis(), "Estimated Background Rate [Hz]");

    // Titles & colors for TGraph
    SetAxes(out.gRate_vsEff->GetXaxis(), "Signal (hh#rightarrow4b) Efficiency");
    SetAxes(out.gRate_vsEff->GetYaxis(), "Estimated Background Rate [Hz]");

    //lead_ET_Scan_RatesVsEff_vec.push_back(out.gRate_vsEff); // this didn't work - c++ being annoying with pointers
    lead_ET_Scan_RatesVsEff_vec.push_back(
        (TGraph*) out.gRate_vsEff->Clone(
            Form("%s_clone_%u", out.gRate_vsEff->GetName(), fileIt)
        )
    );
    lead_ET_Scan_EffVsThresh_vec.push_back(out.hEff_vsThr);
    lead_ET_Scan_RateVsThresh_vec.push_back(out.hRate_vsThr);

    // Optional: vs-threshold views
    auto c1 = new TCanvas("c1","vs threshold",1200,500);
    c1->Divide(2,1);
    c1->cd(1);
    gPad->SetLeftMargin(0.16); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    out.hEff_vsThr->Draw("HIST");  // draw as histogram
    c1->cd(2);
    gPad->SetLeftMargin(0.16); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    gPad->SetLogy();
    out.hRate_vsThr->Draw("HIST");
    c1->SaveAs(rateVsEffFileDir + "threshold_views.pdf");

    // Main plot: rate vs efficiency (graph)
    auto c2 = new TCanvas("c2","Rate vs Eff",700,600);
    c2->SetLeftMargin(0.16); c2->SetBottomMargin(0.16); c2->SetTicks(1,1);
    c2->SetLogy();
    out.gRate_vsEff->Draw("AP");   // A=axes, P=points
    c2->SaveAs(rateVsEffFileDir + "rate_vs_eff.pdf");

    // Compute 10 kHz rate E_T cut:
    double jetTagger_10kHz_Threshold_Leading = FindThrForRate(out.hRate_vsThr, 10000.0);
    jetTagger_10kHz_Threshold_Leading_vec.push_back(jetTagger_10kHz_Threshold_Leading);

    // ---- SUBLEADING -----------------------------------------------------------
    auto out_subleading = MakeRateVsEff(sig_h_subleading_LRJ_Et, back_h_subleading_LRJ_Et);

    double jetTagger_10kHz_Threshold_Subleading = FindThrForRate(out_subleading.hRate_vsThr, 10000.0);
    jetTagger_10kHz_Threshold_Subleading_vec.push_back(jetTagger_10kHz_Threshold_Subleading);

    // TH1s
    SetAxes(out_subleading.hEff_vsThr ->GetXaxis(), "Subleading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out_subleading.hEff_vsThr ->GetYaxis(), "Signal (hh#rightarrow4b) Efficiency");
    SetAxes(out_subleading.hRate_vsThr->GetXaxis(), "Subleading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out_subleading.hRate_vsThr->GetYaxis(), "Estimated Background Rate [Hz]");

    // Graph
    SetAxes(out_subleading.gRate_vsEff->GetXaxis(), "Signal (hh#rightarrow4b) Efficiency");
    SetAxes(out_subleading.gRate_vsEff->GetYaxis(), "Estimated Background Rate [Hz]");

    //sublead_ET_Scan_RatesVsEff_vec.push_back(out_subleading.gRate_vsEff);
    sublead_ET_Scan_RatesVsEff_vec.push_back(
        (TGraph*) out_subleading.gRate_vsEff->Clone(
            Form("%s_clone_%u", out_subleading.gRate_vsEff->GetName(), fileIt)
        )
    );
    sublead_ET_Scan_EffVsThresh_vec.push_back(out_subleading.hEff_vsThr);
    sublead_ET_Scan_RateVsThresh_vec.push_back(out_subleading.hRate_vsThr);

    // Optional: vs-threshold views
    auto c1_subleading = new TCanvas("c1_subleading","vs threshold",1200,500);
    c1_subleading->Divide(2,1);
    c1_subleading->cd(1);
    gPad->SetLeftMargin(0.16); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    out_subleading.hEff_vsThr->Draw("HIST");
    c1_subleading->cd(2);
    gPad->SetLeftMargin(0.16); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    gPad->SetLogy();
    out_subleading.hRate_vsThr->Draw("HIST");
    c1_subleading->SaveAs(rateVsEffFileDir + "threshold_views_subleading.pdf");

    // Main plot
    auto c2_subleading = new TCanvas("c2_subleading","Rate vs Eff",700,600);
    c2_subleading->SetLeftMargin(0.16); c2_subleading->SetBottomMargin(0.16); c2_subleading->SetTicks(1,1);
    c2_subleading->SetLogy();
    out_subleading.gRate_vsEff->Draw("AP");
    c2_subleading->SaveAs(rateVsEffFileDir + "rate_vs_eff_subleading.pdf");



    // ---- gFEX LEADING --------------------------------------------------------------
    auto out_gFEX_leading = MakeRateVsEff(sig_h_gFEX_leading_LRJ_Et, back_h_gFEX_leading_LRJ_Et);

    // Titles & colors for TH1s
    SetAxes(out_gFEX_leading.hEff_vsThr ->GetXaxis(), "Leading gFEX LRJ E_{T} threshold [GeV]");
    SetAxes(out_gFEX_leading.hEff_vsThr ->GetYaxis(), "Signal (hh#rightarrow4b) Efficiency");
    SetAxes(out_gFEX_leading.hRate_vsThr->GetXaxis(), "Leading gFEX LRJ E_{T} threshold [GeV]");
    SetAxes(out_gFEX_leading.hRate_vsThr->GetYaxis(), "Estimated Background Rate [Hz]");

    // Titles & colors for TGraph
    SetAxes(out_gFEX_leading.gRate_vsEff->GetXaxis(), "Signal (hh#rightarrow4b) Efficiency");
    SetAxes(out_gFEX_leading.gRate_vsEff->GetYaxis(), "Estimated Background Rate [Hz]");

    // Optional: vs-threshold views
    auto c1_gFEX_leading = new TCanvas("c1_gFEX_leading","vs threshold",1200,500);
    c1_gFEX_leading->Divide(2,1);
    c1_gFEX_leading->cd(1);
    gPad->SetLeftMargin(0.16); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    out_gFEX_leading.hEff_vsThr->Draw("HIST");  // draw as histogram
    c1_gFEX_leading->cd(2);
    gPad->SetLeftMargin(0.16); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    gPad->SetLogy();
    out_gFEX_leading.hRate_vsThr->Draw("HIST");
    c1_gFEX_leading->SaveAs(rateVsEffFileDir + "threshold_views_gfex_leading.pdf");

    // Main plot: rate vs efficiency (graph)
    auto c2_gFEX_leading = new TCanvas("c2_gFEX_leading","Rate vs Eff",700,600);
    c2_gFEX_leading->SetLeftMargin(0.16); c2_gFEX_leading->SetBottomMargin(0.16); c2_gFEX_leading->SetTicks(1,1);
    c2_gFEX_leading->SetLogy();
    out_gFEX_leading.gRate_vsEff->Draw("AP");   // A=axes, P=points
    c2_gFEX_leading->SaveAs(rateVsEffFileDir + "rate_vs_eff_gfex_leading.pdf");

    // Compute 10 kHz rate E_T cut:
    double gFEX_10kHz_Threshold_Leading = FindThrForRate(out_gFEX_leading.hRate_vsThr, 10000.0);


    // ---- jFEX LEADING --------------------------------------------------------------
    auto out_jFEX_leading = MakeRateVsEff(sig_h_jFEX_leading_LRJ_Et, back_h_jFEX_leading_LRJ_Et);

    // Titles & colors for TH1s
    SetAxes(out_jFEX_leading.hEff_vsThr ->GetXaxis(), "Leading jFEX LRJ E_{T} threshold [GeV]");
    SetAxes(out_jFEX_leading.hEff_vsThr ->GetYaxis(), "Signal (hh#rightarrow4b) Efficiency");
    SetAxes(out_jFEX_leading.hRate_vsThr->GetXaxis(), "Leading jFEX LRJ E_{T} threshold [GeV]");
    SetAxes(out_jFEX_leading.hRate_vsThr->GetYaxis(), "Estimated Background Rate [Hz]");

    // Titles & colors for TGraph
    SetAxes(out_jFEX_leading.gRate_vsEff->GetXaxis(), "Signal (hh#rightarrow4b) Efficiency");
    SetAxes(out_jFEX_leading.gRate_vsEff->GetYaxis(), "Estimated Background Rate [Hz]");

    // Optional: vs-threshold views
    auto c1_jFEX_leading = new TCanvas("c1_jFEX_leading","vs threshold",1200,500);
    c1_jFEX_leading->Divide(2,1);
    c1_jFEX_leading->cd(1);
    gPad->SetLeftMargin(0.16); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    out_jFEX_leading.hEff_vsThr->Draw("HIST");  // draw as histogram
    c1_jFEX_leading->cd(2);
    gPad->SetLeftMargin(0.16); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    gPad->SetLogy();
    out_jFEX_leading.hRate_vsThr->Draw("HIST");
    c1_jFEX_leading->SaveAs(rateVsEffFileDir + "threshold_views_jFEX_leading.pdf");

    // Main plot: rate vs efficiency (graph)
    auto c2_jFEX_leading = new TCanvas("c2_jFEX_leading","Rate vs Eff",700,600);
    c2_jFEX_leading->SetLeftMargin(0.16); c2_jFEX_leading->SetBottomMargin(0.16); c2_jFEX_leading->SetTicks(1,1);
    c2_jFEX_leading->SetLogy();
    out_jFEX_leading.gRate_vsEff->Draw("AP");   // A=axes, P=points
    c2_jFEX_leading->SaveAs(rateVsEffFileDir + "rate_vs_eff_jFEX_leading.pdf");

    // Compute 10 kHz rate E_T cut:
    double jFEX_10kHz_Threshold_Leading = FindThrForRate(out_jFEX_leading.hRate_vsThr, 10000.0);

    // ---- gFEX SUBLEADING --------------------------------------------------------------
    auto out_gFEX_subleading = MakeRateVsEff(sig_h_gFEX_subleading_LRJ_Et, back_h_gFEX_subleading_LRJ_Et);

    double gFEX_10kHz_Threshold_Subleading = FindThrForRate(out_gFEX_subleading.hRate_vsThr, 10000.0);

    // Titles & colors for TH1s
    SetAxes(out_gFEX_subleading.hEff_vsThr ->GetXaxis(), "Subleading gFEX LRJ E_{T} threshold [GeV]");
    SetAxes(out_gFEX_subleading.hEff_vsThr ->GetYaxis(), "Signal (hh#rightarrow4b) Efficiency");
    SetAxes(out_gFEX_subleading.hRate_vsThr->GetXaxis(), "Subleading gFEX LRJ E_{T} threshold [GeV]");
    SetAxes(out_gFEX_subleading.hRate_vsThr->GetYaxis(), "Estimated Background Rate [Hz]");

    // Titles & colors for TGraph
    SetAxes(out_gFEX_subleading.gRate_vsEff->GetXaxis(), "Signal (hh#rightarrow4b) Efficiency");
    SetAxes(out_gFEX_subleading.gRate_vsEff->GetYaxis(), "Estimated Background Rate [Hz]");

    // Optional: vs-threshold views
    auto c1_gFEX_subleading = new TCanvas("c1_gFEX_subleading","vs threshold",1200,500);
    c1_gFEX_subleading->Divide(2,1);
    c1_gFEX_subleading->cd(1);
    gPad->SetLeftMargin(0.16); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    out_gFEX_subleading.hEff_vsThr->Draw("HIST");  // draw as histogram
    c1_gFEX_subleading->cd(2);
    gPad->SetLeftMargin(0.16); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    gPad->SetLogy();
    out_gFEX_subleading.hRate_vsThr->Draw("HIST");
    c1_gFEX_subleading->SaveAs(rateVsEffFileDir + "threshold_views_gfex_subleading.pdf");

    // Main plot: rate vs efficiency (graph)
    auto c2_gFEX_subleading = new TCanvas("c2_gFEX_subleading","Rate vs Eff",700,600);
    c2_gFEX_subleading->SetLeftMargin(0.16); c2_gFEX_subleading->SetBottomMargin(0.16); c2_gFEX_subleading->SetTicks(1,1);
    c2_gFEX_subleading->SetLogy();
    out_gFEX_subleading.gRate_vsEff->Draw("AP");   // A=axes, P=points
    c2_gFEX_subleading->SaveAs(rateVsEffFileDir + "rate_vs_eff_gfex_subleading.pdf");

    // ---- jFEX SUBLEADING --------------------------------------------------------------
    auto out_jFEX_subleading = MakeRateVsEff(sig_h_jFEX_subleading_LRJ_Et, back_h_jFEX_subleading_LRJ_Et);

    // Titles & colors for TH1s
    SetAxes(out_jFEX_subleading.hEff_vsThr ->GetXaxis(), "Subleading jFEX LRJ E_{T} threshold [GeV]");
    SetAxes(out_jFEX_subleading.hEff_vsThr ->GetYaxis(), "Signal (hh#rightarrow4b) Efficiency");
    SetAxes(out_jFEX_subleading.hRate_vsThr->GetXaxis(), "Subleading jFEX LRJ E_{T} threshold [GeV]");
    SetAxes(out_jFEX_subleading.hRate_vsThr->GetYaxis(), "Estimated Background Rate [Hz]");

    // Titles & colors for TGraph
    SetAxes(out_jFEX_subleading.gRate_vsEff->GetXaxis(), "Signal (hh#rightarrow4b) Efficiency");
    SetAxes(out_jFEX_subleading.gRate_vsEff->GetYaxis(), "Estimated Background Rate [Hz]");

    // Optional: vs-threshold views
    auto c1_jFEX_subleading = new TCanvas("c1_jFEX_subleading","vs threshold",1200,500);
    c1_jFEX_subleading->Divide(2,1);
    c1_jFEX_subleading->cd(1);
    gPad->SetLeftMargin(0.16); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    out_jFEX_subleading.hEff_vsThr->Draw("HIST");  // draw as histogram
    c1_jFEX_subleading->cd(2);
    gPad->SetLeftMargin(0.16); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    gPad->SetLogy();
    out_jFEX_subleading.hRate_vsThr->Draw("HIST");
    c1_jFEX_subleading->SaveAs(rateVsEffFileDir + "threshold_views_jFEX_subleading.pdf");

    // Main plot: rate vs efficiency (graph)
    auto c2_jFEX_subleading = new TCanvas("c2_jFEX_subleading","Rate vs Eff",700,600);
    c2_jFEX_subleading->SetLeftMargin(0.16); c2_jFEX_subleading->SetBottomMargin(0.16); c2_jFEX_subleading->SetTicks(1,1);
    c2_jFEX_subleading->SetLogy();
    out_jFEX_subleading.gRate_vsEff->Draw("AP");   // A=axes, P=points
    c2_jFEX_subleading->SaveAs(rateVsEffFileDir + "rate_vs_eff_jFEX_subleading.pdf");


    // ******************** OVERLAYS (LEADING only): JetTagger vs gFEX vs jFEX ********************
    // Colors/markers per algorithm
    const Int_t cols[3]    = { kBlack, kRed+1, kBlue+1 };
    const Int_t mstyles[3] = { 20, 21, 22 };
    const char* labels[3]  = { "JetTagger LRJ", "gFEX LRJ", "jFEX LRJ" };

    // Convenience handles
    TH1*   effH [3] = { out.hEff_vsThr,        out_gFEX_leading.hEff_vsThr,        out_jFEX_leading.hEff_vsThr };
    TH1*   rateH[3] = { out.hRate_vsThr,       out_gFEX_leading.hRate_vsThr,       out_jFEX_leading.hRate_vsThr };
    TGraph* rocG[3] = { out.gRate_vsEff,       out_gFEX_leading.gRate_vsEff,       out_jFEX_leading.gRate_vsEff };

    // ---------- Overlay: Efficiency/Rate vs Threshold ----------
    auto cLeadThrOverlay = new TCanvas("cLeadThrOverlay","Leading: thresholds overlay",1200,500);
    cLeadThrOverlay->Divide(2,1);

    // Left pad: efficiency vs threshold
    cLeadThrOverlay->cd(1);
    gPad->SetLeftMargin(0.16); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);

    for (int i=0;i<2;++i) {
        effH[i]->SetLineColor(cols[i]);
        effH[i]->SetLineWidth(2);
    }
    // draw first to create axes with titles already set on JetTagger hist
    effH[0]->GetXaxis()->SetTitle("Leading LRJ E_{T} Threshold [GeV]");
    effH[0]->Draw("HIST");
    effH[1]->Draw("HIST SAME");
    //effH[2]->Draw("HIST SAME");

    // legend (eff)
    auto legEff = new TLegend(0.55,0.72,0.88,0.88);
    legEff->SetBorderSize(0); legEff->SetFillStyle(0); legEff->SetTextSize(0.04);
    legEff->AddEntry(effH[0], labels[0], "l");
    legEff->AddEntry(effH[1], labels[1], "l");
    //legEff->AddEntry(effH[2], labels[2], "l");
    legEff->Draw();

    // Right pad: rate vs threshold
    cLeadThrOverlay->cd(2);
    gPad->SetLeftMargin(0.16); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    gPad->SetLogy();

    for (int i=0;i<2;++i) {
        rateH[i]->SetLineColor(cols[i]);
        rateH[i]->SetLineWidth(2);
    }
    rateH[0]->GetXaxis()->SetTitle("Leading LRJ E_{T} Threshold [GeV]");
    rateH[0]->Draw("HIST");
    rateH[1]->Draw("HIST SAME");
    //rateH[2]->Draw("HIST SAME");

    // legend (rate)
    auto legRate = new TLegend(0.55,0.72,0.88,0.88);
    legRate->SetBorderSize(0); legRate->SetFillStyle(0); legRate->SetTextSize(0.04);
    legRate->AddEntry(rateH[0], labels[0], "l");
    legRate->AddEntry(rateH[1], labels[1], "l");
    //legRate->AddEntry(rateH[2], labels[2], "l");
    legRate->Draw();

    cLeadThrOverlay->SaveAs(rateVsEffFileDir + "leading_threshold_overlays.pdf");

    // ---------- Overlay: Rate vs Efficiency (ROC-like) ----------
    auto cLeadRocOverlay = new TCanvas("cLeadRocOverlay","Leading: rate vs eff overlay",700,600);
    cLeadRocOverlay->SetLeftMargin(0.16); cLeadRocOverlay->SetBottomMargin(0.16);
    cLeadRocOverlay->SetTicks(1,1);
    cLeadRocOverlay->SetLogy();

    // style graphs
    for (int i=0;i<3;++i) {
        rocG[i]->SetMarkerStyle(mstyles[i]);
        rocG[i]->SetMarkerSize(1.1);
        rocG[i]->SetMarkerColor(cols[i]);
        rocG[i]->SetLineColor(cols[i]);
        rocG[i]->SetLineWidth(2);
    }

    // draw first one with axes, others with SAME
    rocG[0]->Draw("AP");     // axes + points
    rocG[1]->Draw("P SAME");
    rocG[2]->Draw("P SAME");

    // legend (roc)
    auto legROC = new TLegend(0.53,0.37,0.86,0.53);
    legROC->SetBorderSize(0); legROC->SetFillStyle(0); legROC->SetTextSize(0.04);
    legROC->AddEntry(rocG[0], labels[0], "lp");
    legROC->AddEntry(rocG[1], labels[1], "lp");
    legROC->AddEntry(rocG[2], labels[2], "lp");
    legROC->Draw();

    cLeadRocOverlay->SaveAs(rateVsEffFileDir + "leading_rate_vs_eff_overlay.pdf");

    // ******************** OVERLAYS (SUBLEADING): JetTagger vs gFEX vs jFEX ********************
    // Convenience handles (SUBLEADING)
    TH1*    effH_sub [2] = { out_subleading.hEff_vsThr,        out_gFEX_subleading.hEff_vsThr};
    TH1*    rateH_sub[2] = { out_subleading.hRate_vsThr,       out_gFEX_subleading.hRate_vsThr};
    TGraph* rocG_sub [2] = { out_subleading.gRate_vsEff,       out_gFEX_subleading.gRate_vsEff};

    // ---------- Overlay: Efficiency/Rate vs Threshold ----------
    auto cSubLeadThrOverlay = new TCanvas("cSubLeadThrOverlay","Subleading: thresholds overlay",1200,500);
    cSubLeadThrOverlay->Divide(2,1);

    // Left pad: efficiency vs threshold
    cSubLeadThrOverlay->cd(1);
    gPad->SetLeftMargin(0.16); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);

    for (int i=0;i<2;++i) {
        effH_sub[i]->SetLineColor(cols[i]);
        effH_sub[i]->SetLineWidth(2);
    }
    // draw first to set axes; override X title to emphasize subleading
    effH_sub[0]->GetXaxis()->SetTitle("Subleading LRJ E_{T} Threshold [GeV]");
    effH_sub[0]->GetYaxis()->SetTitle("Signal (hh#rightarrow4b) Efficiency");
    effH_sub[0]->Draw("HIST");
    effH_sub[1]->Draw("HIST SAME");

    // legend (eff)
    auto legEff_sub = new TLegend(0.55,0.72,0.88,0.88);
    legEff_sub->SetBorderSize(0); legEff_sub->SetFillStyle(0); legEff_sub->SetTextSize(0.04);
    legEff_sub->AddEntry(effH_sub[0], labels[0], "l");
    legEff_sub->AddEntry(effH_sub[1], labels[1], "l");
    legEff_sub->Draw();

    // Right pad: rate vs threshold
    cSubLeadThrOverlay->cd(2);
    gPad->SetLeftMargin(0.16); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    gPad->SetLogy();

    for (int i=0;i<2;++i) {
        rateH_sub[i]->SetLineColor(cols[i]);
        rateH_sub[i]->SetLineWidth(2);
    }
    rateH_sub[0]->GetXaxis()->SetTitle("Subleading LRJ E_{T} Threshold [GeV]");
    rateH_sub[0]->GetYaxis()->SetTitle("Estimated Background Rate [Hz]");
    rateH_sub[0]->Draw("HIST");
    rateH_sub[1]->Draw("HIST SAME");

    // legend (rate)
    auto legRate_sub = new TLegend(0.55,0.72,0.88,0.88);
    legRate_sub->SetBorderSize(0); legRate_sub->SetFillStyle(0); legRate_sub->SetTextSize(0.04);
    legRate_sub->AddEntry(rateH_sub[0], labels[0], "l");
    legRate_sub->AddEntry(rateH_sub[1], labels[1], "l");
    legRate_sub->Draw();

    cSubLeadThrOverlay->SaveAs(rateVsEffFileDir + "subleading_threshold_overlays.pdf");

    // ---------- Overlay: Rate vs Efficiency (ROC-like) ----------
    auto cSubLeadRocOverlay = new TCanvas("cSubLeadRocOverlay","Subleading: rate vs eff overlay",700,600);
    cSubLeadRocOverlay->SetLeftMargin(0.16); cSubLeadRocOverlay->SetBottomMargin(0.16);
    cSubLeadRocOverlay->SetTicks(1,1);
    cSubLeadRocOverlay->SetLogy();

    // style graphs
    for (int i=0;i<2;++i) {
        rocG_sub[i]->SetMarkerStyle(mstyles[i]);
        rocG_sub[i]->SetMarkerSize(1.1);
        rocG_sub[i]->SetMarkerColor(cols[i]);
        rocG_sub[i]->SetLineColor(cols[i]);
        rocG_sub[i]->SetLineWidth(2);
    }

    // draw first one with axes, others with SAME; set axes titles for clarity
    rocG_sub[0]->Draw("AP");
    rocG_sub[0]->GetXaxis()->SetTitle("Signal (hh#rightarrow4b) Efficiency");
    rocG_sub[0]->GetYaxis()->SetTitle("Estimated Background Rate [Hz]");
    rocG_sub[1]->Draw("P SAME");

    // legend (roc)
    auto legROC_sub = new TLegend(0.53,0.37,0.86,0.53);
    legROC_sub->SetBorderSize(0); legROC_sub->SetFillStyle(0); legROC_sub->SetTextSize(0.04);
    legROC_sub->AddEntry(rocG_sub[0], labels[0], "lp");
    legROC_sub->AddEntry(rocG_sub[1], labels[1], "lp");
    legROC_sub->Draw();

    cSubLeadRocOverlay->SaveAs(rateVsEffFileDir + "subleading_rate_vs_eff_overlay.pdf");

    // ================== COMBINED OVERLAY: Rate vs Efficiency (all 6) ==================
    // Curves: (JetTagger, gFEX, jFEX)  (Leading, Subleading)
    // Uses: out, out_subleading, out_gFEX_leading, out_gFEX_subleading, out_jFEX_leading, out_jFEX_subleading

    // ---- Style palette ----
    // Colors per algorithm
    const Int_t algoCols[2] = { kBlack, kRed+1}; // JetTagger, gFEX, jFEX

    // Marker styles: leading vs subleading per algorithm
    const Int_t mLead [2] = { 20, 21};  // solid markers
    const Int_t mSub  [2] = { 24, 25};  // open markers

    // Line styles: leading=solid, subleading=dashed
    const Int_t lLead = 1;
    const Int_t lSub  = 2;

    // Labels
    const char* algoNames[2] = { "JetTagger LRJ", "gFEX LRJ"};

    // Convenience handles (rate vs eff graphs)
    TGraph* gLead[2] = { out.gRate_vsEff,            out_gFEX_leading.gRate_vsEff};
    TGraph* gSub [2] = { out_subleading.gRate_vsEff, out_gFEX_subleading.gRate_vsEff};

    // ---- Canvas ----
    auto cAllROC = new TCanvas("cAllROC","Rate vs Efficiency: Leading & Subleading (All Algos)",800,650);
    cAllROC->SetLeftMargin(0.16); 
    cAllROC->SetBottomMargin(0.16);
    cAllROC->SetTicks(1,1);
    cAllROC->SetLogy();

    // ---- Style & draw ----
    // Well draw the first curve with axes ("AP"), then all others as "P SAME"
    bool firstDrawn = false;

    // (A) Leading first (solid)
    for (int i=0; i<2; ++i) {
        if (!gLead[i]) continue;
        gLead[i]->SetMarkerStyle(mLead[i]);
        gLead[i]->SetMarkerSize(1.1);
        gLead[i]->SetMarkerColor(algoCols[i]);
        gLead[i]->SetLineColor(algoCols[i]);
        gLead[i]->SetLineStyle(lLead);
        gLead[i]->SetLineWidth(2);

        if (!firstDrawn) {
            gLead[i]->Draw("AP"); // axes + points for the very first
            gLead[i]->GetXaxis()->SetTitle("Signal (hh#rightarrow4b) Efficiency");
            gLead[i]->GetYaxis()->SetTitle("Estimated Background Rate [Hz]");
            // Optional axis cosmetics
            gLead[i]->GetXaxis()->SetTitleOffset(1.2);
            gLead[i]->GetYaxis()->SetTitleOffset(1.6);

            // (optional) Y-range on log axis for clarity  adjust as needed
            gLead[i]->SetMinimum(1e-1); // show down to 0.1 Hz
            // gLead[i]->SetMaximum(1e5); // uncomment/adjust if you want an explicit ceiling

            firstDrawn = true;
        } else {
            gLead[i]->Draw("P SAME");
        }
    }

    // (B) Subleading next (dashed)
    for (int i=0; i<2; ++i) {
        if (!gSub[i]) continue;
        gSub[i]->SetMarkerStyle(mSub[i]);
        gSub[i]->SetMarkerSize(1.1);
        gSub[i]->SetMarkerColor(algoCols[i]);
        gSub[i]->SetLineColor(algoCols[i]);
        gSub[i]->SetLineStyle(lSub);
        gSub[i]->SetLineWidth(2);
        gSub[i]->Draw("P SAME");
    }

    // ---- Legend ----
    // Two-column legend grouping by algorithm, showing leading vs subleading
    auto legAll = new TLegend(0.38, 0.20, 0.78, 0.42); // adjust position if needed
    legAll->SetBorderSize(0);
    legAll->SetFillStyle(0);
    legAll->SetTextSize(0.035);

    // Add algorithm-specific entries
    for (int i=0; i<2; ++i) {
        // Leading entry
        auto eL = legAll->AddEntry(gLead[i], Form("%s (leading)",   algoNames[i]), "lp");
        // Subleading entry
        auto eS = legAll->AddEntry(gSub[i],  Form("%s (subleading)",algoNames[i]), "lp");
    }
    legAll->Draw();

    cAllROC->Update();  // make sure pad/axes are defined

    // Horizontal line at 10 kHz
    double xmin = gPad->GetUxmin();
    double xmax = gPad->GetUxmax();

    TLine *hline10k = new TLine(xmin, 1e4, xmax, 1e4);
    hline10k->SetLineColor(kGray + 2);
    hline10k->SetLineStyle(2);
    hline10k->SetLineWidth(2);
    hline10k->Draw("SAME");

    // Vertical line at the best point near 10 kHz
    // (here using the leading JetTagger curve gLead[0]; change index if desired)
    if (gLead[0]) {
        auto best10k = FindBestPointBelowRate(gLead[0], 1e4);
        double bestEff  = best10k.first;
        double bestRate = best10k.second;

        std::cout << "Best leading JetTagger point near 10 kHz: "
                    << "eff = " << bestEff << ", rate = " << bestRate << std::endl;

        double ymin = gPad->GetUymin();
        double ymax = gPad->GetUymax();

        TLine *vline10k = new TLine(bestEff, ymin, bestEff, 1e4);
        vline10k->SetLineColor(kGray + 2);
        vline10k->SetLineStyle(2);
        vline10k->SetLineWidth(2);
        vline10k->Draw("SAME");
    }

    // ---- Save ----
    gPad->RedrawAxis();
    cAllROC->SaveAs(rateVsEffFileDir + "all_algos_leading_subleading_rate_vs_eff_overlay.pdf");

    // initialize with size and zero-fill
    std::vector<unsigned int> nSubjetsLeadingLRJSignal(
        num_processed_events_signal, 0);

    std::vector<unsigned int> nSubjetsSubleadingLRJSignal(
        num_processed_events_signal, 0);

    std::vector<unsigned int> nOfflineSubjetsLeadingLRJSignal(
        num_processed_events_signal, 0);
    for (unsigned int i = 0; i < num_processed_events_signal; i++) {
        //std::cout << "signal event: " << i << "\n";

        jetTaggerLRJsSignal->GetEntry(i);
        jetTaggerLeadingLRJsSignal->GetEntry(i);
        jetTaggerSubleadingLRJsSignal->GetEntry(i);
        subleadingRecoAntiKt10UFOCSSKJetsSignal->GetEntry(i);
        leadingRecoAntiKt10UFOCSSKJetsSignal->GetEntry(i);
        truthAntiKt4TruthDressedWZJetsSignal->GetEntry(i);
        leadingTruthAntiKt4TruthDressedWZJetsSignal->GetEntry(i);
        subleadingTruthAntiKt4TruthDressedWZJetsSignal->GetEntry(i);
        gFexLeadingLRJTreeSignal->GetEntry(i);
        jFexLeadingLRJTreeSignal->GetEntry(i);
        jFexLeadingSRJTreeSignal->GetEntry(i);
        jFexSubleadingSRJTreeSignal->GetEntry(i);
        gFexSubleadingLRJTreeSignal->GetEntry(i);
        topo422TreeSignal->GetEntry(i);
        gepBasicClustersTreeSignal->GetEntry(i);
        gepCellsTowersTreeSignal->GetEntry(i);
        gepCellsTowersSKTreeSignal->GetEntry(i);
        gepWTAConeCellsTowersJetsTreeSignal->GetEntry(i);
        gepWTAConeBasicClustersJetsTreeSignal->GetEntry(i);
        gepLeadingWTAConeCellsTowersJetsTreeSignal->GetEntry(i);
        gepLeadingWTAConeBasicClustersJetsTreeSignal->GetEntry(i);
        gepSubleadingWTAConeCellsTowersJetsTreeSignal->GetEntry(i);
        gepSubleadingWTAConeBasicClustersJetsTreeSignal->GetEntry(i);
        truthbTreeSignal->GetEntry(i);
        truthHiggsTreeSignal->GetEntry(i);
        jFexSRJTreeSignal->GetEntry(i);
        truthbTreeSignal->GetEntry(i);

        unsigned int nonZeroEtCounter = 0;    
        for(unsigned int iTower = 0; iTower < gepCellsTowersSKEtValuesSignal->size(); iTower++){
            if(gepCellsTowersSKEtValuesSignal->at(iTower) > 0) nonZeroEtCounter++;
        }
        //std::cout << "signl nonZeroEtCounter: " << nonZeroEtCounter << "\n";
        sig_h_JetTagger_CellTowerSK_Multiplicity->Fill(nonZeroEtCounter); 
        if(truthAntiKt4WZSRJLeadingEtaValuesSignal->size() > 0 && truthAntiKt4WZSRJSubleadingEtaValuesSignal->size() > 0) sigDeltaRLeadingSubleadingTruthJets->Fill(sqrt(calcDeltaR2(truthAntiKt4WZSRJLeadingEtaValuesSignal->at(0), truthAntiKt4WZSRJLeadingPhiValuesSignal->at(0), truthAntiKt4WZSRJSubleadingEtaValuesSignal->at(0), truthAntiKt4WZSRJSubleadingPhiValuesSignal->at(0))));
        
        double jetTaggerLeadingEta = jetTaggerLeadingLRJEtaValuesSignal->at(0);
        double jetTaggerLeadingPhi= jetTaggerLeadingLRJEtaValuesSignal->at(0);
        double jetTaggerSubleadingEta = jetTaggerSubleadingLRJEtaValuesSignal->at(0);
        double jetTaggerSubleadingPhi= jetTaggerSubleadingLRJEtaValuesSignal->at(0);
        // Find subjets (jFEX and cone jets) - first for leading JetTagger jet
        std::vector<std::array<double, 3 > > leadingJetTaggerjFEXSubjets; // indexed by Et, Eta, Phi
        std::vector<std::array<double, 3 > > subleadingJetTaggerjFEXSubjets;
        std::vector<std::array<double, 3 > > leadingJetTaggerConeCellsTowersSubjets; 
        std::vector<std::array<double, 3 > > subleadingJetTaggerConeCellsTowersSubjets;
        double nsubjetinessSubjetEtThreshold = subjetEtThreshold; // GeV
        unsigned int nSubjetjFEXJetTaggerLeading = 0;
        unsigned int nSubjetConeCellsTowersJetTaggerLeading = 0;
        unsigned int nSubjetjFEXJetTaggerSubleading = 0;
        unsigned int nSubjetConeCellsTowersJetTaggerSubleading = 0;
        for(unsigned int iSubjet = 0; iSubjet < jFexSRJEtaValuesSignal->size(); iSubjet++ ){ 
            double deltaRJetTaggerSubjet = sqrt(calcDeltaR2(jetTaggerLeadingLRJEtaValuesSignal->at(0), jetTaggerLeadingLRJPhiValuesSignal->at(0), jFexSRJEtaValuesSignal->at(iSubjet), jFexSRJPhiValuesSignal->at(iSubjet))); // FIXME ensure delta R threshold is dynamically calculated from algorithm configuration
            if(deltaRJetTaggerSubjet < jetRadius && jFexSRJEtValuesSignal->at(iSubjet) > nsubjetinessSubjetEtThreshold){ // FIXME ensure delta R threshold is dynamically calculated from algorithm configuration
                nSubjetjFEXJetTaggerLeading++;
                leadingJetTaggerjFEXSubjets.push_back({jFexSRJEtValuesSignal->at(iSubjet), jFexSRJEtaValuesSignal->at(iSubjet), jFexSRJPhiValuesSignal->at(iSubjet)});
            }
        }
        for(unsigned int iSubjet = 0; iSubjet < gepWTAConeCellsTowersJetsEtaValuesSignal->size(); iSubjet++ ){
            double deltaRJetTaggerSubjet = sqrt(calcDeltaR2(jetTaggerLeadingLRJEtaValuesSignal->at(0), jetTaggerLeadingLRJPhiValuesSignal->at(0), gepWTAConeCellsTowersJetsEtaValuesSignal->at(iSubjet), gepWTAConeCellsTowersJetsPhiValuesSignal->at(iSubjet)));
            if(deltaRJetTaggerSubjet < jetRadius && gepWTAConeCellsTowersJetspTValuesSignal->at(iSubjet) > nsubjetinessSubjetEtThreshold){ // FIXME ensure delta R threshold is dynamically calculated from algorithm configuration
                nSubjetConeCellsTowersJetTaggerLeading++;
                //std::cout << "jet tagger eta, phi: " << jetTaggerLeadingLRJEtaValuesSignal->at(0) << " , " << jetTaggerLeadingLRJPhiValuesSignal->at(0) << "\n";
                //std::cout << "cone jet pT, eta, phi: " << gepWTAConeCellsTowersJetspTValuesSignal->at(iSubjet) << " , " << gepWTAConeCellsTowersJetsEtaValuesSignal->at(iSubjet) << " , " << gepWTAConeCellsTowersJetsPhiValuesSignal->at(iSubjet) << "\n";
                //std::cout << "deltaRJetTaggerSubjet : " << deltaRJetTaggerSubjet << "\n";
                leadingJetTaggerConeCellsTowersSubjets.push_back({gepWTAConeCellsTowersJetspTValuesSignal->at(iSubjet), gepWTAConeCellsTowersJetsEtaValuesSignal->at(iSubjet), gepWTAConeCellsTowersJetsPhiValuesSignal->at(iSubjet)});
            }
        }

        // Find subjets (jFEX and cone jets) - now for subleading JetTagger jet
        for(unsigned int iSubjet = 0; iSubjet < jFexSRJEtaValuesSignal->size(); iSubjet++ ){
            //std::cout << "jFexSRJEtaValuesSignal->at(iSubjet): " << jFexSRJEtaValuesSignal->at(iSubjet) << " and phi: " << jFexSRJPhiValuesSignal->at(iSubjet) << "\n";
            double deltaRJetTaggerSubjet = sqrt(calcDeltaR2(jetTaggerSubleadingLRJEtaValuesSignal->at(0), jetTaggerSubleadingLRJPhiValuesSignal->at(0), jFexSRJEtaValuesSignal->at(iSubjet), jFexSRJPhiValuesSignal->at(iSubjet)));
            if(deltaRJetTaggerSubjet < jetRadius && jFexSRJEtValuesSignal->at(iSubjet) > nsubjetinessSubjetEtThreshold){ // FIXME ensure delta R threshold is dynamically calculated from algorithm configuration
                nSubjetjFEXJetTaggerSubleading++;
                subleadingJetTaggerjFEXSubjets.push_back({jFexSRJEtValuesSignal->at(iSubjet), jFexSRJEtaValuesSignal->at(iSubjet), jFexSRJPhiValuesSignal->at(iSubjet)});
            }
        }
        for(unsigned int iSubjet = 0; iSubjet < gepWTAConeCellsTowersJetsEtaValuesSignal->size(); iSubjet++ ){  // FIXME use WTA cone jets for these. IN GENERAL SHOULD USE ONLY WTA CONE JETS!!!
            double deltaRJetTaggerSubjet = sqrt(calcDeltaR2(jetTaggerSubleadingLRJEtaValuesSignal->at(0), jetTaggerSubleadingLRJPhiValuesSignal->at(0), gepWTAConeCellsTowersJetsEtaValuesSignal->at(iSubjet), gepWTAConeCellsTowersJetsPhiValuesSignal->at(iSubjet)));
            if(deltaRJetTaggerSubjet < jetRadius && gepWTAConeCellsTowersJetspTValuesSignal->at(iSubjet) > nsubjetinessSubjetEtThreshold){ // FIXME ensure delta R threshold is dynamically calculated from algorithm configuration
                nSubjetConeCellsTowersJetTaggerSubleading++;
                subleadingJetTaggerConeCellsTowersSubjets.push_back({gepWTAConeCellsTowersJetspTValuesSignal->at(iSubjet), gepWTAConeCellsTowersJetsEtaValuesSignal->at(iSubjet), gepWTAConeCellsTowersJetsPhiValuesSignal->at(iSubjet)});
            }
        }

        // Sort helper lambda: compare by Et (index 0)
        auto sortByEtDescending = [](const std::array<double, 3>& a, const std::array<double, 3>& b) {
            return a[0] > b[0];  // sort by Et descending
        };

        // Sort all four subjet collections for NSubjetiness computation
        std::sort(leadingJetTaggerjFEXSubjets.begin(), leadingJetTaggerjFEXSubjets.end(), sortByEtDescending);
        std::sort(subleadingJetTaggerjFEXSubjets.begin(), subleadingJetTaggerjFEXSubjets.end(), sortByEtDescending);
        std::sort(leadingJetTaggerConeCellsTowersSubjets.begin(), leadingJetTaggerConeCellsTowersSubjets.end(), sortByEtDescending);
        std::sort(subleadingJetTaggerConeCellsTowersSubjets.begin(), subleadingJetTaggerConeCellsTowersSubjets.end(), sortByEtDescending);

        // Compute E_T / p_T of constituent times min. delta R between subjets
        // NSubjetiness for jFEX subjets
        double tau_1_LeadingJetTaggerjFEXSubjet = 0; 
        double tau_1_SubleadingJetTaggerjFEXSubjet = 0; 
        double tau_2_LeadingJetTaggerjFEXSubjet = 0; 
        double tau_2_SubleadingJetTaggerjFEXSubjet = 0; 

        // NSubjetiness for ConeCellsTowers subjets
        double tau_1_LeadingJetTaggerConeCellsTowersSubjet = 0; 
        double tau_1_SubleadingJetTaggerConeCellsTowersSubjet = 0; 
        double tau_2_LeadingJetTaggerConeCellsTowersSubjet = 0; 
        double tau_2_SubleadingJetTaggerConeCellsTowersSubjet = 0; 

        // deltaR for jFEX , ConeCellsTowers subjets
        //std::vector<double > deltaRLeadingJetTaggerjFEXSubjet;  
        //std::vector<double > deltaRSubleadingJetTaggerjFEXSubjet; 
        //std::vector<double > deltaRLeadingJetTaggerjFEXSubjet; 
        //std::vector<double > deltaRSubleadingJetTaggerjFEXSubjet;     
        for(unsigned int iTower = 0; iTower < gepCellsTowersEtValuesSignal->size(); iTower++){
            sig_h_JetTagger_CellsTowersEt->Fill(gepCellsTowersEtValuesSignal->at(iTower));
        }

        for(unsigned int iTower = 0; iTower < nInputObjectsAlgorithmConfiguration; iTower++){
            sig_h_JetTagger_Considered_CellsTowersEt->Fill(gepCellsTowersEtValuesSignal->at(iTower));
        }
        

        // First for leading JetTagger LRJ
        //std::cout << "jetTaggerLeadingLRJMergedIndicesValuesSignal->size() " << jetTaggerLeadingLRJMergedIndicesValuesSignal->size() << "\n";
        for(auto& idxSigJet1 : *jetTaggerLeadingLRJMergedIndicesValuesSignal){ // Loop through jet tagger merged indices
            std::array<double, 3 > inputObjectEtEtaPhi = {0.0, 0.0, 0.0};
            if (inputObjectType == "gepBasicClusters"){
                inputObjectEtEtaPhi[0] = gepBasicClustersEtValuesSignal->at(idxSigJet1);
                inputObjectEtEtaPhi[1] = gepBasicClustersEtaValuesSignal->at(idxSigJet1);
                inputObjectEtEtaPhi[2] = gepBasicClustersPhiValuesSignal->at(idxSigJet1);
                sig_h_JetTagger_Leading_MergedIO_Et->Fill(gepBasicClustersEtValuesSignal->at(idxSigJet1));
            }
            else if (inputObjectType == "Towers"){
                inputObjectEtEtaPhi[0] = gepCellsTowersEtValuesSignal->at(idxSigJet1);
                inputObjectEtEtaPhi[1] = gepCellsTowersEtaValuesSignal->at(idxSigJet1);
                inputObjectEtEtaPhi[2] = gepCellsTowersPhiValuesSignal->at(idxSigJet1);
                sig_h_JetTagger_Leading_MergedIO_Et->Fill(gepCellsTowersEtValuesSignal->at(idxSigJet1));
            }
            else if (inputObjectType == "gepWTAConeCellsTowersJet"){
                inputObjectEtEtaPhi[0] = gepWTAConeCellsTowersJetspTValuesSignal->at(idxSigJet1);
                inputObjectEtEtaPhi[1] = gepWTAConeCellsTowersJetsEtaValuesSignal->at(idxSigJet1);
                inputObjectEtEtaPhi[2] = gepWTAConeCellsTowersJetsPhiValuesSignal->at(idxSigJet1);
                sig_h_JetTagger_Leading_MergedIO_Et->Fill(gepWTAConeCellsTowersJetspTValuesSignal->at(idxSigJet1));
            }
            if(leadingJetTaggerjFEXSubjets.size() > 0){
                double deltaR = sqrt(calcDeltaR2(inputObjectEtEtaPhi[1], inputObjectEtEtaPhi[2], leadingJetTaggerjFEXSubjets[0][1], leadingJetTaggerjFEXSubjets[0][2]));
                //std::cout << "deltaR : " << deltaR << " and input object et: " << inputObjectEtEtaPhi[0] << "\n";
                tau_1_LeadingJetTaggerjFEXSubjet += inputObjectEtEtaPhi[0] * deltaR;
            }
            if(leadingJetTaggerjFEXSubjets.size() > 1){
                double deltaR_first_subjet = sqrt(calcDeltaR2(inputObjectEtEtaPhi[1], inputObjectEtEtaPhi[2], leadingJetTaggerjFEXSubjets[0][1], leadingJetTaggerjFEXSubjets[0][2]));
                double deltaR_second_subjet = sqrt(calcDeltaR2(inputObjectEtEtaPhi[1], inputObjectEtEtaPhi[2], leadingJetTaggerjFEXSubjets[1][1], leadingJetTaggerjFEXSubjets[1][2]));
                double min_deltaR = std::min(deltaR_first_subjet, deltaR_second_subjet);
                tau_2_LeadingJetTaggerjFEXSubjet += inputObjectEtEtaPhi[0] * min_deltaR;
            }
            if(leadingJetTaggerConeCellsTowersSubjets.size() > 0){
                double deltaR = sqrt(calcDeltaR2(inputObjectEtEtaPhi[1], inputObjectEtEtaPhi[2], leadingJetTaggerConeCellsTowersSubjets[0][1], leadingJetTaggerConeCellsTowersSubjets[0][2]));
                tau_1_LeadingJetTaggerConeCellsTowersSubjet += inputObjectEtEtaPhi[0] * deltaR;
            }
            if(leadingJetTaggerConeCellsTowersSubjets.size() > 1){
                double deltaR_first_subjet = sqrt(calcDeltaR2(inputObjectEtEtaPhi[1], inputObjectEtEtaPhi[2], leadingJetTaggerConeCellsTowersSubjets[0][1], leadingJetTaggerConeCellsTowersSubjets[0][2]));
                double deltaR_second_subjet = sqrt(calcDeltaR2(inputObjectEtEtaPhi[1], inputObjectEtEtaPhi[2], leadingJetTaggerConeCellsTowersSubjets[1][1], leadingJetTaggerConeCellsTowersSubjets[1][2]));
                double min_deltaR = std::min(deltaR_first_subjet, deltaR_second_subjet);
                tau_2_LeadingJetTaggerConeCellsTowersSubjet += inputObjectEtEtaPhi[0] * min_deltaR;
            }
        }
        
        // Normalize by 1/d_0 (which here is just the jet E_T / p_T as R assumed = 1.0, else must do annoying computation)
        tau_1_LeadingJetTaggerjFEXSubjet /= (jetTaggerLeadingLRJEtValuesSignal->at(0) * jetRadius);
        tau_2_LeadingJetTaggerjFEXSubjet /= (jetTaggerLeadingLRJEtValuesSignal->at(0) * jetRadius);
        tau_1_LeadingJetTaggerConeCellsTowersSubjet /= (jetTaggerLeadingLRJEtValuesSignal->at(0) * jetRadius);
        tau_2_LeadingJetTaggerConeCellsTowersSubjet /= (jetTaggerLeadingLRJEtValuesSignal->at(0) * jetRadius);

        sig_h_LeadingJetTaggerLRJ_jFEX_SubjetMultiplicity->Fill(nSubjetjFEXJetTaggerLeading);
        sig_h_LeadingJetTaggerLRJ_ConeCellsTowers_SubjetMultiplicity->Fill(nSubjetConeCellsTowersJetTaggerLeading);
        sig_h_SubleadingJetTaggerLRJ_jFEX_SubjetMultiplicity->Fill(nSubjetjFEXJetTaggerSubleading);
        sig_h_SubleadingJetTaggerLRJ_ConeCellsTowers_SubjetMultiplicity->Fill(nSubjetConeCellsTowersJetTaggerSubleading);

        sig_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_1->Fill(tau_1_LeadingJetTaggerjFEXSubjet);
        sig_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_2->Fill(tau_2_LeadingJetTaggerjFEXSubjet);
        sig_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_12->Fill(tau_2_LeadingJetTaggerjFEXSubjet/tau_1_LeadingJetTaggerjFEXSubjet);
        sig_h_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1->Fill(tau_1_LeadingJetTaggerConeCellsTowersSubjet);
        sig_h_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_2->Fill(tau_2_LeadingJetTaggerConeCellsTowersSubjet);
        sig_h_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_12->Fill(tau_2_LeadingJetTaggerConeCellsTowersSubjet/tau_1_LeadingJetTaggerConeCellsTowersSubjet);

        sig_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_1_vs_Tau_2->Fill(tau_1_LeadingJetTaggerjFEXSubjet, tau_2_LeadingJetTaggerjFEXSubjet);
        sig_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1_vs_Tau_2->Fill(tau_1_LeadingJetTaggerConeCellsTowersSubjet, tau_2_LeadingJetTaggerConeCellsTowersSubjet);

        // Fill multiplicity of MERGED input objects
        sig_h_JetTagger_Leading_MergedIO_Multiplicity->Fill(jetTaggerLeadingLRJMergedIndicesValuesSignal->size());
        sig_h_JetTagger_Subleading_MergedIO_Multiplicity->Fill(jetTaggerSubleadingLRJMergedIndicesValuesSignal->size());
        

        // Next for subeading JetTagger LRJ
        for(auto& idxSigJet1 : *jetTaggerSubleadingLRJMergedIndicesValuesSignal){ // Loop through jet tagger merged indices
            std::array<double, 3 > inputObjectEtEtaPhi = {0.0, 0.0, 0.0};
            if (inputObjectType == "gepBasicClusters"){
                inputObjectEtEtaPhi[0] = gepBasicClustersEtValuesSignal->at(idxSigJet1);
                inputObjectEtEtaPhi[1] = gepBasicClustersEtaValuesSignal->at(idxSigJet1);
                inputObjectEtEtaPhi[2] = gepBasicClustersPhiValuesSignal->at(idxSigJet1);
                sig_h_JetTagger_Subleading_MergedIO_Et->Fill(gepBasicClustersEtValuesSignal->at(idxSigJet1));
            }
            else if (inputObjectType == "Towers"){
                inputObjectEtEtaPhi[0] = gepCellsTowersEtValuesSignal->at(idxSigJet1);
                inputObjectEtEtaPhi[1] = gepCellsTowersEtaValuesSignal->at(idxSigJet1);
                inputObjectEtEtaPhi[2] = gepCellsTowersPhiValuesSignal->at(idxSigJet1);
                sig_h_JetTagger_Subleading_MergedIO_Et->Fill(gepCellsTowersEtValuesSignal->at(idxSigJet1));
            }
            else if (inputObjectType == "gepWTAConeCellsTowersJet"){
                inputObjectEtEtaPhi[0] = gepWTAConeCellsTowersJetspTValuesSignal->at(idxSigJet1);
                inputObjectEtEtaPhi[1] = gepWTAConeCellsTowersJetsEtaValuesSignal->at(idxSigJet1);
                inputObjectEtEtaPhi[2] = gepWTAConeCellsTowersJetsPhiValuesSignal->at(idxSigJet1);
                sig_h_JetTagger_Subleading_MergedIO_Et->Fill(gepWTAConeCellsTowersJetspTValuesSignal->at(idxSigJet1));
            }
            if(subleadingJetTaggerjFEXSubjets.size() > 0){
                double deltaR = sqrt(calcDeltaR2(inputObjectEtEtaPhi[1], inputObjectEtEtaPhi[2], subleadingJetTaggerjFEXSubjets[0][1], subleadingJetTaggerjFEXSubjets[0][2]));
                tau_1_SubleadingJetTaggerjFEXSubjet += inputObjectEtEtaPhi[0] * deltaR;
            }
            if(subleadingJetTaggerjFEXSubjets.size() > 1){
                double deltaR_first_subjet = sqrt(calcDeltaR2(inputObjectEtEtaPhi[1], inputObjectEtEtaPhi[2], subleadingJetTaggerjFEXSubjets[0][1], subleadingJetTaggerjFEXSubjets[0][2]));
                double deltaR_second_subjet = sqrt(calcDeltaR2(inputObjectEtEtaPhi[1], inputObjectEtEtaPhi[2], subleadingJetTaggerjFEXSubjets[1][1], subleadingJetTaggerjFEXSubjets[1][2]));
                double min_deltaR = std::min(deltaR_first_subjet, deltaR_second_subjet);
                tau_2_SubleadingJetTaggerjFEXSubjet += inputObjectEtEtaPhi[0] * min_deltaR;
            }

            if(subleadingJetTaggerConeCellsTowersSubjets.size() > 0){
                double deltaR = sqrt(calcDeltaR2(inputObjectEtEtaPhi[1], inputObjectEtEtaPhi[2], subleadingJetTaggerConeCellsTowersSubjets[0][1], subleadingJetTaggerConeCellsTowersSubjets[0][2]));
                tau_1_SubleadingJetTaggerConeCellsTowersSubjet += inputObjectEtEtaPhi[0] * deltaR;
            }
            if(subleadingJetTaggerConeCellsTowersSubjets.size() > 1){
                double deltaR_first_subjet = sqrt(calcDeltaR2(inputObjectEtEtaPhi[1], inputObjectEtEtaPhi[2], subleadingJetTaggerConeCellsTowersSubjets[0][1], subleadingJetTaggerConeCellsTowersSubjets[0][2]));
                double deltaR_second_subjet = sqrt(calcDeltaR2(inputObjectEtEtaPhi[1], inputObjectEtEtaPhi[2], subleadingJetTaggerConeCellsTowersSubjets[1][1], subleadingJetTaggerConeCellsTowersSubjets[1][2]));
                double min_deltaR = std::min(deltaR_first_subjet, deltaR_second_subjet);
                tau_2_SubleadingJetTaggerConeCellsTowersSubjet += inputObjectEtEtaPhi[0] * min_deltaR;
            }
        }

        // Normalize by 1/d_0 (which here is just the jet E_T / p_T as R assumed = 1.0, else must do annoying computation)
        tau_1_SubleadingJetTaggerjFEXSubjet /= (jetTaggerSubleadingLRJEtValuesSignal->at(0) * jetRadius);
        tau_2_SubleadingJetTaggerjFEXSubjet /= (jetTaggerSubleadingLRJEtValuesSignal->at(0) * jetRadius);
        tau_1_SubleadingJetTaggerConeCellsTowersSubjet /= (jetTaggerSubleadingLRJEtValuesSignal->at(0) * jetRadius);
        tau_2_SubleadingJetTaggerConeCellsTowersSubjet /= (jetTaggerSubleadingLRJEtValuesSignal->at(0) * jetRadius);

        sig_h_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_1->Fill(tau_1_SubleadingJetTaggerjFEXSubjet);
        sig_h_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_2->Fill(tau_2_SubleadingJetTaggerjFEXSubjet);
        sig_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1->Fill(tau_1_SubleadingJetTaggerConeCellsTowersSubjet);
        sig_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_2->Fill(tau_2_SubleadingJetTaggerConeCellsTowersSubjet);

        sig_h_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_12->Fill(tau_2_SubleadingJetTaggerConeCellsTowersSubjet / tau_1_SubleadingJetTaggerConeCellsTowersSubjet);

        sig_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_12->Fill(tau_2_SubleadingJetTaggerConeCellsTowersSubjet / tau_1_SubleadingJetTaggerConeCellsTowersSubjet);

        sig_h_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_12->Fill(tau_2_SubleadingJetTaggerjFEXSubjet /tau_1_SubleadingJetTaggerjFEXSubjet );

        sig_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_1_vs_Tau_2->Fill(tau_1_SubleadingJetTaggerjFEXSubjet, tau_2_SubleadingJetTaggerjFEXSubjet);
        sig_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1_vs_Tau_2->Fill(tau_1_SubleadingJetTaggerConeCellsTowersSubjet, tau_2_SubleadingJetTaggerConeCellsTowersSubjet);
        if(tau_1_LeadingJetTaggerjFEXSubjet > 0 && tau_1_SubleadingJetTaggerjFEXSubjet > 0){
            sig_JetTaggerLRJ_jFEX_Subjet_LeadingTau_12_vs_SubleadingTau12->Fill(tau_2_LeadingJetTaggerjFEXSubjet/tau_1_LeadingJetTaggerjFEXSubjet, tau_2_SubleadingJetTaggerjFEXSubjet/tau_1_SubleadingJetTaggerjFEXSubjet);
            sig_JetTaggerLRJ_ConeCellsTowers_Subjet_LeadingTau_12_vs_SubleadingTau12->Fill(tau_2_LeadingJetTaggerConeCellsTowersSubjet/tau_1_LeadingJetTaggerConeCellsTowersSubjet, tau_2_SubleadingJetTaggerConeCellsTowersSubjet/tau_1_SubleadingJetTaggerConeCellsTowersSubjet);
            sig_h_JetTaggerLRJ_jFEX_Subjet_Tau_21_Product_vsLeadingLRJEt->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0), (tau_2_LeadingJetTaggerjFEXSubjet/tau_1_LeadingJetTaggerjFEXSubjet) * (tau_2_SubleadingJetTaggerjFEXSubjet/tau_1_SubleadingJetTaggerjFEXSubjet));
            sigJetTaggerLeadingLRJEtvsPsi_R_squaredvsTau21jFEXProduct->Fill(std::max(sig_LRJ_Et[i][0], sig_LRJ_Et[i][1]), jetTaggerLeadingLRJPsi_RValuesSignal->at(0) * jetTaggerSubleadingLRJPsi_RValuesSignal->at(0), (tau_2_LeadingJetTaggerjFEXSubjet/tau_1_LeadingJetTaggerjFEXSubjet) * (tau_2_SubleadingJetTaggerjFEXSubjet/tau_1_SubleadingJetTaggerjFEXSubjet));
            sigJetTaggerLeadingLRJvsPsi_R_squaredvsTau21jFEXProduct->Fill(jetTaggerLeadingLRJPsi_RValuesSignal->at(0) * jetTaggerSubleadingLRJPsi_RValuesSignal->at(0), (tau_2_LeadingJetTaggerjFEXSubjet/tau_1_LeadingJetTaggerjFEXSubjet) * (tau_2_SubleadingJetTaggerjFEXSubjet/tau_1_SubleadingJetTaggerjFEXSubjet));
        } 
        if(tau_1_LeadingJetTaggerjFEXSubjet > 0) sig_JetTaggerLRJ_jFEX_Subjet_LeadingTau_12_vs_LeadingJetTaggerEt->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0),tau_2_LeadingJetTaggerjFEXSubjet/tau_1_LeadingJetTaggerjFEXSubjet);
        if(tau_1_LeadingJetTaggerConeCellsTowersSubjet > 0) sig_JetTaggerLRJ_ConeCellsTowers_Subjet_LeadingTau_12_vs_LeadingJetTaggerEt->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0), tau_2_LeadingJetTaggerConeCellsTowersSubjet/tau_1_LeadingJetTaggerConeCellsTowersSubjet);
        
        if(tau_1_LeadingJetTaggerConeCellsTowersSubjet > 0 && tau_1_SubleadingJetTaggerConeCellsTowersSubjet > 0){
            sig_h_JetTaggerLRJ_ConeCellsTowers_Subjet_Tau_21_Product->Fill((tau_2_LeadingJetTaggerConeCellsTowersSubjet/tau_1_LeadingJetTaggerConeCellsTowersSubjet) * (tau_2_SubleadingJetTaggerConeCellsTowersSubjet/tau_1_SubleadingJetTaggerConeCellsTowersSubjet));
            sig_h_JetTaggerLRJ_jFEX_Subjet_Tau_21_Product->Fill((tau_2_LeadingJetTaggerjFEXSubjet/tau_1_LeadingJetTaggerjFEXSubjet) * (tau_2_SubleadingJetTaggerjFEXSubjet/tau_1_SubleadingJetTaggerjFEXSubjet));
        }
        
        //std::cout << "(tau_1_LeadingJetTaggerConeCellsTowersSubjet/tau_2_LeadingJetTaggerConeCellsTowersSubjet) * (tau_1_SubleadingJetTaggerConeCellsTowersSubjet/tau_2_SubleadingJetTaggerConeCellsTowersSubjet): " << (tau_2_LeadingJetTaggerConeCellsTowersSubjet/tau_1_LeadingJetTaggerConeCellsTowersSubjet) * (tau_2_SubleadingJetTaggerConeCellsTowersSubjet/tau_1_SubleadingJetTaggerConeCellsTowersSubjet) << "\n";

        if(tau_1_LeadingJetTaggerConeCellsTowersSubjet == 0 || tau_1_SubleadingJetTaggerConeCellsTowersSubjet == 0){
            sig_h_JetTaggerLRJ_ConeCellsTowers_Subjet_Tau_21_Product_vsLeadingLRJEt->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0), 0.0);
        }
        else{
            sig_h_JetTaggerLRJ_ConeCellsTowers_Subjet_Tau_21_Product_vsLeadingLRJEt->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0), (tau_2_LeadingJetTaggerConeCellsTowersSubjet/tau_1_LeadingJetTaggerConeCellsTowersSubjet) * (tau_2_SubleadingJetTaggerConeCellsTowersSubjet/tau_1_SubleadingJetTaggerConeCellsTowersSubjet));
            sigJetTaggerLeadingLRJEtvsPsi_R_squaredvsTau21ConeProduct->Fill(std::max(sig_LRJ_Et[i][0], sig_LRJ_Et[i][1]), jetTaggerLeadingLRJPsi_RValuesSignal->at(0) * jetTaggerSubleadingLRJPsi_RValuesSignal->at(0), (tau_2_LeadingJetTaggerConeCellsTowersSubjet/tau_1_LeadingJetTaggerConeCellsTowersSubjet) * (tau_2_SubleadingJetTaggerConeCellsTowersSubjet/tau_1_SubleadingJetTaggerConeCellsTowersSubjet));
            sigJetTaggerLeadingLRJvsPsi_R_squaredvsTau21ConeProduct->Fill(jetTaggerLeadingLRJPsi_RValuesSignal->at(0) * jetTaggerSubleadingLRJPsi_RValuesSignal->at(0), (tau_2_LeadingJetTaggerConeCellsTowersSubjet/tau_1_LeadingJetTaggerConeCellsTowersSubjet) * (tau_2_SubleadingJetTaggerConeCellsTowersSubjet/tau_1_SubleadingJetTaggerConeCellsTowersSubjet));
        }
        
        

        

        
        // Fill 0 or 1
        if(nSubjetConeCellsTowersJetTaggerLeading <= 1 && nSubjetConeCellsTowersJetTaggerSubleading <= 1){
            sigJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult->Fill(nSubjetConeCellsTowersJetTaggerLeading, nSubjetConeCellsTowersJetTaggerSubleading);
        }
        // Fill >= 2 with just 2 for histogram purposes
        else if(nSubjetConeCellsTowersJetTaggerLeading > 1 && nSubjetConeCellsTowersJetTaggerSubleading <= 1){
            sigJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult->Fill(2, nSubjetConeCellsTowersJetTaggerSubleading);
        }
        else if(nSubjetConeCellsTowersJetTaggerLeading <= 1 && nSubjetConeCellsTowersJetTaggerSubleading > 1){
            sigJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult->Fill(nSubjetConeCellsTowersJetTaggerLeading, 2);
        }
        else if(nSubjetConeCellsTowersJetTaggerLeading > 1 && nSubjetConeCellsTowersJetTaggerSubleading > 1){
            sigJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult->Fill(2, 2);
        }
        
        if(nSubjetConeCellsTowersJetTaggerLeading <= 2 && nSubjetConeCellsTowersJetTaggerSubleading <= 2){
            sigJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult_3->Fill(nSubjetConeCellsTowersJetTaggerLeading, nSubjetConeCellsTowersJetTaggerSubleading);
        }
        if(nSubjetConeCellsTowersJetTaggerLeading >= 3 && nSubjetConeCellsTowersJetTaggerSubleading <= 2){
            sigJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult_3->Fill(3, nSubjetConeCellsTowersJetTaggerSubleading);
        }
        if(nSubjetConeCellsTowersJetTaggerLeading <= 2 && nSubjetConeCellsTowersJetTaggerSubleading >= 3){
            sigJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult_3->Fill(nSubjetConeCellsTowersJetTaggerLeading, 3);
        }
        if(nSubjetConeCellsTowersJetTaggerLeading >= 3 && nSubjetConeCellsTowersJetTaggerSubleading >= 3){
            sigJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult_3->Fill(3, 3);
        }

        // fill different subjet multiplicity categories
        if((nSubjetConeCellsTowersJetTaggerLeading < 1 && nSubjetConeCellsTowersJetTaggerSubleading < 1) || (nSubjetConeCellsTowersJetTaggerLeading == 0 && nSubjetConeCellsTowersJetTaggerSubleading == 1) || (nSubjetConeCellsTowersJetTaggerLeading == 1 && nSubjetConeCellsTowersJetTaggerSubleading == 0)){
            sig_h_leading_LRJ_Et_Category0->Fill(jetTaggerSubleadingLRJEtValuesSignal->at(0));
        }
        if(nSubjetConeCellsTowersJetTaggerLeading == 1 && nSubjetConeCellsTowersJetTaggerSubleading == 1){
            sig_h_leading_LRJ_Et_Category1->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0));
        }
        if(nSubjetConeCellsTowersJetTaggerLeading <= 1 && nSubjetConeCellsTowersJetTaggerSubleading == 2){
            sig_h_leading_LRJ_Et_Category2->Fill(jetTaggerSubleadingLRJEtValuesSignal->at(0));
        }
        if(nSubjetConeCellsTowersJetTaggerLeading == 2 && nSubjetConeCellsTowersJetTaggerSubleading <= 1){
            sig_h_leading_LRJ_Et_Category3->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0));
        }
        if(nSubjetConeCellsTowersJetTaggerLeading == 2 && nSubjetConeCellsTowersJetTaggerSubleading == 2){
            sig_h_leading_LRJ_Et_Category4->Fill(jetTaggerSubleadingLRJEtValuesSignal->at(0));
        }
        if(nSubjetConeCellsTowersJetTaggerLeading <= 2 && nSubjetConeCellsTowersJetTaggerSubleading >= 3){
            sig_h_leading_LRJ_Et_Category5->Fill(jetTaggerSubleadingLRJEtValuesSignal->at(0));
        }
        if(nSubjetConeCellsTowersJetTaggerLeading >= 3 && nSubjetConeCellsTowersJetTaggerSubleading <= 2){
            sig_h_leading_LRJ_Et_Category6->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0));
        }
        if(nSubjetConeCellsTowersJetTaggerLeading >= 3 && nSubjetConeCellsTowersJetTaggerSubleading >= 3){
            sig_h_leading_LRJ_Et_Category7->Fill(jetTaggerSubleadingLRJEtValuesSignal->at(0));
        }
        nSubjetsLeadingLRJSignal[i] += nSubjetConeCellsTowersJetTaggerLeading;
        nSubjetsSubleadingLRJSignal[i] += nSubjetConeCellsTowersJetTaggerSubleading;

        if(nSubjetConeCellsTowersJetTaggerLeading == 1 && nSubjetConeCellsTowersJetTaggerSubleading == 1){
            sig_h_leading_LRJ_Et_NoConeSubjets_Lead_or_1ConeJetLead->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0));
        }

        if((nSubjetConeCellsTowersJetTaggerLeading < 1 && nSubjetConeCellsTowersJetTaggerSubleading < 1) || (nSubjetConeCellsTowersJetTaggerLeading == 0 && nSubjetConeCellsTowersJetTaggerSubleading == 1) || (nSubjetConeCellsTowersJetTaggerLeading == 1 && nSubjetConeCellsTowersJetTaggerSubleading == 0)){
            sig_h_subleading_LRJ_Et_1ConeSubjet_Lead_or_1ConeJetLead_Sublead->Fill(jetTaggerSubleadingLRJEtValuesSignal->at(0));
        }

        if(nSubjetConeCellsTowersJetTaggerLeading >= 2 && nSubjetConeCellsTowersJetTaggerSubleading <= 1){
            double deltaRConeSubjets = sqrt(calcDeltaR2(leadingJetTaggerConeCellsTowersSubjets[0][1], leadingJetTaggerConeCellsTowersSubjets[0][2], leadingJetTaggerConeCellsTowersSubjets[1][1], leadingJetTaggerConeCellsTowersSubjets[1][2]));
            double jetTaggerLeadingMassApproxCone = deltaRConeSubjets * jetTaggerLeadingLRJEtValuesSignal->at(0);
            double jetTaggerLeadingMassApproxCone_SubjetEt = deltaRConeSubjets * (leadingJetTaggerConeCellsTowersSubjets[0][0] + leadingJetTaggerConeCellsTowersSubjets[1][0]);
            sigJetTaggerLeadingLRJEtvsTau21_WithGrEq2ConeSubjet_Lead->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0), tau_2_LeadingJetTaggerConeCellsTowersSubjet/tau_1_LeadingJetTaggerConeCellsTowersSubjet);
            sigJetTaggerLeadingMassApproxvsTau21_WithGrEq2ConeSubjet_Lead->Fill(jetTaggerLeadingMassApproxCone_SubjetEt, tau_2_LeadingJetTaggerConeCellsTowersSubjet/tau_1_LeadingJetTaggerConeCellsTowersSubjet);
            sigJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Lead->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0), jetTaggerLeadingMassApproxCone_SubjetEt);
            sigJetTaggerLeadingLRJMassApproxvsSubjetEtRatio_WithGrEq2ConeSubjet_Lead->Fill(jetTaggerLeadingMassApproxCone_SubjetEt, leadingJetTaggerConeCellsTowersSubjets[0][0]/leadingJetTaggerConeCellsTowersSubjets[1][0]);
            sigJetTaggerLeadingLRJEtvsSubjetEtRatio_WithGrEq2ConeSubjet_Lead->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0), leadingJetTaggerConeCellsTowersSubjets[0][0]/leadingJetTaggerConeCellsTowersSubjets[1][0]);
            sig_h_leading_LRJ_Et_WithGrEq2ConeSubjet_Lead->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0));
            double Z_lead = leadingJetTaggerConeCellsTowersSubjets[1][0]/jetTaggerLeadingLRJEtValuesSignal->at(0);
            double d12_lead = sqrt(Z_lead * Z_lead * jetTaggerLeadingLRJEtValuesSignal->at(0) * jetTaggerLeadingLRJEtValuesSignal->at(0) * deltaRConeSubjets * deltaRConeSubjets);

            sigJetTaggerLeadingLRJEtvsd12_WithGrEq2ConeSubjet_Lead->Fill(jetTaggerSubleadingLRJEtValuesSignal->at(0), d12_lead);
            sigJetTaggerLeadingSubjetEtvsSubleadingSubjetEt_Lead->Fill(leadingJetTaggerConeCellsTowersSubjets[0][0], leadingJetTaggerConeCellsTowersSubjets[1][0]);
        }

        if(nSubjetConeCellsTowersJetTaggerLeading <= 1 && nSubjetConeCellsTowersJetTaggerSubleading >= 2){
            double deltaRConeSubjets = sqrt(calcDeltaR2(subleadingJetTaggerConeCellsTowersSubjets[0][1], subleadingJetTaggerConeCellsTowersSubjets[0][2], subleadingJetTaggerConeCellsTowersSubjets[1][1], subleadingJetTaggerConeCellsTowersSubjets[1][2]));
            double jetTaggerSubleadingMassApproxCone = deltaRConeSubjets * jetTaggerSubleadingLRJEtValuesSignal->at(0);
            double jetTaggerSubleadingMassApproxCone_SubjetEt = deltaRConeSubjets * (subleadingJetTaggerConeCellsTowersSubjets[0][0] + subleadingJetTaggerConeCellsTowersSubjets[1][0]);
            sigJetTaggerSubleadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Sublead->Fill(jetTaggerSubleadingLRJEtValuesSignal->at(0), jetTaggerSubleadingMassApproxCone_SubjetEt);
            sigJetTaggerSubleadingMassApproxvsTau21_WithGrEq2ConeSubjet_Sublead->Fill(jetTaggerSubleadingMassApproxCone_SubjetEt, tau_2_SubleadingJetTaggerConeCellsTowersSubjet/tau_1_SubleadingJetTaggerConeCellsTowersSubjet);
            sigJetTaggerSubleadingLRJEtvsTau21_WithGrEq2ConeSubjet_Sublead->Fill(jetTaggerSubleadingLRJEtValuesSignal->at(0), tau_2_SubleadingJetTaggerConeCellsTowersSubjet/tau_1_SubleadingJetTaggerConeCellsTowersSubjet);
            sigJetTaggerSubleadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet_Sublead->Fill(jetTaggerSubleadingLRJEtValuesSignal->at(0), jetTaggerLeadingLRJPsi_RValuesSignal->at(0) * jetTaggerSubleadingLRJPsi_RValuesSignal->at(0));
            sigJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet_Sublead->Fill(jetTaggerSubleadingLRJEtValuesSignal->at(0), jetTaggerLeadingLRJPsi_RValuesSignal->at(0) * jetTaggerSubleadingLRJPsi_RValuesSignal->at(0));
            sig_h_leading_LRJ_Et_WithGrEq2ConeSubjet_Sublead->Fill(jetTaggerSubleadingLRJEtValuesSignal->at(0));
            double Z_subl = subleadingJetTaggerConeCellsTowersSubjets[1][0]/jetTaggerSubleadingLRJEtValuesSignal->at(0);
            double d12_subl = sqrt(Z_subl * Z_subl * jetTaggerSubleadingLRJEtValuesSignal->at(0) * jetTaggerSubleadingLRJEtValuesSignal->at(0) * deltaRConeSubjets * deltaRConeSubjets);

            sigJetTaggerSubleadingLRJEtvsd12_WithGrEq2ConeSubjet_Sublead->Fill(jetTaggerSubleadingLRJEtValuesSignal->at(0), d12_subl);
            sigJetTaggerLeadingSubjetEtvsSubleadingSubjetEt_Sublead->Fill(subleadingJetTaggerConeCellsTowersSubjets[0][0], subleadingJetTaggerConeCellsTowersSubjets[1][0]);
        }

        if(nSubjetConeCellsTowersJetTaggerLeading >= 2 && nSubjetConeCellsTowersJetTaggerSubleading >= 2){
            double deltaRConeSubjets = sqrt(calcDeltaR2(leadingJetTaggerConeCellsTowersSubjets[0][1], leadingJetTaggerConeCellsTowersSubjets[0][2], leadingJetTaggerConeCellsTowersSubjets[1][1], leadingJetTaggerConeCellsTowersSubjets[1][2]));
            double jetTaggerLeadingMassApproxCone = deltaRConeSubjets * jetTaggerSubleadingLRJEtValuesSignal->at(0);
            double deltaRConeSubjetsSubleading = sqrt(calcDeltaR2(subleadingJetTaggerConeCellsTowersSubjets[0][1], subleadingJetTaggerConeCellsTowersSubjets[0][2], subleadingJetTaggerConeCellsTowersSubjets[1][1], subleadingJetTaggerConeCellsTowersSubjets[1][2]));
            double jetTaggerSubleadingMassApproxCone = deltaRConeSubjetsSubleading * jetTaggerSubleadingLRJEtValuesSignal->at(0);

            double jetTaggerLeadingMassApproxCone_SubjetEt = deltaRConeSubjets * (leadingJetTaggerConeCellsTowersSubjets[0][0] + leadingJetTaggerConeCellsTowersSubjets[1][0]);
            double jetTaggerSubleadingMassApproxCone_SubjetEt = deltaRConeSubjets * (subleadingJetTaggerConeCellsTowersSubjets[0][0] + subleadingJetTaggerConeCellsTowersSubjets[1][0]);
            sigJetTaggerSubleadingLRJEtvsDeltaRSubjets_WithGrEq2ConeSubjet_Lead_Sublead->Fill(jetTaggerSubleadingLRJEtValuesSignal->at(0), deltaRConeSubjets, deltaRConeSubjetsSubleading);
            sigJetTaggerLeadingLRJEtvsTau21_WithGrEq2ConeSubjet_Lead_Sublead->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0), tau_2_SubleadingJetTaggerConeCellsTowersSubjet/tau_1_SubleadingJetTaggerConeCellsTowersSubjet * tau_2_LeadingJetTaggerConeCellsTowersSubjet/tau_1_LeadingJetTaggerConeCellsTowersSubjet);
            sigJetTaggerLeadingMassApproxvsTau21Product_WithGrEq2ConeSubjet_Lead_Sublead->Fill(jetTaggerLeadingMassApproxCone_SubjetEt, tau_2_SubleadingJetTaggerConeCellsTowersSubjet/tau_1_SubleadingJetTaggerConeCellsTowersSubjet * tau_2_LeadingJetTaggerConeCellsTowersSubjet/tau_1_LeadingJetTaggerConeCellsTowersSubjet);
            sigJetTaggerSubleadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Lead_Sublead->Fill(jetTaggerSubleadingLRJEtValuesSignal->at(0), jetTaggerLeadingMassApproxCone_SubjetEt, jetTaggerSubleadingMassApproxCone_SubjetEt);
            sig_h_subleading_LRJ_Et_WithGrEq2ConeSubjet_Lead_Sublead->Fill(jetTaggerSubleadingLRJEtValuesSignal->at(0)); // FIXME test between subleading, leading selection? or both?? 
            double Z_subl = subleadingJetTaggerConeCellsTowersSubjets[1][0]/jetTaggerSubleadingLRJEtValuesSignal->at(0);
            double d12_subl = sqrt(Z_subl * Z_subl * jetTaggerSubleadingLRJEtValuesSignal->at(0) * jetTaggerSubleadingLRJEtValuesSignal->at(0) * deltaRConeSubjetsSubleading * deltaRConeSubjetsSubleading);
            
            double Z_lead = leadingJetTaggerConeCellsTowersSubjets[1][0]/jetTaggerLeadingLRJEtValuesSignal->at(0);
            double d12_lead = sqrt(Z_lead * Z_lead * jetTaggerLeadingLRJEtValuesSignal->at(0) * jetTaggerLeadingLRJEtValuesSignal->at(0) * deltaRConeSubjets * deltaRConeSubjets);

            sigJetTaggerSubleadingLRJEtvsd12_WithGrEq2ConeSubjet_Lead_Sublead->Fill(jetTaggerSubleadingLRJEtValuesSignal->at(0), d12_lead, d12_subl);
        }

        if(nSubjetConeCellsTowersJetTaggerLeading == 0){
            sig_h_leading_LRJ_psi_R_squared_NoConeSubjets->Fill(jetTaggerLeadingLRJPsi_RValuesSignal->at(0) * jetTaggerSubleadingLRJPsi_RValuesSignal->at(0));
            sig_h_leading_LRJ_Et_NoConeSubjets->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0));
            sigJetTaggerLeadingLRJEtvsPsi_R_squared_NoConeSubjets->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0), jetTaggerLeadingLRJPsi_RValuesSignal->at(0) * jetTaggerSubleadingLRJPsi_RValuesSignal->at(0));
            sigJetTaggerLeadingLRJEtvsPsi_R_NoConeSubjets->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0), jetTaggerLeadingLRJPsi_RValuesSignal->at(0));
        }  
        else if(nSubjetConeCellsTowersJetTaggerLeading == 1){
            sig_h_leading_LRJ_psi_R_squared_With1ConeSubjet->Fill(jetTaggerLeadingLRJPsi_RValuesSignal->at(0) * jetTaggerSubleadingLRJPsi_RValuesSignal->at(0));
            sig_h_leading_LRJ_Et_With1ConeSubjet->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0));
            sigJetTaggerLeadingLRJEtvsPsi_R_squared_With1ConeSubjet->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0), jetTaggerLeadingLRJPsi_RValuesSignal->at(0) * jetTaggerSubleadingLRJPsi_RValuesSignal->at(0));
            sigJetTaggerLeadingLRJEtvsPsi_R_With1ConeSubjet->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0), jetTaggerLeadingLRJPsi_RValuesSignal->at(0));

            double Z_lead = leadingJetTaggerConeCellsTowersSubjets[0][0]/jetTaggerLeadingLRJEtValuesSignal->at(0); // NOTE this is not actually "z"

            sigJetTaggerLeadingLRJEtvsZ_With1ConeSubjet->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0), Z_lead);
        } 
        
        else if (nSubjetConeCellsTowersJetTaggerLeading > 1){
            // Compute psi_R of the subleading subjet - want to potentially remove it from being a subjet if above some value?? (depending on these results)
            // Unfortunately this will be quite computationally expensive...
            double psi_R_subjet = 0;
            const double coneJetRadius = 0.4;
            //std::vector<unsigned int > constituentTowerIndices;
            for(unsigned int iTower = 0; iTower < nInputObjectsAlgorithmConfiguration; iTower++){ // First compute which towers are within the subjet - maybe this would be available information from cone jet algorithm??
                // FIXME configure for multiple types of input objects, but for now perfectly fine to just use towers 
                double deltaRSubleadingSubjetTower = sqrt(calcDeltaR2(leadingJetTaggerConeCellsTowersSubjets[1][1], leadingJetTaggerConeCellsTowersSubjets[1][2], gepCellsTowersEtaValuesSignal->at(iTower), gepCellsTowersPhiValuesSignal->at(iTower)));
                if(deltaRSubleadingSubjetTower < coneJetRadius){ // FIXME make this a configurable deltaR value for cone jets in case use a non-default value
                    psi_R_subjet += (1/leadingJetTaggerConeCellsTowersSubjets[1][0] * coneJetRadius) * deltaRSubleadingSubjetTower * gepCellsTowersEtValuesSignal->at(0);
                    //constituentTowerIndices.push_back(iTower); // For now just directly compute psi_R,
                    // may need to adjust since granularity of cone jets could cause discrepancy between constituent towers?
                } 
            }

            sig_h_leading_LRJ_psi_R_SubleadingSubjet_WithGrEq2ConeSubjet->Fill(psi_R_subjet);
            sigJetTaggerLeadingLRJEtvspsi_R_SubleadingSubjet_WithGrEq2ConeSubjet->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0), psi_R_subjet);
            sig_h_leading_LRJ_psi_R_squared_WithGrEq2ConeSubjet->Fill(jetTaggerLeadingLRJPsi_RValuesSignal->at(0) * jetTaggerSubleadingLRJPsi_RValuesSignal->at(0));
            sig_h_leading_LRJ_Et_WithGrEq2ConeSubjet->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0));
            sigJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0), jetTaggerLeadingLRJPsi_RValuesSignal->at(0) * jetTaggerSubleadingLRJPsi_RValuesSignal->at(0));
            sigJetTaggerLeadingLRJEtvsPsi_R_WithGrEq2ConeSubjet->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0), jetTaggerLeadingLRJPsi_RValuesSignal->at(0));
            
            // compute delta R of leading, subleading subjets:
            double deltaRConeSubjets = sqrt(calcDeltaR2(leadingJetTaggerConeCellsTowersSubjets[0][1], leadingJetTaggerConeCellsTowersSubjets[0][2], leadingJetTaggerConeCellsTowersSubjets[1][1], leadingJetTaggerConeCellsTowersSubjets[1][2]));
            //std::cout << "deltaRConeSubjets: " << deltaRConeSubjets << "\n";
            double jetTaggerLeadingMassApproxCone = deltaRConeSubjets * jetTaggerLeadingLRJEtValuesSignal->at(0);
            double jetTaggerLeadingMassApproxCone_SubjetEt = deltaRConeSubjets * (leadingJetTaggerConeCellsTowersSubjets[0][0] + leadingJetTaggerConeCellsTowersSubjets[1][0]);
            sigJetTaggerLeadingLRJDeltaRSubjetsvsSubjetEtRatio_WithGrEq2ConeSubjet->Fill(deltaRConeSubjets, leadingJetTaggerConeCellsTowersSubjets[0][0]/leadingJetTaggerConeCellsTowersSubjets[1][0]);
            sigJetTaggerLeadingLRJEtvsSubjetEtRatioTimesDeltaRSubjets_WithGrEq2ConeSubjet->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0), deltaRConeSubjets * leadingJetTaggerConeCellsTowersSubjets[0][0]/leadingJetTaggerConeCellsTowersSubjets[1][0]);
            sig_h_leading_LRJ_DeltaRSubjetsTimesSubjetEtRatio_WithGrEq2ConeSubjet->Fill(deltaRConeSubjets * leadingJetTaggerConeCellsTowersSubjets[0][0]/leadingJetTaggerConeCellsTowersSubjets[1][0]);
            sig_h_leading_LRJ_MassApprox_WithGrEq2ConeSubjet->Fill(jetTaggerLeadingMassApproxCone_SubjetEt);
            sig_h_leading_LRJ_DeltaRSubjets_WithGrEq2ConeSubjet->Fill(deltaRConeSubjets);
            sigJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0), jetTaggerLeadingMassApproxCone);
            sigJetTaggerLeadingLRJEtvsMassApprox_SubjetEt_WithGrEq2ConeSubjet->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0), jetTaggerLeadingMassApproxCone_SubjetEt);
            sigJetTaggerLeadingLRJEtvsDeltaRSubjets_WithGrEq2ConeSubjet->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0), deltaRConeSubjets);

            double Z_lead = leadingJetTaggerConeCellsTowersSubjets[1][0]/jetTaggerLeadingLRJEtValuesSignal->at(0);
            double d12_lead = sqrt(Z_lead * Z_lead * jetTaggerLeadingLRJEtValuesSignal->at(0) * jetTaggerLeadingLRJEtValuesSignal->at(0) * deltaRConeSubjets * deltaRConeSubjets);

            sigJetTaggerLeadingLRJEtvsZ_WithGrEq2ConeSubjet->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0), Z_lead);
            sigJetTaggerLeadingLRJEtvsd12_WithGrEq2ConeSubjet->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0), d12_lead);
        }

        if(nSubjetConeCellsTowersJetTaggerLeading >= 1){
            double Z = leadingJetTaggerConeCellsTowersSubjets[1][0]/jetTaggerLeadingLRJEtValuesSignal->at(0);
            
            sig_h_leading_LRJ_Z->Fill(Z);
            sigJetTaggerLeadingLRJEtvsZ->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0), Z);
            sigJetTaggerLeadingLRJEtvs1MinusZ->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0), 1 - Z);
            if(nSubjetConeCellsTowersJetTaggerLeading >= 2){
                double Z_lead = leadingJetTaggerConeCellsTowersSubjets[0][0]/jetTaggerLeadingLRJEtValuesSignal->at(0);
                sigJetTaggerLeadingLRJEtvsEtOutsideSubjets->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0), 1 - (Z + Z_lead));
            }
        }
        if(nSubjetConeCellsTowersJetTaggerSubleading >= 1){
            double Z = subleadingJetTaggerConeCellsTowersSubjets[1][0]/jetTaggerSubleadingLRJEtValuesSignal->at(0);
            sig_h_subleading_LRJ_Z->Fill(Z);
            sigJetTaggerSubleadingLRJEtvsZ->Fill(jetTaggerSubleadingLRJEtValuesSignal->at(0), Z);
            sigJetTaggerSubleadingLRJEtvs1MinusZ->Fill(jetTaggerSubleadingLRJEtValuesSignal->at(0), 1 - Z);
            if(nSubjetConeCellsTowersJetTaggerSubleading >= 2){
                double Z_lead = subleadingJetTaggerConeCellsTowersSubjets[0][0]/jetTaggerSubleadingLRJEtValuesSignal->at(0);
                sigJetTaggerSubleadingLRJEtvsEtOutsideSubjets->Fill(jetTaggerSubleadingLRJEtValuesSignal->at(0), 1 - (Z + Z_lead));
            }
        }
        if(nSubjetjFEXJetTaggerLeading == 0){
            sig_h_leading_LRJ_psi_R_squared_NojFEXSubjets->Fill(jetTaggerLeadingLRJPsi_RValuesSignal->at(0) * jetTaggerSubleadingLRJPsi_RValuesSignal->at(0));
            sig_h_leading_LRJ_Et_NojFEXSubjets->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0));
            sigJetTaggerLeadingLRJEtvsPsi_R_squared_NojFEXSubjets->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0), jetTaggerLeadingLRJPsi_RValuesSignal->at(0) * jetTaggerSubleadingLRJPsi_RValuesSignal->at(0));
            sigJetTaggerLeadingLRJEtvsPsi_R_NojFEXSubjets->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0), jetTaggerLeadingLRJPsi_RValuesSignal->at(0));
        }
        else if(nSubjetjFEXJetTaggerLeading == 1){
            sig_h_leading_LRJ_psi_R_squared_With1jFEXSubjet->Fill(jetTaggerLeadingLRJPsi_RValuesSignal->at(0) * jetTaggerSubleadingLRJPsi_RValuesSignal->at(0));
            sig_h_leading_LRJ_Et_With1jFEXSubjet->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0));
            sigJetTaggerLeadingLRJEtvsPsi_R_squared_With1jFEXSubjet->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0), jetTaggerLeadingLRJPsi_RValuesSignal->at(0) * jetTaggerSubleadingLRJPsi_RValuesSignal->at(0));
            sigJetTaggerLeadingLRJEtvsPsi_R_With1jFEXSubjet->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0), jetTaggerLeadingLRJPsi_RValuesSignal->at(0));
        }
        else if(nSubjetjFEXJetTaggerLeading > 1){
            sig_h_leading_LRJ_psi_R_squared_WithGrEq2jFEXSubjet->Fill(jetTaggerLeadingLRJPsi_RValuesSignal->at(0) * jetTaggerSubleadingLRJPsi_RValuesSignal->at(0));
            sig_h_leading_LRJ_Et_WithGrEq2jFEXSubjet->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0));
            sigJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2jFEXSubjet->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0), jetTaggerLeadingLRJPsi_RValuesSignal->at(0) * jetTaggerSubleadingLRJPsi_RValuesSignal->at(0));
            sigJetTaggerLeadingLRJEtvsPsi_R_WithGrEq2jFEXSubjet->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0), jetTaggerLeadingLRJPsi_RValuesSignal->at(0));
            // compute delta R of leading, subleading subjets:
            double deltaRSubjets = sqrt(calcDeltaR2(leadingJetTaggerjFEXSubjets[0][1], leadingJetTaggerjFEXSubjets[0][2], leadingJetTaggerjFEXSubjets[1][1], leadingJetTaggerjFEXSubjets[1][2]));
            double jetTaggerLeadingMassApprox = deltaRSubjets* jetTaggerLeadingLRJEtValuesSignal->at(0);
            sig_h_leading_LRJ_MassApprox_WithGrEq2jFEXSubjet->Fill(jetTaggerLeadingMassApprox);
            sig_h_leading_LRJ_DeltaRSubjets_WithGrEq2jFEXSubjet->Fill(deltaRSubjets);
            sigJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2jFEXSubjet->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0), jetTaggerLeadingMassApprox);
            sigJetTaggerLeadingLRJEtvsDeltaRSubjets_WithGrEq2jFEXSubjet->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0), deltaRSubjets);
        }


        unsigned int highestEtIndexLRJSig = -1;
        if(sig_LRJ_Et[i][0] >= sig_LRJ_Et[i][1]) highestEtIndexLRJSig = 0;
        else highestEtIndexLRJSig = 1;

        double jFEXSRJLeadingEta;
        double jFEXSRJLeadingPhi;
        if(jFexSRJLeadingEtaValuesSignal->size() > 0){
            jFEXSRJLeadingEta = jFexSRJLeadingEtaValuesSignal->at(0);
        
            jFEXSRJLeadingPhi = jFexSRJLeadingPhiValuesSignal->at(0);
        }
        else{
            jFEXSRJLeadingEta = 0.0;
            jFEXSRJLeadingPhi = 0.0;
        }
            
        double jFEXSRJSubleadingEta; 
        double jFEXSRJSubleadingPhi;
        if(jFexSRJSubleadingEtaValuesSignal->size() > 0){ 
            jFEXSRJSubleadingEta = jFexSRJSubleadingEtaValuesSignal->at(0);
            jFEXSRJSubleadingPhi = jFexSRJSubleadingPhiValuesSignal->at(0);
        }   
        else{
            jFEXSRJSubleadingEta = 0.0;
            jFEXSRJSubleadingPhi = 0.0;
        }
        // Fill cone jet kinematic distributions
        //std::cout << "gepLeadingConeCellsTowersJetspTValuesSignal->size(): " << gepLeadingConeCellsTowersJetspTValuesSignal->size() << "\n";
        if(gepLeadingWTAConeCellsTowersJetspTValuesSignal->size() > 0) sig_h_leading_WTA_conecellstowers_pT->Fill(gepLeadingWTAConeCellsTowersJetspTValuesSignal->at(0));
        if(gepSubleadingWTAConeCellsTowersJetspTValuesSignal->size() > 0) sig_h_subleading_WTA_conecellstowers_pT->Fill(gepSubleadingWTAConeCellsTowersJetspTValuesSignal->at(0));
        if(gepLeadingWTAConeGEPBasicClustersJetspTValuesSignal->size() > 0) sig_h_leading_WTA_conebasicclusters_pT->Fill(gepLeadingWTAConeGEPBasicClustersJetspTValuesSignal->at(0));
        if(gepSubleadingWTAConeGEPBasicClustersJetspTValuesSignal->size() > 0) sig_h_subleading_WTA_conebasicclusters_pT->Fill(gepSubleadingWTAConeGEPBasicClustersJetspTValuesSignal->at(0));

        sig_h_WTA_conecellstowers_multiplicity->Fill(gepWTAConeCellsTowersJetspTValuesSignal->size());
        sig_h_WTA_conebasicclusters_multiplicity->Fill(gepWTAConeGEPBasicClustersJetspTValuesSignal->size());

        double psi_R_SigJet1 = 0.0;
        double psi_R_SigJet2 = 0.0;

        // Keep track of psi_R for variable number of considered input objects
        double psi_R_SigJet1_VariableIOs_2 = 0.0;
        double psi_R_SigJet2_VariableIOs_2 = 0.0;
        double psi_R_Et_sum_variableIOs_SigJet1_2 = 0.0;
        double psi_R_Et_sum_variableIOs_SigJet2_2 = 0.0;
        double psi_R_SigJet1_VariableIOs_3 = 0.0;
        double psi_R_SigJet2_VariableIOs_3 = 0.0;
        double psi_R_Et_sum_variableIOs_SigJet1_3 = 0.0;
        double psi_R_Et_sum_variableIOs_SigJet2_3 = 0.0;
        double psi_R_SigJet1_VariableIOs_4 = 0.0;
        double psi_R_SigJet2_VariableIOs_4 = 0.0;
        double psi_R_Et_sum_variableIOs_SigJet1_4 = 0.0;
        double psi_R_Et_sum_variableIOs_SigJet2_4 = 0.0;
        double psi_R_SigJet1_VariableIOs_5 = 0.0;
        double psi_R_SigJet2_VariableIOs_5 = 0.0;
        double psi_R_Et_sum_variableIOs_SigJet1_5 = 0.0;
        double psi_R_Et_sum_variableIOs_SigJet2_5 = 0.0;

        // Keep track of psi_R^2 for variable number of considered input objects
        double psi_R2_SigJet1_VariableIOs_2 = 0.0;
        double psi_R2_SigJet2_VariableIOs_2 = 0.0;
        double psi_R2_Et_sum_variableIOs_SigJet1_2 = 0.0;
        double psi_R2_Et_sum_variableIOs_SigJet2_2 = 0.0;
        double psi_R2_SigJet1_VariableIOs_3 = 0.0;
        double psi_R2_SigJet2_VariableIOs_3 = 0.0;
        double psi_R2_Et_sum_variableIOs_SigJet1_3 = 0.0;
        double psi_R2_Et_sum_variableIOs_SigJet2_3 = 0.0;
        double psi_R2_SigJet1_VariableIOs_4 = 0.0;
        double psi_R2_SigJet2_VariableIOs_4 = 0.0;
        double psi_R2_Et_sum_variableIOs_SigJet1_4 = 0.0;
        double psi_R2_Et_sum_variableIOs_SigJet2_4 = 0.0;
        double psi_R2_SigJet1_VariableIOs_5 = 0.0;
        double psi_R2_SigJet2_VariableIOs_5 = 0.0;
        double psi_R2_Et_sum_variableIOs_SigJet1_5 = 0.0;
        double psi_R2_Et_sum_variableIOs_SigJet2_5 = 0.0;

        double psi_R2_SigJet1 = 0.0;
        double psi_R2_SigJet2 = 0.0;

        psi_R_SigJet1 = jetTaggerLeadingLRJPsi_RValuesSignal->at(0);
        psi_R_SigJet2 = jetTaggerSubleadingLRJPsi_RValuesSignal->at(0);

        //if((i >= evDisplay0Sig_) && (i <= evDisplay4Sig_)){
        //    std::cout << "psi_R leading jet: " << psi_R_SigJet1 << "\n";
        //    std::cout << "psi_R subleading jet: " << psi_R_SigJet2 << "\n";
        //}

        //std::cout << "jetTaggerLeadingLRJMergedIndicesValuesSignal: " << jetTaggerLeadingLRJMergedIndicesValuesSignal->size() << "\n";

        // Loop through and compute psi_R^2 for each large-R jet
        unsigned indexCounterLeadingJet = 0;
        unsigned indexCounterSubleadingJet = 0;
        for(auto& idxSigJet1 : *jetTaggerLeadingLRJMergedIndicesValuesSignal){
            if(inputObjectType == "gepBasicClusters"){
                if (indexCounterLeadingJet < variableIOCutOff_2){
                    psi_R_SigJet1_VariableIOs_2 += gepBasicClustersEtValuesSignal->at(idxSigJet1) * sqrt(calcDeltaR2(jetTaggerLeadingLRJEtaValuesSignal->at(0), jetTaggerLeadingLRJPhiValuesSignal->at(0), gepBasicClustersEtaValuesSignal->at(idxSigJet1), gepBasicClustersPhiValuesSignal->at(idxSigJet1)));
                    psi_R2_SigJet1_VariableIOs_2 += gepBasicClustersEtValuesSignal->at(idxSigJet1) * calcDeltaR2(jetTaggerLeadingLRJEtaValuesSignal->at(0), jetTaggerLeadingLRJPhiValuesSignal->at(0), gepBasicClustersEtaValuesSignal->at(idxSigJet1), gepBasicClustersPhiValuesSignal->at(idxSigJet1));
                    psi_R_Et_sum_variableIOs_SigJet1_2 += gepBasicClustersEtValuesSignal->at(idxSigJet1);
                } 
                if (indexCounterLeadingJet < variableIOCutOff_3){
                    psi_R_SigJet1_VariableIOs_3 += gepBasicClustersEtValuesSignal->at(idxSigJet1) * sqrt(calcDeltaR2(jetTaggerLeadingLRJEtaValuesSignal->at(0), jetTaggerLeadingLRJPhiValuesSignal->at(0), gepBasicClustersEtaValuesSignal->at(idxSigJet1), gepBasicClustersPhiValuesSignal->at(idxSigJet1)));
                    psi_R2_SigJet1_VariableIOs_3 += gepBasicClustersEtValuesSignal->at(idxSigJet1) * calcDeltaR2(jetTaggerLeadingLRJEtaValuesSignal->at(0), jetTaggerLeadingLRJPhiValuesSignal->at(0), gepBasicClustersEtaValuesSignal->at(idxSigJet1), gepBasicClustersPhiValuesSignal->at(idxSigJet1));
                    psi_R_Et_sum_variableIOs_SigJet1_3 += gepBasicClustersEtValuesSignal->at(idxSigJet1);
                } 
                if (indexCounterLeadingJet < variableIOCutOff_4){
                    psi_R_SigJet1_VariableIOs_4 += gepBasicClustersEtValuesSignal->at(idxSigJet1) * sqrt(calcDeltaR2(jetTaggerLeadingLRJEtaValuesSignal->at(0), jetTaggerLeadingLRJPhiValuesSignal->at(0), gepBasicClustersEtaValuesSignal->at(idxSigJet1), gepBasicClustersPhiValuesSignal->at(idxSigJet1)));
                    psi_R2_SigJet1_VariableIOs_4 += gepBasicClustersEtValuesSignal->at(idxSigJet1) * calcDeltaR2(jetTaggerLeadingLRJEtaValuesSignal->at(0), jetTaggerLeadingLRJPhiValuesSignal->at(0), gepBasicClustersEtaValuesSignal->at(idxSigJet1), gepBasicClustersPhiValuesSignal->at(idxSigJet1));
                    psi_R_Et_sum_variableIOs_SigJet1_4 += gepBasicClustersEtValuesSignal->at(idxSigJet1);
                } 
                if (indexCounterLeadingJet < variableIOCutOff_5){
                    psi_R_SigJet1_VariableIOs_5 += gepBasicClustersEtValuesSignal->at(idxSigJet1) * sqrt(calcDeltaR2(jetTaggerLeadingLRJEtaValuesSignal->at(0), jetTaggerLeadingLRJPhiValuesSignal->at(0), gepBasicClustersEtaValuesSignal->at(idxSigJet1), gepBasicClustersPhiValuesSignal->at(idxSigJet1)));
                    psi_R2_SigJet1_VariableIOs_5 += gepBasicClustersEtValuesSignal->at(idxSigJet1) * calcDeltaR2(jetTaggerLeadingLRJEtaValuesSignal->at(0), jetTaggerLeadingLRJPhiValuesSignal->at(0), gepBasicClustersEtaValuesSignal->at(idxSigJet1), gepBasicClustersPhiValuesSignal->at(idxSigJet1));
                    psi_R_Et_sum_variableIOs_SigJet1_5 += gepBasicClustersEtValuesSignal->at(idxSigJet1);
                } 
                //if(i == evDisplay3Sig_){
                //    std::cout << "ith cluster: " << idxSigJet1 << "\n";
                //    std::cout << "leading jet tagger eta: " << jetTaggerLeadingLRJEtaValuesSignal->at(0) << " and phi: " << jetTaggerLeadingLRJPhiValuesSignal->at(0) << "\n";
                //    std::cout << "cluster eta: " << gepBasicClustersEtaValuesSignal->at(idxSigJet1) << " and phi: " << gepBasicClustersPhiValuesSignal->at(idxSigJet1) << "\n";
                //    std::cout << "deltaR: " << sqrt(calcDeltaR2(jetTaggerLeadingLRJEtaValuesSignal->at(0), jetTaggerLeadingLRJPhiValuesSignal->at(0), gepBasicClustersEtaValuesSignal->at(idxSigJet1), gepBasicClustersPhiValuesSignal->at(idxSigJet1))) << "\n";
                //    std::cout << "cluster et: " << gepBasicClustersEtValuesSignal->at(idxSigJet1) << " and psi_R contribution: " << (1.0/jetTaggerLeadingLRJEtValuesSignal->at(0)) * gepBasicClustersEtValuesSignal->at(idxSigJet1) * sqrt(calcDeltaR2(jetTaggerLeadingLRJEtaValuesSignal->at(0), jetTaggerLeadingLRJPhiValuesSignal->at(0), gepBasicClustersEtaValuesSignal->at(idxSigJet1), gepBasicClustersPhiValuesSignal->at(idxSigJet1))) << "\n";
                //}
                psi_R2_SigJet1 += (1.0/jetTaggerLeadingLRJEtValuesSignal->at(0) * jetRadius * jetRadius) * gepBasicClustersEtValuesSignal->at(idxSigJet1) * calcDeltaR2(jetTaggerLeadingLRJEtaValuesSignal->at(0), jetTaggerLeadingLRJPhiValuesSignal->at(0), gepBasicClustersEtaValuesSignal->at(idxSigJet1), gepBasicClustersPhiValuesSignal->at(idxSigJet1));
            }
            else if(inputObjectType == "Towers"){
                if (indexCounterLeadingJet < variableIOCutOff_2){
                    psi_R_SigJet1_VariableIOs_2 += gepCellsTowersEtValuesSignal->at(idxSigJet1) * sqrt(calcDeltaR2(jetTaggerLeadingLRJEtaValuesSignal->at(0), jetTaggerLeadingLRJPhiValuesSignal->at(0), gepCellsTowersEtaValuesSignal->at(idxSigJet1), gepCellsTowersPhiValuesSignal->at(idxSigJet1)));
                    psi_R2_SigJet1_VariableIOs_2 += gepCellsTowersEtValuesSignal->at(idxSigJet1) * calcDeltaR2(jetTaggerLeadingLRJEtaValuesSignal->at(0), jetTaggerLeadingLRJPhiValuesSignal->at(0), gepCellsTowersEtaValuesSignal->at(idxSigJet1), gepCellsTowersPhiValuesSignal->at(idxSigJet1));
                    psi_R_Et_sum_variableIOs_SigJet1_2 += gepCellsTowersEtValuesSignal->at(idxSigJet1);
                } 
                if (indexCounterLeadingJet < variableIOCutOff_3){
                    psi_R_SigJet1_VariableIOs_3 += gepCellsTowersEtValuesSignal->at(idxSigJet1) * sqrt(calcDeltaR2(jetTaggerLeadingLRJEtaValuesSignal->at(0), jetTaggerLeadingLRJPhiValuesSignal->at(0), gepCellsTowersEtaValuesSignal->at(idxSigJet1), gepCellsTowersPhiValuesSignal->at(idxSigJet1)));
                    psi_R2_SigJet1_VariableIOs_3 += gepCellsTowersEtValuesSignal->at(idxSigJet1) * calcDeltaR2(jetTaggerLeadingLRJEtaValuesSignal->at(0), jetTaggerLeadingLRJPhiValuesSignal->at(0), gepCellsTowersEtaValuesSignal->at(idxSigJet1), gepCellsTowersPhiValuesSignal->at(idxSigJet1));
                    psi_R_Et_sum_variableIOs_SigJet1_3 += gepCellsTowersEtValuesSignal->at(idxSigJet1);
                } 
                if (indexCounterLeadingJet < variableIOCutOff_4){
                    psi_R_SigJet1_VariableIOs_4 += gepCellsTowersEtValuesSignal->at(idxSigJet1) * sqrt(calcDeltaR2(jetTaggerLeadingLRJEtaValuesSignal->at(0), jetTaggerLeadingLRJPhiValuesSignal->at(0), gepCellsTowersEtaValuesSignal->at(idxSigJet1), gepCellsTowersPhiValuesSignal->at(idxSigJet1)));
                    psi_R2_SigJet1_VariableIOs_4 += gepCellsTowersEtValuesSignal->at(idxSigJet1) * calcDeltaR2(jetTaggerLeadingLRJEtaValuesSignal->at(0), jetTaggerLeadingLRJPhiValuesSignal->at(0), gepCellsTowersEtaValuesSignal->at(idxSigJet1), gepCellsTowersPhiValuesSignal->at(idxSigJet1));
                    psi_R_Et_sum_variableIOs_SigJet1_4 += gepCellsTowersEtValuesSignal->at(idxSigJet1);
                } 
                if (indexCounterLeadingJet < variableIOCutOff_5){
                    psi_R_SigJet1_VariableIOs_5 += gepCellsTowersEtValuesSignal->at(idxSigJet1) * sqrt(calcDeltaR2(jetTaggerLeadingLRJEtaValuesSignal->at(0), jetTaggerLeadingLRJPhiValuesSignal->at(0), gepCellsTowersEtaValuesSignal->at(idxSigJet1), gepCellsTowersPhiValuesSignal->at(idxSigJet1)));
                    psi_R2_SigJet1_VariableIOs_5 += gepCellsTowersEtValuesSignal->at(idxSigJet1) * calcDeltaR2(jetTaggerLeadingLRJEtaValuesSignal->at(0), jetTaggerLeadingLRJPhiValuesSignal->at(0), gepCellsTowersEtaValuesSignal->at(idxSigJet1), gepCellsTowersPhiValuesSignal->at(idxSigJet1));
                    psi_R_Et_sum_variableIOs_SigJet1_5 += gepCellsTowersEtValuesSignal->at(idxSigJet1);
                } 
                //if(i == evDisplay3Sig_){
                ///    std::cout << "ith tower: " << idxSigJet1 << "\n";
                //    std::cout << "leading jet tagger eta: " << jetTaggerLeadingLRJEtaValuesSignal->at(0) << " and phi: " << jetTaggerLeadingLRJPhiValuesSignal->at(0) << "\n";
                //    std::cout << "tower eta: " << gepCellsTowersEtaValuesSignal->at(idxSigJet1) << " and phi: " << gepCellsTowersPhiValuesSignal->at(idxSigJet1) << "\n";
                //    std::cout << "tower deltaR : " << sqrt(calcDeltaR2(jetTaggerLeadingLRJEtaValuesSignal->at(0), jetTaggerLeadingLRJPhiValuesSignal->at(0), gepCellsTowersEtaValuesSignal->at(idxSigJet1), gepCellsTowersPhiValuesSignal->at(idxSigJet1))) << "\n";
                //    std::cout << "tower et: " << gepCellsTowersEtValuesSignal->at(idxSigJet1) << " and psi_R contribution: " << (1.0/jetTaggerLeadingLRJEtValuesSignal->at(0)) * gepCellsTowersEtValuesSignal->at(idxSigJet1) * sqrt(calcDeltaR2(jetTaggerLeadingLRJEtaValuesSignal->at(0), jetTaggerLeadingLRJPhiValuesSignal->at(0), gepCellsTowersEtaValuesSignal->at(idxSigJet1), gepCellsTowersPhiValuesSignal->at(idxSigJet1))) << "\n";
                //}
                psi_R2_SigJet1 += (1.0/jetTaggerLeadingLRJEtValuesSignal->at(0)  * jetRadius * jetRadius) * gepCellsTowersEtValuesSignal->at(idxSigJet1) * calcDeltaR2(jetTaggerLeadingLRJEtaValuesSignal->at(0), jetTaggerLeadingLRJPhiValuesSignal->at(0), gepCellsTowersEtaValuesSignal->at(idxSigJet1), gepCellsTowersPhiValuesSignal->at(idxSigJet1));
            }
            else if(inputObjectType == "ConeJets"){
                if (indexCounterLeadingJet < variableIOCutOff_2){
                    psi_R_SigJet1_VariableIOs_2 += gepWTAConeCellsTowersJetspTValuesSignal->at(idxSigJet1) * sqrt(calcDeltaR2(jetTaggerLeadingLRJEtaValuesSignal->at(0), jetTaggerLeadingLRJPhiValuesSignal->at(0), gepWTAConeCellsTowersJetsEtaValuesSignal->at(idxSigJet1), gepWTAConeCellsTowersJetsPhiValuesSignal->at(idxSigJet1)));
                    psi_R2_SigJet1_VariableIOs_2 += gepWTAConeCellsTowersJetspTValuesSignal->at(idxSigJet1) * calcDeltaR2(jetTaggerLeadingLRJEtaValuesSignal->at(0), jetTaggerLeadingLRJPhiValuesSignal->at(0), gepWTAConeCellsTowersJetsEtaValuesSignal->at(idxSigJet1), gepWTAConeCellsTowersJetsPhiValuesSignal->at(idxSigJet1));
                    psi_R_Et_sum_variableIOs_SigJet1_2 += gepWTAConeCellsTowersJetspTValuesSignal->at(idxSigJet1);
                } 
                if (indexCounterLeadingJet < variableIOCutOff_3){
                    psi_R_SigJet1_VariableIOs_3 += gepWTAConeCellsTowersJetspTValuesSignal->at(idxSigJet1) * sqrt(calcDeltaR2(jetTaggerLeadingLRJEtaValuesSignal->at(0), jetTaggerLeadingLRJPhiValuesSignal->at(0), gepWTAConeCellsTowersJetsEtaValuesSignal->at(idxSigJet1), gepWTAConeCellsTowersJetsPhiValuesSignal->at(idxSigJet1)));
                    psi_R2_SigJet1_VariableIOs_3 += gepWTAConeCellsTowersJetspTValuesSignal->at(idxSigJet1) * calcDeltaR2(jetTaggerLeadingLRJEtaValuesSignal->at(0), jetTaggerLeadingLRJPhiValuesSignal->at(0), gepWTAConeCellsTowersJetsEtaValuesSignal->at(idxSigJet1), gepWTAConeCellsTowersJetsPhiValuesSignal->at(idxSigJet1));
                    psi_R_Et_sum_variableIOs_SigJet1_3 += gepWTAConeCellsTowersJetspTValuesSignal->at(idxSigJet1);
                } 
                if (indexCounterLeadingJet < variableIOCutOff_4){
                    psi_R_SigJet1_VariableIOs_4 += gepWTAConeCellsTowersJetspTValuesSignal->at(idxSigJet1) * sqrt(calcDeltaR2(jetTaggerLeadingLRJEtaValuesSignal->at(0), jetTaggerLeadingLRJPhiValuesSignal->at(0), gepWTAConeCellsTowersJetsEtaValuesSignal->at(idxSigJet1), gepWTAConeCellsTowersJetsPhiValuesSignal->at(idxSigJet1)));
                    psi_R2_SigJet1_VariableIOs_4 += gepWTAConeCellsTowersJetspTValuesSignal->at(idxSigJet1) * calcDeltaR2(jetTaggerLeadingLRJEtaValuesSignal->at(0), jetTaggerLeadingLRJPhiValuesSignal->at(0), gepWTAConeCellsTowersJetsEtaValuesSignal->at(idxSigJet1), gepWTAConeCellsTowersJetsPhiValuesSignal->at(idxSigJet1));
                    psi_R_Et_sum_variableIOs_SigJet1_4 += gepWTAConeCellsTowersJetspTValuesSignal->at(idxSigJet1);
                } 
                if (indexCounterLeadingJet < variableIOCutOff_5){
                    psi_R_SigJet1_VariableIOs_5 += gepWTAConeCellsTowersJetspTValuesSignal->at(idxSigJet1) * sqrt(calcDeltaR2(jetTaggerLeadingLRJEtaValuesSignal->at(0), jetTaggerLeadingLRJPhiValuesSignal->at(0), gepWTAConeCellsTowersJetsEtaValuesSignal->at(idxSigJet1), gepWTAConeCellsTowersJetsPhiValuesSignal->at(idxSigJet1)));
                    psi_R2_SigJet1_VariableIOs_5 += gepWTAConeCellsTowersJetspTValuesSignal->at(idxSigJet1) * calcDeltaR2(jetTaggerLeadingLRJEtaValuesSignal->at(0), jetTaggerLeadingLRJPhiValuesSignal->at(0), gepWTAConeCellsTowersJetsEtaValuesSignal->at(idxSigJet1), gepWTAConeCellsTowersJetsPhiValuesSignal->at(idxSigJet1));
                    psi_R_Et_sum_variableIOs_SigJet1_5 += gepWTAConeCellsTowersJetspTValuesSignal->at(idxSigJet1);
                } 
                psi_R2_SigJet1 += (1.0/jetTaggerLeadingLRJEtValuesSignal->at(0) * jetRadius * jetRadius) * gepWTAConeCellsTowersJetspTValuesSignal->at(idxSigJet1) * calcDeltaR2(jetTaggerLeadingLRJEtaValuesSignal->at(0), jetTaggerLeadingLRJPhiValuesSignal->at(0), gepWTAConeCellsTowersJetsEtaValuesSignal->at(idxSigJet1), gepWTAConeCellsTowersJetsPhiValuesSignal->at(idxSigJet1));
            }
            else {
                std::cerr << "INPUT OBJECT UNKNOWN!" << "\n";
            }
            indexCounterLeadingJet++;
        }
        psi_R_SigJet1_VariableIOs_2/=psi_R_Et_sum_variableIOs_SigJet1_2;
        psi_R_SigJet1_VariableIOs_3/=psi_R_Et_sum_variableIOs_SigJet1_3;
        psi_R_SigJet1_VariableIOs_4/=psi_R_Et_sum_variableIOs_SigJet1_4;
        psi_R_SigJet1_VariableIOs_5/=psi_R_Et_sum_variableIOs_SigJet1_5;

        psi_R2_SigJet1_VariableIOs_2/=psi_R_Et_sum_variableIOs_SigJet1_2;
        psi_R2_SigJet1_VariableIOs_3/=psi_R_Et_sum_variableIOs_SigJet1_3;
        psi_R2_SigJet1_VariableIOs_4/=psi_R_Et_sum_variableIOs_SigJet1_4;
        psi_R2_SigJet1_VariableIOs_5/=psi_R_Et_sum_variableIOs_SigJet1_5;

        for(auto& idxSigJet2 : *jetTaggerSubleadingLRJMergedIndicesValuesSignal){
            if(inputObjectType == "gepBasicClusters"){
                if (indexCounterSubleadingJet < variableIOCutOff_2){
                    psi_R_SigJet2_VariableIOs_2 += gepBasicClustersEtValuesSignal->at(idxSigJet2) * sqrt(calcDeltaR2(jetTaggerSubleadingLRJEtaValuesSignal->at(0), jetTaggerSubleadingLRJPhiValuesSignal->at(0), gepBasicClustersEtaValuesSignal->at(idxSigJet2), gepBasicClustersPhiValuesSignal->at(idxSigJet2)));
                    psi_R2_SigJet2_VariableIOs_2 += gepBasicClustersEtValuesSignal->at(idxSigJet2) * calcDeltaR2(jetTaggerSubleadingLRJEtaValuesSignal->at(0), jetTaggerSubleadingLRJPhiValuesSignal->at(0), gepBasicClustersEtaValuesSignal->at(idxSigJet2), gepBasicClustersPhiValuesSignal->at(idxSigJet2));
                    psi_R_Et_sum_variableIOs_SigJet2_2 += gepBasicClustersEtValuesSignal->at(idxSigJet2);
                } 
                if (indexCounterSubleadingJet < variableIOCutOff_3){
                    psi_R_SigJet2_VariableIOs_3 += gepBasicClustersEtValuesSignal->at(idxSigJet2) *  sqrt(calcDeltaR2(jetTaggerSubleadingLRJEtaValuesSignal->at(0), jetTaggerSubleadingLRJPhiValuesSignal->at(0), gepBasicClustersEtaValuesSignal->at(idxSigJet2), gepBasicClustersPhiValuesSignal->at(idxSigJet2)));
                    psi_R2_SigJet2_VariableIOs_3 += gepBasicClustersEtValuesSignal->at(idxSigJet2) * calcDeltaR2(jetTaggerSubleadingLRJEtaValuesSignal->at(0), jetTaggerSubleadingLRJPhiValuesSignal->at(0), gepBasicClustersEtaValuesSignal->at(idxSigJet2), gepBasicClustersPhiValuesSignal->at(idxSigJet2));
                    psi_R_Et_sum_variableIOs_SigJet2_3 += gepBasicClustersEtValuesSignal->at(idxSigJet2);
                } 
                if (indexCounterSubleadingJet < variableIOCutOff_4){
                    psi_R_SigJet2_VariableIOs_4 += gepBasicClustersEtValuesSignal->at(idxSigJet2) * sqrt(calcDeltaR2(jetTaggerSubleadingLRJEtaValuesSignal->at(0), jetTaggerSubleadingLRJPhiValuesSignal->at(0), gepBasicClustersEtaValuesSignal->at(idxSigJet2), gepBasicClustersPhiValuesSignal->at(idxSigJet2)));
                    psi_R2_SigJet2_VariableIOs_4 += gepBasicClustersEtValuesSignal->at(idxSigJet2) * calcDeltaR2(jetTaggerSubleadingLRJEtaValuesSignal->at(0), jetTaggerSubleadingLRJPhiValuesSignal->at(0), gepBasicClustersEtaValuesSignal->at(idxSigJet2), gepBasicClustersPhiValuesSignal->at(idxSigJet2));
                    psi_R_Et_sum_variableIOs_SigJet2_4 += gepBasicClustersEtValuesSignal->at(idxSigJet2);
                } 
                if (indexCounterSubleadingJet < variableIOCutOff_5){
                    psi_R_SigJet2_VariableIOs_5 += gepBasicClustersEtValuesSignal->at(idxSigJet2) * sqrt(calcDeltaR2(jetTaggerSubleadingLRJEtaValuesSignal->at(0), jetTaggerSubleadingLRJPhiValuesSignal->at(0), gepBasicClustersEtaValuesSignal->at(idxSigJet2), gepBasicClustersPhiValuesSignal->at(idxSigJet2)));
                    psi_R2_SigJet2_VariableIOs_5 += gepBasicClustersEtValuesSignal->at(idxSigJet2) * calcDeltaR2(jetTaggerSubleadingLRJEtaValuesSignal->at(0), jetTaggerSubleadingLRJPhiValuesSignal->at(0), gepBasicClustersEtaValuesSignal->at(idxSigJet2), gepBasicClustersPhiValuesSignal->at(idxSigJet2));
                    psi_R_Et_sum_variableIOs_SigJet2_5 += gepBasicClustersEtValuesSignal->at(idxSigJet2);
                } 
                psi_R2_SigJet2 += (1.0/jetTaggerSubleadingLRJEtValuesSignal->at(0) * jetRadius * jetRadius) * gepBasicClustersEtValuesSignal->at(idxSigJet2) * calcDeltaR2(jetTaggerSubleadingLRJEtaValuesSignal->at(0), jetTaggerSubleadingLRJPhiValuesSignal->at(0), gepBasicClustersEtaValuesSignal->at(idxSigJet2), gepBasicClustersPhiValuesSignal->at(idxSigJet2));
            }
            else if(inputObjectType == "Towers"){
                if (indexCounterSubleadingJet < variableIOCutOff_2){
                    psi_R_SigJet2_VariableIOs_2 += gepCellsTowersEtValuesSignal->at(idxSigJet2) * sqrt(calcDeltaR2(jetTaggerSubleadingLRJEtaValuesSignal->at(0), jetTaggerSubleadingLRJPhiValuesSignal->at(0), gepCellsTowersEtaValuesSignal->at(idxSigJet2), gepCellsTowersPhiValuesSignal->at(idxSigJet2)));
                    psi_R2_SigJet2_VariableIOs_2 += gepCellsTowersEtValuesSignal->at(idxSigJet2) * calcDeltaR2(jetTaggerSubleadingLRJEtaValuesSignal->at(0), jetTaggerSubleadingLRJPhiValuesSignal->at(0), gepCellsTowersEtaValuesSignal->at(idxSigJet2), gepCellsTowersPhiValuesSignal->at(idxSigJet2));
                    psi_R_Et_sum_variableIOs_SigJet2_2 += gepCellsTowersEtValuesSignal->at(idxSigJet2);
                } 
                if (indexCounterSubleadingJet < variableIOCutOff_3){
                    psi_R_SigJet2_VariableIOs_3 += gepCellsTowersEtValuesSignal->at(idxSigJet2) * sqrt(calcDeltaR2(jetTaggerSubleadingLRJEtaValuesSignal->at(0), jetTaggerSubleadingLRJPhiValuesSignal->at(0), gepCellsTowersEtaValuesSignal->at(idxSigJet2), gepCellsTowersPhiValuesSignal->at(idxSigJet2)));
                    psi_R2_SigJet2_VariableIOs_3 += gepCellsTowersEtValuesSignal->at(idxSigJet2) * calcDeltaR2(jetTaggerSubleadingLRJEtaValuesSignal->at(0), jetTaggerSubleadingLRJPhiValuesSignal->at(0), gepCellsTowersEtaValuesSignal->at(idxSigJet2), gepCellsTowersPhiValuesSignal->at(idxSigJet2));
                    psi_R_Et_sum_variableIOs_SigJet2_3 += gepCellsTowersEtValuesSignal->at(idxSigJet2);
                } 
                if (indexCounterSubleadingJet < variableIOCutOff_4){
                    psi_R_SigJet2_VariableIOs_4 += gepCellsTowersEtValuesSignal->at(idxSigJet2) * sqrt(calcDeltaR2(jetTaggerSubleadingLRJEtaValuesSignal->at(0), jetTaggerSubleadingLRJPhiValuesSignal->at(0), gepCellsTowersEtaValuesSignal->at(idxSigJet2), gepCellsTowersPhiValuesSignal->at(idxSigJet2)));
                    psi_R2_SigJet2_VariableIOs_4 += gepCellsTowersEtValuesSignal->at(idxSigJet2) * calcDeltaR2(jetTaggerSubleadingLRJEtaValuesSignal->at(0), jetTaggerSubleadingLRJPhiValuesSignal->at(0), gepCellsTowersEtaValuesSignal->at(idxSigJet2), gepCellsTowersPhiValuesSignal->at(idxSigJet2));
                    psi_R_Et_sum_variableIOs_SigJet2_4 += gepCellsTowersEtValuesSignal->at(idxSigJet2);
                } 
                if (indexCounterSubleadingJet < variableIOCutOff_5){
                    psi_R_SigJet2_VariableIOs_5 += gepCellsTowersEtValuesSignal->at(idxSigJet2) * sqrt(calcDeltaR2(jetTaggerSubleadingLRJEtaValuesSignal->at(0), jetTaggerSubleadingLRJPhiValuesSignal->at(0), gepCellsTowersEtaValuesSignal->at(idxSigJet2), gepCellsTowersPhiValuesSignal->at(idxSigJet2)));
                    psi_R2_SigJet2_VariableIOs_5 += gepCellsTowersEtValuesSignal->at(idxSigJet2) * calcDeltaR2(jetTaggerSubleadingLRJEtaValuesSignal->at(0), jetTaggerSubleadingLRJPhiValuesSignal->at(0), gepCellsTowersEtaValuesSignal->at(idxSigJet2), gepCellsTowersPhiValuesSignal->at(idxSigJet2));
                    psi_R_Et_sum_variableIOs_SigJet2_5 += gepCellsTowersEtValuesSignal->at(idxSigJet2);
                } 
                psi_R2_SigJet2 += (1.0/jetTaggerSubleadingLRJEtValuesSignal->at(0) * jetRadius * jetRadius) * gepCellsTowersEtValuesSignal->at(idxSigJet2) * calcDeltaR2(jetTaggerSubleadingLRJEtaValuesSignal->at(0), jetTaggerSubleadingLRJPhiValuesSignal->at(0), gepCellsTowersEtaValuesSignal->at(idxSigJet2), gepCellsTowersPhiValuesSignal->at(idxSigJet2));
            }
            else if(inputObjectType == "ConeJets"){
                if (indexCounterSubleadingJet < variableIOCutOff_2){
                    psi_R_SigJet2_VariableIOs_2 += gepWTAConeCellsTowersJetspTValuesSignal->at(idxSigJet2) * sqrt(calcDeltaR2(jetTaggerSubleadingLRJEtaValuesSignal->at(0), jetTaggerSubleadingLRJPhiValuesSignal->at(0), gepWTAConeCellsTowersJetsEtaValuesSignal->at(idxSigJet2), gepWTAConeCellsTowersJetsPhiValuesSignal->at(idxSigJet2)));
                    psi_R2_SigJet2_VariableIOs_2 += gepWTAConeCellsTowersJetspTValuesSignal->at(idxSigJet2) * calcDeltaR2(jetTaggerSubleadingLRJEtaValuesSignal->at(0), jetTaggerSubleadingLRJPhiValuesSignal->at(0), gepWTAConeCellsTowersJetsEtaValuesSignal->at(idxSigJet2), gepWTAConeCellsTowersJetsPhiValuesSignal->at(idxSigJet2));
                    psi_R_Et_sum_variableIOs_SigJet2_2 += gepWTAConeCellsTowersJetspTValuesSignal->at(idxSigJet2);
                } 
                if (indexCounterSubleadingJet < variableIOCutOff_3){
                    psi_R_SigJet2_VariableIOs_3 += gepWTAConeCellsTowersJetspTValuesSignal->at(idxSigJet2) * sqrt(calcDeltaR2(jetTaggerSubleadingLRJEtaValuesSignal->at(0), jetTaggerSubleadingLRJPhiValuesSignal->at(0), gepWTAConeCellsTowersJetsEtaValuesSignal->at(idxSigJet2), gepWTAConeCellsTowersJetsPhiValuesSignal->at(idxSigJet2)));
                    psi_R2_SigJet2_VariableIOs_3 += gepWTAConeCellsTowersJetspTValuesSignal->at(idxSigJet2) * calcDeltaR2(jetTaggerSubleadingLRJEtaValuesSignal->at(0), jetTaggerSubleadingLRJPhiValuesSignal->at(0), gepWTAConeCellsTowersJetsEtaValuesSignal->at(idxSigJet2), gepWTAConeCellsTowersJetsPhiValuesSignal->at(idxSigJet2));
                    psi_R_Et_sum_variableIOs_SigJet2_3 += gepWTAConeCellsTowersJetspTValuesSignal->at(idxSigJet2);
                } 
                if (indexCounterSubleadingJet < variableIOCutOff_4){
                    psi_R_SigJet2_VariableIOs_4 += gepWTAConeCellsTowersJetspTValuesSignal->at(idxSigJet2) * sqrt(calcDeltaR2(jetTaggerSubleadingLRJEtaValuesSignal->at(0), jetTaggerSubleadingLRJPhiValuesSignal->at(0), gepWTAConeCellsTowersJetsEtaValuesSignal->at(idxSigJet2), gepWTAConeCellsTowersJetsPhiValuesSignal->at(idxSigJet2)));
                    psi_R2_SigJet2_VariableIOs_4 += gepWTAConeCellsTowersJetspTValuesSignal->at(idxSigJet2) * calcDeltaR2(jetTaggerSubleadingLRJEtaValuesSignal->at(0), jetTaggerSubleadingLRJPhiValuesSignal->at(0), gepWTAConeCellsTowersJetsEtaValuesSignal->at(idxSigJet2), gepWTAConeCellsTowersJetsPhiValuesSignal->at(idxSigJet2));
                    psi_R_Et_sum_variableIOs_SigJet2_4 += gepWTAConeCellsTowersJetspTValuesSignal->at(idxSigJet2);
                } 
                if (indexCounterSubleadingJet < variableIOCutOff_5){
                    psi_R_SigJet2_VariableIOs_5 += gepWTAConeCellsTowersJetspTValuesSignal->at(idxSigJet2) * sqrt(calcDeltaR2(jetTaggerSubleadingLRJEtaValuesSignal->at(0), jetTaggerSubleadingLRJPhiValuesSignal->at(0), gepWTAConeCellsTowersJetsEtaValuesSignal->at(idxSigJet2), gepWTAConeCellsTowersJetsPhiValuesSignal->at(idxSigJet2)));
                    psi_R2_SigJet2_VariableIOs_5 += gepWTAConeCellsTowersJetspTValuesSignal->at(idxSigJet2) * calcDeltaR2(jetTaggerSubleadingLRJEtaValuesSignal->at(0), jetTaggerSubleadingLRJPhiValuesSignal->at(0), gepWTAConeCellsTowersJetsEtaValuesSignal->at(idxSigJet2), gepWTAConeCellsTowersJetsPhiValuesSignal->at(idxSigJet2));
                    psi_R_Et_sum_variableIOs_SigJet2_5 += gepWTAConeCellsTowersJetspTValuesSignal->at(idxSigJet2);
                } 
                psi_R2_SigJet2 += (1.0/jetTaggerSubleadingLRJEtValuesSignal->at(0) * jetRadius * jetRadius) * gepWTAConeCellsTowersJetspTValuesSignal->at(idxSigJet2) * calcDeltaR2(jetTaggerSubleadingLRJEtaValuesSignal->at(0), jetTaggerSubleadingLRJPhiValuesSignal->at(0), gepWTAConeCellsTowersJetsEtaValuesSignal->at(idxSigJet2), gepWTAConeCellsTowersJetsPhiValuesSignal->at(idxSigJet2));
            }
            else {
                std::cerr << "INPUT OBJECT UNKNOWN!" << "\n";
            }
            indexCounterSubleadingJet++;
        }

        psi_R_SigJet2_VariableIOs_2/=psi_R_Et_sum_variableIOs_SigJet2_2;
        psi_R_SigJet2_VariableIOs_3/=psi_R_Et_sum_variableIOs_SigJet2_3;
        psi_R_SigJet2_VariableIOs_4/=psi_R_Et_sum_variableIOs_SigJet2_4;
        psi_R_SigJet2_VariableIOs_5/=psi_R_Et_sum_variableIOs_SigJet2_5;

        psi_R2_SigJet2_VariableIOs_2/=psi_R_Et_sum_variableIOs_SigJet2_2;
        psi_R2_SigJet2_VariableIOs_3/=psi_R_Et_sum_variableIOs_SigJet2_3;
        psi_R2_SigJet2_VariableIOs_4/=psi_R_Et_sum_variableIOs_SigJet2_4;
        psi_R2_SigJet2_VariableIOs_5/=psi_R_Et_sum_variableIOs_SigJet2_5;


        sig_h_leading_LRJ_psi_R_VariableIOs_2->Fill(psi_R_SigJet1_VariableIOs_2);
        sig_h_subleading_LRJ_psi_R_VariableIOs_2->Fill(psi_R_SigJet2_VariableIOs_2);
        sig_h_LRJ_psi_R_squared_VariableIOs_2->Fill(psi_R_SigJet1_VariableIOs_2 * psi_R_SigJet2_VariableIOs_2); 
        sigJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_2->Fill(std::max(sig_LRJ_Et[i][0], sig_LRJ_Et[i][1]), psi_R_SigJet1_VariableIOs_2 * psi_R_SigJet2_VariableIOs_2);
        sigJetTaggerSubleadingLRJEtvsPsi_R_VariableIOs_2->Fill(std::min(sig_LRJ_Et[i][0], sig_LRJ_Et[i][1]), psi_R_SigJet1_VariableIOs_2 * psi_R_SigJet2_VariableIOs_2);

        sig_h_leading_LRJ_psi_R_VariableIOs_3->Fill(psi_R_SigJet1_VariableIOs_3);
        sig_h_subleading_LRJ_psi_R_VariableIOs_3->Fill(psi_R_SigJet2_VariableIOs_3);
        sig_h_LRJ_psi_R_squared_VariableIOs_3->Fill(psi_R_SigJet1_VariableIOs_3 * psi_R_SigJet2_VariableIOs_3); 
        sigJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_3->Fill(std::max(sig_LRJ_Et[i][0], sig_LRJ_Et[i][1]), psi_R_SigJet1_VariableIOs_3 * psi_R_SigJet2_VariableIOs_3);
        sigJetTaggerSubleadingLRJEtvsPsi_R_VariableIOs_3->Fill(std::min(sig_LRJ_Et[i][0], sig_LRJ_Et[i][1]), psi_R_SigJet1_VariableIOs_3 * psi_R_SigJet2_VariableIOs_3);

        sig_h_leading_LRJ_psi_R_VariableIOs_4->Fill(psi_R_SigJet1_VariableIOs_4);
        sig_h_subleading_LRJ_psi_R_VariableIOs_4->Fill(psi_R_SigJet2_VariableIOs_4);
        sig_h_LRJ_psi_R_squared_VariableIOs_4->Fill(psi_R_SigJet1_VariableIOs_4 * psi_R_SigJet2_VariableIOs_4); 
        sigJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_4->Fill(std::max(sig_LRJ_Et[i][0], sig_LRJ_Et[i][1]), psi_R_SigJet1_VariableIOs_4 * psi_R_SigJet2_VariableIOs_4);
        sigJetTaggerSubleadingLRJEtvsPsi_R_VariableIOs_4->Fill(std::min(sig_LRJ_Et[i][0], sig_LRJ_Et[i][1]), psi_R_SigJet1_VariableIOs_4 * psi_R_SigJet2_VariableIOs_4);

        sig_h_leading_LRJ_psi_R_VariableIOs_5->Fill(psi_R_SigJet1_VariableIOs_5);
        sig_h_subleading_LRJ_psi_R_VariableIOs_5->Fill(psi_R_SigJet2_VariableIOs_5);
        sig_h_LRJ_psi_R_squared_VariableIOs_5->Fill(psi_R_SigJet1_VariableIOs_5 * psi_R_SigJet2_VariableIOs_5); 
        sigJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_5->Fill(std::max(sig_LRJ_Et[i][0], sig_LRJ_Et[i][1]), psi_R_SigJet1_VariableIOs_5 * psi_R_SigJet2_VariableIOs_5);
        sigJetTaggerSubleadingLRJEtvsPsi_R_VariableIOs_5->Fill(std::min(sig_LRJ_Et[i][0], sig_LRJ_Et[i][1]), psi_R_SigJet1_VariableIOs_5 * psi_R_SigJet2_VariableIOs_5);

        sig_h_leading_LRJ_Psi_R2_VariableIOs_2->Fill(psi_R2_SigJet1_VariableIOs_2);
        sig_h_subleading_LRJ_Psi_R2_VariableIOs_2->Fill(psi_R2_SigJet2_VariableIOs_2);
        sig_h_LRJ_Psi_R2_squared_VariableIOs_2->Fill(psi_R2_SigJet1_VariableIOs_2 * psi_R2_SigJet2_VariableIOs_2); 
        sigJetTaggerLeadingLRJEtvsPsi_R2_VariableIOs_2->Fill(std::max(sig_LRJ_Et[i][0], sig_LRJ_Et[i][1]), psi_R2_SigJet1_VariableIOs_2 * psi_R2_SigJet2_VariableIOs_2);

        sig_h_leading_LRJ_Psi_R2_VariableIOs_3->Fill(psi_R2_SigJet1_VariableIOs_3);
        sig_h_subleading_LRJ_Psi_R2_VariableIOs_3->Fill(psi_R2_SigJet2_VariableIOs_3);
        sig_h_LRJ_Psi_R2_squared_VariableIOs_3->Fill(psi_R2_SigJet1_VariableIOs_3 * psi_R2_SigJet2_VariableIOs_3); 
        sigJetTaggerLeadingLRJEtvsPsi_R2_VariableIOs_3->Fill(std::max(sig_LRJ_Et[i][0], sig_LRJ_Et[i][1]), psi_R2_SigJet1_VariableIOs_3 * psi_R2_SigJet2_VariableIOs_3);

        sig_h_leading_LRJ_Psi_R2_VariableIOs_4->Fill(psi_R2_SigJet1_VariableIOs_4);
        sig_h_subleading_LRJ_Psi_R2_VariableIOs_4->Fill(psi_R2_SigJet2_VariableIOs_4);
        sig_h_LRJ_Psi_R2_squared_VariableIOs_4->Fill(psi_R2_SigJet1_VariableIOs_4 * psi_R2_SigJet2_VariableIOs_4); 
        sigJetTaggerLeadingLRJEtvsPsi_R2_VariableIOs_4->Fill(std::max(sig_LRJ_Et[i][0], sig_LRJ_Et[i][1]), psi_R2_SigJet1_VariableIOs_4 * psi_R2_SigJet2_VariableIOs_4);

        sig_h_leading_LRJ_Psi_R2_VariableIOs_5->Fill(psi_R2_SigJet1_VariableIOs_5);
        sig_h_subleading_LRJ_Psi_R2_VariableIOs_5->Fill(psi_R2_SigJet2_VariableIOs_5);
        sig_h_LRJ_Psi_R2_squared_VariableIOs_5->Fill(psi_R2_SigJet1_VariableIOs_5 * psi_R2_SigJet2_VariableIOs_5); 
        sigJetTaggerLeadingLRJEtvsPsi_R2_VariableIOs_5->Fill(std::max(sig_LRJ_Et[i][0], sig_LRJ_Et[i][1]), psi_R2_SigJet1_VariableIOs_5 * psi_R2_SigJet2_VariableIOs_5);

        sig_h_LRJ_psi_R_squared->Fill(psi_R_SigJet1 * psi_R_SigJet2);
        sigJetTaggerLeadingLRJEtvsPsi_R_squared->Fill(std::max(sig_LRJ_Et[i][0], sig_LRJ_Et[i][1]), psi_R_SigJet1 * psi_R_SigJet2);
        sigJetTaggerSubleadingLRJEtvsPsi_R_squared->Fill(std::min(sig_LRJ_Et[i][0], sig_LRJ_Et[i][1]), psi_R_SigJet1 * psi_R_SigJet2);
        sig_h_LRJ_psi_R2_squared->Fill(psi_R2_SigJet1 * psi_R2_SigJet2);
        sigJetTaggerLeadingLRJEtvsPsi_R2_squared->Fill(std::max(sig_LRJ_Et[i][0], sig_LRJ_Et[i][1]), psi_R2_SigJet1 * psi_R2_SigJet2);
        sigJetTaggerSubleadingLRJEtvsPsi_R2_squared->Fill(std::min(sig_LRJ_Et[i][0], sig_LRJ_Et[i][1]), psi_R2_SigJet1 * psi_R2_SigJet2);

        // Fill psi_R for leading, subleading, signal, background
        // Fill with regular deltaR metric
        sig_h_leading_LRJ_psi_R->Fill(psi_R_SigJet1);
        if (recoAntiKt10LRJLeadingEtValuesSignal->size() > 0){
            if((recoAntiKt10LRJLeadingMassValuesSignal->at(0) >= 100.0) && (recoAntiKt10LRJLeadingMassValuesSignal->at(0) <= 150.0)){
                sig_h_leading_LRJ_psi_R_MassWindow->Fill(psi_R_SigJet1);
            }
            else sig_h_leading_LRJ_psi_R_OutsideMassWindow->Fill(psi_R_SigJet1);
            sigOfflineLeadingLRJMassvsPsi_R->Fill(recoAntiKt10LRJLeadingMassValuesSignal->at(0), psi_R_SigJet1);
        }
        sig_h_subleading_LRJ_psi_R->Fill(psi_R_SigJet2);
        sig_h_LRJ_psi_R_12->Fill(psi_R_SigJet1 / psi_R_SigJet2);
        sigJetTaggerLeadingLRJEtvsPsi_12->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0), psi_R_SigJet1 / psi_R_SigJet2);
        sigJetTaggerSubleadingLRJEtvsPsi_12->Fill(jetTaggerSubleadingLRJEtValuesSignal->at(0), psi_R_SigJet1 / psi_R_SigJet2);
        sigJetTaggerLeadingLRJEtvsPsi_R2_12->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0), psi_R2_SigJet1 / psi_R2_SigJet2);
        sigJetTaggerSubleadingLRJEtvsPsi_R2_12->Fill(jetTaggerSubleadingLRJEtValuesSignal->at(0), psi_R2_SigJet1 / psi_R2_SigJet2);
        sigJetTaggerLeadingLRJEtvsPsi_R->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0), psi_R_SigJet1);
        sigJetTaggerSubleadingLRJEtvsPsi_R->Fill(jetTaggerSubleadingLRJEtValuesSignal->at(0), psi_R_SigJet2);
        sigJetTaggerLeadingLRJPsi_RvsSubleadingPsi_R->Fill(psi_R_SigJet2, psi_R_SigJet1); // subleading filled to x-axis

        // Fill with deltaR^2 metric
        //std::cout << "psi_R2_SigJet1: " << psi_R2_SigJet1 << "\n";
        //std::cout << "psi_R2_SigJet2 : " << psi_R2_SigJet2 << "\n";
        sig_h_leading_LRJ_psi_R2->Fill(psi_R2_SigJet1);
        sig_h_subleading_LRJ_psi_R2->Fill(psi_R2_SigJet2);
        sig_h_LRJ_psi_R2_12->Fill(psi_R2_SigJet1 / psi_R2_SigJet2);
        sigJetTaggerLeadingLRJEtvsPsi_R2->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0), psi_R2_SigJet1);
        sigJetTaggerSubleadingLRJEtvsPsi_R2->Fill(jetTaggerSubleadingLRJEtValuesSignal->at(0), psi_R2_SigJet2);
        sigJetTaggerLeadingLRJPsi_R2vsSubleadingPsi_R2->Fill(psi_R2_SigJet2, psi_R2_SigJet1); 
        //std::cout << "SIGNAL final psi1_R: " << psi_R_SigJet1 << " and final psi_R_SigJet2 : " << psi_R_SigJet2 << "\n";
        //std::cout << "filling 1 sig" << "\n";

        // Fill deltaEt for digitized, undigitized algorithm configuration (can also serve to compare for using seed position recalculation algorithm version)
        sig_h_LRJ1_deltaEt_digitized_double->Fill((sig_LRJ_Et[i][0] - jetTaggerLeadingLRJEtValuesSignal->at(0))); 
        sig_h_LRJ2_deltaEt_digitized_double->Fill((sig_LRJ_Et[i][1] - jetTaggerSubleadingLRJEtValuesSignal->at(0)));

        // Map: Higgs index -> list of b-quark indices
        std::unordered_map<int, std::vector<int>> higgsToB;
        higgsToB.reserve(higgsIndexValuesSignal->size());
        for (size_t ib = 0; ib < higgsIndexValuesSignal->size(); ++ib) {
            higgsToB[ (*higgsIndexValuesSignal)[ib] ].push_back((int)ib);
        }

        // For each Higgs, take the first two associated b's
        for (size_t ih = 0; ih < indexOfHiggsValuesSignal->size(); ++ih) {
            const int hid = (*indexOfHiggsValuesSignal)[ih];

            auto it = higgsToB.find(hid);
            if (it == higgsToB.end() || it->second.size() < 2) continue;

            const int ib1 = it->second[0];
            const int ib2 = it->second[1];

            const double eta1 = (*truthbquarksEtaValuesSignal)[ib1];
            const double phi1 = (*truthbquarksPhiValuesSignal)[ib1];
            const double eta2 = (*truthbquarksEtaValuesSignal)[ib2];
            const double phi2 = (*truthbquarksPhiValuesSignal)[ib2];

            const double dr2 = calcDeltaR2(eta1, phi1, eta2, phi2);
            const double dR  = std::sqrt(dr2);

            const double hpT = (*truthHiggspTValuesSignal)[ih];

            prof_AvgDR_vs_HpT->Fill(hpT, dR);
            h2_DR_vs_HpT     ->Fill(hpT, dR);
            
        }

        if(truthHiggspTValuesSignal->size() > 1){
            
            if(truthHiggspTValuesSignal->at(0) >= truthHiggspTValuesSignal->at(1)){

                leadingHiggsVsSubleadingHiggspT->Fill(truthHiggspTValuesSignal->at(0), truthHiggspTValuesSignal->at(1));

                // Find b's associated with leading higgs
                auto it_leading = higgsToB.find(indexOfHiggsValuesSignal->at(0));
                if (it_leading == higgsToB.end() || it_leading->second.size() < 2) continue;

                const int ib1_leading = it_leading->second[0];
                const int ib2_leading = it_leading->second[1];

                if(truthbquarkspTValuesSignal->at(ib1_leading) >= truthbquarkspTValuesSignal->at(ib2_leading) ) leadingbVsSubleadingbpT_LeadingHiggs->Fill(truthbquarkspTValuesSignal->at(ib1_leading), truthbquarkspTValuesSignal->at(ib2_leading));
                else leadingbVsSubleadingbpT_LeadingHiggs->Fill(truthbquarkspTValuesSignal->at(ib2_leading), truthbquarkspTValuesSignal->at(ib1_leading));

                // Find b's associated with subleading higgs
                auto it_subleading = higgsToB.find(indexOfHiggsValuesSignal->at(1));
                if (it_subleading == higgsToB.end() || it_subleading->second.size() < 2) continue;

                const int ib1_subleading = it_subleading->second[0];
                const int ib2_subleading = it_subleading->second[1];
                if(truthbquarkspTValuesSignal->at(ib1_subleading) >= truthbquarkspTValuesSignal->at(ib2_subleading) ) leadingbVsSubleadingbpT_LeadingHiggs->Fill(truthbquarkspTValuesSignal->at(ib1_subleading), truthbquarkspTValuesSignal->at(ib2_subleading));
                else leadingbVsSubleadingbpT_SubleadingHiggs->Fill(truthbquarkspTValuesSignal->at(ib2_subleading), truthbquarkspTValuesSignal->at(ib1_subleading));
            } 
            else{
                leadingHiggsVsSubleadingHiggspT->Fill(truthHiggspTValuesSignal->at(1), truthHiggspTValuesSignal->at(0));
                // Find b's associated with leading higgs
                auto it_leading = higgsToB.find(indexOfHiggsValuesSignal->at(1));
                if (it_leading == higgsToB.end() || it_leading->second.size() < 2) continue;

                const int ib1_leading = it_leading->second[0];
                const int ib2_leading = it_leading->second[1];

                if(truthbquarkspTValuesSignal->at(ib1_leading) >= truthbquarkspTValuesSignal->at(ib2_leading) ) leadingbVsSubleadingbpT_LeadingHiggs->Fill(truthbquarkspTValuesSignal->at(ib1_leading), truthbquarkspTValuesSignal->at(ib2_leading));
                else leadingbVsSubleadingbpT_LeadingHiggs->Fill(truthbquarkspTValuesSignal->at(ib2_leading), truthbquarkspTValuesSignal->at(ib1_leading));

                // Find b's associated with subleading higgs
                auto it_subleading = higgsToB.find(indexOfHiggsValuesSignal->at(0));
                if (it_subleading == higgsToB.end() || it_subleading->second.size() < 2) continue;

                const int ib1_subleading = it_subleading->second[0];
                const int ib2_subleading = it_subleading->second[1];
                if(truthbquarkspTValuesSignal->at(ib1_subleading) >= truthbquarkspTValuesSignal->at(ib2_subleading) ) leadingbVsSubleadingbpT_LeadingHiggs->Fill(truthbquarkspTValuesSignal->at(ib1_subleading), truthbquarkspTValuesSignal->at(ib2_subleading));
                else leadingbVsSubleadingbpT_SubleadingHiggs->Fill(truthbquarkspTValuesSignal->at(ib2_subleading), truthbquarkspTValuesSignal->at(ib1_subleading));
            }
        }
        
        // FIXME don't want to skip over all these events??
        if(recoAntiKt10LRJLeadingEtValuesSignal->size() == 0) continue;

        // Mass vs. Et for Leading Offline LRJ 
        sigOfflineLeadingLRJMassvsEt->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0), recoAntiKt10LRJLeadingMassValuesSignal->at(0));
        sigOfflineLeadingLRJMass->Fill(recoAntiKt10LRJLeadingMassValuesSignal->at(0));
        if(recoAntiKt10LRJSubleadingEtValuesSignal->size() > 0){
            sigOfflineSubleadingLRJMassvsEt->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0), recoAntiKt10LRJSubleadingMassValuesSignal->at(0));
            sigOfflineSubleadingLRJMassvsLeadingLRJMass->Fill(recoAntiKt10LRJLeadingMassValuesSignal->at(0), recoAntiKt10LRJSubleadingMassValuesSignal->at(0));
            sigOfflineSubleadingLRJMass->Fill(recoAntiKt10LRJSubleadingMassValuesSignal->at(0));
            sig_h_subleading_offlineLRJ_Et_byfile->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
        }

        sig_h_leading_offlineLRJ_Et->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
        sig_h_leading_offlineLRJ_Et_byfile->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
        sig_h_leading_offlineLRJ_Mass_byfile->Fill(recoAntiKt10LRJLeadingMassValuesSignal->at(0));

        // ------------------- SIGNAL -------------------
        // Subjet plots 
        const auto& etSig  = *truthAntiKt4WZSRJEtValuesSignal;
        const auto& etaSig = *truthAntiKt4WZSRJEtaValuesSignal;
        const auto& phiSig = *truthAntiKt4WZSRJPhiValuesSignal;

        double lrjEtaSig = 0;
        double lrjPhiSig = 0;
        double lrjEtaSigSubleading = 0;
        double lrjPhiSigSubleading = 0;
        if(recoAntiKt10LRJLeadingEtaValuesSignal->size() > 0 ){
            lrjEtaSig = recoAntiKt10LRJLeadingEtaValuesSignal->at(0);
            lrjPhiSig = recoAntiKt10LRJLeadingPhiValuesSignal->at(0);
        } 
        if(recoAntiKt10LRJSubleadingEtaValuesSignal->size() > 0 ){
            lrjEtaSigSubleading = recoAntiKt10LRJSubleadingEtaValuesSignal->at(0);
            lrjPhiSigSubleading = recoAntiKt10LRJSubleadingPhiValuesSignal->at(0);
        } 

        // ---- Tunable parameters ----
        const double subjetEtCutoff           = 25.0;  // as before
        const double drMatchToLRJ             = 1.0;   // match truth subjets to leading large-R jet
        const double drMinBetweenSubjets      = 0.4;   // NEW: minimum deltaR separation between counted subjets

        // ---- Utility: select non-overlapping subjets (greedy by Et desc) ----
        auto selectNonOverlappingSubjets = [&](const std::vector<double>& et,
                                            const std::vector<double>& eta,
                                            const std::vector<double>& phi,
                                            double lrjEta, double lrjPhi,
                                            TH1* etHist)
        {
            const size_t n = et.size();

            // 1) First, collect candidates within drMatchToLRJ to the leading LRJ (for plotting) 
            //    and build a list of indices that ALSO pass the Et cut (for counting).
            std::vector<size_t> candidates; candidates.reserve(n);
            for (size_t i = 0; i < n; ++i) {
                const double dR = std::sqrt(calcDeltaR2(eta[i], phi[i], lrjEta, lrjPhi));
                if (dR < drMatchToLRJ) {
                    if (etHist) etHist->Fill(et[i]);          // unchanged behavior for plotting
                    if (et[i] >= subjetEtCutoff) {
                        candidates.push_back(i);              // for counting (subject to overlap removal)
                    }
                }
            }

            // 2) Sort candidates by Et descending so we keep the highest-Et subjets when enforcing separation
            std::sort(candidates.begin(), candidates.end(),
                    [&](size_t a, size_t b){ return et[a] > et[b]; });

            // 3) Greedily select non-overlapping subjets (R > drMinBetweenSubjets)
            std::vector<size_t> selected; selected.reserve(candidates.size());
            for (size_t idx : candidates) {
                bool overlaps = false;
                for (size_t jdx : selected) {
                    const double dR = std::sqrt(calcDeltaR2(eta[idx], phi[idx], eta[jdx], phi[jdx]));
                    if (dR <= drMinBetweenSubjets) { overlaps = true; break; }
                }
                if (!overlaps) selected.push_back(idx);
            }

            return selected.size(); // this is the multiplicity you want to Fill(...)
        };

        const unsigned int signalSubjetCounterLeading =
            selectNonOverlappingSubjets(etSig, etaSig, phiSig, lrjEtaSig, lrjPhiSig,
                                        sig_h_LeadingOfflineLRJ_SubjetEt);

        const unsigned int signalSubjetCounterSubleading =
            selectNonOverlappingSubjets(etSig, etaSig, phiSig, lrjEtaSigSubleading, lrjPhiSigSubleading,
                                        sig_h_SubleadingOfflineLRJ_SubjetEt);
        nOfflineSubjetsLeadingLRJSignal[i] = signalSubjetCounterLeading;
        sig_h_LeadingOfflineLRJ_SubjetMultiplicity->Fill(signalSubjetCounterLeading);
        sig_h_SubleadingOfflineLRJ_SubjetMultiplicity->Fill(signalSubjetCounterSubleading);
        sigOfflineLeadingLRJEtvsSubjetMult->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0), signalSubjetCounterLeading);
        sigOfflineLeadingLRJMassvsSubjetMult->Fill(signalSubjetCounterLeading, recoAntiKt10LRJLeadingMassValuesSignal->at(0));
        // Delta R, delta Et for leading gFEX, jFEX SRJ (seeds), Offline LRJs
        sig_h_leading_LRJ_gFexLRJ_deltaEt->Fill(gFexLRJLeadingEtValuesSignal->at(0) - jetTaggerLeadingLRJEtValuesSignal->at(0));
        sig_h_leading_offlineLRJ_gFexLRJ_deltaEt->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0) - gFexLRJLeadingEtValuesSignal->at(0));
        sig_h_leading_offlineLRJ_jFexLRJ_deltaEt->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0) - jFexLRJLeadingEtValuesSignal->at(0));
        sig_h_leading_LRJ_offlineLRJ_deltaEt->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0) - jetTaggerLeadingLRJEtValuesSignal->at(0));   

        sigJetTaggerLeadingLRJEtvsSubleadingLRJEt->Fill(jetTaggerLeadingLRJEtValuesSignal->at(0), jetTaggerSubleadingLRJEtValuesSignal->at(0));

        // Fill Et "resolution"]
        //std::cout << "(gFexLRJLeadingEtValuesSignal->at(0) - jetTaggerLeadingLRJEtValuesSignal->at(0)) /gFexLRJLeadingEtValuesSignal->at(0): " << (gFexLRJLeadingEtValuesSignal->at(0) - jetTaggerLeadingLRJEtValuesSignal->at(0)) /gFexLRJLeadingEtValuesSignal->at(0) << "\n";
        sig_h_leading_LRJ_gFexLRJ_Et_resolution->Fill((gFexLRJLeadingEtValuesSignal->at(0) - jetTaggerLeadingLRJEtValuesSignal->at(0)) /gFexLRJLeadingEtValuesSignal->at(0));
        sig_h_leading_offlineLRJ_gFexLRJ_Et_resolution->Fill((recoAntiKt10LRJLeadingEtValuesSignal->at(0) - gFexLRJLeadingEtValuesSignal->at(0))/recoAntiKt10LRJLeadingEtValuesSignal->at(0));
        sig_h_leading_offlineLRJ_jFexLRJ_Et_resolution->Fill((recoAntiKt10LRJLeadingEtValuesSignal->at(0) - jFexLRJLeadingEtValuesSignal->at(0))/recoAntiKt10LRJLeadingEtValuesSignal->at(0));
        sig_h_leading_LRJ_offlineLRJ_Et_resolution->Fill((recoAntiKt10LRJLeadingEtValuesSignal->at(0) - jetTaggerLeadingLRJEtValuesSignal->at(0)) / recoAntiKt10LRJLeadingEtValuesSignal->at(0)); 

        sig_h_lead_sublead_LRJ_deltaR->Fill(sqrt(calcDeltaR2(sig_LRJ_Eta[i][0], sig_LRJ_Phi[i][0], sig_LRJ_Eta[i][1], sig_LRJ_Phi[i][1])));
        sig_h_leading_LRJ_gFexLRJ_deltaR->Fill(sqrt(calcDeltaR2(gFexLRJLeadingEtaValuesSignal->at(0), gFexLRJLeadingPhiValuesSignal->at(0), sig_LRJ_Eta[i][highestEtIndexLRJSig], sig_LRJ_Phi[i][highestEtIndexLRJSig])));
        sig_h_first_LRJ_jFexSRJ_deltaR->Fill(sqrt(calcDeltaR2(jFEXSRJLeadingEta, jFEXSRJLeadingPhi, sig_LRJ_Eta[i][0], sig_LRJ_Phi[i][0])));
        sig_h_second_LRJ_jFexSRJ_deltaR->Fill(sqrt(calcDeltaR2(jFEXSRJSubleadingEta, jFEXSRJSubleadingPhi, sig_LRJ_Eta[i][1], sig_LRJ_Phi[i][1])));
        sig_h_leading_LRJ_offlineLRJ_deltaR->Fill(sqrt(calcDeltaR2(recoAntiKt10LRJLeadingEtaValuesSignal->at(0), recoAntiKt10LRJLeadingPhiValuesSignal->at(0), sig_LRJ_Eta[i][highestEtIndexLRJSig], sig_LRJ_Phi[i][highestEtIndexLRJSig])));
        // Dijet efficiencies (signal)
        if(recoAntiKt10LRJSubleadingEtValuesSignal->size() > 0){
            if (fileIt == 0) sig_h_subleading_offlineLRJ_Et->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
            if(sig_LRJ_Et[i][0] >= 50.0 && sig_LRJ_Et[i][1] >= 50.0){
                sig_h_offlineLRJ_Et_num50_Dijet->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom50_Dijet->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));

            if(sig_LRJ_Et[i][0] >= 100.0 && sig_LRJ_Et[i][1] >= 100.0){
                sig_h_offlineLRJ_Et_num100_Dijet->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom100_Dijet->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));

            if(sig_LRJ_Et[i][0] >= 150.0 && sig_LRJ_Et[i][1] >= 150.0){
                sig_h_offlineLRJ_Et_num150_Dijet->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom150_Dijet->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));

            if(sig_LRJ_Et[i][0] >= 200.0 && sig_LRJ_Et[i][1] >= 200.0){
                sig_h_offlineLRJ_Et_num200_Dijet->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom200_Dijet->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));

            if(sig_LRJ_Et[i][0] >= 250.0 && sig_LRJ_Et[i][1] >= 250.0){
                sig_h_offlineLRJ_Et_num250_Dijet->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom250_Dijet->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));

            if(sig_LRJ_Et[i][0] >= 300.0 && sig_LRJ_Et[i][1] >= 300.0){
                sig_h_offlineLRJ_Et_num300_Dijet->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom300_Dijet->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));

            if(sig_LRJ_Et[i][0] >= 350.0 && sig_LRJ_Et[i][1] >= 350.0){
                sig_h_offlineLRJ_Et_num350_Dijet->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom350_Dijet->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));

            if(sig_LRJ_Et[i][0] >= 400.0 && sig_LRJ_Et[i][1] >= 400.0){
                sig_h_offlineLRJ_Et_num400_Dijet->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom400_Dijet->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));

            if(sig_LRJ_Et[i][0] >= 450.0 && sig_LRJ_Et[i][1] >= 450.0){
                sig_h_offlineLRJ_Et_num450_Dijet->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom450_Dijet->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));

            if(sig_LRJ_Et[i][0] >= 500.0 && sig_LRJ_Et[i][1] >= 500.0){
                sig_h_offlineLRJ_Et_num500_Dijet->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom500_Dijet->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
        }
        
        // Subjet requirement efficiencies
        if(signalSubjetCounterLeading == 1){
            if(sig_LRJ_Et[i][0] >= 50.0 || sig_LRJ_Et[i][1] >= 50.0){
                sig_h_offlineLRJ_Et_num50_1Subjet->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom50_1Subjet->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

            if(sig_LRJ_Et[i][0] >= 100.0 || sig_LRJ_Et[i][1] >= 100.0){
                sig_h_offlineLRJ_Et_num100_1Subjet->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom100_1Subjet->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

            if(sig_LRJ_Et[i][0] >= 150.0 || sig_LRJ_Et[i][1] >= 150.0){
                sig_h_offlineLRJ_Et_num150_1Subjet->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom150_1Subjet->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

            if(sig_LRJ_Et[i][0] >= 200.0 || sig_LRJ_Et[i][1] >= 200.0){
                sig_h_offlineLRJ_Et_num200_1Subjet->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom200_1Subjet->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

            if(sig_LRJ_Et[i][0] >= 250.0 || sig_LRJ_Et[i][1] >= 250.0){
                sig_h_offlineLRJ_Et_num250_1Subjet->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom250_1Subjet->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

            if(sig_LRJ_Et[i][0] >= 300.0 || sig_LRJ_Et[i][1] >= 300.0){
                sig_h_offlineLRJ_Et_num300_1Subjet->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom300_1Subjet->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

            if(sig_LRJ_Et[i][0] >= 350.0 || sig_LRJ_Et[i][1] >= 350.0){
                sig_h_offlineLRJ_Et_num350_1Subjet->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom350_1Subjet->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

            if(sig_LRJ_Et[i][0] >= 400.0 || sig_LRJ_Et[i][1] >= 400.0){
                sig_h_offlineLRJ_Et_num400_1Subjet->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom400_1Subjet->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

            if(sig_LRJ_Et[i][0] >= 450.0 || sig_LRJ_Et[i][1] >= 450.0){
                sig_h_offlineLRJ_Et_num450_1Subjet->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom450_1Subjet->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

            if(sig_LRJ_Et[i][0] >= 500.0 || sig_LRJ_Et[i][1] >= 500.0){
                sig_h_offlineLRJ_Et_num500_1Subjet->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom500_1Subjet->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
        }

        if(signalSubjetCounterLeading >= 2){
            if(sig_LRJ_Et[i][0] >= 50.0 || sig_LRJ_Et[i][1] >= 50.0){
                sig_h_offlineLRJ_Et_num50_GrEq2Subjets->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom50_GrEq2Subjets->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

            if(sig_LRJ_Et[i][0] >= 100.0 || sig_LRJ_Et[i][1] >= 100.0){
                sig_h_offlineLRJ_Et_num100_GrEq2Subjets->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom100_GrEq2Subjets->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

            if(sig_LRJ_Et[i][0] >= 150.0 || sig_LRJ_Et[i][1] >= 150.0){
                sig_h_offlineLRJ_Et_num150_GrEq2Subjets->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom150_GrEq2Subjets->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

            if(sig_LRJ_Et[i][0] >= 200.0 || sig_LRJ_Et[i][1] >= 200.0){
                sig_h_offlineLRJ_Et_num200_GrEq2Subjets->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom200_GrEq2Subjets->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

            if(sig_LRJ_Et[i][0] >= 250.0 || sig_LRJ_Et[i][1] >= 250.0){
                sig_h_offlineLRJ_Et_num250_GrEq2Subjets->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom250_GrEq2Subjets->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

            if(sig_LRJ_Et[i][0] >= 300.0 || sig_LRJ_Et[i][1] >= 300.0){
                sig_h_offlineLRJ_Et_num300_GrEq2Subjets->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom300_GrEq2Subjets->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

            if(sig_LRJ_Et[i][0] >= 350.0 || sig_LRJ_Et[i][1] >= 350.0){
                sig_h_offlineLRJ_Et_num350_GrEq2Subjets->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom350_GrEq2Subjets->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

            if(sig_LRJ_Et[i][0] >= 400.0 || sig_LRJ_Et[i][1] >= 400.0){
                sig_h_offlineLRJ_Et_num400_GrEq2Subjets->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom400_GrEq2Subjets->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

            if(sig_LRJ_Et[i][0] >= 450.0 || sig_LRJ_Et[i][1] >= 450.0){
                sig_h_offlineLRJ_Et_num450_GrEq2Subjets->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom450_GrEq2Subjets->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

            if(sig_LRJ_Et[i][0] >= 500.0 || sig_LRJ_Et[i][1] >= 500.0){
                sig_h_offlineLRJ_Et_num500_GrEq2Subjets->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom500_GrEq2Subjets->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
        }
        // Mass window efficiencies

        if(recoAntiKt10LRJLeadingMassValuesSignal->size() > 0){
            if(recoAntiKt10LRJLeadingMassValuesSignal->at(0) >= 100.0 && recoAntiKt10LRJLeadingMassValuesSignal->at(0) <= 150.0){
            if(sig_LRJ_Et[i][0] >= 50.0 || sig_LRJ_Et[i][1] >= 50.0){
                    sig_h_offlineLRJ_Et_num50_mass100to150->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                }
                sig_h_offlineLRJ_Et_denom50_mass100to150->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

                if(sig_LRJ_Et[i][0] >= 100.0 || sig_LRJ_Et[i][1] >= 100.0){
                    sig_h_offlineLRJ_Et_num100_mass100to150->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                }
                sig_h_offlineLRJ_Et_denom100_mass100to150->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

                if(sig_LRJ_Et[i][0] >= 150.0 || sig_LRJ_Et[i][1] >= 150.0){
                    sig_h_offlineLRJ_Et_num150_mass100to150->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                }
                sig_h_offlineLRJ_Et_denom150_mass100to150->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

                if(sig_LRJ_Et[i][0] >= 200.0 || sig_LRJ_Et[i][1] >= 200.0){
                    sig_h_offlineLRJ_Et_num200_mass100to150->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                }
                sig_h_offlineLRJ_Et_denom200_mass100to150->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

                if(sig_LRJ_Et[i][0] >= 250.0 || sig_LRJ_Et[i][1] >= 250.0){
                    sig_h_offlineLRJ_Et_num250_mass100to150->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                }
                sig_h_offlineLRJ_Et_denom250_mass100to150->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

                if(sig_LRJ_Et[i][0] >= 300.0 || sig_LRJ_Et[i][1] >= 300.0){
                    sig_h_offlineLRJ_Et_num300_mass100to150->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                }
                sig_h_offlineLRJ_Et_denom300_mass100to150->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

                if(sig_LRJ_Et[i][0] >= 350.0 || sig_LRJ_Et[i][1] >= 350.0){
                    sig_h_offlineLRJ_Et_num350_mass100to150->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                }
                sig_h_offlineLRJ_Et_denom350_mass100to150->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

                if(sig_LRJ_Et[i][0] >= 400.0 || sig_LRJ_Et[i][1] >= 400.0){
                    sig_h_offlineLRJ_Et_num400_mass100to150->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                }
                sig_h_offlineLRJ_Et_denom400_mass100to150->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

                if(sig_LRJ_Et[i][0] >= 450.0 || sig_LRJ_Et[i][1] >= 450.0){
                    sig_h_offlineLRJ_Et_num450_mass100to150->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                }
                sig_h_offlineLRJ_Et_denom450_mass100to150->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

                if(sig_LRJ_Et[i][0] >= 500.0 || sig_LRJ_Et[i][1] >= 500.0){
                    sig_h_offlineLRJ_Et_num500_mass100to150->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                }
                sig_h_offlineLRJ_Et_denom500_mass100to150->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
        }
        

        // Dijet selection + mass window efficiencies
        if(recoAntiKt10LRJSubleadingEtValuesSignal->size() > 0){
            if(recoAntiKt10LRJSubleadingMassValuesSignal->at(0) >= 100.0 && recoAntiKt10LRJSubleadingMassValuesSignal->at(0) <= 150.0){
                if(sig_LRJ_Et[i][0] >= 50.0 && sig_LRJ_Et[i][1] >= 50.0){
                    sig_h_offlineLRJ_subleading_Et_num50_mass100to150->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
                }
                sig_h_offlineLRJ_subleading_Et_denom50_mass100to150->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));

                if(sig_LRJ_Et[i][0] >= 100.0 && sig_LRJ_Et[i][1] >= 100.0){
                    sig_h_offlineLRJ_subleading_Et_num100_mass100to150->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
                }
                sig_h_offlineLRJ_subleading_Et_denom100_mass100to150->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));

                if(sig_LRJ_Et[i][0] >= 150.0 && sig_LRJ_Et[i][1] >= 150.0){
                    sig_h_offlineLRJ_subleading_Et_num150_mass100to150->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
                }
                sig_h_offlineLRJ_subleading_Et_denom150_mass100to150->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));

                if(sig_LRJ_Et[i][0] >= 200.0 && sig_LRJ_Et[i][1] >= 200.0){
                    sig_h_offlineLRJ_subleading_Et_num200_mass100to150->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
                }
                sig_h_offlineLRJ_subleading_Et_denom200_mass100to150->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));

                if(sig_LRJ_Et[i][0] >= 250.0 && sig_LRJ_Et[i][1] >= 250.0){
                    sig_h_offlineLRJ_subleading_Et_num250_mass100to150->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
                }
                sig_h_offlineLRJ_subleading_Et_denom250_mass100to150->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));

                if(sig_LRJ_Et[i][0] >= 300.0 && sig_LRJ_Et[i][1] >= 300.0){
                    sig_h_offlineLRJ_subleading_Et_num300_mass100to150->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
                }
                sig_h_offlineLRJ_subleading_Et_denom300_mass100to150->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));

                if(sig_LRJ_Et[i][0] >= 350.0 && sig_LRJ_Et[i][1] >= 350.0){
                    sig_h_offlineLRJ_subleading_Et_num350_mass100to150->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
                }
                sig_h_offlineLRJ_subleading_Et_denom350_mass100to150->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));

                if(sig_LRJ_Et[i][0] >= 400.0 && sig_LRJ_Et[i][1] >= 400.0){
                    sig_h_offlineLRJ_subleading_Et_num400_mass100to150->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
                }
                sig_h_offlineLRJ_subleading_Et_denom400_mass100to150->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));

                if(sig_LRJ_Et[i][0] >= 450.0 && sig_LRJ_Et[i][1] >= 450.0){
                    sig_h_offlineLRJ_subleading_Et_num450_mass100to150->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
                }
                sig_h_offlineLRJ_subleading_Et_denom450_mass100to150->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));

                if(sig_LRJ_Et[i][0] >= 500.0 && sig_LRJ_Et[i][1] >= 500.0){
                    sig_h_offlineLRJ_subleading_Et_num500_mass100to150->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
                }
                sig_h_offlineLRJ_subleading_Et_denom500_mass100to150->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
            }
        }

        // Leading efficiency curves at 10 kHz fixed rate
        if(recoAntiKt10LRJLeadingMassValuesSignal->size() > 0){
            if(recoAntiKt10LRJLeadingMassValuesSignal->at(0) >= 100.0 && recoAntiKt10LRJLeadingMassValuesSignal->at(0) <= 150.0){
                if((sig_LRJ_Et[i][0] >= jetTagger_10kHz_Threshold_Leading || sig_LRJ_Et[i][1] >= jetTagger_10kHz_Threshold_Leading)){
                    sig_h_offlineLRJ_Et_num10kHz_HiggsMassWindow->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                }
                sig_h_offlineLRJ_Et_denom10kHz_HiggsMassWindow->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

                if(gFexLRJLeadingEtValuesSignal->at(0) >= gFEX_10kHz_Threshold_Leading){
                    sig_h_offlineLRJ_Et_num10kHz_gFexLRJ_HiggsMassWindow->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                }
                sig_h_offlineLRJ_Et_denom10kHz_gFexLRJ_HiggsMassWindow->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            if(sig_LRJ_Et[i][0] >= jetTagger_10kHz_Threshold_Leading || sig_LRJ_Et[i][1] >= jetTagger_10kHz_Threshold_Leading){
            sig_h_offlineLRJ_Et_num10kHz->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }

            if(gFexLRJLeadingEtValuesSignal->at(0) >= gFEX_10kHz_Threshold_Leading){
                sig_h_offlineLRJ_Et_num10kHz_gFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom10kHz_gFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

            sig_h_offlineLRJ_Et_denom10kHz->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            
            if(signalSubjetCounterLeading == 1){
                if(sig_LRJ_Et[i][0] >= jetTagger_10kHz_Threshold_Leading || sig_LRJ_Et[i][1] >= jetTagger_10kHz_Threshold_Leading){
                    sig_h_offlineLRJ_Et_num10kHz_1Subjet->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                }
                sig_h_offlineLRJ_Et_denom10kHz_1Subjet->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

                if(gFexLRJLeadingEtValuesSignal->at(0) >= gFEX_10kHz_Threshold_Leading){
                    sig_h_offlineLRJ_Et_num10kHz_gFexLRJ_1Subjet->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                }
                sig_h_offlineLRJ_Et_denom10kHz_gFexLRJ_1Subjet->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }

            if(signalSubjetCounterLeading >= 2){
                if(sig_LRJ_Et[i][0] >= jetTagger_10kHz_Threshold_Leading || sig_LRJ_Et[i][1] >= jetTagger_10kHz_Threshold_Leading){
                    sig_h_offlineLRJ_Et_num10kHz_GrEq2Subjets->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                }
                sig_h_offlineLRJ_Et_denom10kHz_GrEq2Subjets->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

                if(gFexLRJLeadingEtValuesSignal->at(0) >= gFEX_10kHz_Threshold_Leading){
                    sig_h_offlineLRJ_Et_num10kHz_gFexLRJ_GrEq2Subjets->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                }
                sig_h_offlineLRJ_Et_denom10kHz_gFexLRJ_GrEq2Subjets->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
        }
        
        // Subleading efficiency curves at 10 kHz fixed rate (|| changed to && - FIXME eventually need to use values straight from ntuple)
        if(recoAntiKt10LRJSubleadingEtValuesSignal->size() > 0){
            if(sig_LRJ_Et[i][0] >= jetTagger_10kHz_Threshold_Subleading && sig_LRJ_Et[i][1] >= jetTagger_10kHz_Threshold_Subleading){
                sig_h_offlineLRJ_Et_num10kHz_Subleading->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
            }

            if(gFexLRJSubleadingEtValuesSignal->at(0) >= gFEX_10kHz_Threshold_Subleading){
                sig_h_offlineLRJ_Et_num10kHz_gFexLRJ_Subleading->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom10kHz_gFexLRJ_Subleading->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));

            sig_h_offlineLRJ_Et_denom10kHz_Subleading->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
            if(recoAntiKt10LRJSubleadingMassValuesSignal->size() > 0){
                if(recoAntiKt10LRJSubleadingMassValuesSignal->at(0) >= 100.0 && recoAntiKt10LRJSubleadingMassValuesSignal->at(0) <= 150.0){
                    if((sig_LRJ_Et[i][0] >= jetTagger_10kHz_Threshold_Subleading && sig_LRJ_Et[i][1] >= jetTagger_10kHz_Threshold_Subleading)){
                        sig_h_offlineLRJ_Et_num10kHz_HiggsMassWindow_Subleading->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
                    }
                    sig_h_offlineLRJ_Et_denom10kHz_HiggsMassWindow_Subleading->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));

                    if(gFexLRJSubleadingEtValuesSignal->at(0) >= gFEX_10kHz_Threshold_Subleading){
                        sig_h_offlineLRJ_Et_num10kHz_gFexLRJ_HiggsMassWindow_Subleading->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
                    }
                    sig_h_offlineLRJ_Et_denom10kHz_gFexLRJ_HiggsMassWindow_Subleading->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
                }
            }
            
            
            if(signalSubjetCounterSubleading == 1){
                if(sig_LRJ_Et[i][0] >= jetTagger_10kHz_Threshold_Subleading && sig_LRJ_Et[i][1] >= jetTagger_10kHz_Threshold_Subleading){
                    sig_h_offlineLRJ_Et_num10kHz_1Subjet_Subleading->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
                }
                sig_h_offlineLRJ_Et_denom10kHz_1Subjet_Subleading->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));

                if(gFexLRJSubleadingEtValuesSignal->at(0) >= gFEX_10kHz_Threshold_Subleading){
                    sig_h_offlineLRJ_Et_num10kHz_gFexLRJ_1Subjet_Subleading->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
                }
                sig_h_offlineLRJ_Et_denom10kHz_gFexLRJ_1Subjet_Subleading->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
            }
            
            if(signalSubjetCounterSubleading >= 2){
                if(sig_LRJ_Et[i][0] >= jetTagger_10kHz_Threshold_Subleading && sig_LRJ_Et[i][1] >= jetTagger_10kHz_Threshold_Subleading){
                    sig_h_offlineLRJ_Et_num10kHz_GrEq2Subjets_Subleading->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
                }
                sig_h_offlineLRJ_Et_denom10kHz_GrEq2Subjets_Subleading->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));

                if(gFexLRJSubleadingEtValuesSignal->at(0) >= gFEX_10kHz_Threshold_Subleading){
                    sig_h_offlineLRJ_Et_num10kHz_gFexLRJ_GrEq2Subjets_Subleading->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
                }
                sig_h_offlineLRJ_Et_denom10kHz_gFexLRJ_GrEq2Subjets_Subleading->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
            }
        }

        if(recoAntiKt10LRJLeadingEtValuesSignal->at(0) > 0){
            if(jFexLRJLeadingEtValuesSignal->at(0) >= jFEX_10kHz_Threshold_Leading){
                sig_h_offlineLRJ_Et_num10kHz_jFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom10kHz_jFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            if(truthbquarksEtValuesSignal->size() > 0){
                if(sig_LRJ_Et[i][0] >= 50.0 || sig_LRJ_Et[i][1] >= 50.0){
                    sig_h_offlineLRJ_Et_num50->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                    sig_h_Avg_b_Et_num50->Fill((truthbquarksEtValuesSignal->at(0) + truthbquarksEtValuesSignal->at(1))/2);
                }
                sig_h_offlineLRJ_Et_denom50->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                sig_h_Avg_b_Et_denom50->Fill((truthbquarksEtValuesSignal->at(0) + truthbquarksEtValuesSignal->at(1))/2);

                if(sig_LRJ_Et[i][0] >= 100.0 || sig_LRJ_Et[i][1] >= 100.0){
                    sig_h_offlineLRJ_Et_num100->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                    h_sig_num100->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                    sig_h_Avg_b_Et_num100->Fill((truthbquarksEtValuesSignal->at(0) + truthbquarksEtValuesSignal->at(1))/2);
                }
                sig_h_offlineLRJ_Et_denom100->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                h_sig_denom100->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                sig_h_Avg_b_Et_denom100->Fill((truthbquarksEtValuesSignal->at(0) + truthbquarksEtValuesSignal->at(1))/2);

                if(sig_LRJ_Et[i][0] >= 150.0 || sig_LRJ_Et[i][1] >= 150.0){
                    sig_h_offlineLRJ_Et_num150->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                    sig_h_Avg_b_Et_num150->Fill((truthbquarksEtValuesSignal->at(0) + truthbquarksEtValuesSignal->at(1))/2);
                }
                sig_h_offlineLRJ_Et_denom150->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                sig_h_Avg_b_Et_denom150->Fill((truthbquarksEtValuesSignal->at(0) + truthbquarksEtValuesSignal->at(1))/2);

                if(sig_LRJ_Et[i][0] >= 200.0 || sig_LRJ_Et[i][1] >= 200.0){
                    sig_h_offlineLRJ_Et_num200->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                    sig_h_Avg_b_Et_num200->Fill((truthbquarksEtValuesSignal->at(0) + truthbquarksEtValuesSignal->at(1))/2);
                }
                sig_h_offlineLRJ_Et_denom200->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                sig_h_Avg_b_Et_denom200->Fill((truthbquarksEtValuesSignal->at(0) + truthbquarksEtValuesSignal->at(1))/2);

                if(sig_LRJ_Et[i][0] >= 250.0 || sig_LRJ_Et[i][1] >= 250.0){
                    sig_h_offlineLRJ_Et_num250->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                    h_sig_num250->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                    sig_h_Avg_b_Et_num250->Fill((truthbquarksEtValuesSignal->at(0) + truthbquarksEtValuesSignal->at(1))/2);
                }
                h_sig_denom250->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                sig_h_offlineLRJ_Et_denom250->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                sig_h_Avg_b_Et_denom250->Fill((truthbquarksEtValuesSignal->at(0) + truthbquarksEtValuesSignal->at(1))/2);

                if(sig_LRJ_Et[i][0] >= 300.0 || sig_LRJ_Et[i][1] >= 300.0){
                    sig_h_offlineLRJ_Et_num300->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                    sig_h_Avg_b_Et_num300->Fill((truthbquarksEtValuesSignal->at(0) + truthbquarksEtValuesSignal->at(1))/2);
                }
                sig_h_offlineLRJ_Et_denom300->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                sig_h_Avg_b_Et_denom300->Fill((truthbquarksEtValuesSignal->at(0) + truthbquarksEtValuesSignal->at(1))/2);

                if(sig_LRJ_Et[i][0] >= 350.0 || sig_LRJ_Et[i][1] >= 350.0){
                    sig_h_offlineLRJ_Et_num350->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                    sig_h_Avg_b_Et_num350->Fill((truthbquarksEtValuesSignal->at(0) + truthbquarksEtValuesSignal->at(1))/2);
                }
                sig_h_offlineLRJ_Et_denom350->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                sig_h_Avg_b_Et_denom350->Fill((truthbquarksEtValuesSignal->at(0) + truthbquarksEtValuesSignal->at(1))/2);

                if(sig_LRJ_Et[i][0] >= 400.0 || sig_LRJ_Et[i][1] >= 400.0){
                    sig_h_offlineLRJ_Et_num400->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                    h_sig_num400->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                    sig_h_Avg_b_Et_num400->Fill((truthbquarksEtValuesSignal->at(0) + truthbquarksEtValuesSignal->at(1))/2);
                }
                h_sig_denom400->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                sig_h_offlineLRJ_Et_denom400->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                sig_h_Avg_b_Et_denom400->Fill((truthbquarksEtValuesSignal->at(0) + truthbquarksEtValuesSignal->at(1))/2);

                if(sig_LRJ_Et[i][0] >= 450.0 || sig_LRJ_Et[i][1] >= 450.0){
                    sig_h_offlineLRJ_Et_num450->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                    sig_h_Avg_b_Et_num450->Fill((truthbquarksEtValuesSignal->at(0) + truthbquarksEtValuesSignal->at(1))/2);
                }
                sig_h_offlineLRJ_Et_denom450->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                sig_h_Avg_b_Et_denom450->Fill((truthbquarksEtValuesSignal->at(0) + truthbquarksEtValuesSignal->at(1))/2);

                if(sig_LRJ_Et[i][0] >= 500.0 || sig_LRJ_Et[i][1] >= 500.0){
                    sig_h_offlineLRJ_Et_num500->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                    sig_h_Avg_b_Et_num500->Fill((truthbquarksEtValuesSignal->at(0) + truthbquarksEtValuesSignal->at(1))/2);
                }
                sig_h_offlineLRJ_Et_denom500->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                sig_h_Avg_b_Et_denom500->Fill((truthbquarksEtValuesSignal->at(0) + truthbquarksEtValuesSignal->at(1))/2);
            }
            
            // Fill jFEX Signal Trigger Efficiencies (first 1 jet)
            if(jFexLRJLeadingEtValuesSignal->at(0) >= 50.0){
                sig_h_offlineLRJ_Et_num50_jFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom50_jFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

            if(jFexLRJLeadingEtValuesSignal->at(0) >= 100.0){
                sig_h_offlineLRJ_Et_num100_jFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom100_jFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

            if(jFexLRJLeadingEtValuesSignal->at(0) >= 150.0){
                sig_h_offlineLRJ_Et_num150_jFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom150_jFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

            if(jFexLRJLeadingEtValuesSignal->at(0) >= 200.0){
                sig_h_offlineLRJ_Et_num200_jFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom200_jFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

            if(jFexLRJLeadingEtValuesSignal->at(0) >= 250.0){
                sig_h_offlineLRJ_Et_num250_jFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom250_jFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

            if(jFexLRJLeadingEtValuesSignal->at(0) >= 300.0){
                sig_h_offlineLRJ_Et_num300_jFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom300_jFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

            if(jFexLRJLeadingEtValuesSignal->at(0) >= 350.0){
                sig_h_offlineLRJ_Et_num350_jFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom350_jFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

            if(jFexLRJLeadingEtValuesSignal->at(0) >= 400.0){
                sig_h_offlineLRJ_Et_num400_jFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom400_jFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

            if(jFexLRJLeadingEtValuesSignal->at(0) >= 450.0){
                sig_h_offlineLRJ_Et_num450_jFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom450_jFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

            if(jFexLRJLeadingEtValuesSignal->at(0) >= 500.0){
                sig_h_offlineLRJ_Et_num500_jFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom500_jFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

            // Fill gFEX Signal Trigger Efficiencies (first 1 jet)
            if(gFexLRJLeadingEtValuesSignal->at(0) >= 50.0){
                sig_h_offlineLRJ_Et_num50_gFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom50_gFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

            if(gFexLRJLeadingEtValuesSignal->at(0) >= 100.0){
                sig_h_offlineLRJ_Et_num100_gFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom100_gFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

            if(gFexLRJLeadingEtValuesSignal->at(0) >= 150.0){
                sig_h_offlineLRJ_Et_num150_gFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom150_gFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

            if(gFexLRJLeadingEtValuesSignal->at(0) >= 200.0){
                sig_h_offlineLRJ_Et_num200_gFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom200_gFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

            if(gFexLRJLeadingEtValuesSignal->at(0) >= 250.0){
                sig_h_offlineLRJ_Et_num250_gFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom250_gFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

            if(gFexLRJLeadingEtValuesSignal->at(0) >= 300.0){
                sig_h_offlineLRJ_Et_num300_gFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom300_gFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

            if(gFexLRJLeadingEtValuesSignal->at(0) >= 350.0){
                sig_h_offlineLRJ_Et_num350_gFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom350_gFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

            if(gFexLRJLeadingEtValuesSignal->at(0) >= 400.0){
                sig_h_offlineLRJ_Et_num400_gFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom400_gFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

            if(gFexLRJLeadingEtValuesSignal->at(0) >= 450.0){
                sig_h_offlineLRJ_Et_num450_gFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom450_gFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

            if(gFexLRJLeadingEtValuesSignal->at(0) >= 500.0){
                sig_h_offlineLRJ_Et_num500_gFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom500_gFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
        }

        // next dijet for signal
        if(recoAntiKt10LRJSubleadingEtValuesSignal->size() > 0){
            if(gFexLRJSubleadingEtValuesSignal->at(0) >= 50.0){
                sig_h_offlineLRJ_Et_num50_gFexLRJ_Dijet->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom50_gFexLRJ_Dijet->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));

            if(gFexLRJSubleadingEtValuesSignal->at(0) >= 100.0){
                sig_h_offlineLRJ_Et_num100_gFexLRJ_Dijet->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom100_gFexLRJ_Dijet->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));

            if(gFexLRJSubleadingEtValuesSignal->at(0) >= 150.0){
                sig_h_offlineLRJ_Et_num150_gFexLRJ_Dijet->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom150_gFexLRJ_Dijet->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));

            if(gFexLRJSubleadingEtValuesSignal->at(0) >= 200.0){
                sig_h_offlineLRJ_Et_num200_gFexLRJ_Dijet->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom200_gFexLRJ_Dijet->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));

            if(gFexLRJSubleadingEtValuesSignal->at(0) >= 250.0){
                sig_h_offlineLRJ_Et_num250_gFexLRJ_Dijet->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom250_gFexLRJ_Dijet->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));

            if(gFexLRJSubleadingEtValuesSignal->at(0) >= 300.0){
                sig_h_offlineLRJ_Et_num300_gFexLRJ_Dijet->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom300_gFexLRJ_Dijet->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));

            if(gFexLRJSubleadingEtValuesSignal->at(0) >= 350.0){
                sig_h_offlineLRJ_Et_num350_gFexLRJ_Dijet->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom350_gFexLRJ_Dijet->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));

            if(gFexLRJSubleadingEtValuesSignal->at(0) >= 400.0){
                sig_h_offlineLRJ_Et_num400_gFexLRJ_Dijet->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom400_gFexLRJ_Dijet->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));

            if(gFexLRJSubleadingEtValuesSignal->at(0) >= 450.0){
                sig_h_offlineLRJ_Et_num450_gFexLRJ_Dijet->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom450_gFexLRJ_Dijet->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));

            if(gFexLRJSubleadingEtValuesSignal->at(0) >= 500.0){
                sig_h_offlineLRJ_Et_num500_gFexLRJ_Dijet->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
            }
            sig_h_offlineLRJ_Et_denom500_gFexLRJ_Dijet->Fill(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
        }

        if(i == evDisplay0Sig_){
            if(recoAntiKt10LRJSubleadingEtValuesSignal->size() > 0 && jFexSRJEtaValuesSignal->size() >= 6){
                displayEv0Sig_ = true;
                jFexSeedPositionsSigEv0.push_back(std::make_pair(jFexSRJEtaValuesSignal->at(0), jFexSRJPhiValuesSignal->at(0)));
                jFexSeedPositionsSigEv0.push_back(std::make_pair(jFexSRJEtaValuesSignal->at(1), jFexSRJPhiValuesSignal->at(1)));
                jFexAdditionalSRJPositionsSigEv0.push_back(std::make_pair(jFexSRJEtaValuesSignal->at(2), jFexSRJPhiValuesSignal->at(2)));
                jFexAdditionalSRJPositionsSigEv0.push_back(std::make_pair(jFexSRJEtaValuesSignal->at(3), jFexSRJPhiValuesSignal->at(3)));
                jFexAdditionalSRJPositionsSigEv0.push_back(std::make_pair(jFexSRJEtaValuesSignal->at(4), jFexSRJPhiValuesSignal->at(4)));
                jFexAdditionalSRJPositionsSigEv0.push_back(std::make_pair(jFexSRJEtaValuesSignal->at(5), jFexSRJPhiValuesSignal->at(5)));
                if(sig_LRJ_Et[i][0] > sig_LRJ_Et[i][1]){
                    newSeedPositionsSigEv0.push_back(std::make_pair(sig_LRJ_Eta[i][0], sig_LRJ_Phi[i][0]));
                    newSeedPositionsSigEv0.push_back(std::make_pair(sig_LRJ_Eta[i][1], sig_LRJ_Phi[i][1]));
                    sigLRJEtEv0.push_back(sig_LRJ_Et[i][0]);
                    sigLRJEtEv0.push_back(sig_LRJ_Et[i][1]);
                    sigLRJPsi_REv0.push_back(psi_R_SigJet1);
                    sigLRJPsi_REv0.push_back(psi_R_SigJet2);
                }
                else{
                    newSeedPositionsSigEv0.push_back(std::make_pair(sig_LRJ_Eta[i][1], sig_LRJ_Phi[i][1]));
                    newSeedPositionsSigEv0.push_back(std::make_pair(sig_LRJ_Eta[i][0], sig_LRJ_Phi[i][0]));
                    sigLRJEtEv0.push_back(sig_LRJ_Et[i][1]);
                    sigLRJEtEv0.push_back(sig_LRJ_Et[i][0]);
                    sigLRJPsi_REv0.push_back(psi_R_SigJet1);
                    sigLRJPsi_REv0.push_back(psi_R_SigJet2);
                }
                gFexLRJPositionSigEv0.push_back(std::make_pair(gFexLRJLeadingEtaValuesSignal->at(0), gFexLRJLeadingPhiValuesSignal->at(0)));
                gFexLRJPositionSigEv0.push_back(std::make_pair(gFexLRJSubleadingEtaValuesSignal->at(0), gFexLRJSubleadingPhiValuesSignal->at(0)));
                siggFexLRJEtEv0.push_back(gFexLRJLeadingEtValuesSignal->at(0));
                siggFexLRJEtEv0.push_back(gFexLRJSubleadingEtValuesSignal->at(0));
                offlineLRJPositionSigEv0.push_back(std::make_pair(recoAntiKt10LRJLeadingEtaValuesSignal->at(0), recoAntiKt10LRJLeadingPhiValuesSignal->at(0)));
                offlineLRJPositionSigEv0.push_back(std::make_pair(recoAntiKt10LRJSubleadingEtaValuesSignal->at(0), recoAntiKt10LRJSubleadingPhiValuesSignal->at(0)));
                sigOfflineLRJEtEv0.push_back(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                sigOfflineLRJEtEv0.push_back(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
                std::cout << "Event 0 Sig LRJ 1 Et, Eta, Phi: " << sig_LRJ_Et[i][0] << " , " << sig_LRJ_Eta[i][0] << " , " << sig_LRJ_Phi[i][0] << "\n";
                std::cout << "Event 0 Sig LRJ 2 Et, Eta, Phi: " << sig_LRJ_Et[i][1] << " , " << sig_LRJ_Eta[i][1] << " , " << sig_LRJ_Phi[i][1] << "\n";
            }
        }

        if(i == evDisplay1Sig_){
            if(recoAntiKt10LRJSubleadingEtValuesSignal->size() > 0 && jFexSRJEtaValuesSignal->size() >= 6){
                displayEv1Sig_ = true;
                jFexSeedPositionsSigEv1.push_back(std::make_pair(jFexSRJEtaValuesSignal->at(0), jFexSRJPhiValuesSignal->at(0)));
                jFexSeedPositionsSigEv1.push_back(std::make_pair(jFexSRJEtaValuesSignal->at(1), jFexSRJPhiValuesSignal->at(1)));
                jFexAdditionalSRJPositionsSigEv1.push_back(std::make_pair(jFexSRJEtaValuesSignal->at(2), jFexSRJPhiValuesSignal->at(2)));
                jFexAdditionalSRJPositionsSigEv1.push_back(std::make_pair(jFexSRJEtaValuesSignal->at(3), jFexSRJPhiValuesSignal->at(3)));
                jFexAdditionalSRJPositionsSigEv1.push_back(std::make_pair(jFexSRJEtaValuesSignal->at(4), jFexSRJPhiValuesSignal->at(4)));
                jFexAdditionalSRJPositionsSigEv1.push_back(std::make_pair(jFexSRJEtaValuesSignal->at(5), jFexSRJPhiValuesSignal->at(5)));
                if(sig_LRJ_Et[i][0] > sig_LRJ_Et[i][1]){
                    newSeedPositionsSigEv1.push_back(std::make_pair(sig_LRJ_Eta[i][0], sig_LRJ_Phi[i][0]));
                    newSeedPositionsSigEv1.push_back(std::make_pair(sig_LRJ_Eta[i][1], sig_LRJ_Phi[i][1]));
                    sigLRJEtEv1.push_back(sig_LRJ_Et[i][0]);
                    sigLRJEtEv1.push_back(sig_LRJ_Et[i][1]);
                    sigLRJPsi_REv1.push_back(psi_R_SigJet1);
                    sigLRJPsi_REv1.push_back(psi_R_SigJet2);
                }
                else{
                    newSeedPositionsSigEv1.push_back(std::make_pair(sig_LRJ_Eta[i][1], sig_LRJ_Phi[i][1]));
                    newSeedPositionsSigEv1.push_back(std::make_pair(sig_LRJ_Eta[i][0], sig_LRJ_Phi[i][0]));
                    sigLRJEtEv1.push_back(sig_LRJ_Et[i][1]);
                    sigLRJEtEv1.push_back(sig_LRJ_Et[i][0]);
                    sigLRJPsi_REv1.push_back(psi_R_SigJet1);
                    sigLRJPsi_REv1.push_back(psi_R_SigJet2);
                }
                gFexLRJPositionSigEv1.push_back(std::make_pair(gFexLRJLeadingEtaValuesSignal->at(0), gFexLRJLeadingPhiValuesSignal->at(0)));
                gFexLRJPositionSigEv1.push_back(std::make_pair(gFexLRJSubleadingEtaValuesSignal->at(0), gFexLRJSubleadingPhiValuesSignal->at(0)));
                siggFexLRJEtEv1.push_back(gFexLRJLeadingEtValuesSignal->at(0));
                siggFexLRJEtEv1.push_back(gFexLRJSubleadingEtValuesSignal->at(0));
                
                offlineLRJPositionSigEv1.push_back(std::make_pair(recoAntiKt10LRJLeadingEtaValuesSignal->at(0), recoAntiKt10LRJLeadingPhiValuesSignal->at(0)));
                offlineLRJPositionSigEv1.push_back(std::make_pair(recoAntiKt10LRJSubleadingEtaValuesSignal->at(0), recoAntiKt10LRJSubleadingPhiValuesSignal->at(0)));
                sigOfflineLRJEtEv1.push_back(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                sigOfflineLRJEtEv1.push_back(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
                //std::cout << "Event 1 Sig LRJ 1 Et, Eta, Phi: " << sig_LRJ_Et[i][0] << " , " << sig_LRJ_Eta[i][0] << " , " << sig_LRJ_Phi[i][0] << "\n";
                //std::cout << "Event 1 Sig LRJ 2 Et, Eta, Phi: " << sig_LRJ_Et[i][1] << " , " << sig_LRJ_Eta[i][1] << " , " << sig_LRJ_Phi[i][1] << "\n";
            
            }
        }
        if(i == evDisplay2Sig_){
            if(recoAntiKt10LRJSubleadingEtValuesSignal->size() > 0 && jFexSRJEtaValuesSignal->size() >= 6){
                displayEv2Sig_ = true;
                jFexSeedPositionsSigEv2.push_back(std::make_pair(jFexSRJEtaValuesSignal->at(0), jFexSRJPhiValuesSignal->at(0)));
                jFexSeedPositionsSigEv2.push_back(std::make_pair(jFexSRJEtaValuesSignal->at(1), jFexSRJPhiValuesSignal->at(1)));
                jFexAdditionalSRJPositionsSigEv2.push_back(std::make_pair(jFexSRJEtaValuesSignal->at(2), jFexSRJPhiValuesSignal->at(2)));
                jFexAdditionalSRJPositionsSigEv2.push_back(std::make_pair(jFexSRJEtaValuesSignal->at(3), jFexSRJPhiValuesSignal->at(3)));
                jFexAdditionalSRJPositionsSigEv2.push_back(std::make_pair(jFexSRJEtaValuesSignal->at(4), jFexSRJPhiValuesSignal->at(4)));
                jFexAdditionalSRJPositionsSigEv2.push_back(std::make_pair(jFexSRJEtaValuesSignal->at(5), jFexSRJPhiValuesSignal->at(5)));
                if(sig_LRJ_Et[i][0] > sig_LRJ_Et[i][1]){
                    newSeedPositionsSigEv2.push_back(std::make_pair(sig_LRJ_Eta[i][0], sig_LRJ_Phi[i][0]));
                    newSeedPositionsSigEv2.push_back(std::make_pair(sig_LRJ_Eta[i][1], sig_LRJ_Phi[i][1]));
                    sigLRJEtEv2.push_back(sig_LRJ_Et[i][0]);
                    sigLRJEtEv2.push_back(sig_LRJ_Et[i][1]);
                    sigLRJPsi_REv2.push_back(psi_R_SigJet1);
                    sigLRJPsi_REv2.push_back(psi_R_SigJet2);
                }
                else{
                    newSeedPositionsSigEv2.push_back(std::make_pair(sig_LRJ_Eta[i][1], sig_LRJ_Phi[i][1]));
                    newSeedPositionsSigEv2.push_back(std::make_pair(sig_LRJ_Eta[i][0], sig_LRJ_Phi[i][0]));
                    sigLRJEtEv2.push_back(sig_LRJ_Et[i][1]);
                    sigLRJEtEv2.push_back(sig_LRJ_Et[i][0]);
                    sigLRJPsi_REv2.push_back(psi_R_SigJet1);
                    sigLRJPsi_REv2.push_back(psi_R_SigJet2);
                }
                gFexLRJPositionSigEv2.push_back(std::make_pair(gFexLRJLeadingEtaValuesSignal->at(0), gFexLRJLeadingPhiValuesSignal->at(0)));
                gFexLRJPositionSigEv2.push_back(std::make_pair(gFexLRJSubleadingEtaValuesSignal->at(0), gFexLRJSubleadingPhiValuesSignal->at(0)));
                siggFexLRJEtEv2.push_back(gFexLRJLeadingEtValuesSignal->at(0));
                siggFexLRJEtEv2.push_back(gFexLRJSubleadingEtValuesSignal->at(0));
                offlineLRJPositionSigEv2.push_back(std::make_pair(recoAntiKt10LRJLeadingEtaValuesSignal->at(0), recoAntiKt10LRJLeadingPhiValuesSignal->at(0)));
                offlineLRJPositionSigEv2.push_back(std::make_pair(recoAntiKt10LRJSubleadingEtaValuesSignal->at(0), recoAntiKt10LRJSubleadingPhiValuesSignal->at(0)));
                sigOfflineLRJEtEv2.push_back(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                sigOfflineLRJEtEv2.push_back(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
                //std::cout << "Event 2 Sig LRJ 1 Et, Eta, Phi: " << sig_LRJ_Et[i][0] << " , " << sig_LRJ_Eta[i][0] << " , " << sig_LRJ_Phi[i][0] << "\n";
                //std::cout << "Event 2 Sig LRJ 2 Et, Eta, Phi: " << sig_LRJ_Et[i][1] << " , " << sig_LRJ_Eta[i][1] << " , " << sig_LRJ_Phi[i][1] << "\n";
            }
            
        }

        if(i == evDisplay3Sig_){
            if(recoAntiKt10LRJSubleadingEtValuesSignal->size() > 0 && jFexSRJEtaValuesSignal->size() >= 6){
                displayEv3Sig_ = true;
                jFexSeedPositionsSigEv3.push_back(std::make_pair(jFexSRJEtaValuesSignal->at(0), jFexSRJPhiValuesSignal->at(0)));
                jFexSeedPositionsSigEv3.push_back(std::make_pair(jFexSRJEtaValuesSignal->at(1), jFexSRJPhiValuesSignal->at(1)));
                jFexAdditionalSRJPositionsSigEv3.push_back(std::make_pair(jFexSRJEtaValuesSignal->at(2), jFexSRJPhiValuesSignal->at(2)));
                jFexAdditionalSRJPositionsSigEv3.push_back(std::make_pair(jFexSRJEtaValuesSignal->at(3), jFexSRJPhiValuesSignal->at(3)));
                jFexAdditionalSRJPositionsSigEv3.push_back(std::make_pair(jFexSRJEtaValuesSignal->at(4), jFexSRJPhiValuesSignal->at(4)));
                jFexAdditionalSRJPositionsSigEv3.push_back(std::make_pair(jFexSRJEtaValuesSignal->at(5), jFexSRJPhiValuesSignal->at(5)));
                if(sig_LRJ_Et[i][0] > sig_LRJ_Et[i][1]){
                    newSeedPositionsSigEv3.push_back(std::make_pair(sig_LRJ_Eta[i][0], sig_LRJ_Phi[i][0]));
                    newSeedPositionsSigEv3.push_back(std::make_pair(sig_LRJ_Eta[i][1], sig_LRJ_Phi[i][1]));
                    sigLRJEtEv3.push_back(sig_LRJ_Et[i][0]);
                    sigLRJEtEv3.push_back(sig_LRJ_Et[i][1]);
                    sigLRJPsi_REv3.push_back(psi_R_SigJet1);
                    sigLRJPsi_REv3.push_back(psi_R_SigJet2);
                }
                else{
                    newSeedPositionsSigEv3.push_back(std::make_pair(sig_LRJ_Eta[i][1], sig_LRJ_Phi[i][1]));
                    newSeedPositionsSigEv3.push_back(std::make_pair(sig_LRJ_Eta[i][0], sig_LRJ_Phi[i][0]));
                    sigLRJEtEv3.push_back(sig_LRJ_Et[i][1]);
                    sigLRJEtEv3.push_back(sig_LRJ_Et[i][0]);
                    sigLRJPsi_REv3.push_back(psi_R_SigJet1);
                    sigLRJPsi_REv3.push_back(psi_R_SigJet2);
                }
                gFexLRJPositionSigEv3.push_back(std::make_pair(gFexLRJLeadingEtaValuesSignal->at(0), gFexLRJLeadingPhiValuesSignal->at(0)));
                gFexLRJPositionSigEv3.push_back(std::make_pair(gFexLRJSubleadingEtaValuesSignal->at(0), gFexLRJSubleadingPhiValuesSignal->at(0)));
                siggFexLRJEtEv3.push_back(gFexLRJLeadingEtValuesSignal->at(0));
                siggFexLRJEtEv3.push_back(gFexLRJSubleadingEtValuesSignal->at(0));
                offlineLRJPositionSigEv3.push_back(std::make_pair(recoAntiKt10LRJLeadingEtaValuesSignal->at(0), recoAntiKt10LRJLeadingPhiValuesSignal->at(0)));
                offlineLRJPositionSigEv3.push_back(std::make_pair(recoAntiKt10LRJSubleadingEtaValuesSignal->at(0), recoAntiKt10LRJSubleadingPhiValuesSignal->at(0)));
                sigOfflineLRJEtEv3.push_back(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                sigOfflineLRJEtEv3.push_back(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
                //std::cout << "Event 3 Sig LRJ 1 Et, Eta, Phi: " << sig_LRJ_Et[i][0] << " , " << sig_LRJ_Eta[i][0] << " , " << sig_LRJ_Phi[i][0] << "\n";
                //std::cout << "Event 3 Sig LRJ 2 Et, Eta, Phi: " << sig_LRJ_Et[i][1] << " , " << sig_LRJ_Eta[i][1] << " , " << sig_LRJ_Phi[i][1] << "\n";
            }
            
        }
        if(i == evDisplay4Sig_){
            if(recoAntiKt10LRJSubleadingEtValuesSignal->size() > 0 && jFexSRJEtaValuesSignal->size() >= 6){
                displayEv4Sig_ = true;
                jFexSeedPositionsSigEv4.push_back(std::make_pair(jFexSRJEtaValuesSignal->at(0), jFexSRJPhiValuesSignal->at(0)));
                jFexSeedPositionsSigEv4.push_back(std::make_pair(jFexSRJEtaValuesSignal->at(1), jFexSRJPhiValuesSignal->at(1)));
                jFexAdditionalSRJPositionsSigEv4.push_back(std::make_pair(jFexSRJEtaValuesSignal->at(2), jFexSRJPhiValuesSignal->at(2)));
                jFexAdditionalSRJPositionsSigEv4.push_back(std::make_pair(jFexSRJEtaValuesSignal->at(3), jFexSRJPhiValuesSignal->at(3)));
                jFexAdditionalSRJPositionsSigEv4.push_back(std::make_pair(jFexSRJEtaValuesSignal->at(4), jFexSRJPhiValuesSignal->at(4)));
                jFexAdditionalSRJPositionsSigEv4.push_back(std::make_pair(jFexSRJEtaValuesSignal->at(5), jFexSRJPhiValuesSignal->at(5)));
                if(sig_LRJ_Et[i][0] > sig_LRJ_Et[i][1]){
                    newSeedPositionsSigEv4.push_back(std::make_pair(sig_LRJ_Eta[i][0], sig_LRJ_Phi[i][0]));
                    newSeedPositionsSigEv4.push_back(std::make_pair(sig_LRJ_Eta[i][1], sig_LRJ_Phi[i][1]));
                    sigLRJEtEv4.push_back(sig_LRJ_Et[i][0]);
                    sigLRJEtEv4.push_back(sig_LRJ_Et[i][1]);
                    sigLRJPsi_REv4.push_back(psi_R_SigJet1);
                    sigLRJPsi_REv4.push_back(psi_R_SigJet2);
                }
                else{
                    newSeedPositionsSigEv4.push_back(std::make_pair(sig_LRJ_Eta[i][1], sig_LRJ_Phi[i][1]));
                    newSeedPositionsSigEv4.push_back(std::make_pair(sig_LRJ_Eta[i][0], sig_LRJ_Phi[i][0]));
                    sigLRJEtEv4.push_back(sig_LRJ_Et[i][1]);
                    sigLRJEtEv4.push_back(sig_LRJ_Et[i][0]);
                    sigLRJPsi_REv4.push_back(psi_R_SigJet1);
                    sigLRJPsi_REv4.push_back(psi_R_SigJet2);
                }
                gFexLRJPositionSigEv4.push_back(std::make_pair(gFexLRJLeadingEtaValuesSignal->at(0), gFexLRJLeadingPhiValuesSignal->at(0)));
                gFexLRJPositionSigEv4.push_back(std::make_pair(gFexLRJSubleadingEtaValuesSignal->at(0), gFexLRJSubleadingPhiValuesSignal->at(0)));
                siggFexLRJEtEv4.push_back(gFexLRJLeadingEtValuesSignal->at(0));
                siggFexLRJEtEv4.push_back(gFexLRJSubleadingEtValuesSignal->at(0));
                offlineLRJPositionSigEv4.push_back(std::make_pair(recoAntiKt10LRJLeadingEtaValuesSignal->at(0), recoAntiKt10LRJLeadingPhiValuesSignal->at(0)));
                offlineLRJPositionSigEv4.push_back(std::make_pair(recoAntiKt10LRJSubleadingEtaValuesSignal->at(0), recoAntiKt10LRJSubleadingPhiValuesSignal->at(0)));
                sigOfflineLRJEtEv4.push_back(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                sigOfflineLRJEtEv4.push_back(recoAntiKt10LRJSubleadingEtValuesSignal->at(0));
                //std::cout << "Event 4 Sig LRJ 1 Et, Eta, Phi: " << sig_LRJ_Et[i][0] << " , " << sig_LRJ_Eta[i][0] << " , " << sig_LRJ_Phi[i][0] << "\n";
                //std::cout << "Event 4 Sig LRJ 2 Et, Eta, Phi: " << sig_LRJ_Et[i][1] << " , " << sig_LRJ_Eta[i][1] << " , " << sig_LRJ_Phi[i][1] << "\n";
            }
        }

        if(i <= evDisplayMaxSig_){
            for(unsigned int iTopo = 0; iTopo < nInputObjectsAlgorithmConfiguration; iTopo++){
                if(inputObjectType == "gepBasicClusters"){
                    if(i == evDisplay0Sig_){
                        sigTopo422Highest128SeedPositionsEv0->Fill(gepBasicClustersEtaValuesSignal->at(iTopo), gepBasicClustersPhiValuesSignal->at(iTopo), gepBasicClustersEtValuesSignal->at(iTopo));
                    } 
                    if(i == evDisplay1Sig_){
                        sigTopo422Highest128SeedPositionsEv1->Fill(gepBasicClustersEtaValuesSignal->at(iTopo), gepBasicClustersPhiValuesSignal->at(iTopo), gepBasicClustersEtValuesSignal->at(iTopo));
                    } 
                    if(i == evDisplay2Sig_){
                        sigTopo422Highest128SeedPositionsEv2->Fill(gepBasicClustersEtaValuesSignal->at(iTopo), gepBasicClustersPhiValuesSignal->at(iTopo), gepBasicClustersEtValuesSignal->at(iTopo));
                    } 
                    if(i == evDisplay3Sig_){
                        sigTopo422Highest128SeedPositionsEv3->Fill(gepBasicClustersEtaValuesSignal->at(iTopo), gepBasicClustersPhiValuesSignal->at(iTopo), gepBasicClustersEtValuesSignal->at(iTopo));
                    } 
                    if(i == evDisplay4Sig_){
                        sigTopo422Highest128SeedPositionsEv4->Fill(gepBasicClustersEtaValuesSignal->at(iTopo), gepBasicClustersPhiValuesSignal->at(iTopo), gepBasicClustersEtValuesSignal->at(iTopo));
                    } 
                }
                else if(inputObjectType == "Towers"){
                    if(i == evDisplay0Sig_){
                        sigTopo422Highest128SeedPositionsEv0->Fill(gepCellsTowersEtaValuesSignal->at(iTopo), gepCellsTowersPhiValuesSignal->at(iTopo), gepCellsTowersEtValuesSignal->at(iTopo));
                    } 
                    if(i == evDisplay1Sig_){
                        sigTopo422Highest128SeedPositionsEv1->Fill(gepCellsTowersEtaValuesSignal->at(iTopo), gepCellsTowersPhiValuesSignal->at(iTopo), gepCellsTowersEtValuesSignal->at(iTopo));
                    } 
                    if(i == evDisplay2Sig_){
                        sigTopo422Highest128SeedPositionsEv2->Fill(gepCellsTowersEtaValuesSignal->at(iTopo), gepCellsTowersPhiValuesSignal->at(iTopo), gepCellsTowersEtValuesSignal->at(iTopo));
                    } 
                    if(i == evDisplay3Sig_){
                        sigTopo422Highest128SeedPositionsEv3->Fill(gepCellsTowersEtaValuesSignal->at(iTopo), gepCellsTowersPhiValuesSignal->at(iTopo), gepCellsTowersEtValuesSignal->at(iTopo));
                    } 
                    if(i == evDisplay4Sig_){
                        sigTopo422Highest128SeedPositionsEv4->Fill(gepCellsTowersEtaValuesSignal->at(iTopo), gepCellsTowersPhiValuesSignal->at(iTopo), gepCellsTowersEtValuesSignal->at(iTopo));
                    } 
                }
                
            }
        }

        // try computing invariant mass, signal, background using jet tagger jets
        double sigDeltaEta = sig_LRJ_Eta[i][0] - sig_LRJ_Eta[i][1];
        double sigDeltaPhi = std::abs(sig_LRJ_Phi[i][0] - sig_LRJ_Phi[i][1]);
        // Ensure  is within [-, ] range
        if (sigDeltaPhi > M_PI) {
            sigDeltaPhi = 2 * M_PI - sigDeltaPhi;
        }

        double sigCoshDeltaEta = cosh(sigDeltaEta);
        double sigCosDeltaPhi = cos(sigDeltaPhi);
        double sigMjj = sqrt(2.0 * sig_LRJ_Et[i][0] * sig_LRJ_Et[i][1] * sigCoshDeltaEta - sigCosDeltaPhi);
        //std::cout << "sigMjj: " << sigMjj << "\n";

        sig_h_Mjj->Fill(sigMjj);
    } // loop through signal events

    std::vector<unsigned int> nSubjetsLeadingLRJBack(
        num_processed_events_background, 0);

    std::vector<unsigned int> nSubjetsSubleadingLRJBack(
        num_processed_events_background, 0);

    std::vector<unsigned int> nOfflineSubjetsLeadingLRJBack(
        num_processed_events_background, 0);
    for (unsigned int i = 0; i < num_processed_events_background; i++) {
        //std::cout << "i:  "<< i << "\n";
        jetTaggerLRJsBack->GetEntry(i);
        jetTaggerLeadingLRJsBack->GetEntry(i);
        jetTaggerSubleadingLRJsBack->GetEntry(i);
        eventInfoTreeBack->GetEntry(i);
        truthAntiKt4TruthDressedWZJetsBack->GetEntry(i);
        leadingTruthAntiKt4TruthDressedWZJetsBack->GetEntry(i);
        subleadingTruthAntiKt4TruthDressedWZJetsBack->GetEntry(i);
        leadingRecoAntiKt10UFOCSSKJetsBack->GetEntry(i);
        subleadingRecoAntiKt10UFOCSSKJetsBack->GetEntry(i);
        jFexLeadingLRJTreeBack->GetEntry(i);
        gFexLeadingLRJTreeBack->GetEntry(i);
        jFexSubleadingLRJTreeBack->GetEntry(i);
        gFexSubleadingLRJTreeBack->GetEntry(i);
        jFexLeadingSRJTreeBack->GetEntry(i);
        jFexSubleadingSRJTreeBack->GetEntry(i);
        gFexLeadingSRJTreeBack->GetEntry(i);
        gFexSubleadingSRJTreeBack->GetEntry(i);
        jFexSRJTreeBack->GetEntry(i);
        topo422TreeBack->GetEntry(i);
        gepBasicClustersTreeBack->GetEntry(i);
        gepCellsTowersTreeBack->GetEntry(i);
        gepCellsTowersSKTreeBack->GetEntry(i);
        gepWTAConeCellsTowersJetsTreeBack->GetEntry(i);
        gepWTAConeBasicClustersJetsTreeBack->GetEntry(i);
        gepLeadingWTAConeCellsTowersJetsTreeBack->GetEntry(i);
        gepLeadingWTAConeBasicClustersJetsTreeBack->GetEntry(i);
        gepSubleadingWTAConeCellsTowersJetsTreeBack->GetEntry(i);
        gepSubleadingWTAConeBasicClustersJetsTreeBack->GetEntry(i);
        leadingInTimeAntiKt4TruthJetsTreeBack->GetEntry(i);

        double backgroundEventWeight = eventWeightsValuesBack->at(0);

        if(truthAntiKt4WZSRJSubleadingEtaValuesBack->size() > 0){
            backDeltaRLeadingSubleadingTruthJets->Fill(sqrt(calcDeltaR2(truthAntiKt4WZSRJLeadingEtaValuesBack->at(0), truthAntiKt4WZSRJLeadingPhiValuesBack->at(0), truthAntiKt4WZSRJSubleadingEtaValuesBack->at(0), truthAntiKt4WZSRJSubleadingPhiValuesBack->at(0))));
        }

        unsigned int nonZeroEtCounter = 0;
        for(unsigned int iTower = 0; iTower < gepCellsTowersSKEtValuesBack->size(); iTower++){
            if(gepCellsTowersSKEtValuesBack->at(iTower) > 0) nonZeroEtCounter++;
        }
        //std::cout << "bgnd nonZeroEtCounter: " << nonZeroEtCounter << "\n";
        back_h_JetTagger_CellTowerSK_Multiplicity->Fill(nonZeroEtCounter, backgroundEventWeight);

        double jetTaggerLeadingEta = jetTaggerLeadingLRJEtaValuesBack->at(0);
        double jetTaggerLeadingPhi= jetTaggerLeadingLRJEtaValuesBack->at(0);
        double jetTaggerSubleadingEta = jetTaggerSubleadingLRJEtaValuesBack->at(0);
        double jetTaggerSubleadingPhi= jetTaggerSubleadingLRJEtaValuesBack->at(0);
        // Find subjets (jFEX and cone jets) - first for leading JetTagger jet
        std::vector<std::array<double, 3 > > leadingJetTaggerjFEXSubjets; // indexed by Et, Eta, Phi
        std::vector<std::array<double, 3 > > subleadingJetTaggerjFEXSubjets;
        std::vector<std::array<double, 3 > > leadingJetTaggerConeCellsTowersSubjets; 
        std::vector<std::array<double, 3 > > subleadingJetTaggerConeCellsTowersSubjets;

        /*if(sampleJZSliceValuesBack == 1 && jetTaggerLeadingLRJEtValuesBack->at(0) > 150.0){
            std::cout << "EVENT WITH SPIKE i: " << i << "\n";
            std::cout << "background event weight: " << backgroundEventWeight << "\n";
            std::cout << "leading pileup jet E_T, eta, phi: " << inTimeAntiKt4TruthSRJLeadingEtValuesBack->at(0) << " , " << inTimeAntiKt4TruthSRJLeadingEtaValuesBack->at(0) << " , " << inTimeAntiKt4TruthSRJLeadingPhiValuesBack->at(0) << "\n";
            std::cout << "leading truth jet E_T, eta, phi: " << truthAntiKt4WZSRJLeadingEtValuesBack->at(0) << " , " << truthAntiKt4WZSRJLeadingEtaValuesBack->at(0) << " , " << truthAntiKt4WZSRJLeadingPhiValuesBack->at(0) << "\n";
        } */

        double nsubjetinessSubjetEtThreshold = subjetEtThreshold; // GeV
        unsigned int nSubjetjFEXJetTaggerLeading = 0;
        unsigned int nSubjetConeCellsTowersJetTaggerLeading = 0;
        unsigned int nSubjetjFEXJetTaggerSubleading = 0;
        unsigned int nSubjetConeCellsTowersJetTaggerSubleading = 0;
        for(unsigned int iSubjet = 0; iSubjet < jFexSRJEtaValuesBack->size(); iSubjet++ ){ 
            double deltaRJetTaggerSubjet = sqrt(calcDeltaR2(jetTaggerLeadingLRJEtaValuesBack->at(0), jetTaggerLeadingLRJPhiValuesBack->at(0), jFexSRJEtaValuesBack->at(iSubjet), jFexSRJPhiValuesBack->at(iSubjet))); // FIXME ensure delta R threshold is dynamically calculated from algorithm configuration
            if(deltaRJetTaggerSubjet < jetRadius && jFexSRJEtValuesBack->at(iSubjet) > nsubjetinessSubjetEtThreshold){ // FIXME ensure delta R threshold is dynamically calculated from algorithm configuration
                nSubjetjFEXJetTaggerLeading++;
                leadingJetTaggerjFEXSubjets.push_back({jFexSRJEtValuesBack->at(iSubjet), jFexSRJEtaValuesBack->at(iSubjet), jFexSRJPhiValuesBack->at(iSubjet)});
            }
        }
        for(unsigned int iSubjet = 0; iSubjet < gepWTAConeCellsTowersJetsEtaValuesBack->size(); iSubjet++ ){
            double deltaRJetTaggerSubjet = sqrt(calcDeltaR2(jetTaggerLeadingLRJEtaValuesBack->at(0), jetTaggerLeadingLRJPhiValuesBack->at(0), gepWTAConeCellsTowersJetsEtaValuesBack->at(iSubjet), gepWTAConeCellsTowersJetsPhiValuesBack->at(iSubjet)));
            if(deltaRJetTaggerSubjet < jetRadius && gepWTAConeCellsTowersJetspTValuesBack->at(iSubjet) > nsubjetinessSubjetEtThreshold){ // FIXME ensure delta R threshold is dynamically calculated from algorithm configuration
                nSubjetConeCellsTowersJetTaggerLeading++;
                leadingJetTaggerConeCellsTowersSubjets.push_back({gepWTAConeCellsTowersJetspTValuesBack->at(iSubjet), gepWTAConeCellsTowersJetsEtaValuesBack->at(iSubjet), gepWTAConeCellsTowersJetsPhiValuesBack->at(iSubjet)});
            }
        }

        // Find subjets (jFEX and cone jets) - now for subleading JetTagger jet
        for(unsigned int iSubjet = 0; iSubjet < jFexSRJEtaValuesBack->size(); iSubjet++ ){
            double deltaRJetTaggerSubjet = sqrt(calcDeltaR2(jetTaggerSubleadingLRJEtaValuesBack->at(0), jetTaggerSubleadingLRJPhiValuesBack->at(0), jFexSRJEtaValuesBack->at(iSubjet), jFexSRJPhiValuesBack->at(iSubjet)));
            if(deltaRJetTaggerSubjet < jetRadius && jFexSRJEtValuesBack->at(iSubjet) > nsubjetinessSubjetEtThreshold){ // FIXME ensure delta R threshold is dynamically calculated from algorithm configuration
                nSubjetjFEXJetTaggerSubleading++;
                subleadingJetTaggerjFEXSubjets.push_back({jFexSRJEtValuesBack->at(iSubjet), jFexSRJEtaValuesBack->at(iSubjet), jFexSRJPhiValuesBack->at(iSubjet)});
            }
        }
        for(unsigned int iSubjet = 0; iSubjet < gepWTAConeCellsTowersJetsEtaValuesBack->size(); iSubjet++ ){ 
            double deltaRJetTaggerSubjet = sqrt(calcDeltaR2(jetTaggerSubleadingLRJEtaValuesBack->at(0), jetTaggerSubleadingLRJPhiValuesBack->at(0), gepWTAConeCellsTowersJetsEtaValuesBack->at(iSubjet), gepWTAConeCellsTowersJetsPhiValuesBack->at(iSubjet)));
            if(deltaRJetTaggerSubjet < jetRadius && gepWTAConeCellsTowersJetspTValuesBack->at(iSubjet) > nsubjetinessSubjetEtThreshold){ // FIXME ensure delta R threshold is dynamically calculated from algorithm configuration
                nSubjetConeCellsTowersJetTaggerSubleading++;
                subleadingJetTaggerConeCellsTowersSubjets.push_back({gepWTAConeCellsTowersJetspTValuesBack->at(iSubjet), gepWTAConeCellsTowersJetsEtaValuesBack->at(iSubjet), gepWTAConeCellsTowersJetsPhiValuesBack->at(iSubjet)});
            }
        }

        // Sort helper lambda: compare by Et (index 0)
        auto sortByEtDescending = [](const std::array<double, 3>& a, const std::array<double, 3>& b) {
            return a[0] > b[0];  // sort by Et descending
        };

        // Sort all four subjet collections for NSubjetiness computation
        std::sort(leadingJetTaggerjFEXSubjets.begin(), leadingJetTaggerjFEXSubjets.end(), sortByEtDescending);
        std::sort(subleadingJetTaggerjFEXSubjets.begin(), subleadingJetTaggerjFEXSubjets.end(), sortByEtDescending);
        std::sort(leadingJetTaggerConeCellsTowersSubjets.begin(), leadingJetTaggerConeCellsTowersSubjets.end(), sortByEtDescending);
        std::sort(subleadingJetTaggerConeCellsTowersSubjets.begin(), subleadingJetTaggerConeCellsTowersSubjets.end(), sortByEtDescending);

        // Compute E_T / p_T of constituent times min. delta R between subjets
        // NSubjetiness for jFEX subjets
        double tau_1_LeadingJetTaggerjFEXSubjet = 0; 
        double tau_1_SubleadingJetTaggerjFEXSubjet = 0; 
        double tau_2_LeadingJetTaggerjFEXSubjet = 0; 
        double tau_2_SubleadingJetTaggerjFEXSubjet = 0; 

        // NSubjetiness for ConeCellsTowers subjets
        double tau_1_LeadingJetTaggerConeCellsTowersSubjet = 0; 
        double tau_1_SubleadingJetTaggerConeCellsTowersSubjet = 0; 
        double tau_2_LeadingJetTaggerConeCellsTowersSubjet = 0; 
        double tau_2_SubleadingJetTaggerConeCellsTowersSubjet = 0; 

        for(unsigned int iTower = 0; iTower < gepCellsTowersEtValuesBack->size(); iTower++){
            back_h_JetTagger_CellsTowersEt->Fill(gepCellsTowersEtValuesBack->at(iTower), backgroundEventWeight);
        }
        for(unsigned int iTower = 0; iTower < nInputObjectsAlgorithmConfiguration; iTower++){
            back_h_JetTagger_Considered_CellsTowersEt->Fill(gepCellsTowersEtValuesBack->at(iTower), backgroundEventWeight);
        }

        // deltaR for jFEX , ConeCellsTowers subjets
        //std::vector<double > deltaRLeadingJetTaggerjFEXSubjet;  // FIXME unneeded?
        //std::vector<double > deltaRSubleadingJetTaggerjFEXSubjet; 
        //std::vector<double > deltaRLeadingJetTaggerjFEXSubjet; 
        //std::vector<double > deltaRSubleadingJetTaggerjFEXSubjet; 
        // First for leading JetTagger LRJ

        for(auto& idxSigJet1 : *jetTaggerLeadingLRJMergedIndicesValuesBack){ // Loop through jet tagger merged indices
            std::array<double, 3 > inputObjectEtEtaPhi = {0.0, 0.0, 0.0};;
            if (inputObjectType == "gepBasicClusters"){
                inputObjectEtEtaPhi[0] = gepBasicClustersEtValuesBack->at(idxSigJet1);
                inputObjectEtEtaPhi[1] = gepBasicClustersEtaValuesBack->at(idxSigJet1);
                inputObjectEtEtaPhi[2] = gepBasicClustersPhiValuesBack->at(idxSigJet1);
                back_h_JetTagger_Leading_MergedIO_Et->Fill(gepBasicClustersEtValuesBack->at(idxSigJet1), backgroundEventWeight);
            }
            else if (inputObjectType == "Towers"){
                inputObjectEtEtaPhi[0] = gepCellsTowersEtValuesBack->at(idxSigJet1);
                inputObjectEtEtaPhi[1] = gepCellsTowersEtaValuesBack->at(idxSigJet1);
                inputObjectEtEtaPhi[2] = gepCellsTowersPhiValuesBack->at(idxSigJet1);
                back_h_JetTagger_Leading_MergedIO_Et->Fill(gepCellsTowersEtValuesBack->at(idxSigJet1), backgroundEventWeight);
            }
            else if (inputObjectType == "gepWTAConeCellsTowersJet"){
                inputObjectEtEtaPhi[0] = gepWTAConeCellsTowersJetspTValuesBack->at(idxSigJet1);
                inputObjectEtEtaPhi[1] = gepWTAConeCellsTowersJetsEtaValuesBack->at(idxSigJet1);
                inputObjectEtEtaPhi[2] = gepWTAConeCellsTowersJetsPhiValuesBack->at(idxSigJet1);
                back_h_JetTagger_Leading_MergedIO_Et->Fill(gepWTAConeCellsTowersJetspTValuesBack->at(idxSigJet1), backgroundEventWeight);
            }
            if(leadingJetTaggerjFEXSubjets.size() > 0){
                double deltaR = sqrt(calcDeltaR2(inputObjectEtEtaPhi[1], inputObjectEtEtaPhi[2], leadingJetTaggerjFEXSubjets[0][1], leadingJetTaggerjFEXSubjets[0][2]));
                tau_1_LeadingJetTaggerjFEXSubjet += inputObjectEtEtaPhi[0] * deltaR;
            }
            if(leadingJetTaggerjFEXSubjets.size() > 1){
                double deltaR_first_subjet = sqrt(calcDeltaR2(inputObjectEtEtaPhi[1], inputObjectEtEtaPhi[2], leadingJetTaggerjFEXSubjets[0][1], leadingJetTaggerjFEXSubjets[0][2]));
                double deltaR_second_subjet = sqrt(calcDeltaR2(inputObjectEtEtaPhi[1], inputObjectEtEtaPhi[2], leadingJetTaggerjFEXSubjets[1][1], leadingJetTaggerjFEXSubjets[1][2]));
                double min_deltaR = std::min(deltaR_first_subjet, deltaR_second_subjet);
                tau_2_LeadingJetTaggerjFEXSubjet += inputObjectEtEtaPhi[0] * min_deltaR;
            }

            if(leadingJetTaggerConeCellsTowersSubjets.size() > 0){
                double deltaR = sqrt(calcDeltaR2(inputObjectEtEtaPhi[1], inputObjectEtEtaPhi[2], leadingJetTaggerConeCellsTowersSubjets[0][1], leadingJetTaggerConeCellsTowersSubjets[0][2]));
                tau_1_LeadingJetTaggerConeCellsTowersSubjet += inputObjectEtEtaPhi[0] * deltaR;
            }
            if(leadingJetTaggerConeCellsTowersSubjets.size() > 1){
                double deltaR_first_subjet = sqrt(calcDeltaR2(inputObjectEtEtaPhi[1], inputObjectEtEtaPhi[2], leadingJetTaggerConeCellsTowersSubjets[0][1], leadingJetTaggerConeCellsTowersSubjets[0][2]));
                double deltaR_second_subjet = sqrt(calcDeltaR2(inputObjectEtEtaPhi[1], inputObjectEtEtaPhi[2], leadingJetTaggerConeCellsTowersSubjets[1][1], leadingJetTaggerConeCellsTowersSubjets[1][2]));
                double min_deltaR = std::min(deltaR_first_subjet, deltaR_second_subjet);
                tau_2_LeadingJetTaggerConeCellsTowersSubjet += inputObjectEtEtaPhi[0] * min_deltaR;
            }
        }
        
        // Normalize by 1/d_0 (which here is just the jet E_T / p_T as R assumed = 1.0, else must do annoying computation)
        tau_1_LeadingJetTaggerjFEXSubjet /= (jetTaggerLeadingLRJEtValuesBack->at(0) * jetRadius);
        tau_2_LeadingJetTaggerjFEXSubjet /= (jetTaggerLeadingLRJEtValuesBack->at(0) * jetRadius);
        tau_1_LeadingJetTaggerConeCellsTowersSubjet /= (jetTaggerLeadingLRJEtValuesBack->at(0) * jetRadius);
        tau_2_LeadingJetTaggerConeCellsTowersSubjet /= (jetTaggerLeadingLRJEtValuesBack->at(0) * jetRadius);

        back_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_1->Fill(tau_1_LeadingJetTaggerjFEXSubjet, backgroundEventWeight);
        back_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_2->Fill(tau_2_LeadingJetTaggerjFEXSubjet, backgroundEventWeight);
        back_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_12->Fill(tau_2_LeadingJetTaggerjFEXSubjet / tau_1_LeadingJetTaggerjFEXSubjet, backgroundEventWeight);
        back_h_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1->Fill(tau_1_LeadingJetTaggerConeCellsTowersSubjet, backgroundEventWeight);
        back_h_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_2->Fill(tau_2_LeadingJetTaggerConeCellsTowersSubjet, backgroundEventWeight);

        back_h_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_12->Fill(tau_2_LeadingJetTaggerConeCellsTowersSubjet / tau_1_LeadingJetTaggerConeCellsTowersSubjet, backgroundEventWeight);
        
        back_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_2->Fill(tau_2_LeadingJetTaggerjFEXSubjet / tau_1_LeadingJetTaggerjFEXSubjet, backgroundEventWeight);
        

        back_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_1_vs_Tau_2->Fill(tau_1_LeadingJetTaggerjFEXSubjet, tau_2_LeadingJetTaggerjFEXSubjet, backgroundEventWeight);
        back_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1_vs_Tau_2->Fill(tau_1_LeadingJetTaggerConeCellsTowersSubjet, tau_2_LeadingJetTaggerConeCellsTowersSubjet, backgroundEventWeight);
        
        // Fill multiplicity of MERGED input objects
        back_h_JetTagger_Leading_MergedIO_Multiplicity->Fill(jetTaggerLeadingLRJMergedIndicesValuesBack->size());
        back_h_JetTagger_Subleading_MergedIO_Multiplicity->Fill(jetTaggerSubleadingLRJMergedIndicesValuesBack->size());

        // Next for subeading JetTagger LRJ
        for(auto& idxSigJet1 : *jetTaggerSubleadingLRJMergedIndicesValuesBack){ // Loop through jet tagger merged indices
            std::array<double, 3 > inputObjectEtEtaPhi = {0.0, 0.0, 0.0};
            if (inputObjectType == "gepBasicClusters"){
                inputObjectEtEtaPhi[0] = gepBasicClustersEtValuesBack->at(idxSigJet1);
                inputObjectEtEtaPhi[1] = gepBasicClustersEtaValuesBack->at(idxSigJet1);
                inputObjectEtEtaPhi[2] = gepBasicClustersPhiValuesBack->at(idxSigJet1);
                back_h_JetTagger_Subleading_MergedIO_Et->Fill(gepBasicClustersEtValuesBack->at(idxSigJet1), backgroundEventWeight);
            }
            if (inputObjectType == "Towers"){
                inputObjectEtEtaPhi[0] = gepCellsTowersEtValuesBack->at(idxSigJet1);
                inputObjectEtEtaPhi[1] = gepCellsTowersEtaValuesBack->at(idxSigJet1);
                inputObjectEtEtaPhi[2] = gepCellsTowersPhiValuesBack->at(idxSigJet1);
                back_h_JetTagger_Subleading_MergedIO_Et->Fill(gepCellsTowersEtValuesBack->at(idxSigJet1), backgroundEventWeight);
            }
            else if (inputObjectType == "gepWTAConeCellsTowersJet"){
                inputObjectEtEtaPhi[0] = gepWTAConeCellsTowersJetspTValuesBack->at(idxSigJet1);
                inputObjectEtEtaPhi[1] = gepWTAConeCellsTowersJetsEtaValuesBack->at(idxSigJet1);
                inputObjectEtEtaPhi[2] = gepWTAConeCellsTowersJetsPhiValuesBack->at(idxSigJet1);
                back_h_JetTagger_Subleading_MergedIO_Et->Fill(gepWTAConeCellsTowersJetspTValuesBack->at(idxSigJet1), backgroundEventWeight);
            }
            if(subleadingJetTaggerjFEXSubjets.size() > 0){
                double deltaR = sqrt(calcDeltaR2(inputObjectEtEtaPhi[1], inputObjectEtEtaPhi[2], subleadingJetTaggerjFEXSubjets[0][1], subleadingJetTaggerjFEXSubjets[0][2]));
                tau_1_SubleadingJetTaggerjFEXSubjet += inputObjectEtEtaPhi[0] * deltaR;
            }
            if(subleadingJetTaggerjFEXSubjets.size() > 1){
                double deltaR_first_subjet = sqrt(calcDeltaR2(inputObjectEtEtaPhi[1], inputObjectEtEtaPhi[2], subleadingJetTaggerjFEXSubjets[0][1], subleadingJetTaggerjFEXSubjets[0][2]));
                double deltaR_second_subjet = sqrt(calcDeltaR2(inputObjectEtEtaPhi[1], inputObjectEtEtaPhi[2], subleadingJetTaggerjFEXSubjets[1][1], subleadingJetTaggerjFEXSubjets[1][2]));
                double min_deltaR = std::min(deltaR_first_subjet, deltaR_second_subjet);
                tau_2_SubleadingJetTaggerjFEXSubjet += inputObjectEtEtaPhi[0] * min_deltaR;
            }

            if(subleadingJetTaggerConeCellsTowersSubjets.size() > 0){
                double deltaR = sqrt(calcDeltaR2(inputObjectEtEtaPhi[1], inputObjectEtEtaPhi[2], subleadingJetTaggerConeCellsTowersSubjets[0][1], subleadingJetTaggerConeCellsTowersSubjets[0][2]));
                tau_1_SubleadingJetTaggerConeCellsTowersSubjet += inputObjectEtEtaPhi[0] * deltaR;
            }
            if(subleadingJetTaggerConeCellsTowersSubjets.size() > 1){
                double deltaR_first_subjet = sqrt(calcDeltaR2(inputObjectEtEtaPhi[1], inputObjectEtEtaPhi[2], subleadingJetTaggerConeCellsTowersSubjets[0][1], subleadingJetTaggerConeCellsTowersSubjets[0][2]));
                double deltaR_second_subjet = sqrt(calcDeltaR2(inputObjectEtEtaPhi[1], inputObjectEtEtaPhi[2], subleadingJetTaggerConeCellsTowersSubjets[1][1], subleadingJetTaggerConeCellsTowersSubjets[1][2]));
                double min_deltaR = std::min(deltaR_first_subjet, deltaR_second_subjet);
                tau_2_SubleadingJetTaggerConeCellsTowersSubjet += inputObjectEtEtaPhi[0] * min_deltaR;
            }
        }

        // Normalize by 1/d_0 (which here is just the jet E_T / p_T as R assumed = 1.0, else must do annoying computation)
        tau_1_SubleadingJetTaggerjFEXSubjet /= (jetTaggerSubleadingLRJEtValuesBack->at(0) * jetRadius);
        tau_2_SubleadingJetTaggerjFEXSubjet /= (jetTaggerSubleadingLRJEtValuesBack->at(0) * jetRadius);
        tau_1_SubleadingJetTaggerConeCellsTowersSubjet /= (jetTaggerSubleadingLRJEtValuesBack->at(0) * jetRadius);
        tau_2_SubleadingJetTaggerConeCellsTowersSubjet /= (jetTaggerSubleadingLRJEtValuesBack->at(0) * jetRadius);

        back_h_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_1->Fill(tau_1_SubleadingJetTaggerjFEXSubjet, backgroundEventWeight);
        back_h_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_2->Fill(tau_2_SubleadingJetTaggerjFEXSubjet, backgroundEventWeight);
        back_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1->Fill(tau_1_SubleadingJetTaggerConeCellsTowersSubjet, backgroundEventWeight);
        back_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_2->Fill(tau_2_SubleadingJetTaggerConeCellsTowersSubjet, backgroundEventWeight);

        back_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_12->Fill(tau_2_SubleadingJetTaggerConeCellsTowersSubjet / tau_1_SubleadingJetTaggerConeCellsTowersSubjet, backgroundEventWeight);

        back_h_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_12->Fill(tau_2_SubleadingJetTaggerjFEXSubjet /tau_1_SubleadingJetTaggerjFEXSubjet );

        back_JetTaggerLRJ_jFEX_Subjet_LeadingTau_12_vs_SubleadingTau12->Fill(tau_2_LeadingJetTaggerjFEXSubjet/tau_1_LeadingJetTaggerjFEXSubjet, tau_2_SubleadingJetTaggerjFEXSubjet/tau_1_SubleadingJetTaggerjFEXSubjet, backgroundEventWeight);
        back_JetTaggerLRJ_ConeCellsTowers_Subjet_LeadingTau_12_vs_SubleadingTau12->Fill(tau_2_LeadingJetTaggerConeCellsTowersSubjet/tau_1_LeadingJetTaggerConeCellsTowersSubjet, tau_2_SubleadingJetTaggerConeCellsTowersSubjet/tau_1_SubleadingJetTaggerConeCellsTowersSubjet, backgroundEventWeight);

        back_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_1_vs_Tau_2->Fill(tau_1_SubleadingJetTaggerjFEXSubjet, tau_2_SubleadingJetTaggerjFEXSubjet, backgroundEventWeight);
        back_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1_vs_Tau_2->Fill(tau_1_SubleadingJetTaggerConeCellsTowersSubjet, tau_2_SubleadingJetTaggerConeCellsTowersSubjet, backgroundEventWeight);

        back_JetTaggerLRJ_ConeCellsTowers_Subjet_LeadingTau_12_vs_SubleadingTau12->Fill(tau_2_LeadingJetTaggerConeCellsTowersSubjet / tau_1_LeadingJetTaggerConeCellsTowersSubjet, tau_2_SubleadingJetTaggerConeCellsTowersSubjet / tau_1_SubleadingJetTaggerConeCellsTowersSubjet, backgroundEventWeight);

        back_h_LeadingJetTaggerLRJ_jFEX_SubjetMultiplicity->Fill(nSubjetjFEXJetTaggerLeading, backgroundEventWeight);
        back_h_LeadingJetTaggerLRJ_ConeCellsTowers_SubjetMultiplicity->Fill(nSubjetConeCellsTowersJetTaggerLeading, backgroundEventWeight);
        back_h_SubleadingJetTaggerLRJ_jFEX_SubjetMultiplicity->Fill(nSubjetjFEXJetTaggerSubleading, backgroundEventWeight);
        back_h_SubleadingJetTaggerLRJ_ConeCellsTowers_SubjetMultiplicity->Fill(nSubjetConeCellsTowersJetTaggerSubleading, backgroundEventWeight);

        
        back_JetTaggerLRJ_ConeCellsTowers_Subjet_LeadingTau_12_vs_LeadingJetTaggerEt->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), tau_2_LeadingJetTaggerConeCellsTowersSubjet/tau_1_LeadingJetTaggerConeCellsTowersSubjet, backgroundEventWeight);

        back_h_JetTaggerLRJ_ConeCellsTowers_Subjet_Tau_21_Product->Fill((tau_2_LeadingJetTaggerConeCellsTowersSubjet / tau_1_LeadingJetTaggerConeCellsTowersSubjet) * (tau_2_SubleadingJetTaggerConeCellsTowersSubjet / tau_1_SubleadingJetTaggerConeCellsTowersSubjet), backgroundEventWeight);
        
        if(tau_1_LeadingJetTaggerjFEXSubjet > 0) back_JetTaggerLRJ_jFEX_Subjet_LeadingTau_12_vs_LeadingJetTaggerEt->Fill(jetTaggerLeadingLRJEtValuesBack->at(0),tau_2_LeadingJetTaggerjFEXSubjet/tau_1_LeadingJetTaggerjFEXSubjet, backgroundEventWeight);
        if(tau_1_SubleadingJetTaggerjFEXSubjet > 0 && tau_1_LeadingJetTaggerjFEXSubjet > 0){
            back_h_JetTaggerLRJ_jFEX_Subjet_Tau_21_Product->Fill((tau_2_LeadingJetTaggerjFEXSubjet/tau_1_LeadingJetTaggerjFEXSubjet)*(tau_2_SubleadingJetTaggerjFEXSubjet/tau_1_SubleadingJetTaggerjFEXSubjet), backgroundEventWeight);
            back_h_JetTaggerLRJ_jFEX_Subjet_Tau_21_Product_vsLeadingLRJEt->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), (tau_2_LeadingJetTaggerjFEXSubjet/tau_1_LeadingJetTaggerjFEXSubjet)*(tau_2_SubleadingJetTaggerjFEXSubjet/tau_1_SubleadingJetTaggerjFEXSubjet), backgroundEventWeight);
            backJetTaggerLeadingLRJEtvsPsi_R_squaredvsTau21jFEXProduct->Fill(std::max(back_LRJ_Et[i][0], back_LRJ_Et[i][1]), jetTaggerLeadingLRJPsi_RValuesBack->at(0) * jetTaggerSubleadingLRJPsi_RValuesBack->at(0), (tau_2_LeadingJetTaggerjFEXSubjet/tau_1_LeadingJetTaggerjFEXSubjet) * (tau_2_SubleadingJetTaggerjFEXSubjet/tau_1_SubleadingJetTaggerjFEXSubjet), backgroundEventWeight);
            backJetTaggerLeadingLRJvsPsi_R_squaredvsTau21jFEXProduct->Fill(jetTaggerLeadingLRJPsi_RValuesBack->at(0) * jetTaggerSubleadingLRJPsi_RValuesBack->at(0), (tau_2_LeadingJetTaggerjFEXSubjet/tau_1_LeadingJetTaggerjFEXSubjet) * (tau_2_SubleadingJetTaggerjFEXSubjet/tau_1_SubleadingJetTaggerjFEXSubjet), backgroundEventWeight);
        }
        
        //std::cout << "tau21 lead * tau21 sublead: " << (tau_2_LeadingJetTaggerConeCellsTowersSubjet / tau_1_LeadingJetTaggerConeCellsTowersSubjet) * (tau_2_SubleadingJetTaggerConeCellsTowersSubjet / tau_1_SubleadingJetTaggerConeCellsTowersSubjet) << "\n";
        //std::cout << "for weight: " << backgroundEventWeight << "\n";
        if(tau_1_LeadingJetTaggerConeCellsTowersSubjet == 0 || tau_1_SubleadingJetTaggerConeCellsTowersSubjet == 0){ // NOTE this is necessary, the nan values are not nominally filled
            back_h_JetTaggerLRJ_ConeCellsTowers_Subjet_Tau_21_Product_vsLeadingLRJEt->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), 0.0, backgroundEventWeight);
        }
        else{
            back_h_JetTaggerLRJ_ConeCellsTowers_Subjet_Tau_21_Product_vsLeadingLRJEt->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), (tau_2_LeadingJetTaggerConeCellsTowersSubjet / tau_1_LeadingJetTaggerConeCellsTowersSubjet) * (tau_2_SubleadingJetTaggerConeCellsTowersSubjet / tau_1_SubleadingJetTaggerConeCellsTowersSubjet), backgroundEventWeight);
             backJetTaggerLeadingLRJEtvsPsi_R_squaredvsTau21ConeProduct->Fill(std::max(back_LRJ_Et[i][0], back_LRJ_Et[i][1]), jetTaggerLeadingLRJPsi_RValuesBack->at(0) * jetTaggerSubleadingLRJPsi_RValuesBack->at(0), (tau_2_LeadingJetTaggerConeCellsTowersSubjet/tau_1_LeadingJetTaggerConeCellsTowersSubjet) * (tau_2_SubleadingJetTaggerConeCellsTowersSubjet/tau_1_SubleadingJetTaggerConeCellsTowersSubjet), backgroundEventWeight);
            backJetTaggerLeadingLRJvsPsi_R_squaredvsTau21ConeProduct->Fill(jetTaggerLeadingLRJPsi_RValuesBack->at(0) * jetTaggerSubleadingLRJPsi_RValuesBack->at(0), (tau_2_LeadingJetTaggerConeCellsTowersSubjet/tau_1_LeadingJetTaggerConeCellsTowersSubjet) * (tau_2_SubleadingJetTaggerConeCellsTowersSubjet/tau_1_SubleadingJetTaggerConeCellsTowersSubjet), backgroundEventWeight);
        }
        
        

        
       
        // Fill 0 or 1
        if(nSubjetConeCellsTowersJetTaggerLeading <= 1 && nSubjetConeCellsTowersJetTaggerSubleading <= 1){
            backJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult->Fill(nSubjetConeCellsTowersJetTaggerLeading, nSubjetConeCellsTowersJetTaggerSubleading, backgroundEventWeight);
        }
        // Fill >= 2 with just 2 for histogram purposes
        else if(nSubjetConeCellsTowersJetTaggerLeading > 1 && nSubjetConeCellsTowersJetTaggerSubleading <= 1){
            backJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult->Fill(2, nSubjetConeCellsTowersJetTaggerSubleading, backgroundEventWeight);
        }
        else if(nSubjetConeCellsTowersJetTaggerLeading <= 1 && nSubjetConeCellsTowersJetTaggerSubleading > 1){
            backJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult->Fill(nSubjetConeCellsTowersJetTaggerLeading, 2, backgroundEventWeight);
        }
        else if(nSubjetConeCellsTowersJetTaggerLeading > 1 && nSubjetConeCellsTowersJetTaggerSubleading > 1){
            backJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult->Fill(2, 2, backgroundEventWeight);
        }

        if(nSubjetConeCellsTowersJetTaggerLeading <= 2 && nSubjetConeCellsTowersJetTaggerSubleading <= 2){
            backJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult_3->Fill(nSubjetConeCellsTowersJetTaggerLeading, nSubjetConeCellsTowersJetTaggerSubleading, backgroundEventWeight);
        }
        if(nSubjetConeCellsTowersJetTaggerLeading >= 3 && nSubjetConeCellsTowersJetTaggerSubleading <= 2){
            backJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult_3->Fill(3, nSubjetConeCellsTowersJetTaggerSubleading, backgroundEventWeight);
        }
        if(nSubjetConeCellsTowersJetTaggerLeading <= 2 && nSubjetConeCellsTowersJetTaggerSubleading >= 3){
            backJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult_3->Fill(nSubjetConeCellsTowersJetTaggerLeading, 3, backgroundEventWeight);
        }
        if(nSubjetConeCellsTowersJetTaggerLeading >= 3 && nSubjetConeCellsTowersJetTaggerSubleading >= 3){
            backJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult_3->Fill(3, 3, backgroundEventWeight);
        }

        // fill different subjet multiplicity categories
        if((nSubjetConeCellsTowersJetTaggerLeading < 1 && nSubjetConeCellsTowersJetTaggerSubleading < 1) || (nSubjetConeCellsTowersJetTaggerLeading == 0 && nSubjetConeCellsTowersJetTaggerSubleading == 1) || (nSubjetConeCellsTowersJetTaggerLeading == 1 && nSubjetConeCellsTowersJetTaggerSubleading == 0)){
            back_h_leading_LRJ_Et_Category0->Fill(jetTaggerSubleadingLRJEtValuesBack->at(0), backgroundEventWeight);
        }
        if(nSubjetConeCellsTowersJetTaggerLeading == 1 && nSubjetConeCellsTowersJetTaggerSubleading == 1){
            back_h_leading_LRJ_Et_Category1->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), backgroundEventWeight);
        }
        if(nSubjetConeCellsTowersJetTaggerLeading <= 1 && nSubjetConeCellsTowersJetTaggerSubleading == 2){
            back_h_leading_LRJ_Et_Category2->Fill(jetTaggerSubleadingLRJEtValuesBack->at(0), backgroundEventWeight);
        }
        if(nSubjetConeCellsTowersJetTaggerLeading == 2 && nSubjetConeCellsTowersJetTaggerSubleading <= 1){
            back_h_leading_LRJ_Et_Category3->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), backgroundEventWeight);
        }
        if(nSubjetConeCellsTowersJetTaggerLeading == 2 && nSubjetConeCellsTowersJetTaggerSubleading == 2){
            back_h_leading_LRJ_Et_Category4->Fill(jetTaggerSubleadingLRJEtValuesBack->at(0), backgroundEventWeight);
        }
        if(nSubjetConeCellsTowersJetTaggerLeading <= 2 && nSubjetConeCellsTowersJetTaggerSubleading >= 3){
            back_h_leading_LRJ_Et_Category5->Fill(jetTaggerSubleadingLRJEtValuesBack->at(0), backgroundEventWeight);
        }
        if(nSubjetConeCellsTowersJetTaggerLeading >= 3 && nSubjetConeCellsTowersJetTaggerSubleading <= 2){
            back_h_leading_LRJ_Et_Category6->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), backgroundEventWeight);
        }
        if(nSubjetConeCellsTowersJetTaggerLeading >= 3 && nSubjetConeCellsTowersJetTaggerSubleading >= 3){
            back_h_leading_LRJ_Et_Category7->Fill(jetTaggerSubleadingLRJEtValuesBack->at(0), backgroundEventWeight);
        }


        nSubjetsLeadingLRJBack[i] += nSubjetConeCellsTowersJetTaggerLeading;
        nSubjetsSubleadingLRJBack[i] += nSubjetConeCellsTowersJetTaggerSubleading;
        if(nSubjetConeCellsTowersJetTaggerLeading == 1 && nSubjetConeCellsTowersJetTaggerSubleading == 1){
            back_h_leading_LRJ_Et_NoConeSubjets_Lead_or_1ConeJetLead->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), backgroundEventWeight);
        }

        if((nSubjetConeCellsTowersJetTaggerLeading < 1 && nSubjetConeCellsTowersJetTaggerSubleading < 1) || (nSubjetConeCellsTowersJetTaggerLeading == 0 && nSubjetConeCellsTowersJetTaggerSubleading == 1) || (nSubjetConeCellsTowersJetTaggerLeading == 1 && nSubjetConeCellsTowersJetTaggerSubleading == 0)){
            back_h_subleading_LRJ_Et_1ConeSubjet_Lead_or_1ConeJetLead_Sublead->Fill(jetTaggerSubleadingLRJEtValuesBack->at(0), backgroundEventWeight);
        }

        if(nSubjetConeCellsTowersJetTaggerLeading >= 2 && nSubjetConeCellsTowersJetTaggerSubleading <= 1){
            double deltaRConeSubjets = sqrt(calcDeltaR2(leadingJetTaggerConeCellsTowersSubjets[0][1], leadingJetTaggerConeCellsTowersSubjets[0][2], leadingJetTaggerConeCellsTowersSubjets[1][1], leadingJetTaggerConeCellsTowersSubjets[1][2]));
            double jetTaggerLeadingMassApproxCone = deltaRConeSubjets * jetTaggerLeadingLRJEtValuesBack->at(0);
            double jetTaggerLeadingMassApproxCone_SubjetEt = deltaRConeSubjets * (leadingJetTaggerConeCellsTowersSubjets[0][0] + leadingJetTaggerConeCellsTowersSubjets[1][0]);
            backJetTaggerLeadingLRJEtvsTau21_WithGrEq2ConeSubjet_Lead->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), tau_2_LeadingJetTaggerConeCellsTowersSubjet/tau_1_LeadingJetTaggerConeCellsTowersSubjet, backgroundEventWeight);
            backJetTaggerLeadingMassApproxvsTau21_WithGrEq2ConeSubjet_Lead->Fill(jetTaggerLeadingMassApproxCone_SubjetEt, tau_2_LeadingJetTaggerConeCellsTowersSubjet/tau_1_LeadingJetTaggerConeCellsTowersSubjet, backgroundEventWeight);
            backJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Lead->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), jetTaggerLeadingMassApproxCone_SubjetEt, backgroundEventWeight);
            backJetTaggerLeadingLRJMassApproxvsSubjetEtRatio_WithGrEq2ConeSubjet_Lead->Fill(jetTaggerLeadingMassApproxCone_SubjetEt, leadingJetTaggerConeCellsTowersSubjets[0][0]/leadingJetTaggerConeCellsTowersSubjets[1][0], backgroundEventWeight);
            backJetTaggerLeadingLRJEtvsSubjetEtRatio_WithGrEq2ConeSubjet_Lead->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), leadingJetTaggerConeCellsTowersSubjets[0][0]/leadingJetTaggerConeCellsTowersSubjets[1][0], backgroundEventWeight);
            back_h_leading_LRJ_Et_WithGrEq2ConeSubjet_Lead->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), backgroundEventWeight);
            double Z_lead = leadingJetTaggerConeCellsTowersSubjets[1][0]/jetTaggerLeadingLRJEtValuesBack->at(0);
            double d12_lead = sqrt(Z_lead * Z_lead * jetTaggerLeadingLRJEtValuesBack->at(0) * jetTaggerLeadingLRJEtValuesBack->at(0) * deltaRConeSubjets * deltaRConeSubjets);

            backJetTaggerLeadingLRJEtvsd12_WithGrEq2ConeSubjet_Lead->Fill(jetTaggerSubleadingLRJEtValuesBack->at(0), d12_lead, backgroundEventWeight);
            backJetTaggerLeadingSubjetEtvsSubleadingSubjetEt_Lead->Fill(leadingJetTaggerConeCellsTowersSubjets[0][0], leadingJetTaggerConeCellsTowersSubjets[1][0], backgroundEventWeight);
        }

        if(nSubjetConeCellsTowersJetTaggerLeading <= 1 && nSubjetConeCellsTowersJetTaggerSubleading >= 2){
            double deltaRConeSubjets = sqrt(calcDeltaR2(subleadingJetTaggerConeCellsTowersSubjets[0][1], subleadingJetTaggerConeCellsTowersSubjets[0][2], subleadingJetTaggerConeCellsTowersSubjets[1][1], subleadingJetTaggerConeCellsTowersSubjets[1][2]));
            double jetTaggerSubleadingMassApproxCone = deltaRConeSubjets * jetTaggerSubleadingLRJEtValuesBack->at(0);
            double jetTaggerSubleadingMassApproxCone_SubjetEt = deltaRConeSubjets * (subleadingJetTaggerConeCellsTowersSubjets[0][0] + subleadingJetTaggerConeCellsTowersSubjets[1][0]);
            backJetTaggerSubleadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Sublead->Fill(jetTaggerSubleadingLRJEtValuesBack->at(0), jetTaggerSubleadingMassApproxCone_SubjetEt, backgroundEventWeight);
            backJetTaggerSubleadingMassApproxvsTau21_WithGrEq2ConeSubjet_Sublead->Fill(jetTaggerSubleadingMassApproxCone_SubjetEt, tau_2_SubleadingJetTaggerConeCellsTowersSubjet/tau_1_SubleadingJetTaggerConeCellsTowersSubjet, backgroundEventWeight);
            backJetTaggerSubleadingLRJEtvsTau21_WithGrEq2ConeSubjet_Sublead->Fill(jetTaggerSubleadingLRJEtValuesBack->at(0), tau_2_SubleadingJetTaggerConeCellsTowersSubjet/tau_1_SubleadingJetTaggerConeCellsTowersSubjet, backgroundEventWeight);
            backJetTaggerSubleadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet_Sublead->Fill(jetTaggerSubleadingLRJEtValuesBack->at(0), jetTaggerLeadingLRJPsi_RValuesBack->at(0) * jetTaggerSubleadingLRJPsi_RValuesBack->at(0), backgroundEventWeight);
            backJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet_Sublead->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), jetTaggerLeadingLRJPsi_RValuesBack->at(0) * jetTaggerSubleadingLRJPsi_RValuesBack->at(0), backgroundEventWeight);
            back_h_leading_LRJ_Et_WithGrEq2ConeSubjet_Sublead->Fill(jetTaggerSubleadingLRJEtValuesBack->at(0), backgroundEventWeight);
            double Z_subl = subleadingJetTaggerConeCellsTowersSubjets[1][0]/jetTaggerSubleadingLRJEtValuesBack->at(0);
            double d12_subl = sqrt(Z_subl * Z_subl * jetTaggerSubleadingLRJEtValuesBack->at(0) * jetTaggerSubleadingLRJEtValuesBack->at(0) * deltaRConeSubjets * deltaRConeSubjets);

            backJetTaggerSubleadingLRJEtvsd12_WithGrEq2ConeSubjet_Sublead->Fill(jetTaggerSubleadingLRJEtValuesBack->at(0), d12_subl, backgroundEventWeight);
            backJetTaggerLeadingSubjetEtvsSubleadingSubjetEt_Sublead->Fill(subleadingJetTaggerConeCellsTowersSubjets[0][0], subleadingJetTaggerConeCellsTowersSubjets[1][0], backgroundEventWeight);
        }

        if(nSubjetConeCellsTowersJetTaggerLeading >= 2 && nSubjetConeCellsTowersJetTaggerSubleading >= 2){
            double deltaRConeSubjets = sqrt(calcDeltaR2(leadingJetTaggerConeCellsTowersSubjets[0][1], leadingJetTaggerConeCellsTowersSubjets[0][2], leadingJetTaggerConeCellsTowersSubjets[1][1], leadingJetTaggerConeCellsTowersSubjets[1][2]));
            double jetTaggerLeadingMassApproxCone = deltaRConeSubjets * jetTaggerSubleadingLRJEtValuesBack->at(0);
            double deltaRConeSubjetsSubleading = sqrt(calcDeltaR2(subleadingJetTaggerConeCellsTowersSubjets[0][1], subleadingJetTaggerConeCellsTowersSubjets[0][2], subleadingJetTaggerConeCellsTowersSubjets[1][1], subleadingJetTaggerConeCellsTowersSubjets[1][2]));
            double jetTaggerSubleadingMassApproxCone = deltaRConeSubjetsSubleading * jetTaggerSubleadingLRJEtValuesBack->at(0);

            double jetTaggerLeadingMassApproxCone_SubjetEt = deltaRConeSubjets * (leadingJetTaggerConeCellsTowersSubjets[0][0] + leadingJetTaggerConeCellsTowersSubjets[1][0]);
            double jetTaggerSubleadingMassApproxCone_SubjetEt = deltaRConeSubjetsSubleading * (subleadingJetTaggerConeCellsTowersSubjets[0][0] + subleadingJetTaggerConeCellsTowersSubjets[1][0]);
            backJetTaggerSubleadingLRJEtvsDeltaRSubjets_WithGrEq2ConeSubjet_Lead_Sublead->Fill(jetTaggerSubleadingLRJEtValuesBack->at(0), deltaRConeSubjets, deltaRConeSubjetsSubleading, backgroundEventWeight);
            backJetTaggerLeadingLRJEtvsTau21_WithGrEq2ConeSubjet_Lead_Sublead->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), tau_2_SubleadingJetTaggerConeCellsTowersSubjet/tau_1_SubleadingJetTaggerConeCellsTowersSubjet * tau_2_LeadingJetTaggerConeCellsTowersSubjet/tau_1_LeadingJetTaggerConeCellsTowersSubjet, backgroundEventWeight);
            back_h_subleading_LRJ_Et_WithGrEq2ConeSubjet_Lead_Sublead->Fill(jetTaggerSubleadingLRJEtValuesBack->at(0), backgroundEventWeight);
            backJetTaggerLeadingMassApproxvsTau21Product_WithGrEq2ConeSubjet_Lead_Sublead->Fill(jetTaggerLeadingMassApproxCone_SubjetEt, tau_2_SubleadingJetTaggerConeCellsTowersSubjet/tau_1_SubleadingJetTaggerConeCellsTowersSubjet * tau_2_LeadingJetTaggerConeCellsTowersSubjet/tau_1_LeadingJetTaggerConeCellsTowersSubjet, backgroundEventWeight);
            backJetTaggerSubleadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Lead_Sublead->Fill(jetTaggerSubleadingLRJEtValuesBack->at(0), jetTaggerLeadingMassApproxCone_SubjetEt, jetTaggerSubleadingMassApproxCone_SubjetEt, backgroundEventWeight);

            double Z_subl = subleadingJetTaggerConeCellsTowersSubjets[1][0]/jetTaggerSubleadingLRJEtValuesBack->at(0);
            double d12_subl = sqrt(Z_subl * Z_subl * jetTaggerSubleadingLRJEtValuesBack->at(0) * jetTaggerSubleadingLRJEtValuesBack->at(0) * deltaRConeSubjetsSubleading * deltaRConeSubjetsSubleading);
            
            double Z_lead = leadingJetTaggerConeCellsTowersSubjets[1][0]/jetTaggerLeadingLRJEtValuesBack->at(0);
            double d12_lead = sqrt(Z_lead * Z_lead * jetTaggerLeadingLRJEtValuesBack->at(0) * jetTaggerLeadingLRJEtValuesBack->at(0) * deltaRConeSubjets * deltaRConeSubjets);
            

            backJetTaggerSubleadingLRJEtvsd12_WithGrEq2ConeSubjet_Lead_Sublead->Fill(jetTaggerSubleadingLRJEtValuesBack->at(0), d12_lead, d12_subl, backgroundEventWeight);
        }

        if(nSubjetConeCellsTowersJetTaggerLeading == 0){
            back_h_leading_LRJ_psi_R_squared_NoConeSubjets->Fill(jetTaggerLeadingLRJPsi_RValuesBack->at(0) * jetTaggerSubleadingLRJPsi_RValuesBack->at(0), backgroundEventWeight);
            back_h_leading_LRJ_Et_NoConeSubjets->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), backgroundEventWeight);
            backJetTaggerLeadingLRJEtvsPsi_R_squared_NoConeSubjets->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), jetTaggerLeadingLRJPsi_RValuesBack->at(0) * jetTaggerSubleadingLRJPsi_RValuesBack->at(0), backgroundEventWeight);
            backJetTaggerLeadingLRJEtvsPsi_R_NoConeSubjets->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), jetTaggerLeadingLRJPsi_RValuesBack->at(0), backgroundEventWeight);
        }   
        else if(nSubjetConeCellsTowersJetTaggerLeading == 1){
            back_h_leading_LRJ_psi_R_squared_With1ConeSubjet->Fill(jetTaggerLeadingLRJPsi_RValuesBack->at(0) * jetTaggerSubleadingLRJPsi_RValuesBack->at(0), backgroundEventWeight);
            back_h_leading_LRJ_Et_With1ConeSubjet->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), backgroundEventWeight);
            backJetTaggerLeadingLRJEtvsPsi_R_squared_With1ConeSubjet->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), jetTaggerLeadingLRJPsi_RValuesBack->at(0) * jetTaggerSubleadingLRJPsi_RValuesBack->at(0), backgroundEventWeight);
            backJetTaggerLeadingLRJEtvsPsi_R_With1ConeSubjet->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), jetTaggerLeadingLRJPsi_RValuesBack->at(0), backgroundEventWeight);
            double Z_lead = leadingJetTaggerConeCellsTowersSubjets[0][0]/jetTaggerLeadingLRJEtValuesBack->at(0);

            backJetTaggerLeadingLRJEtvsZ_With1ConeSubjet->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), Z_lead, backgroundEventWeight); // NOTE this is not really "z"
        }
        else if(nSubjetConeCellsTowersJetTaggerLeading > 1){
            // Compute psi_R of the subleading subjet - want to potentially remove it from being a subjet if above some value?? (depending on these results)
            // Unfortunately this will be quite computationally expensive...
            double psi_R_subjet = 0;
            const double coneJetRadius = 0.4;
            //std::vector<unsigned int > constituentTowerIndices;
            for(unsigned int iTower = 0; iTower < nInputObjectsAlgorithmConfiguration; iTower++){ // First compute which towers are within the subjet - maybe this would be available information from cone jet algorithm??
                // FIXME configure for multiple types of input objects, but for now perfectly fine to just use towers 
                double deltaRSubleadingSubjetTower = sqrt(calcDeltaR2(leadingJetTaggerConeCellsTowersSubjets[1][1], leadingJetTaggerConeCellsTowersSubjets[1][2], gepCellsTowersEtaValuesBack->at(iTower), gepCellsTowersPhiValuesBack->at(iTower)));
                if(deltaRSubleadingSubjetTower < coneJetRadius){ // FIXME make this a configurable deltaR value for cone jets in case use a non-default value
                    psi_R_subjet += (1/leadingJetTaggerConeCellsTowersSubjets[1][0] * coneJetRadius) * deltaRSubleadingSubjetTower * gepCellsTowersEtValuesBack->at(0);
                    //constituentTowerIndices.push_back(iTower); // For now just directly compute psi_R,
                    // may need to adjust since granularity of cone jets could cause discrepancy between constituent towers?
                } 
            }

            back_h_leading_LRJ_psi_R_SubleadingSubjet_WithGrEq2ConeSubjet->Fill(psi_R_subjet, backgroundEventWeight);
            backJetTaggerLeadingLRJEtvspsi_R_SubleadingSubjet_WithGrEq2ConeSubjet->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), psi_R_subjet, backgroundEventWeight);
            back_h_leading_LRJ_psi_R_squared_WithGrEq2ConeSubjet->Fill(jetTaggerLeadingLRJPsi_RValuesBack->at(0) * jetTaggerSubleadingLRJPsi_RValuesBack->at(0), backgroundEventWeight);
            back_h_leading_LRJ_Et_WithGrEq2ConeSubjet->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), backgroundEventWeight);
            backJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), jetTaggerLeadingLRJPsi_RValuesBack->at(0) * jetTaggerSubleadingLRJPsi_RValuesBack->at(0), backgroundEventWeight);
            backJetTaggerLeadingLRJEtvsPsi_R_WithGrEq2ConeSubjet->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), jetTaggerLeadingLRJPsi_RValuesBack->at(0), backgroundEventWeight);
            // compute delta R of leading, subleading subjets:
            double deltaRSubjets = sqrt(calcDeltaR2(leadingJetTaggerConeCellsTowersSubjets[0][1], leadingJetTaggerConeCellsTowersSubjets[0][2], leadingJetTaggerConeCellsTowersSubjets[1][1], leadingJetTaggerConeCellsTowersSubjets[1][2]));
            double jetTaggerLeadingMassApprox = deltaRSubjets * jetTaggerLeadingLRJEtValuesBack->at(0);
            double jetTaggerLeadingMassApproxCone_SubjetEt = deltaRSubjets * (leadingJetTaggerConeCellsTowersSubjets[0][0] + leadingJetTaggerConeCellsTowersSubjets[1][0]);
            backJetTaggerLeadingLRJDeltaRSubjetsvsSubjetEtRatio_WithGrEq2ConeSubjet->Fill(deltaRSubjets, leadingJetTaggerConeCellsTowersSubjets[0][0]/leadingJetTaggerConeCellsTowersSubjets[1][0], backgroundEventWeight);
            backJetTaggerLeadingLRJEtvsSubjetEtRatioTimesDeltaRSubjets_WithGrEq2ConeSubjet->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), deltaRSubjets * leadingJetTaggerConeCellsTowersSubjets[0][0]/leadingJetTaggerConeCellsTowersSubjets[1][0], backgroundEventWeight);
            back_h_leading_LRJ_DeltaRSubjetsTimesSubjetEtRatio_WithGrEq2ConeSubjet->Fill(deltaRSubjets * leadingJetTaggerConeCellsTowersSubjets[0][0]/leadingJetTaggerConeCellsTowersSubjets[1][0], backgroundEventWeight);
            back_h_leading_LRJ_MassApprox_WithGrEq2ConeSubjet->Fill(jetTaggerLeadingMassApproxCone_SubjetEt, backgroundEventWeight);
            back_h_leading_LRJ_DeltaRSubjets_WithGrEq2ConeSubjet->Fill(deltaRSubjets, backgroundEventWeight);
            backJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), jetTaggerLeadingMassApprox, backgroundEventWeight);
            backJetTaggerLeadingLRJEtvsMassApprox_SubjetEt_WithGrEq2ConeSubjet->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), jetTaggerLeadingMassApproxCone_SubjetEt, backgroundEventWeight);
            backJetTaggerLeadingLRJEtvsDeltaRSubjets_WithGrEq2ConeSubjet->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), deltaRSubjets, backgroundEventWeight);

            double Z_lead = leadingJetTaggerConeCellsTowersSubjets[1][0]/jetTaggerLeadingLRJEtValuesBack->at(0);
            //double d12_lead = sqrt(Z_lead * Z_lead * jetTaggerLeadingLRJEtValuesBack->at(0) * jetTaggerLeadingLRJEtValuesBack->at(0) * deltaRSubjets * deltaRSubjets);
            double d12_lead = sqrt(Z_lead * Z_lead * jetTaggerLeadingLRJEtValuesBack->at(0) * jetTaggerLeadingLRJEtValuesBack->at(0) * deltaRSubjets * deltaRSubjets);

            backJetTaggerLeadingLRJEtvsZ_WithGrEq2ConeSubjet->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), Z_lead, backgroundEventWeight);
            backJetTaggerLeadingLRJEtvsd12_WithGrEq2ConeSubjet->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), d12_lead, backgroundEventWeight);
        }

        if(nSubjetConeCellsTowersJetTaggerLeading >= 1){
            double Z = leadingJetTaggerConeCellsTowersSubjets[1][0]/jetTaggerLeadingLRJEtValuesBack->at(0);
            back_h_leading_LRJ_Z->Fill(Z, backgroundEventWeight);
            backJetTaggerLeadingLRJEtvsZ->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), Z, backgroundEventWeight);
            backJetTaggerLeadingLRJEtvs1MinusZ->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), 1 - Z, backgroundEventWeight);
            if(nSubjetConeCellsTowersJetTaggerLeading >= 2){
                double Z_lead = leadingJetTaggerConeCellsTowersSubjets[0][0]/jetTaggerLeadingLRJEtValuesBack->at(0);
                backJetTaggerLeadingLRJEtvsEtOutsideSubjets->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), 1 - (Z + Z_lead), backgroundEventWeight);
            }
        }
        if(nSubjetConeCellsTowersJetTaggerSubleading >= 1){
            double Z = subleadingJetTaggerConeCellsTowersSubjets[0][0]/jetTaggerSubleadingLRJEtValuesBack->at(0);
            back_h_subleading_LRJ_Z->Fill(Z, backgroundEventWeight);
            backJetTaggerSubleadingLRJEtvsZ->Fill(jetTaggerSubleadingLRJEtValuesBack->at(0), Z, backgroundEventWeight);
        }

        if(nSubjetjFEXJetTaggerLeading == 0){
            back_h_leading_LRJ_psi_R_squared_NojFEXSubjets->Fill(jetTaggerLeadingLRJPsi_RValuesBack->at(0) * jetTaggerSubleadingLRJPsi_RValuesBack->at(0), backgroundEventWeight);
            back_h_leading_LRJ_Et_NojFEXSubjets->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), backgroundEventWeight);
            backJetTaggerLeadingLRJEtvsPsi_R_squared_NojFEXSubjets->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), jetTaggerLeadingLRJPsi_RValuesBack->at(0) * jetTaggerSubleadingLRJPsi_RValuesBack->at(0), backgroundEventWeight);
            backJetTaggerLeadingLRJEtvsPsi_R_NojFEXSubjets->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), jetTaggerLeadingLRJPsi_RValuesBack->at(0), backgroundEventWeight);
        }
        else if(nSubjetjFEXJetTaggerLeading == 1){
            back_h_leading_LRJ_psi_R_squared_With1jFEXSubjet->Fill(jetTaggerLeadingLRJPsi_RValuesBack->at(0) * jetTaggerSubleadingLRJPsi_RValuesBack->at(0), backgroundEventWeight);
            back_h_leading_LRJ_Et_With1jFEXSubjet->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), backgroundEventWeight);
            backJetTaggerLeadingLRJEtvsPsi_R_squared_With1jFEXSubjet->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), jetTaggerLeadingLRJPsi_RValuesBack->at(0) * jetTaggerSubleadingLRJPsi_RValuesBack->at(0), backgroundEventWeight);
            backJetTaggerLeadingLRJEtvsPsi_R_With1jFEXSubjet->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), jetTaggerLeadingLRJPsi_RValuesBack->at(0), backgroundEventWeight);
        }
        else if(nSubjetjFEXJetTaggerLeading > 1){
            back_h_leading_LRJ_psi_R_squared_WithGrEq2jFEXSubjet->Fill(jetTaggerLeadingLRJPsi_RValuesBack->at(0) * jetTaggerSubleadingLRJPsi_RValuesBack->at(0), backgroundEventWeight);
            back_h_leading_LRJ_Et_WithGrEq2jFEXSubjet->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), backgroundEventWeight);
            backJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2jFEXSubjet->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), jetTaggerLeadingLRJPsi_RValuesBack->at(0) * jetTaggerSubleadingLRJPsi_RValuesBack->at(0), backgroundEventWeight);
            backJetTaggerLeadingLRJEtvsPsi_R_WithGrEq2jFEXSubjet->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), jetTaggerLeadingLRJPsi_RValuesBack->at(0), backgroundEventWeight);
            // compute delta R of leading, subleading subjets:
            double deltaRSubjets = sqrt(calcDeltaR2(leadingJetTaggerjFEXSubjets[0][1], leadingJetTaggerjFEXSubjets[0][2], leadingJetTaggerjFEXSubjets[1][1], leadingJetTaggerjFEXSubjets[1][2]));
            double jetTaggerLeadingMassApprox = deltaRSubjets * jetTaggerLeadingLRJEtValuesBack->at(0);
            back_h_leading_LRJ_MassApprox_WithGrEq2jFEXSubjet->Fill(jetTaggerLeadingMassApprox, backgroundEventWeight);
            backJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2jFEXSubjet->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), jetTaggerLeadingMassApprox, backgroundEventWeight);
        }

        //std::cout << "test 0" << "\n";
        // Fill jetTagger, gFEX, jFEX LRJs E_T by JZ Slice
        back_h_leading_LRJ_Et_arr[sampleJZSliceValuesBack]->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), backgroundEventWeight);
        back_h_subleading_LRJ_Et_arr[sampleJZSliceValuesBack]->Fill(jetTaggerSubleadingLRJEtValuesBack->at(0), backgroundEventWeight);
        back_h_gFEX_leading_LRJ_Et_arr[sampleJZSliceValuesBack]->Fill(gFexLRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        back_h_gFEX_subleading_LRJ_Et_arr[sampleJZSliceValuesBack]->Fill(gFexLRJSubleadingEtValuesBack->at(0), backgroundEventWeight);
        if(jFexLRJLeadingEtValuesBack->size() > 0) back_h_jFEX_leading_LRJ_Et_arr[sampleJZSliceValuesBack]->Fill(jFexLRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        if(jFexLRJSubleadingEtValuesBack->size() > 0) back_h_jFEX_subleading_LRJ_Et_arr[sampleJZSliceValuesBack]->Fill(jFexLRJSubleadingEtValuesBack->at(0), backgroundEventWeight);

        // Fill jetTagger, gFEX, jFEX SRJs E_T by JZ Slice
        back_h_gFEX_leading_SRJ_Et_arr[sampleJZSliceValuesBack]->Fill(gFexSRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        back_h_gFEX_subleading_SRJ_Et_arr[sampleJZSliceValuesBack]->Fill(gFexSRJSubleadingEtValuesBack->at(0), backgroundEventWeight);
        if(jFexSRJLeadingEtValuesBack->size() > 0) back_h_jFEX_leading_SRJ_Et_arr[sampleJZSliceValuesBack]->Fill(jFexSRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        if(jFexSRJSubleadingEtValuesBack->size() > 0) back_h_jFEX_subleading_SRJ_Et_arr[sampleJZSliceValuesBack]->Fill(jFexSRJSubleadingEtValuesBack->at(0), backgroundEventWeight);

        // Fill offline LRJ, truth SRJ E_T by JZ Slice
        if(recoAntiKt10LRJLeadingEtValuesBack->size() > 0) back_h_leading_offlineLRJ_Et_arr[sampleJZSliceValuesBack]->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        if(recoAntiKt10LRJSubleadingEtValuesBack->size() > 0) back_h_subleading_offlineLRJ_Et_arr[sampleJZSliceValuesBack]->Fill(recoAntiKt10LRJSubleadingEtValuesBack->at(0), backgroundEventWeight);
        if(truthAntiKt4WZSRJLeadingEtValuesBack->size() > 0) back_h_leading_truthSRJs_Et_arr[sampleJZSliceValuesBack]->Fill(truthAntiKt4WZSRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        if(truthAntiKt4WZSRJSubleadingEtValuesBack->size() > 0) back_h_subleading_truthSRJs_Et_arr[sampleJZSliceValuesBack]->Fill(truthAntiKt4WZSRJSubleadingEtValuesBack->at(0), backgroundEventWeight);

        // Fill cone jet JZ Slice pT distributions
        if (gepLeadingWTAConeCellsTowersJetspTValuesBack->size() > 0) back_h_leading_WTA_conejets_cellstowers_pT_arr[sampleJZSliceValuesBack]->Fill(gepLeadingWTAConeCellsTowersJetspTValuesBack->at(0), backgroundEventWeight);
        if (gepSubleadingWTAConeCellsTowersJetspTValuesBack->size() > 0) back_h_subleading_WTA_conejets_cellstowers_pT_arr[sampleJZSliceValuesBack]->Fill(gepSubleadingWTAConeCellsTowersJetspTValuesBack->at(0), backgroundEventWeight);
        if (gepLeadingWTAConeGEPBasicClustersJetspTValuesBack->size() > 0) back_h_leading_WTA_conejets_basicclusters_pT_arr[sampleJZSliceValuesBack]->Fill(gepLeadingWTAConeGEPBasicClustersJetspTValuesBack->at(0), backgroundEventWeight);
        if (gepSubleadingWTAConeGEPBasicClustersJetspTValuesBack->size() > 0) back_h_subleading_WTA_conejets_basicclusters_pT_arr[sampleJZSliceValuesBack]->Fill(gepSubleadingWTAConeGEPBasicClustersJetspTValuesBack->at(0), backgroundEventWeight);

        // Fill cone jet kinematic distributions
        if (gepLeadingWTAConeCellsTowersJetspTValuesBack->size() > 0) back_h_leading_WTA_conecellstowers_pT->Fill(gepLeadingWTAConeCellsTowersJetspTValuesBack->at(0), backgroundEventWeight);
        if (gepSubleadingWTAConeCellsTowersJetspTValuesBack->size() > 0) back_h_subleading_WTA_conecellstowers_pT->Fill(gepSubleadingWTAConeCellsTowersJetspTValuesBack->at(0), backgroundEventWeight);
        if (gepLeadingWTAConeGEPBasicClustersJetspTValuesBack->size() > 0) back_h_leading_WTA_conebasicclusters_pT->Fill(gepLeadingWTAConeGEPBasicClustersJetspTValuesBack->at(0), backgroundEventWeight);
        if (gepSubleadingWTAConeGEPBasicClustersJetspTValuesBack->size() > 0) back_h_subleading_WTA_conebasicclusters_pT->Fill(gepSubleadingWTAConeGEPBasicClustersJetspTValuesBack->at(0), backgroundEventWeight);

        back_h_WTA_conecellstowers_multiplicity->Fill(gepWTAConeCellsTowersJetspTValuesBack->size());
        back_h_WTA_conebasicclusters_multiplicity->Fill(gepWTAConeGEPBasicClustersJetspTValuesBack->size());

        //std::cout << "test 1" << "\n";
        unsigned int highestEtIndexLRJBack = -1;
        //std::cout << "test 1.1" << "\n";
        if(back_LRJ_Et[i][0] >= back_LRJ_Et[i][1]) highestEtIndexLRJBack = 0;
        else highestEtIndexLRJBack = 1;

        double psi_R_BackJet1 = 0.0;
        double psi_R_BackJet2 = 0.0;

        // Psi_R computation with variable number of considered input objects
        double psi_R_BackJet1_VariableIOs_2 = 0.0;
        double psi_R_BackJet2_VariableIOs_2 = 0.0;
        double psi_R_Et_sum_variableIOs_BackJet1_2 = 0.0;
        double psi_R_Et_sum_variableIOs_BackJet2_2 = 0.0;
        double psi_R_BackJet1_VariableIOs_3 = 0.0;
        double psi_R_BackJet2_VariableIOs_3 = 0.0;
        double psi_R_Et_sum_variableIOs_BackJet1_3 = 0.0;
        double psi_R_Et_sum_variableIOs_BackJet2_3 = 0.0;
        double psi_R_BackJet1_VariableIOs_4 = 0.0;
        double psi_R_BackJet2_VariableIOs_4 = 0.0;
        double psi_R_Et_sum_variableIOs_BackJet1_4 = 0.0;
        double psi_R_Et_sum_variableIOs_BackJet2_4 = 0.0;
        double psi_R_BackJet1_VariableIOs_5 = 0.0;
        double psi_R_BackJet2_VariableIOs_5 = 0.0;

        // Psi_R^2 computation with variable number of considered input objects
        double psi_R2_BackJet1_VariableIOs_2 = 0.0;
        double psi_R2_BackJet2_VariableIOs_2 = 0.0;
        double psi_R2_Et_sum_variableIOs_BackJet1_2 = 0.0;
        double psi_R2_Et_sum_variableIOs_BackJet2_2 = 0.0;
        double psi_R2_BackJet1_VariableIOs_3 = 0.0;
        double psi_R2_BackJet2_VariableIOs_3 = 0.0;
        double psi_R2_Et_sum_variableIOs_BackJet1_3 = 0.0;
        double psi_R2_Et_sum_variableIOs_BackJet2_3 = 0.0;
        double psi_R2_BackJet1_VariableIOs_4 = 0.0;
        double psi_R2_BackJet2_VariableIOs_4 = 0.0;
        double psi_R2_Et_sum_variableIOs_BackJet1_4 = 0.0;
        double psi_R2_Et_sum_variableIOs_BackJet2_4 = 0.0;
        double psi_R2_BackJet1_VariableIOs_5 = 0.0;
        double psi_R2_BackJet2_VariableIOs_5 = 0.0;

        double psi_R_Et_sum_variableIOs_BackJet1_5 = 0.0;
        double psi_R_Et_sum_variableIOs_BackJet2_5 = 0.0;
        double psi_R2_BackJet1 = 0.0;
        double psi_R2_BackJet2 = 0.0;
        unsigned indexCounterLeadingJet = 0;
        unsigned indexCounterSubleadingJet = 0;
        for(auto& idxBackJet1 : *jetTaggerLeadingLRJMergedIndicesValuesBack){
            if(inputObjectType == "gepBasicClusters"){
                if(indexCounterLeadingJet < variableIOCutOff_2){
                    psi_R_BackJet1_VariableIOs_2 += gepBasicClustersEtValuesBack->at(idxBackJet1) * sqrt(calcDeltaR2(jetTaggerLeadingLRJEtaValuesBack->at(0), jetTaggerLeadingLRJPhiValuesBack->at(0), gepBasicClustersEtaValuesBack->at(idxBackJet1), gepBasicClustersPhiValuesBack->at(idxBackJet1)));
                    psi_R2_BackJet1_VariableIOs_2 += gepBasicClustersEtValuesBack->at(idxBackJet1) * calcDeltaR2(jetTaggerLeadingLRJEtaValuesBack->at(0), jetTaggerLeadingLRJPhiValuesBack->at(0), gepBasicClustersEtaValuesBack->at(idxBackJet1), gepBasicClustersPhiValuesBack->at(idxBackJet1));
                    psi_R_Et_sum_variableIOs_BackJet1_2 += gepBasicClustersEtValuesBack->at(idxBackJet1);
                } 
                if(indexCounterLeadingJet < variableIOCutOff_3){
                    psi_R_BackJet1_VariableIOs_3 += gepBasicClustersEtValuesBack->at(idxBackJet1) * sqrt(calcDeltaR2(jetTaggerLeadingLRJEtaValuesBack->at(0), jetTaggerLeadingLRJPhiValuesBack->at(0), gepBasicClustersEtaValuesBack->at(idxBackJet1), gepBasicClustersPhiValuesBack->at(idxBackJet1)));
                    psi_R2_BackJet1_VariableIOs_3 += gepBasicClustersEtValuesBack->at(idxBackJet1) * calcDeltaR2(jetTaggerLeadingLRJEtaValuesBack->at(0), jetTaggerLeadingLRJPhiValuesBack->at(0), gepBasicClustersEtaValuesBack->at(idxBackJet1), gepBasicClustersPhiValuesBack->at(idxBackJet1));
                    psi_R_Et_sum_variableIOs_BackJet1_3 += gepBasicClustersEtValuesBack->at(idxBackJet1);
                } 
                if(indexCounterLeadingJet < variableIOCutOff_4){
                    psi_R_BackJet1_VariableIOs_4 += gepBasicClustersEtValuesBack->at(idxBackJet1) * sqrt(calcDeltaR2(jetTaggerLeadingLRJEtaValuesBack->at(0), jetTaggerLeadingLRJPhiValuesBack->at(0), gepBasicClustersEtaValuesBack->at(idxBackJet1), gepBasicClustersPhiValuesBack->at(idxBackJet1)));
                    psi_R2_BackJet1_VariableIOs_4 += gepBasicClustersEtValuesBack->at(idxBackJet1) * calcDeltaR2(jetTaggerLeadingLRJEtaValuesBack->at(0), jetTaggerLeadingLRJPhiValuesBack->at(0), gepBasicClustersEtaValuesBack->at(idxBackJet1), gepBasicClustersPhiValuesBack->at(idxBackJet1));
                    psi_R_Et_sum_variableIOs_BackJet1_4 += gepBasicClustersEtValuesBack->at(idxBackJet1);
                } 
                if(indexCounterLeadingJet < variableIOCutOff_5){
                    psi_R_BackJet1_VariableIOs_5 += gepBasicClustersEtValuesBack->at(idxBackJet1) * sqrt(calcDeltaR2(jetTaggerLeadingLRJEtaValuesBack->at(0), jetTaggerLeadingLRJPhiValuesBack->at(0), gepBasicClustersEtaValuesBack->at(idxBackJet1), gepBasicClustersPhiValuesBack->at(idxBackJet1)));
                    psi_R2_BackJet1_VariableIOs_5 += gepBasicClustersEtValuesBack->at(idxBackJet1) * calcDeltaR2(jetTaggerLeadingLRJEtaValuesBack->at(0), jetTaggerLeadingLRJPhiValuesBack->at(0), gepBasicClustersEtaValuesBack->at(idxBackJet1), gepBasicClustersPhiValuesBack->at(idxBackJet1));
                    psi_R_Et_sum_variableIOs_BackJet1_5 += gepBasicClustersEtValuesBack->at(idxBackJet1);
                } 
                psi_R2_BackJet1 += (1.0/jetTaggerLeadingLRJEtValuesBack->at(0) * jetRadius * jetRadius) * gepBasicClustersEtValuesBack->at(idxBackJet1) * calcDeltaR2(jetTaggerLeadingLRJEtaValuesBack->at(0), jetTaggerLeadingLRJPhiValuesBack->at(0), gepBasicClustersEtaValuesBack->at(idxBackJet1), gepBasicClustersPhiValuesBack->at(idxBackJet1));
            }
            else if(inputObjectType == "Towers"){
                if(indexCounterLeadingJet < variableIOCutOff_2){
                    psi_R_BackJet1_VariableIOs_2 += gepCellsTowersEtValuesBack->at(idxBackJet1) * sqrt(calcDeltaR2(jetTaggerLeadingLRJEtaValuesBack->at(0), jetTaggerLeadingLRJPhiValuesBack->at(0), gepCellsTowersEtaValuesBack->at(idxBackJet1), gepCellsTowersPhiValuesBack->at(idxBackJet1)));
                    psi_R2_BackJet1_VariableIOs_2 += gepCellsTowersEtValuesBack->at(idxBackJet1) * calcDeltaR2(jetTaggerLeadingLRJEtaValuesBack->at(0), jetTaggerLeadingLRJPhiValuesBack->at(0), gepCellsTowersEtaValuesBack->at(idxBackJet1), gepCellsTowersPhiValuesBack->at(idxBackJet1));
                    psi_R_Et_sum_variableIOs_BackJet1_2 += gepCellsTowersEtValuesBack->at(idxBackJet1);
                } 
                if(indexCounterLeadingJet < variableIOCutOff_3){
                    psi_R_BackJet1_VariableIOs_3 += gepCellsTowersEtValuesBack->at(idxBackJet1) * sqrt(calcDeltaR2(jetTaggerLeadingLRJEtaValuesBack->at(0), jetTaggerLeadingLRJPhiValuesBack->at(0), gepCellsTowersEtaValuesBack->at(idxBackJet1), gepCellsTowersPhiValuesBack->at(idxBackJet1)));
                    psi_R2_BackJet1_VariableIOs_3 += gepCellsTowersEtValuesBack->at(idxBackJet1) * calcDeltaR2(jetTaggerLeadingLRJEtaValuesBack->at(0), jetTaggerLeadingLRJPhiValuesBack->at(0), gepCellsTowersEtaValuesBack->at(idxBackJet1), gepCellsTowersPhiValuesBack->at(idxBackJet1));
                    psi_R_Et_sum_variableIOs_BackJet1_3 += gepCellsTowersEtValuesBack->at(idxBackJet1);
                } 
                if(indexCounterLeadingJet < variableIOCutOff_4){
                    psi_R_BackJet1_VariableIOs_4 += gepCellsTowersEtValuesBack->at(idxBackJet1) * sqrt(calcDeltaR2(jetTaggerLeadingLRJEtaValuesBack->at(0), jetTaggerLeadingLRJPhiValuesBack->at(0), gepCellsTowersEtaValuesBack->at(idxBackJet1), gepCellsTowersPhiValuesBack->at(idxBackJet1)));
                    psi_R2_BackJet1_VariableIOs_4 += gepCellsTowersEtValuesBack->at(idxBackJet1) * calcDeltaR2(jetTaggerLeadingLRJEtaValuesBack->at(0), jetTaggerLeadingLRJPhiValuesBack->at(0), gepCellsTowersEtaValuesBack->at(idxBackJet1), gepCellsTowersPhiValuesBack->at(idxBackJet1));
                    psi_R_Et_sum_variableIOs_BackJet1_4 += gepCellsTowersEtValuesBack->at(idxBackJet1);
                } 
                if(indexCounterLeadingJet < variableIOCutOff_5){
                    psi_R_BackJet1_VariableIOs_5 += gepCellsTowersEtValuesBack->at(idxBackJet1) * sqrt(calcDeltaR2(jetTaggerLeadingLRJEtaValuesBack->at(0), jetTaggerLeadingLRJPhiValuesBack->at(0), gepCellsTowersEtaValuesBack->at(idxBackJet1), gepCellsTowersPhiValuesBack->at(idxBackJet1)));
                    psi_R2_BackJet1_VariableIOs_5 += gepCellsTowersEtValuesBack->at(idxBackJet1) * calcDeltaR2(jetTaggerLeadingLRJEtaValuesBack->at(0), jetTaggerLeadingLRJPhiValuesBack->at(0), gepCellsTowersEtaValuesBack->at(idxBackJet1), gepCellsTowersPhiValuesBack->at(idxBackJet1));
                    psi_R_Et_sum_variableIOs_BackJet1_5 += gepCellsTowersEtValuesBack->at(idxBackJet1);
                } 
                //std::cout << "jet tagging leading lrj eta: " << jetTaggerLeadingLRJEtaValuesBack->at(0) << " , phi: " << jetTaggerLeadingLRJPhiValuesBack->at(0) << "\n";
                //std::cout << "'merged' tower eta:" << gepCellsTowersEtaValuesBack->at(idxBackJet1) << " , phi: " << gepCellsTowersPhiValuesBack->at(idxBackJet1) << "\n";
                //std::cout << "idxBackJet1: " << idxBackJet1 << "\n";
                //std::cout << "psi_R2 1 incrementation: " << (1.0/jetTaggerLeadingLRJEtValuesBack->at(0) * jetRadius * jetRadius) * gepCellsTowersEtValuesBack->at(idxBackJet1) * calcDeltaR2(jetTaggerLeadingLRJEtaValuesBack->at(0), jetTaggerLeadingLRJPhiValuesBack->at(0), gepCellsTowersEtaValuesBack->at(idxBackJet1), gepCellsTowersPhiValuesBack->at(idxBackJet1)) << "\n";
                //std::cout << "deltaR^2 contribution: " << calcDeltaR2(jetTaggerLeadingLRJEtaValuesBack->at(0), jetTaggerLeadingLRJPhiValuesBack->at(0), gepCellsTowersEtaValuesBack->at(idxBackJet1), gepCellsTowersPhiValuesBack->at(idxBackJet1)) << "\n";
                //std::cout << "normalization factor: " << (1.0/jetTaggerLeadingLRJEtValuesBack->at(0) * jetRadius * jetRadius) << "\n";
                //std::cout << "tower energy: " << gepCellsTowersEtValuesBack->at(idxBackJet1) << "\n";
                psi_R2_BackJet1 += (1.0/jetTaggerLeadingLRJEtValuesBack->at(0) * jetRadius * jetRadius) * gepCellsTowersEtValuesBack->at(idxBackJet1) * calcDeltaR2(jetTaggerLeadingLRJEtaValuesBack->at(0), jetTaggerLeadingLRJPhiValuesBack->at(0), gepCellsTowersEtaValuesBack->at(idxBackJet1), gepCellsTowersPhiValuesBack->at(idxBackJet1));
                //std::cout << "psi_R2_BackJet1: " << psi_R2_BackJet1 << "\n";
            }
            else if(inputObjectType == "ConeJets"){
                if(indexCounterSubleadingJet < variableIOCutOff_2){
                    psi_R_BackJet2_VariableIOs_2 += gepWTAConeCellsTowersJetspTValuesBack->at(idxBackJet1) * sqrt(calcDeltaR2(jetTaggerSubleadingLRJEtaValuesBack->at(0), jetTaggerSubleadingLRJPhiValuesBack->at(0), gepWTAConeCellsTowersJetsEtaValuesBack->at(idxBackJet1), gepWTAConeCellsTowersJetsPhiValuesBack->at(idxBackJet1)));
                    psi_R2_BackJet2_VariableIOs_2 += gepWTAConeCellsTowersJetspTValuesBack->at(idxBackJet1) * calcDeltaR2(jetTaggerSubleadingLRJEtaValuesBack->at(0), jetTaggerSubleadingLRJPhiValuesBack->at(0), gepWTAConeCellsTowersJetsEtaValuesBack->at(idxBackJet1), gepWTAConeCellsTowersJetsPhiValuesBack->at(idxBackJet1));
                    psi_R_Et_sum_variableIOs_BackJet2_2 += gepWTAConeCellsTowersJetspTValuesBack->at(idxBackJet1);
                } 
                if(indexCounterSubleadingJet < variableIOCutOff_3){
                    psi_R_BackJet2_VariableIOs_3 += gepWTAConeCellsTowersJetspTValuesBack->at(idxBackJet1) * sqrt(calcDeltaR2(jetTaggerSubleadingLRJEtaValuesBack->at(0), jetTaggerSubleadingLRJPhiValuesBack->at(0), gepWTAConeCellsTowersJetsEtaValuesBack->at(idxBackJet1), gepWTAConeCellsTowersJetsPhiValuesBack->at(idxBackJet1)));
                    psi_R2_BackJet2_VariableIOs_3 += gepWTAConeCellsTowersJetspTValuesBack->at(idxBackJet1) * calcDeltaR2(jetTaggerSubleadingLRJEtaValuesBack->at(0), jetTaggerSubleadingLRJPhiValuesBack->at(0), gepWTAConeCellsTowersJetsEtaValuesBack->at(idxBackJet1), gepWTAConeCellsTowersJetsPhiValuesBack->at(idxBackJet1));
                    psi_R_Et_sum_variableIOs_BackJet2_3 += gepWTAConeCellsTowersJetspTValuesBack->at(idxBackJet1);
                } 
                if(indexCounterSubleadingJet < variableIOCutOff_4){
                    psi_R_BackJet2_VariableIOs_4 += gepWTAConeCellsTowersJetspTValuesBack->at(idxBackJet1) * sqrt(calcDeltaR2(jetTaggerSubleadingLRJEtaValuesBack->at(0), jetTaggerSubleadingLRJPhiValuesBack->at(0), gepWTAConeCellsTowersJetsEtaValuesBack->at(idxBackJet1), gepWTAConeCellsTowersJetsPhiValuesBack->at(idxBackJet1)));
                    psi_R2_BackJet2_VariableIOs_4 += gepWTAConeCellsTowersJetspTValuesBack->at(idxBackJet1) * calcDeltaR2(jetTaggerSubleadingLRJEtaValuesBack->at(0), jetTaggerSubleadingLRJPhiValuesBack->at(0), gepWTAConeCellsTowersJetsEtaValuesBack->at(idxBackJet1), gepWTAConeCellsTowersJetsPhiValuesBack->at(idxBackJet1));
                    psi_R_Et_sum_variableIOs_BackJet2_4 += gepWTAConeCellsTowersJetspTValuesBack->at(idxBackJet1);
                } 
                if(indexCounterSubleadingJet < variableIOCutOff_5){
                    psi_R_BackJet2_VariableIOs_5 += gepWTAConeCellsTowersJetspTValuesBack->at(idxBackJet1) * sqrt(calcDeltaR2(jetTaggerSubleadingLRJEtaValuesBack->at(0), jetTaggerSubleadingLRJPhiValuesBack->at(0), gepWTAConeCellsTowersJetsEtaValuesBack->at(idxBackJet1), gepWTAConeCellsTowersJetsPhiValuesBack->at(idxBackJet1)));
                    psi_R2_BackJet2_VariableIOs_5 += gepWTAConeCellsTowersJetspTValuesBack->at(idxBackJet1) * calcDeltaR2(jetTaggerSubleadingLRJEtaValuesBack->at(0), jetTaggerSubleadingLRJPhiValuesBack->at(0), gepWTAConeCellsTowersJetsEtaValuesBack->at(idxBackJet1), gepWTAConeCellsTowersJetsPhiValuesBack->at(idxBackJet1));
                    psi_R_Et_sum_variableIOs_BackJet2_5 += gepWTAConeCellsTowersJetspTValuesBack->at(idxBackJet1);
                } 
                psi_R2_BackJet2 += (1.0/jetTaggerSubleadingLRJEtValuesBack->at(0) * jetRadius * jetRadius) * gepWTAConeCellsTowersJetspTValuesBack->at(idxBackJet1) * calcDeltaR2(jetTaggerSubleadingLRJEtaValuesBack->at(0), jetTaggerSubleadingLRJPhiValuesBack->at(0), gepWTAConeCellsTowersJetsEtaValuesBack->at(idxBackJet1), gepWTAConeCellsTowersJetsPhiValuesBack->at(idxBackJet1));
            }
            else {
                std::cerr << "INPUT OBJECT UNKNOWN!" << "\n";
            }
            indexCounterLeadingJet++;
        }
        psi_R_BackJet1_VariableIOs_2/=psi_R_Et_sum_variableIOs_BackJet1_2;
        psi_R_BackJet1_VariableIOs_3/=psi_R_Et_sum_variableIOs_BackJet1_3;
        psi_R_BackJet1_VariableIOs_4/=psi_R_Et_sum_variableIOs_BackJet1_4;
        psi_R_BackJet1_VariableIOs_5/=psi_R_Et_sum_variableIOs_BackJet1_5;

        psi_R2_BackJet1_VariableIOs_2/=psi_R_Et_sum_variableIOs_BackJet1_2;
        psi_R2_BackJet1_VariableIOs_3/=psi_R_Et_sum_variableIOs_BackJet1_3;
        psi_R2_BackJet1_VariableIOs_4/=psi_R_Et_sum_variableIOs_BackJet1_4;
        psi_R2_BackJet1_VariableIOs_5/=psi_R_Et_sum_variableIOs_BackJet1_5;

        for(auto& idxBackJet2 : *jetTaggerSubleadingLRJMergedIndicesValuesBack){
            if(inputObjectType == "gepBasicClusters"){
                if(indexCounterSubleadingJet < variableIOCutOff_2){
                    psi_R_BackJet2_VariableIOs_2 += gepBasicClustersEtValuesBack->at(idxBackJet2) * sqrt(calcDeltaR2(jetTaggerSubleadingLRJEtaValuesBack->at(0), jetTaggerSubleadingLRJPhiValuesBack->at(0), gepBasicClustersEtaValuesBack->at(idxBackJet2), gepBasicClustersPhiValuesBack->at(idxBackJet2)));
                    psi_R2_BackJet2_VariableIOs_2 += gepBasicClustersEtValuesBack->at(idxBackJet2) * calcDeltaR2(jetTaggerSubleadingLRJEtaValuesBack->at(0), jetTaggerSubleadingLRJPhiValuesBack->at(0), gepBasicClustersEtaValuesBack->at(idxBackJet2), gepBasicClustersPhiValuesBack->at(idxBackJet2));
                    psi_R_Et_sum_variableIOs_BackJet2_2 += gepBasicClustersEtValuesBack->at(idxBackJet2);
                } 
                if(indexCounterSubleadingJet < variableIOCutOff_3){
                    psi_R_BackJet2_VariableIOs_3 += gepBasicClustersEtValuesBack->at(idxBackJet2) * sqrt(calcDeltaR2(jetTaggerSubleadingLRJEtaValuesBack->at(0), jetTaggerSubleadingLRJPhiValuesBack->at(0), gepBasicClustersEtaValuesBack->at(idxBackJet2), gepBasicClustersPhiValuesBack->at(idxBackJet2)));
                    psi_R2_BackJet2_VariableIOs_3 += gepBasicClustersEtValuesBack->at(idxBackJet2) * calcDeltaR2(jetTaggerSubleadingLRJEtaValuesBack->at(0), jetTaggerSubleadingLRJPhiValuesBack->at(0), gepBasicClustersEtaValuesBack->at(idxBackJet2), gepBasicClustersPhiValuesBack->at(idxBackJet2));
                    psi_R_Et_sum_variableIOs_BackJet2_3 += gepBasicClustersEtValuesBack->at(idxBackJet2);
                } 
                if(indexCounterSubleadingJet < variableIOCutOff_4){
                    psi_R_BackJet2_VariableIOs_4 += gepBasicClustersEtValuesBack->at(idxBackJet2) * sqrt(calcDeltaR2(jetTaggerSubleadingLRJEtaValuesBack->at(0), jetTaggerSubleadingLRJPhiValuesBack->at(0), gepBasicClustersEtaValuesBack->at(idxBackJet2), gepBasicClustersPhiValuesBack->at(idxBackJet2)));
                    psi_R2_BackJet2_VariableIOs_4 += gepBasicClustersEtValuesBack->at(idxBackJet2) * calcDeltaR2(jetTaggerSubleadingLRJEtaValuesBack->at(0), jetTaggerSubleadingLRJPhiValuesBack->at(0), gepBasicClustersEtaValuesBack->at(idxBackJet2), gepBasicClustersPhiValuesBack->at(idxBackJet2));
                    psi_R_Et_sum_variableIOs_BackJet2_4 += gepBasicClustersEtValuesBack->at(idxBackJet2);
                } 
                if(indexCounterSubleadingJet < variableIOCutOff_5){
                    psi_R_BackJet2_VariableIOs_5 += gepBasicClustersEtValuesBack->at(idxBackJet2) * sqrt(calcDeltaR2(jetTaggerSubleadingLRJEtaValuesBack->at(0), jetTaggerSubleadingLRJPhiValuesBack->at(0), gepBasicClustersEtaValuesBack->at(idxBackJet2), gepBasicClustersPhiValuesBack->at(idxBackJet2)));
                    psi_R2_BackJet2_VariableIOs_5 += gepBasicClustersEtValuesBack->at(idxBackJet2) * calcDeltaR2(jetTaggerSubleadingLRJEtaValuesBack->at(0), jetTaggerSubleadingLRJPhiValuesBack->at(0), gepBasicClustersEtaValuesBack->at(idxBackJet2), gepBasicClustersPhiValuesBack->at(idxBackJet2));
                    psi_R_Et_sum_variableIOs_BackJet2_5 += gepBasicClustersEtValuesBack->at(idxBackJet2);
                } 
                psi_R2_BackJet2 += (1.0/jetTaggerSubleadingLRJEtValuesBack->at(0) * jetRadius * jetRadius) * gepBasicClustersEtValuesBack->at(idxBackJet2) * calcDeltaR2(jetTaggerSubleadingLRJEtaValuesBack->at(0), jetTaggerSubleadingLRJPhiValuesBack->at(0), gepBasicClustersEtaValuesBack->at(idxBackJet2), gepBasicClustersPhiValuesBack->at(idxBackJet2));
            }
            else if(inputObjectType == "Towers"){
                if(indexCounterSubleadingJet < variableIOCutOff_2){
                    psi_R_BackJet2_VariableIOs_2 += gepCellsTowersEtValuesBack->at(idxBackJet2) * sqrt(calcDeltaR2(jetTaggerSubleadingLRJEtaValuesBack->at(0), jetTaggerSubleadingLRJPhiValuesBack->at(0), gepCellsTowersEtaValuesBack->at(idxBackJet2), gepCellsTowersPhiValuesBack->at(idxBackJet2)));
                    psi_R2_BackJet2_VariableIOs_2 += gepCellsTowersEtValuesBack->at(idxBackJet2) * calcDeltaR2(jetTaggerSubleadingLRJEtaValuesBack->at(0), jetTaggerSubleadingLRJPhiValuesBack->at(0), gepCellsTowersEtaValuesBack->at(idxBackJet2), gepCellsTowersPhiValuesBack->at(idxBackJet2));
                    psi_R_Et_sum_variableIOs_BackJet2_2 += gepCellsTowersEtValuesBack->at(idxBackJet2);
                } 
                if(indexCounterSubleadingJet < variableIOCutOff_3){
                    psi_R_BackJet2_VariableIOs_3 += gepCellsTowersEtValuesBack->at(idxBackJet2) * sqrt(calcDeltaR2(jetTaggerSubleadingLRJEtaValuesBack->at(0), jetTaggerSubleadingLRJPhiValuesBack->at(0), gepCellsTowersEtaValuesBack->at(idxBackJet2), gepCellsTowersPhiValuesBack->at(idxBackJet2)));
                    psi_R2_BackJet2_VariableIOs_3 += gepCellsTowersEtValuesBack->at(idxBackJet2) * calcDeltaR2(jetTaggerSubleadingLRJEtaValuesBack->at(0), jetTaggerSubleadingLRJPhiValuesBack->at(0), gepCellsTowersEtaValuesBack->at(idxBackJet2), gepCellsTowersPhiValuesBack->at(idxBackJet2));
                    psi_R_Et_sum_variableIOs_BackJet2_3 += gepCellsTowersEtValuesBack->at(idxBackJet2);
                } 
                if(indexCounterSubleadingJet < variableIOCutOff_4){
                    psi_R_BackJet2_VariableIOs_4 += gepCellsTowersEtValuesBack->at(idxBackJet2) * sqrt(calcDeltaR2(jetTaggerSubleadingLRJEtaValuesBack->at(0), jetTaggerSubleadingLRJPhiValuesBack->at(0), gepCellsTowersEtaValuesBack->at(idxBackJet2), gepCellsTowersPhiValuesBack->at(idxBackJet2)));
                    psi_R2_BackJet2_VariableIOs_4 += gepCellsTowersEtValuesBack->at(idxBackJet2) * calcDeltaR2(jetTaggerSubleadingLRJEtaValuesBack->at(0), jetTaggerSubleadingLRJPhiValuesBack->at(0), gepCellsTowersEtaValuesBack->at(idxBackJet2), gepCellsTowersPhiValuesBack->at(idxBackJet2));
                    psi_R_Et_sum_variableIOs_BackJet2_4 += gepCellsTowersEtValuesBack->at(idxBackJet2);
                } 
                if(indexCounterSubleadingJet < variableIOCutOff_5){
                    psi_R_BackJet2_VariableIOs_5 += gepCellsTowersEtValuesBack->at(idxBackJet2) * sqrt(calcDeltaR2(jetTaggerSubleadingLRJEtaValuesBack->at(0), jetTaggerSubleadingLRJPhiValuesBack->at(0), gepCellsTowersEtaValuesBack->at(idxBackJet2), gepCellsTowersPhiValuesBack->at(idxBackJet2)));
                    psi_R2_BackJet2_VariableIOs_5 += gepCellsTowersEtValuesBack->at(idxBackJet2) * calcDeltaR2(jetTaggerSubleadingLRJEtaValuesBack->at(0), jetTaggerSubleadingLRJPhiValuesBack->at(0), gepCellsTowersEtaValuesBack->at(idxBackJet2), gepCellsTowersPhiValuesBack->at(idxBackJet2));
                    psi_R_Et_sum_variableIOs_BackJet2_5 += gepCellsTowersEtValuesBack->at(idxBackJet2);
                } 
                psi_R2_BackJet2 += (1.0/jetTaggerSubleadingLRJEtValuesBack->at(0) * jetRadius * jetRadius) * gepCellsTowersEtValuesBack->at(idxBackJet2) * calcDeltaR2(jetTaggerSubleadingLRJEtaValuesBack->at(0), jetTaggerSubleadingLRJPhiValuesBack->at(0), gepCellsTowersEtaValuesBack->at(idxBackJet2), gepCellsTowersPhiValuesBack->at(idxBackJet2));
            }
            else if(inputObjectType == "ConeJets"){
                if(indexCounterSubleadingJet < variableIOCutOff_2){
                    psi_R_BackJet2_VariableIOs_2 += gepWTAConeCellsTowersJetspTValuesBack->at(idxBackJet2) * sqrt(calcDeltaR2(jetTaggerSubleadingLRJEtaValuesBack->at(0), jetTaggerSubleadingLRJPhiValuesBack->at(0), gepWTAConeCellsTowersJetsEtaValuesBack->at(idxBackJet2), gepWTAConeCellsTowersJetsPhiValuesBack->at(idxBackJet2)));
                    psi_R2_BackJet2_VariableIOs_2 += gepWTAConeCellsTowersJetspTValuesBack->at(idxBackJet2) * calcDeltaR2(jetTaggerSubleadingLRJEtaValuesBack->at(0), jetTaggerSubleadingLRJPhiValuesBack->at(0), gepWTAConeCellsTowersJetsEtaValuesBack->at(idxBackJet2), gepWTAConeCellsTowersJetsPhiValuesBack->at(idxBackJet2));
                    psi_R_Et_sum_variableIOs_BackJet2_2 += gepWTAConeCellsTowersJetspTValuesBack->at(idxBackJet2);
                } 
                if(indexCounterSubleadingJet < variableIOCutOff_3){
                    psi_R_BackJet2_VariableIOs_3 += gepWTAConeCellsTowersJetspTValuesBack->at(idxBackJet2) * sqrt(calcDeltaR2(jetTaggerSubleadingLRJEtaValuesBack->at(0), jetTaggerSubleadingLRJPhiValuesBack->at(0), gepWTAConeCellsTowersJetsEtaValuesBack->at(idxBackJet2), gepWTAConeCellsTowersJetsPhiValuesBack->at(idxBackJet2)));
                    psi_R2_BackJet2_VariableIOs_3 += gepWTAConeCellsTowersJetspTValuesBack->at(idxBackJet2) * calcDeltaR2(jetTaggerSubleadingLRJEtaValuesBack->at(0), jetTaggerSubleadingLRJPhiValuesBack->at(0), gepWTAConeCellsTowersJetsEtaValuesBack->at(idxBackJet2), gepWTAConeCellsTowersJetsPhiValuesBack->at(idxBackJet2));
                    psi_R_Et_sum_variableIOs_BackJet2_3 += gepWTAConeCellsTowersJetspTValuesBack->at(idxBackJet2);
                } 
                if(indexCounterSubleadingJet < variableIOCutOff_4){
                    psi_R_BackJet2_VariableIOs_4 += gepWTAConeCellsTowersJetspTValuesBack->at(idxBackJet2) * sqrt(calcDeltaR2(jetTaggerSubleadingLRJEtaValuesBack->at(0), jetTaggerSubleadingLRJPhiValuesBack->at(0), gepWTAConeCellsTowersJetsEtaValuesBack->at(idxBackJet2), gepWTAConeCellsTowersJetsPhiValuesBack->at(idxBackJet2)));
                    psi_R2_BackJet2_VariableIOs_4 += gepWTAConeCellsTowersJetspTValuesBack->at(idxBackJet2) * calcDeltaR2(jetTaggerSubleadingLRJEtaValuesBack->at(0), jetTaggerSubleadingLRJPhiValuesBack->at(0), gepWTAConeCellsTowersJetsEtaValuesBack->at(idxBackJet2), gepWTAConeCellsTowersJetsPhiValuesBack->at(idxBackJet2));
                    psi_R_Et_sum_variableIOs_BackJet2_4 += gepWTAConeCellsTowersJetspTValuesBack->at(idxBackJet2);
                } 
                if(indexCounterSubleadingJet < variableIOCutOff_5){
                    psi_R_BackJet2_VariableIOs_5 += gepWTAConeCellsTowersJetspTValuesBack->at(idxBackJet2) * sqrt(calcDeltaR2(jetTaggerSubleadingLRJEtaValuesBack->at(0), jetTaggerSubleadingLRJPhiValuesBack->at(0), gepWTAConeCellsTowersJetsEtaValuesBack->at(idxBackJet2), gepWTAConeCellsTowersJetsPhiValuesBack->at(idxBackJet2)));
                    psi_R2_BackJet2_VariableIOs_5 += gepWTAConeCellsTowersJetspTValuesBack->at(idxBackJet2) * calcDeltaR2(jetTaggerSubleadingLRJEtaValuesBack->at(0), jetTaggerSubleadingLRJPhiValuesBack->at(0), gepWTAConeCellsTowersJetsEtaValuesBack->at(idxBackJet2), gepWTAConeCellsTowersJetsPhiValuesBack->at(idxBackJet2));
                    psi_R_Et_sum_variableIOs_BackJet2_5 += gepWTAConeCellsTowersJetspTValuesBack->at(idxBackJet2);
                } 
                psi_R2_BackJet2 += (1.0/jetTaggerSubleadingLRJEtValuesBack->at(0) * jetRadius * jetRadius) * gepWTAConeCellsTowersJetspTValuesBack->at(idxBackJet2) * calcDeltaR2(jetTaggerSubleadingLRJEtaValuesBack->at(0), jetTaggerSubleadingLRJPhiValuesBack->at(0), gepWTAConeCellsTowersJetsEtaValuesBack->at(idxBackJet2), gepWTAConeCellsTowersJetsPhiValuesBack->at(idxBackJet2));
            }
            else {
                std::cerr << "INPUT OBJECT UNKNOWN!" << "\n";
            }
            indexCounterSubleadingJet++;
        }
        psi_R_BackJet2_VariableIOs_2/=psi_R_Et_sum_variableIOs_BackJet2_2;
        psi_R_BackJet2_VariableIOs_3/=psi_R_Et_sum_variableIOs_BackJet2_3;
        psi_R_BackJet2_VariableIOs_4/=psi_R_Et_sum_variableIOs_BackJet2_4;
        psi_R_BackJet2_VariableIOs_5/=psi_R_Et_sum_variableIOs_BackJet2_5;

        psi_R2_BackJet2_VariableIOs_2/=psi_R_Et_sum_variableIOs_BackJet2_2;
        psi_R2_BackJet2_VariableIOs_3/=psi_R_Et_sum_variableIOs_BackJet2_3;
        psi_R2_BackJet2_VariableIOs_4/=psi_R_Et_sum_variableIOs_BackJet2_4;
        psi_R2_BackJet2_VariableIOs_5/=psi_R_Et_sum_variableIOs_BackJet2_5;

        back_h_leading_LRJ_psi_R_VariableIOs_2->Fill(psi_R_BackJet1_VariableIOs_2, backgroundEventWeight);
        back_h_subleading_LRJ_psi_R_VariableIOs_2->Fill(psi_R_BackJet2_VariableIOs_2, backgroundEventWeight);
        back_h_LRJ_psi_R_squared_VariableIOs_2->Fill(psi_R_BackJet1_VariableIOs_2 * psi_R_BackJet2_VariableIOs_2, backgroundEventWeight); 
        backJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_2->Fill(std::max(back_LRJ_Et[i][0], back_LRJ_Et[i][1]), psi_R_BackJet1_VariableIOs_2 * psi_R_BackJet2_VariableIOs_2, backgroundEventWeight);
        backJetTaggerSubleadingLRJEtvsPsi_R_VariableIOs_2->Fill(std::min(back_LRJ_Et[i][0], back_LRJ_Et[i][1]), psi_R_BackJet1_VariableIOs_2 * psi_R_BackJet2_VariableIOs_2, backgroundEventWeight);

        back_h_leading_LRJ_Psi_R2_VariableIOs_2->Fill(psi_R2_BackJet1_VariableIOs_2, backgroundEventWeight);
        back_h_subleading_LRJ_Psi_R2_VariableIOs_2->Fill(psi_R2_BackJet2_VariableIOs_2, backgroundEventWeight);
        back_h_LRJ_Psi_R2_squared_VariableIOs_2->Fill(psi_R2_BackJet1_VariableIOs_2 * psi_R2_BackJet2_VariableIOs_2, backgroundEventWeight); 
        backJetTaggerLeadingLRJEtvsPsi_R2_VariableIOs_2->Fill(std::max(back_LRJ_Et[i][0], back_LRJ_Et[i][1]), psi_R2_BackJet1_VariableIOs_2 * psi_R2_BackJet2_VariableIOs_2, backgroundEventWeight);

        back_h_leading_LRJ_psi_R_VariableIOs_3->Fill(psi_R_BackJet1_VariableIOs_3, backgroundEventWeight);
        back_h_subleading_LRJ_psi_R_VariableIOs_3->Fill(psi_R_BackJet2_VariableIOs_3, backgroundEventWeight);
        back_h_LRJ_psi_R_squared_VariableIOs_3->Fill(psi_R_BackJet1_VariableIOs_3 * psi_R_BackJet2_VariableIOs_3, backgroundEventWeight); 
        backJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_3->Fill(std::max(back_LRJ_Et[i][0], back_LRJ_Et[i][1]), psi_R_BackJet1_VariableIOs_3 * psi_R_BackJet2_VariableIOs_3, backgroundEventWeight);
        backJetTaggerSubleadingLRJEtvsPsi_R_VariableIOs_3->Fill(std::min(back_LRJ_Et[i][0], back_LRJ_Et[i][1]), psi_R_BackJet1_VariableIOs_3 * psi_R_BackJet2_VariableIOs_3, backgroundEventWeight);

        back_h_leading_LRJ_Psi_R2_VariableIOs_3->Fill(psi_R2_BackJet1_VariableIOs_3, backgroundEventWeight);
        back_h_subleading_LRJ_Psi_R2_VariableIOs_3->Fill(psi_R2_BackJet2_VariableIOs_3, backgroundEventWeight);
        back_h_LRJ_Psi_R2_squared_VariableIOs_3->Fill(psi_R2_BackJet1_VariableIOs_3 * psi_R2_BackJet2_VariableIOs_3, backgroundEventWeight); 
        backJetTaggerLeadingLRJEtvsPsi_R2_VariableIOs_3->Fill(std::max(back_LRJ_Et[i][0], back_LRJ_Et[i][1]), psi_R2_BackJet1_VariableIOs_3 * psi_R2_BackJet2_VariableIOs_3, backgroundEventWeight);

        back_h_leading_LRJ_psi_R_VariableIOs_4->Fill(psi_R_BackJet1_VariableIOs_4, backgroundEventWeight);
        back_h_subleading_LRJ_psi_R_VariableIOs_4->Fill(psi_R_BackJet2_VariableIOs_4, backgroundEventWeight);
        back_h_LRJ_psi_R_squared_VariableIOs_4->Fill(psi_R_BackJet1_VariableIOs_4 * psi_R_BackJet2_VariableIOs_4, backgroundEventWeight); 
        backJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_4->Fill(std::max(back_LRJ_Et[i][0], back_LRJ_Et[i][1]), psi_R_BackJet1_VariableIOs_4 * psi_R_BackJet2_VariableIOs_4, backgroundEventWeight);
        backJetTaggerSubleadingLRJEtvsPsi_R_VariableIOs_4->Fill(std::min(back_LRJ_Et[i][0], back_LRJ_Et[i][1]), psi_R_BackJet1_VariableIOs_4 * psi_R_BackJet2_VariableIOs_4, backgroundEventWeight);

        back_h_leading_LRJ_Psi_R2_VariableIOs_4->Fill(psi_R2_BackJet1_VariableIOs_4, backgroundEventWeight);
        back_h_subleading_LRJ_Psi_R2_VariableIOs_4->Fill(psi_R2_BackJet2_VariableIOs_4, backgroundEventWeight);
        back_h_LRJ_Psi_R2_squared_VariableIOs_4->Fill(psi_R2_BackJet1_VariableIOs_4 * psi_R2_BackJet2_VariableIOs_4, backgroundEventWeight); 
        backJetTaggerLeadingLRJEtvsPsi_R2_VariableIOs_4->Fill(std::max(back_LRJ_Et[i][0], back_LRJ_Et[i][1]), psi_R2_BackJet1_VariableIOs_4 * psi_R2_BackJet2_VariableIOs_4, backgroundEventWeight);

        back_h_leading_LRJ_psi_R_VariableIOs_5->Fill(psi_R_BackJet1_VariableIOs_5, backgroundEventWeight);
        back_h_subleading_LRJ_psi_R_VariableIOs_5->Fill(psi_R_BackJet2_VariableIOs_5, backgroundEventWeight);
        back_h_LRJ_psi_R_squared_VariableIOs_5->Fill(psi_R_BackJet1_VariableIOs_5 * psi_R_BackJet2_VariableIOs_5, backgroundEventWeight); 
        backJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_5->Fill(std::max(back_LRJ_Et[i][0], back_LRJ_Et[i][1]), psi_R_BackJet1_VariableIOs_5 * psi_R_BackJet2_VariableIOs_5, backgroundEventWeight);
        backJetTaggerSubleadingLRJEtvsPsi_R_VariableIOs_5->Fill(std::min(back_LRJ_Et[i][0], back_LRJ_Et[i][1]), psi_R_BackJet1_VariableIOs_5 * psi_R_BackJet2_VariableIOs_5, backgroundEventWeight);

        back_h_leading_LRJ_Psi_R2_VariableIOs_5->Fill(psi_R2_BackJet1_VariableIOs_5, backgroundEventWeight);
        back_h_subleading_LRJ_Psi_R2_VariableIOs_5->Fill(psi_R2_BackJet2_VariableIOs_5, backgroundEventWeight);
        back_h_LRJ_Psi_R2_squared_VariableIOs_5->Fill(psi_R2_BackJet1_VariableIOs_5 * psi_R2_BackJet2_VariableIOs_5, backgroundEventWeight); 
        backJetTaggerLeadingLRJEtvsPsi_R2_VariableIOs_5->Fill(std::max(back_LRJ_Et[i][0], back_LRJ_Et[i][1]), psi_R2_BackJet1_VariableIOs_5 * psi_R2_BackJet2_VariableIOs_5, backgroundEventWeight);

        psi_R_BackJet1 = jetTaggerLeadingLRJPsi_RValuesBack->at(0);
        psi_R_BackJet2 = jetTaggerSubleadingLRJPsi_RValuesBack->at(0);

        back_h_LRJ_psi_R_squared->Fill(psi_R_BackJet1 * psi_R_BackJet2, backgroundEventWeight);
        backJetTaggerLeadingLRJEtvsPsi_R_squared->Fill(std::max(back_LRJ_Et[i][0], back_LRJ_Et[i][1]), psi_R_BackJet1 * psi_R_BackJet2, backgroundEventWeight);
        backJetTaggerSubleadingLRJEtvsPsi_R_squared->Fill(std::min(back_LRJ_Et[i][0], back_LRJ_Et[i][1]), psi_R_BackJet1 * psi_R_BackJet2, backgroundEventWeight);
        back_h_LRJ_psi_R2_squared->Fill(psi_R2_BackJet1 * psi_R2_BackJet2, backgroundEventWeight);
        back_h_leading_LRJ_psi_R->Fill(psi_R_BackJet1, backgroundEventWeight);
        if(recoAntiKt10LRJLeadingEtValuesBack->size() > 0){
            if(recoAntiKt10LRJLeadingMassValuesBack->at(0) >= 50.0) back_h_leading_LRJ_psi_R_MassWindow->Fill(psi_R_BackJet1, backgroundEventWeight);
            else back_h_leading_LRJ_psi_R_OutsideMassWindow->Fill(psi_R_BackJet1, backgroundEventWeight);
            backOfflineLeadingLRJMassvsPsi_R->Fill(recoAntiKt10LRJLeadingMassValuesBack->at(0), psi_R_BackJet1, backgroundEventWeight);
        }
        back_h_subleading_LRJ_psi_R->Fill(psi_R_BackJet2, backgroundEventWeight);
        backJetTaggerLeadingLRJEtvsPsi_R->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), psi_R_BackJet1, backgroundEventWeight);
        backJetTaggerSubleadingLRJEtvsPsi_R->Fill(jetTaggerSubleadingLRJEtValuesBack->at(0), psi_R_BackJet2, backgroundEventWeight);
        //std::cout << "psi_R2_BackJet1: " << psi_R2_BackJet1 << " , psi_R2_BackJet2: " << psi_R2_BackJet2 << "\n";
        //std::cout << "psi_R2 squared: " << psi_R2_BackJet1 * psi_R2_BackJet2 << "\n";
        backJetTaggerLeadingLRJEtvsPsi_R2_squared->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), psi_R2_BackJet1 * psi_R2_BackJet2, backgroundEventWeight);
        backJetTaggerSubleadingLRJEtvsPsi_R2_squared->Fill(jetTaggerSubleadingLRJEtValuesBack->at(0), psi_R2_BackJet1 * psi_R2_BackJet2, backgroundEventWeight);
        //std::cout << "test 2" << "\n";
        // Fill with regular deltaR metric
        back_h_LRJ_psi_R_12->Fill(psi_R_BackJet1 / psi_R_BackJet2, backgroundEventWeight);
        backJetTaggerLeadingLRJEtvsPsi_12->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), psi_R_BackJet1 / psi_R_BackJet2, backgroundEventWeight);
        backJetTaggerSubleadingLRJEtvsPsi_12->Fill(jetTaggerSubleadingLRJEtValuesBack->at(0), psi_R_BackJet1 / psi_R_BackJet2, backgroundEventWeight);
        backJetTaggerLeadingLRJEtvsPsi_R2_12->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), psi_R2_BackJet1 / psi_R2_BackJet2, backgroundEventWeight);
        backJetTaggerSubleadingLRJEtvsPsi_R2_12->Fill(jetTaggerSubleadingLRJEtValuesBack->at(0), psi_R2_BackJet1 / psi_R2_BackJet2, backgroundEventWeight);
        
        backJetTaggerLeadingLRJPsi_RvsSubleadingPsi_R->Fill(psi_R_BackJet2, psi_R_BackJet1, backgroundEventWeight); // subleading filled to x-axis
        // Fill with deltaR^2 metric
        back_h_leading_LRJ_psi_R2->Fill(psi_R2_BackJet1, backgroundEventWeight);
        back_h_subleading_LRJ_psi_R2->Fill(psi_R2_BackJet2, backgroundEventWeight);
        back_h_LRJ_psi_R2_12->Fill(psi_R2_BackJet1 / psi_R2_BackJet2, backgroundEventWeight);
        backJetTaggerLeadingLRJEtvsPsi_R2->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), psi_R2_BackJet1, backgroundEventWeight);
        backJetTaggerSubleadingLRJEtvsPsi_R2->Fill(jetTaggerSubleadingLRJEtValuesBack->at(0), psi_R2_BackJet2, backgroundEventWeight);
        backJetTaggerLeadingLRJPsi_R2vsSubleadingPsi_R2->Fill(psi_R2_BackJet2, psi_R2_BackJet1, backgroundEventWeight); // subleading filled to x-axis

        //std::cout << "test 3" << "\n";
        back_h_LRJ1_deltaEt_digitized_double->Fill((back_LRJ_Et[i][0] - jetTaggerLeadingLRJEtValuesBack->at(0)), backgroundEventWeight);
        back_h_LRJ2_deltaEt_digitized_double->Fill((back_LRJ_Et[i][1] - jetTaggerSubleadingLRJEtValuesBack->at(0)), backgroundEventWeight);

        if(recoAntiKt10LRJLeadingEtValuesBack->size() == 0) continue;
        // Mass vs. Et for Leading Offline LRJ 
        backOfflineLeadingLRJMassvsEt->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), recoAntiKt10LRJLeadingMassValuesBack->at(0), backgroundEventWeight);
        
        backOfflineLeadingLRJMass->Fill(recoAntiKt10LRJLeadingMassValuesBack->at(0), backgroundEventWeight);
        if(recoAntiKt10LRJSubleadingEtValuesBack->size() > 0){
            backOfflineSubleadingLRJMassvsEt->Fill(recoAntiKt10LRJSubleadingEtValuesBack->at(0), recoAntiKt10LRJSubleadingMassValuesBack->at(0), backgroundEventWeight);
            backOfflineSubleadingLRJMassvsLeadingLRJMass->Fill(recoAntiKt10LRJLeadingMassValuesBack->at(0), recoAntiKt10LRJSubleadingMassValuesBack->at(0), backgroundEventWeight);
            backOfflineSubleadingLRJMass->Fill(recoAntiKt10LRJSubleadingMassValuesBack->at(0), backgroundEventWeight);
            back_h_subleading_offlineLRJ_Et_byfile->Fill(recoAntiKt10LRJSubleadingEtValuesBack->at(0), backgroundEventWeight);
        }
        
        back_h_leading_offlineLRJ_Et->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        back_h_leading_offlineLRJ_Et_byfile->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        back_h_leading_offlineLRJ_Mass_byfile->Fill(recoAntiKt10LRJLeadingMassValuesBack->at(0), backgroundEventWeight);

        if(recoAntiKt10LRJSubleadingEtValuesBack->size() > 0) back_h_subleading_offlineLRJ_Et->Fill(recoAntiKt10LRJSubleadingEtValuesBack->at(0), backgroundEventWeight);
        //std::cout << "test 4" << "\n";
        // ------------------- BACKGROUND -------------------
        const auto& etBkg  = *truthAntiKt4WZSRJEtValuesBack;
        const auto& etaBkg = *truthAntiKt4WZSRJEtaValuesBack;
        const auto& phiBkg = *truthAntiKt4WZSRJPhiValuesBack;

        double lrjEtaBkgLeading = 0;
        double lrjPhiBkgLeading = 0;
        double lrjEtaBkgSubleading = 0;
        double lrjPhiBkgSubleading = 0;
        if(recoAntiKt10LRJLeadingEtaValuesBack->size() > 0 ){
            lrjEtaBkgLeading = recoAntiKt10LRJLeadingEtaValuesBack->at(0);
            lrjPhiBkgLeading = recoAntiKt10LRJLeadingPhiValuesBack->at(0);
        } 
        if(recoAntiKt10LRJSubleadingEtaValuesBack->size() > 0 ){
            lrjEtaBkgSubleading = recoAntiKt10LRJSubleadingEtaValuesBack->at(0);
            lrjPhiBkgSubleading = recoAntiKt10LRJSubleadingPhiValuesBack->at(0);
        } 

        // ---- Tunable parameters ----
        const double subjetEtCutoff           = 25.0;  // as before
        const double drMatchToLRJ             = 1.0;   // match truth subjets to leading large-R jet
        const double drMinBetweenSubjets      = 0.4;   // NEW: minimum deltaR separation between counted subjets

        // ---- Utility: select non-overlapping subjets (greedy by Et desc) ----
        auto selectNonOverlappingSubjets = [&](const std::vector<double>& et,
                                            const std::vector<double>& eta,
                                            const std::vector<double>& phi,
                                            double lrjEta, double lrjPhi,
                                            TH1* etHist)
        {
            const size_t n = et.size();

            // 1) First, collect candidates within drMatchToLRJ to the leading LRJ (for plotting) 
            //    and build a list of indices that ALSO pass the Et cut (for counting).
            std::vector<size_t> candidates; candidates.reserve(n);
            for (size_t i = 0; i < n; ++i) {
                const double dR = std::sqrt(calcDeltaR2(eta[i], phi[i], lrjEta, lrjPhi));
                if (dR < drMatchToLRJ) {
                    if (etHist) etHist->Fill(et[i]);          // unchanged behavior for plotting
                    if (et[i] >= subjetEtCutoff) {
                        candidates.push_back(i);              // for counting (subject to overlap removal)
                    }
                }
            }

            // 2) Sort candidates by Et descending so we keep the highest-Et subjets when enforcing separation
            std::sort(candidates.begin(), candidates.end(),
                    [&](size_t a, size_t b){ return et[a] > et[b]; });

            // 3) Greedily select non-overlapping subjets (R > drMinBetweenSubjets)
            std::vector<size_t> selected; selected.reserve(candidates.size());
            for (size_t idx : candidates) {
                bool overlaps = false;
                for (size_t jdx : selected) {
                    const double dR = std::sqrt(calcDeltaR2(eta[idx], phi[idx], eta[jdx], phi[jdx]));
                    if (dR <= drMinBetweenSubjets) { overlaps = true; break; }
                }
                if (!overlaps) selected.push_back(idx);
            }

            return selected.size(); // this is the multiplicity you want to Fill(...)
        };
        
        const unsigned int backgroundSubjetCounterLeading =
            selectNonOverlappingSubjets(etBkg, etaBkg, phiBkg, lrjEtaBkgLeading, lrjPhiBkgLeading,
                                        back_h_LeadingOfflineLRJ_SubjetEt);

        const unsigned int backgroundSubjetCounterSubleading =
            selectNonOverlappingSubjets(etBkg, etaBkg, phiBkg, lrjEtaBkgSubleading, lrjPhiBkgSubleading,
                                        back_h_SubleadingOfflineLRJ_SubjetEt);
        //std::cout << "test 5" << "\n";
        nOfflineSubjetsLeadingLRJBack[i] = backgroundSubjetCounterLeading;        
        back_h_LeadingOfflineLRJ_SubjetMultiplicity->Fill(backgroundSubjetCounterLeading, backgroundEventWeight);
        back_h_SubleadingOfflineLRJ_SubjetMultiplicity->Fill(backgroundSubjetCounterSubleading, backgroundEventWeight);
        backOfflineLeadingLRJEtvsSubjetMult->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundSubjetCounterLeading, backgroundEventWeight);
        backOfflineLeadingLRJMassvsSubjetMult->Fill(backgroundSubjetCounterLeading, recoAntiKt10LRJLeadingMassValuesBack->at(0), backgroundEventWeight);

        backJetTaggerLeadingLRJEtvsSubleadingLRJEt->Fill(jetTaggerLeadingLRJEtValuesBack->at(0), jetTaggerSubleadingLRJEtValuesBack->at(0), backgroundEventWeight);

        // Delta R, delta Et for leading gFEX, jFEX SRJ (seeds), Offline LRJs
        back_h_leading_LRJ_gFexLRJ_deltaEt->Fill(gFexLRJLeadingEtValuesBack->at(0) - jetTaggerLeadingLRJEtValuesBack->at(0), backgroundEventWeight);
        back_h_leading_offlineLRJ_gFexLRJ_deltaEt->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0) - gFexLRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        back_h_leading_offlineLRJ_jFexLRJ_deltaEt->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0) - jFexLRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        back_h_leading_LRJ_offlineLRJ_deltaEt->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0) - jetTaggerLeadingLRJEtValuesBack->at(0), backgroundEventWeight);
        // Fill "resolution"
        back_h_leading_LRJ_gFexLRJ_Et_resolution->Fill(((gFexLRJLeadingEtValuesBack->at(0) - jetTaggerLeadingLRJEtValuesBack->at(0))/ gFexLRJLeadingEtValuesBack->at(0)), backgroundEventWeight);
        back_h_leading_offlineLRJ_gFexLRJ_Et_resolution->Fill((recoAntiKt10LRJLeadingEtValuesBack->at(0) - gFexLRJLeadingEtValuesBack->at(0))/recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        back_h_leading_offlineLRJ_jFexLRJ_Et_resolution->Fill((recoAntiKt10LRJLeadingEtValuesBack->at(0) - jFexLRJLeadingEtValuesBack->at(0))/recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        back_h_leading_LRJ_offlineLRJ_Et_resolution->Fill(((recoAntiKt10LRJLeadingEtValuesBack->at(0) - jetTaggerLeadingLRJEtValuesBack->at(0))/ recoAntiKt10LRJLeadingEtValuesBack->at(0)), backgroundEventWeight);

        back_h_leading_LRJ_gFexLRJ_deltaR->Fill(sqrt(calcDeltaR2(gFexLRJLeadingEtaValuesBack->at(0), gFexLRJLeadingPhiValuesBack->at(0), back_LRJ_Eta[i][highestEtIndexLRJBack], back_LRJ_Phi[i][highestEtIndexLRJBack])), backgroundEventWeight);
        //std::cout << "test 6" << "\n";
        back_h_leading_LRJ_offlineLRJ_deltaR->Fill(sqrt(calcDeltaR2(recoAntiKt10LRJLeadingEtaValuesBack->at(0), recoAntiKt10LRJLeadingPhiValuesBack->at(0), back_LRJ_Eta[i][highestEtIndexLRJBack], back_LRJ_Phi[i][highestEtIndexLRJBack])), backgroundEventWeight);
        back_h_first_LRJ_jFexSRJ_deltaR->Fill(sqrt(calcDeltaR2(jFexSRJLeadingEtaValuesBack->at(0), jFexSRJLeadingPhiValuesBack->at(0), back_LRJ_Eta[i][0], back_LRJ_Phi[i][0])));
        back_h_second_LRJ_jFexSRJ_deltaR->Fill(sqrt(calcDeltaR2(jFexSRJSubleadingEtaValuesBack->at(0), jFexSRJSubleadingPhiValuesBack->at(0), back_LRJ_Eta[i][1], back_LRJ_Phi[i][1])), backgroundEventWeight);
        back_h_lead_sublead_LRJ_deltaR->Fill(sqrt(calcDeltaR2(back_LRJ_Eta[i][0], back_LRJ_Phi[i][0], back_LRJ_Eta[i][1], back_LRJ_Phi[i][1])), backgroundEventWeight);

        // Dijet efficiencies (background)
        if(backgroundSubjetCounterLeading == 1){
            if(back_LRJ_Et[i][0] >= 100.0 || back_LRJ_Et[i][1] >= 100.0){
                back_h_offlineLRJ_Et_num100_1Subjet->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
            }
            back_h_offlineLRJ_Et_denom100_1Subjet->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);

            if(back_LRJ_Et[i][0] >= 200.0 || back_LRJ_Et[i][1] >= 200.0){
                back_h_offlineLRJ_Et_num200_1Subjet->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
            }
            back_h_offlineLRJ_Et_denom200_1Subjet->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);

            if(back_LRJ_Et[i][0] >= 300.0 || back_LRJ_Et[i][1] >= 300.0){
                back_h_offlineLRJ_Et_num300_1Subjet->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
            }
            back_h_offlineLRJ_Et_denom300_1Subjet->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        }

        if(backgroundSubjetCounterLeading >= 2){
            if(back_LRJ_Et[i][0] >= 100.0 || back_LRJ_Et[i][1] >= 100.0){
                back_h_offlineLRJ_Et_num100_GrEq2Subjets->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
            }
            back_h_offlineLRJ_Et_denom100_GrEq2Subjets->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);

            if(back_LRJ_Et[i][0] >= 200.0 || back_LRJ_Et[i][1] >= 200.0){
                back_h_offlineLRJ_Et_num200_GrEq2Subjets->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
            }
            back_h_offlineLRJ_Et_denom200_GrEq2Subjets->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);


            if(back_LRJ_Et[i][0] >= 300.0 || back_LRJ_Et[i][1] >= 300.0){
                back_h_offlineLRJ_Et_num300_GrEq2Subjets->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
            }
            back_h_offlineLRJ_Et_denom300_GrEq2Subjets->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        }
        //std::cout << "test 7" << "\n";
        // Fill background jFEX trigger efficiencies (1 jet) 
        if(jFexLRJLeadingEtValuesBack->at(0) >= 50.0){
            back_h_offlineLRJ_Et_num50_jFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        }
        back_h_offlineLRJ_Et_denom50_jFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);

        if(jFexLRJLeadingEtValuesBack->at(0) >= 100.0){
            back_h_offlineLRJ_Et_num100_jFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        }
        back_h_offlineLRJ_Et_denom100_jFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);

        if(jFexLRJLeadingEtValuesBack->at(0) >= 150.0){
            back_h_offlineLRJ_Et_num150_jFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        }
        back_h_offlineLRJ_Et_denom150_jFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);

        if(jFexLRJLeadingEtValuesBack->at(0) >= 200.0){
            back_h_offlineLRJ_Et_num200_jFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        }
        back_h_offlineLRJ_Et_denom200_jFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);

        if(jFexLRJLeadingEtValuesBack->at(0) >= 250.0){
            back_h_offlineLRJ_Et_num250_jFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        }
        back_h_offlineLRJ_Et_denom250_jFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);

        if(jFexLRJLeadingEtValuesBack->at(0) >= 300.0){
            back_h_offlineLRJ_Et_num300_jFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        }
        back_h_offlineLRJ_Et_denom300_jFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);

        if(jFexLRJLeadingEtValuesBack->at(0) >= 350.0){
            back_h_offlineLRJ_Et_num350_jFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        }
        back_h_offlineLRJ_Et_denom350_jFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);

        if(jFexLRJLeadingEtValuesBack->at(0) >= 400.0){
            back_h_offlineLRJ_Et_num400_jFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        }
        back_h_offlineLRJ_Et_denom400_jFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);

        if(jFexLRJLeadingEtValuesBack->at(0) >= 450.0){
            back_h_offlineLRJ_Et_num450_jFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        }
        back_h_offlineLRJ_Et_denom450_jFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);

        // Fill background gFex trigger efficiencies
        if(gFexLRJLeadingEtValuesBack->at(0) >= 50.0){
            back_h_offlineLRJ_Et_num50_gFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        }
        back_h_offlineLRJ_Et_denom50_gFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);

        if(gFexLRJLeadingEtValuesBack->at(0) >= 100.0){
            back_h_offlineLRJ_Et_num100_gFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        }
        back_h_offlineLRJ_Et_denom100_gFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);

        if(gFexLRJLeadingEtValuesBack->at(0) >= 150.0){
            back_h_offlineLRJ_Et_num150_gFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        }
        back_h_offlineLRJ_Et_denom150_gFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);

        if(gFexLRJLeadingEtValuesBack->at(0) >= 200.0){
            back_h_offlineLRJ_Et_num200_gFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        }
        back_h_offlineLRJ_Et_denom200_gFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);

        if(gFexLRJLeadingEtValuesBack->at(0) >= 250.0){
            back_h_offlineLRJ_Et_num250_gFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        }
        back_h_offlineLRJ_Et_denom250_gFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);

        if(gFexLRJLeadingEtValuesBack->at(0) >= 300.0){
            back_h_offlineLRJ_Et_num300_gFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        }
        back_h_offlineLRJ_Et_denom300_gFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);

        if(gFexLRJLeadingEtValuesBack->at(0) >= 350.0){
            back_h_offlineLRJ_Et_num350_gFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        }
        back_h_offlineLRJ_Et_denom350_gFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);

        if(gFexLRJLeadingEtValuesBack->at(0) >= 400.0){
            back_h_offlineLRJ_Et_num400_gFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        }
        back_h_offlineLRJ_Et_denom400_gFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);

        if(gFexLRJLeadingEtValuesBack->at(0) >= 450.0){
            back_h_offlineLRJ_Et_num450_gFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        }
        back_h_offlineLRJ_Et_denom450_gFexLRJ->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);

        // Fill background JetTagger trigger efficiencies
        if(back_LRJ_Et[i][0] >= 50.0 || back_LRJ_Et[i][1] >= 50.0){
            back_h_offlineLRJ_Et_num50->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        }
        back_h_offlineLRJ_Et_denom50->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);

        if(back_LRJ_Et[i][0] >= 100.0 || back_LRJ_Et[i][1] >= 100.0){
            h_back_num100->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
            back_h_offlineLRJ_Et_num100->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        }
        h_back_denom100->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        back_h_offlineLRJ_Et_denom100->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);

        if(back_LRJ_Et[i][0] >= 150.0 || back_LRJ_Et[i][1] >= 150.0){
            back_h_offlineLRJ_Et_num150->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        }
        back_h_offlineLRJ_Et_denom150->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);

        if(back_LRJ_Et[i][0] >= 200.0 || back_LRJ_Et[i][1] >= 200.0){
            h_back_num200->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
            back_h_offlineLRJ_Et_num200->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        }
        h_back_denom200->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        back_h_offlineLRJ_Et_denom200->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);

        if(back_LRJ_Et[i][0] >= 250.0 || back_LRJ_Et[i][1] >= 250.0){
            back_h_offlineLRJ_Et_num250->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        }
        back_h_offlineLRJ_Et_denom250->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);

        if(back_LRJ_Et[i][0] >= 300.0 || back_LRJ_Et[i][1] >= 300.0){
            h_back_num300->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
            back_h_offlineLRJ_Et_num300->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        }
        h_back_denom300->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        back_h_offlineLRJ_Et_denom300->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);

        if(back_LRJ_Et[i][0] >= 350.0 || back_LRJ_Et[i][1] >= 350.0){
            back_h_offlineLRJ_Et_num350->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        }
        back_h_offlineLRJ_Et_denom350->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);

        if(back_LRJ_Et[i][0] >= 400.0 || back_LRJ_Et[i][1] >= 400.0){
            back_h_offlineLRJ_Et_num400->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        }
        back_h_offlineLRJ_Et_denom400->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);

        if(back_LRJ_Et[i][0] >= 450.0 || back_LRJ_Et[i][1] >= 450.0){
            back_h_offlineLRJ_Et_num450->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);
        }
        back_h_offlineLRJ_Et_denom450->Fill(recoAntiKt10LRJLeadingEtValuesBack->at(0), backgroundEventWeight);

        
        if(i == evDisplay0Back_){
            if(jFexSRJEtaValuesBack->size() >= 6){
                displayEv0Back_ = true;
                jFexSeedPositionsBackEv0.push_back(std::make_pair(jFexSRJEtaValuesBack->at(0), jFexSRJPhiValuesBack->at(0)));
                jFexSeedPositionsBackEv0.push_back(std::make_pair(jFexSRJEtaValuesBack->at(1), jFexSRJPhiValuesBack->at(1)));
                jFexAdditionalSRJPositionsBackEv0.push_back(std::make_pair(jFexSRJEtaValuesBack->at(2), jFexSRJPhiValuesBack->at(2)));
                jFexAdditionalSRJPositionsBackEv0.push_back(std::make_pair(jFexSRJEtaValuesBack->at(3), jFexSRJPhiValuesBack->at(3)));
                jFexAdditionalSRJPositionsBackEv0.push_back(std::make_pair(jFexSRJEtaValuesBack->at(4), jFexSRJPhiValuesBack->at(4)));
                jFexAdditionalSRJPositionsBackEv0.push_back(std::make_pair(jFexSRJEtaValuesBack->at(5), jFexSRJPhiValuesBack->at(5)));
                newSeedPositionsBackEv0.push_back(std::make_pair(back_LRJ_Eta[i][0], back_LRJ_Phi[i][0]));
                newSeedPositionsBackEv0.push_back(std::make_pair(back_LRJ_Eta[i][1], back_LRJ_Phi[i][1]));
                backLRJEtEv0.push_back(back_LRJ_Et[i][0]);
                backLRJEtEv0.push_back(back_LRJ_Et[i][1]);
                backLRJPsi_REv0.push_back(psi_R_BackJet1);
                backLRJPsi_REv0.push_back(psi_R_BackJet2);
            }
            
        }
        if(i == evDisplay1Back_){
            if(jFexSRJEtaValuesBack->size() >= 6){
                displayEv1Back_ = true;
                jFexSeedPositionsBackEv1.push_back(std::make_pair(jFexSRJEtaValuesBack->at(0), jFexSRJPhiValuesBack->at(0)));
                jFexSeedPositionsBackEv1.push_back(std::make_pair(jFexSRJEtaValuesBack->at(1), jFexSRJPhiValuesBack->at(1)));
                jFexAdditionalSRJPositionsBackEv1.push_back(std::make_pair(jFexSRJEtaValuesBack->at(2), jFexSRJPhiValuesBack->at(2)));
                jFexAdditionalSRJPositionsBackEv1.push_back(std::make_pair(jFexSRJEtaValuesBack->at(3), jFexSRJPhiValuesBack->at(3)));
                jFexAdditionalSRJPositionsBackEv1.push_back(std::make_pair(jFexSRJEtaValuesBack->at(4), jFexSRJPhiValuesBack->at(4)));
                jFexAdditionalSRJPositionsBackEv1.push_back(std::make_pair(jFexSRJEtaValuesBack->at(5), jFexSRJPhiValuesBack->at(5)));
                newSeedPositionsBackEv1.push_back(std::make_pair(back_LRJ_Eta[i][0], back_LRJ_Phi[i][0]));
                newSeedPositionsBackEv1.push_back(std::make_pair(back_LRJ_Eta[i][1], back_LRJ_Phi[i][1]));
                backLRJEtEv1.push_back(back_LRJ_Et[i][0]);
                backLRJEtEv1.push_back(back_LRJ_Et[i][1]);
                backLRJPsi_REv1.push_back(psi_R_BackJet1);
                backLRJPsi_REv1.push_back(psi_R_BackJet2);
            }
            
        }
        if(i == evDisplay2Back_){
            if(jFexSRJEtaValuesBack->size() >= 6){
                displayEv2Back_ = true;
                jFexSeedPositionsBackEv2.push_back(std::make_pair(jFexSRJEtaValuesBack->at(0), jFexSRJPhiValuesBack->at(0)));
                jFexSeedPositionsBackEv2.push_back(std::make_pair(jFexSRJEtaValuesBack->at(1), jFexSRJPhiValuesBack->at(1)));
                jFexAdditionalSRJPositionsBackEv2.push_back(std::make_pair(jFexSRJEtaValuesBack->at(2), jFexSRJPhiValuesBack->at(2)));
                jFexAdditionalSRJPositionsBackEv2.push_back(std::make_pair(jFexSRJEtaValuesBack->at(3), jFexSRJPhiValuesBack->at(3)));
                jFexAdditionalSRJPositionsBackEv2.push_back(std::make_pair(jFexSRJEtaValuesBack->at(4), jFexSRJPhiValuesBack->at(4)));
                jFexAdditionalSRJPositionsBackEv2.push_back(std::make_pair(jFexSRJEtaValuesBack->at(5), jFexSRJPhiValuesBack->at(5)));
                newSeedPositionsBackEv2.push_back(std::make_pair(back_LRJ_Eta[i][0], back_LRJ_Phi[i][0]));
                newSeedPositionsBackEv2.push_back(std::make_pair(back_LRJ_Eta[i][1], back_LRJ_Phi[i][1]));
                backLRJEtEv2.push_back(back_LRJ_Et[i][0]);
                backLRJEtEv2.push_back(back_LRJ_Et[i][1]);
                backLRJPsi_REv2.push_back(psi_R_BackJet1);
                backLRJPsi_REv2.push_back(psi_R_BackJet2);
            }
            
        }
        if(i == evDisplay3Back_){
            if(jFexSRJEtaValuesBack->size() >= 6){
                displayEv3Back_ = true;
                jFexSeedPositionsBackEv3.push_back(std::make_pair(jFexSRJEtaValuesBack->at(0), jFexSRJPhiValuesBack->at(0)));
                jFexSeedPositionsBackEv3.push_back(std::make_pair(jFexSRJEtaValuesBack->at(1), jFexSRJPhiValuesBack->at(1)));
                jFexAdditionalSRJPositionsBackEv3.push_back(std::make_pair(jFexSRJEtaValuesBack->at(2), jFexSRJPhiValuesBack->at(2)));
                jFexAdditionalSRJPositionsBackEv3.push_back(std::make_pair(jFexSRJEtaValuesBack->at(3), jFexSRJPhiValuesBack->at(3)));
                jFexAdditionalSRJPositionsBackEv3.push_back(std::make_pair(jFexSRJEtaValuesBack->at(4), jFexSRJPhiValuesBack->at(4)));
                jFexAdditionalSRJPositionsBackEv3.push_back(std::make_pair(jFexSRJEtaValuesBack->at(5), jFexSRJPhiValuesBack->at(5)));
                newSeedPositionsBackEv3.push_back(std::make_pair(back_LRJ_Eta[i][0], back_LRJ_Phi[i][0]));
                newSeedPositionsBackEv3.push_back(std::make_pair(back_LRJ_Eta[i][1], back_LRJ_Phi[i][1]));
                backLRJEtEv3.push_back(back_LRJ_Et[i][0]);
                backLRJEtEv3.push_back(back_LRJ_Et[i][1]);
                backLRJPsi_REv3.push_back(psi_R_BackJet1);
                backLRJPsi_REv3.push_back(psi_R_BackJet2);
            }
            
        }
        if(i == evDisplay4Back_){
            if(jFexSRJEtaValuesBack->size() >= 6){
                displayEv4Back_ = true; 
                jFexSeedPositionsBackEv4.push_back(std::make_pair(jFexSRJEtaValuesBack->at(0), jFexSRJPhiValuesBack->at(0)));
                jFexSeedPositionsBackEv4.push_back(std::make_pair(jFexSRJEtaValuesBack->at(1), jFexSRJPhiValuesBack->at(1)));
                jFexAdditionalSRJPositionsBackEv4.push_back(std::make_pair(jFexSRJEtaValuesBack->at(2), jFexSRJPhiValuesBack->at(2)));
                jFexAdditionalSRJPositionsBackEv4.push_back(std::make_pair(jFexSRJEtaValuesBack->at(3), jFexSRJPhiValuesBack->at(3)));
                jFexAdditionalSRJPositionsBackEv4.push_back(std::make_pair(jFexSRJEtaValuesBack->at(4), jFexSRJPhiValuesBack->at(4)));
                jFexAdditionalSRJPositionsBackEv4.push_back(std::make_pair(jFexSRJEtaValuesBack->at(5), jFexSRJPhiValuesBack->at(5)));
                newSeedPositionsBackEv4.push_back(std::make_pair(back_LRJ_Eta[i][0], back_LRJ_Phi[i][0]));
                newSeedPositionsBackEv4.push_back(std::make_pair(back_LRJ_Eta[i][1], back_LRJ_Phi[i][1]));
                backLRJEtEv4.push_back(back_LRJ_Et[i][0]);
                backLRJEtEv4.push_back(back_LRJ_Et[i][1]);
                backLRJPsi_REv4.push_back(psi_R_BackJet1);
                backLRJPsi_REv4.push_back(psi_R_BackJet2);
            }
        }
        if(i <= evDisplayMaxBack_){
            for(unsigned int iTopo = 0; iTopo < nInputObjectsAlgorithmConfiguration; iTopo++){
                if(i == evDisplay0Back_){
                    backTopo422Highest128SeedPositionsEv0->Fill(gepBasicClustersEtaValuesBack->at(iTopo), gepBasicClustersPhiValuesBack->at(iTopo), gepBasicClustersEtValuesBack->at(iTopo));
                } 
                if(i == evDisplay1Back_){
                    backTopo422Highest128SeedPositionsEv1->Fill(gepBasicClustersEtaValuesBack->at(iTopo), gepBasicClustersPhiValuesBack->at(iTopo), gepBasicClustersEtValuesBack->at(iTopo));
                } 
                if(i == evDisplay2Back_){
                    backTopo422Highest128SeedPositionsEv2->Fill(gepBasicClustersEtaValuesBack->at(iTopo), gepBasicClustersPhiValuesBack->at(iTopo), gepBasicClustersEtValuesBack->at(iTopo));
                } 
                if(i == evDisplay3Back_){
                    backTopo422Highest128SeedPositionsEv3->Fill(gepBasicClustersEtaValuesBack->at(iTopo), gepBasicClustersPhiValuesBack->at(iTopo), gepBasicClustersEtValuesBack->at(iTopo));
                } 
                if(i == evDisplay4Back_){
                    backTopo422Highest128SeedPositionsEv4->Fill(gepBasicClustersEtaValuesBack->at(iTopo), gepBasicClustersPhiValuesBack->at(iTopo), gepBasicClustersEtValuesBack->at(iTopo));
                } 
            }
        }

        // Compute invariant mass using JetTagger LRJs for background
        double backDeltaEta = back_LRJ_Eta[i][0] - back_LRJ_Eta[i][1];
        double backDeltaPhi = std::abs(back_LRJ_Phi[i][0] - back_LRJ_Phi[i][1]);
        // Ensure  is within [-, ] range
        if (backDeltaPhi > M_PI) {
            backDeltaPhi = 2 * M_PI - backDeltaPhi;
        }

        double backCoshDeltaEta = cosh(backDeltaEta);
        double backCosDeltaPhi = cos(backDeltaPhi);

        double backMjj = sqrt(2.0 * back_LRJ_Et[i][0] * back_LRJ_Et[i][1] * backCoshDeltaEta - backCosDeltaPhi);

        back_h_Mjj->Fill(backMjj, backgroundEventWeight);

    } // end of background event loop

    double det_cutoff = 1.0;
    for (double et_cutoff = det_cutoff; et_cutoff < 500.0; et_cutoff += det_cutoff) {
        


        //std::cout << "back_LRJ_Et.size(): " << back_LRJ_Et.size() << " and sig_LRJ_Et.size(): " << sig_LRJ_Et.size() << "\n";
        int numTruePositive = 0;
        int numTruePositive2 = 0;
        
        for (unsigned int i = 0; i < num_processed_events_signal; i++) {
            //std::cout << "i: " << i << "\n";
            //std::cout << "i:  " << i << "\n";
            //for (int j = 0; j < sig_LRJ_Et[current_event]; j++){
            //   if ()
            //}
            //std::cout << "sig_LRJ_Et[i][0]: " << sig_LRJ_Et[i][0] << " and i " << i << "\n";
            if(sig_LRJ_Et[i][0] >= et_cutoff || sig_LRJ_Et[i][1] >= et_cutoff){
                numTruePositive++;
            }
            if(sig_LRJ_Et[i][0] >= et_cutoff && sig_LRJ_Et[i][1] >= et_cutoff){
                numTruePositive2++;
            }
        }
    

        double truePositiveRate = ((double)numTruePositive)/(num_processed_events_signal);
        double truePositiveRate2 = ((double)numTruePositive2)/(num_processed_events_signal);
        //std::cout << "truePositiveRate: " << truePositiveRate << " for et_cutoff: " << et_cutoff << "\n";
        roc_curve_points_x[fileIt].emplace_back(truePositiveRate);
        roc_curve_points_x2[fileIt].emplace_back(truePositiveRate2);

        efficiency_curve_points_x[fileIt].emplace_back(et_cutoff);
        efficiency_curve_points_y[fileIt].emplace_back(truePositiveRate);
        efficiency_curve_points_y2[fileIt].emplace_back(truePositiveRate2);

        int numFalsePositive = 0;
        int numFalsePositive2 = 0;
        for (unsigned int i = 0; i < num_processed_events_background; i++) {
            //std::cout << "back_LRJ_Et[i][0]: " << back_LRJ_Et[i][0] << " and i : " << i << "\n";
            if(back_LRJ_Et[i][0] >= et_cutoff || back_LRJ_Et[i][1] >= et_cutoff){
                numFalsePositive++;
            }
            if(back_LRJ_Et[i][0] >= et_cutoff && back_LRJ_Et[i][1] >= et_cutoff){
                numFalsePositive2++;
            }
        }

        double falsePositiveRate = ((double)numFalsePositive)/((double) num_processed_events_background);
        double falsePositiveRate2 = ((double)numFalsePositive2)/((double) num_processed_events_background);
        if (falsePositiveRate == 0){
            //std::cout << "FPR IS 0!!" << "\n";
            falsePositiveRate = 1.0/num_processed_events_background; // /10
            //std::cout << "FPR WHEN FPR IS 0: " << falsePositiveRate << "\n";
        } 
        if (falsePositiveRate2 == 0){
            //std::cout << "FPR2 IS 0!!" << "\n";
            falsePositiveRate2 = 1.0/num_processed_events_background; 
        } 
        double backgroundRejection = 1.0 / falsePositiveRate;
        double backgroundRejection2 = 1.0 / falsePositiveRate2;
        //std::cout << " backgroundRejectioN: "  << backgroundRejection << " for et_cutoff: " << et_cutoff << " and file: " << algorithmConfigurations[fileIt] << "\n";
        roc_curve_points_y[fileIt].emplace_back(backgroundRejection);
        roc_curve_points_y2[fileIt].emplace_back(backgroundRejection2);
        //std::cout << "signal to background: " << std::fixed << std::setprecision(16) << backgroundRejection * truePositiveRate << "\n";
        if (truePositiveRate > 0.1) maxSignalToBackgroundRatioTPR0p1[fileIt].push_back(backgroundRejection * truePositiveRate);
        maxSignalToBackgroundRatio[fileIt].push_back(backgroundRejection * truePositiveRate);

        if (truePositiveRate2 > 0.1) maxSignalToBackgroundRatio2TPR0p1[fileIt].push_back(backgroundRejection2 * truePositiveRate2);
        maxSignalToBackgroundRatio2[fileIt].push_back(backgroundRejection2 * truePositiveRate2);
    }
    int numTruePositiveMinMaxCut = 0;
    int numFalsePositiveMinMaxCut = 0;
    for (unsigned int i = 0; i < num_processed_events_signal; i++) {
        if ((sig_LRJ_Et[i][0] > 100 && sig_LRJ_Et[i][0] < 200) && (sig_LRJ_Et[i][1] > 100 && sig_LRJ_Et[i][1] < 200)){
            numTruePositiveMinMaxCut++;
        }
    }
    for (unsigned int i = 0; i < num_processed_events_background; i++) {
        if ((back_LRJ_Et[i][0] > 100 && back_LRJ_Et[i][0] < 200) && (back_LRJ_Et[i][1] > 100 && back_LRJ_Et[i][1] < 200)){
            numFalsePositiveMinMaxCut++;
        }
    }
    tprMinMaxCut[fileIt] = double(numTruePositiveMinMaxCut)/ double(num_processed_events_signal );
    fprMinMaxCut[fileIt] = double(numFalsePositiveMinMaxCut)/ double(num_processed_events_background);

    // Start drawing and saving histograms and plots
    TString outputFileDir = "overlayLargeRJetHistograms/";
    std::string subjetEtString_LargeRJetPlots;
    if(subjetEtThreshold == 15.0) subjetEtString_LargeRJetPlots = "_15GeVSubjets/";
    else if(subjetEtThreshold == 10.0) subjetEtString_LargeRJetPlots = "_10GeVSubjets/";
    else if(subjetEtThreshold == 20.0) subjetEtString_LargeRJetPlots = "_20GeVSubjets/";
    else if(subjetEtThreshold == 25.0) subjetEtString_LargeRJetPlots = "_25GeVSubjets/";
    else if(subjetEtThreshold == 30.0) subjetEtString_LargeRJetPlots = "_30GeVSubjets/";
    else if(subjetEtThreshold == 35.0) subjetEtString_LargeRJetPlots = "_35GeVSubjets/";
    TString modifiedOutputFileDir = "largeRJetPlots/" + algorithmConfigurations[fileIt] + subjetEtString_LargeRJetPlots;

    gSystem->mkdir(modifiedOutputFileDir);

    TCanvas cAvgDR_vs_HpT("cAvgDR_vs_HpT","Avg dR vs HpT", 900, 700);
    prof_AvgDR_vs_HpT->SetMinimum(0.0);
    prof_AvgDR_vs_HpT->SetMaximum(5.2);
    prof_AvgDR_vs_HpT->Draw("E1");

    // R=1 guide (optional)
    TLine lDR1(ptMin, 1.0, ptMax, 1.0); lDR1.SetLineColor(kBlue+1); lDR1.SetLineStyle(2); lDR1.Draw("same");

    // 2 mH_ / pT^H curve
    
    TF1 f_opening("f_opening", Form("%g*2.0/x", mH_), ptMin, ptMax);
    f_opening.SetLineColor(kRed);
    f_opening.SetLineStyle(2);
    f_opening.Draw("same");

    TLegend legdRvsHiggspTProfile(0.54, 0.72, 0.86, 0.90);
    legdRvsHiggspTProfile.SetBorderSize(0); legdRvsHiggspTProfile.SetFillStyle(0);
    legdRvsHiggspTProfile.SetTextSize(0.04);
    legdRvsHiggspTProfile.AddEntry(prof_AvgDR_vs_HpT, "Average #DeltaR", "lep");
    legdRvsHiggspTProfile.AddEntry(&lDR1, "#DeltaR = 1.0", "l");
    legdRvsHiggspTProfile.AddEntry(&f_opening, "2 m_{H} / p_{T}^{H}", "l");
    legdRvsHiggspTProfile.Draw();

    cAvgDR_vs_HpT.SaveAs(modifiedOutputFileDir + "avg_dR_vs_HpT_profile.pdf");


    TCanvas c2_TH2F("c2_TH2F","dR vs HpT 2D", 900, 700);
    h2_DR_vs_HpT->Draw("COLZ");
    // Legend in top-right for the fit and normalization info
    TLegend leg_TH2f(0.52, 0.80, 0.82, 0.93);
    TF1 f_opening2("f_opening2", Form("%g*2.0/x", mH_), ptMin, ptMax);
    f_opening2.SetLineColor(kBlack);
    f_opening2.SetLineStyle(3); // dotted
    f_opening2.SetLineWidth(2);
    f_opening2.Draw("same");
    leg_TH2f.SetBorderSize(0);
    leg_TH2f.SetTextSize(0.06);
    leg_TH2f.SetFillStyle(0);
    leg_TH2f.AddEntry(&f_opening2, "2 m_{H} / p_{T}^{H}", "l");
    //leg_TH2f.AddEntry(h2_DR_vs_HpT, "Normalized counts", "f");
    leg_TH2f.Draw();
    h2_DR_vs_HpT->Scale(1.0 / h2_DR_vs_HpT->Integral());
    c2_TH2F.SaveAs(modifiedOutputFileDir + "dR_vs_HpT_2D.pdf");

    // Fill these with clones s.t. they can be later overlaid
    sig_h_leading_LRJ_Et_vec.push_back(static_cast<TH1F*>(sig_h_leading_LRJ_Et_normalbinning->Clone())); // These will later be filled with clones of the original histograms
    sig_h_subleading_LRJ_Et_vec.push_back(static_cast<TH1F*>(sig_h_subleading_LRJ_Et_normalbinning->Clone()));
    sig_h_leading_offline_LRJ_Et_vec.push_back(static_cast<TH1F*>(sig_h_leading_offlineLRJ_Et_byfile->Clone()));
    sig_h_leading_offline_LRJ_Mass_vec.push_back(static_cast<TH1F*>(sig_h_leading_offlineLRJ_Mass_byfile->Clone()));
    sig_h_subleading_offline_LRJ_Et_vec.push_back(static_cast<TH1F*>(sig_h_subleading_offlineLRJ_Et_byfile->Clone()));
    back_h_leading_offline_LRJ_Et_vec.push_back(static_cast<TH1F*>(back_h_leading_offlineLRJ_Et_byfile->Clone()));
    back_h_leading_offline_LRJ_Mass_vec.push_back(static_cast<TH1F*>(back_h_leading_offlineLRJ_Mass_byfile->Clone()));
    back_h_subleading_offline_LRJ_Et_vec.push_back(static_cast<TH1F*>(back_h_subleading_offlineLRJ_Et_byfile->Clone()));
    back_h_leading_LRJ_Et_vec.push_back(static_cast<TH1F*>(back_h_leading_LRJ_Et_normalbinning->Clone()));
    back_h_subleading_LRJ_Et_vec.push_back(static_cast<TH1F*>(back_h_subleading_LRJ_Et_normalbinning->Clone()));
    sig_h_leading_LRJ_psi_R_vec.push_back(static_cast<TH1F*>(sig_h_leading_LRJ_psi_R->Clone()));
    sig_h_LRJ_psi_R_squared_vec.push_back(static_cast<TH1F*>(sig_h_LRJ_psi_R_squared->Clone()));
    sig_h_LRJ_psi_R_12_vec.push_back(static_cast<TH1F*>(sig_h_LRJ_psi_R_12->Clone()));
    sig_h_subleading_LRJ_psi_R_vec.push_back(static_cast<TH1F*>(sig_h_subleading_LRJ_psi_R->Clone()));
    sig_h_leading_LRJ_psi_R2_vec.push_back(static_cast<TH1F*>(sig_h_leading_LRJ_psi_R2->Clone()));
    sig_h_LRJ_psi_R2_squared_vec.push_back(static_cast<TH1F*>(sig_h_LRJ_psi_R2_squared->Clone()));
    sig_h_LRJ_psi_R2_12_vec.push_back(static_cast<TH1F*>(sig_h_LRJ_psi_R2_12->Clone()));
    sig_h_subleading_LRJ_psi_R2_vec.push_back(static_cast<TH1F*>(sig_h_subleading_LRJ_psi_R2->Clone()));
    back_h_leading_LRJ_psi_R_vec.push_back(static_cast<TH1F*>(back_h_leading_LRJ_psi_R->Clone()));
    back_h_LRJ_psi_R_squared_vec.push_back(static_cast<TH1F*>(back_h_LRJ_psi_R_squared->Clone()));
    back_h_LRJ_psi_R_12_vec.push_back(static_cast<TH1F*>(back_h_LRJ_psi_R_12->Clone()));
    back_h_subleading_LRJ_psi_R_vec.push_back(static_cast<TH1F*>(back_h_subleading_LRJ_psi_R->Clone()));
    back_h_leading_LRJ_psi_R2_vec.push_back(static_cast<TH1F*>(back_h_leading_LRJ_psi_R2->Clone()));
    back_h_LRJ_psi_R2_squared_vec.push_back(static_cast<TH1F*>(back_h_LRJ_psi_R2_squared->Clone()));
    back_h_LRJ_psi_R2_12_vec.push_back(static_cast<TH1F*>(back_h_LRJ_psi_R2_12->Clone()));
    back_h_subleading_LRJ_psi_R2_vec.push_back(static_cast<TH1F*>(back_h_subleading_LRJ_psi_R2->Clone()));



    // Start of main plotting 
    
    // Rates vs. Eff with different selections based on the number of subjets.
    auto out_0subjetEtScan = MakeRateVsEff(sig_h_leading_LRJ_Et_NoConeSubjets, back_h_leading_LRJ_Et_NoConeSubjets);

    // Titles & colors for TH1s
    SetAxes(out_0subjetEtScan.hEff_vsThr ->GetXaxis(), "Leading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out_0subjetEtScan.hEff_vsThr ->GetYaxis(), "Signal (hh#rightarrow4b) Efficiency [0 SUBJETS ONLY]");
    SetAxes(out_0subjetEtScan.hRate_vsThr->GetXaxis(), "Leading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out_0subjetEtScan.hRate_vsThr->GetYaxis(), "Estimated Background Rate [Hz] [0 SUBJETS ONLY]");

    // Titles & colors for TGraph
    SetAxes(out_0subjetEtScan.gRate_vsEff->GetXaxis(), "Signal (hh#rightarrow4b) Efficiency [0 SUBJETS ONLY]");
    SetAxes(out_0subjetEtScan.gRate_vsEff->GetYaxis(), "Estimated Background Rate [Hz] [0 SUBJETS ONLY]");

    // Optional: vs-threshold views
    auto c1_0Subjets = new TCanvas("c1_0Subjets","vs threshold",1200,500);
    c1_0Subjets->Divide(2,1);
    c1_0Subjets->cd(1);
    gPad->SetLeftMargin(0.16); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    out_0subjetEtScan.hEff_vsThr->Draw("HIST");  // draw as histogram
    c1_0Subjets->cd(2);
    gPad->SetLeftMargin(0.16); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    gPad->SetLogy();
    out_0subjetEtScan.hRate_vsThr->Draw("HIST");
    c1_0Subjets->SaveAs(rateVsEffFileDir + "threshold_views_0subjets_EtScan.pdf");

    // Main plot: rate vs efficiency (graph)
    auto c2_0Subjets = new TCanvas("c2_0Subjets","Rate vs Eff",700,600);
    c2_0Subjets->SetLeftMargin(0.16); c2_0Subjets->SetBottomMargin(0.16); c2_0Subjets->SetTicks(1,1);
    c2_0Subjets->SetLogy();
    out_0subjetEtScan.gRate_vsEff->Draw("AP");   // A=axes, P=points
    c2_0Subjets->SaveAs(rateVsEffFileDir + "rate_vs_eff_0subjets_EtScan.pdf");


    // ===================== LEADING (ET_th vs Leading psi_R scan [1 Subjet!]) =======================
    /*auto out2D_leading_1Subjet = MakeRateVsEff_ScanRMax(
        sigJetTaggerLeadingLRJEtvsPsi,    backJetTaggerLeadingLRJEtvsPsi      // R = psi_lead/psi_subl
    );

    // Axis titles
    SetAxes(out2D_leading_1Subjet.hEff_vsThr_vsR ->GetXaxis(), "Leading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_leading_1Subjet.hEff_vsThr_vsR ->GetYaxis(), "#psi_{R,lead} [1 SUBJET ONLY]");
    SetAxes(out2D_leading_1Subjet.hRate_vsThr_vsR->GetXaxis(), "Leading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_leading_1Subjet.hRate_vsThr_vsR->GetYaxis(), "#psi_{R,lead} [1 SUBJET ONLY]");

    SetAxes(out2D_leading_1Subjet.gRate_vsEff_all->GetXaxis(), "Signal (hh#rightarrow4b) Efficiency [1 SUBJET ONLY]");
    SetAxes(out2D_leading_1Subjet.gRate_vsEff_all->GetYaxis(), "Estimated Background Rate [Hz] [1 SUBJET ONLY]");

    

    // 2D "vs-threshold & Rmax" views (surfaces)
    auto c1_leading2D_1Subjet = new TCanvas("c1_leading2D_1Subjet","ET_thr vs Rmax surfaces",1200,520);
    c1_leading2D_1Subjet->Divide(2,1);

    // Efficiency surface
    c1_leading2D_1Subjet->cd(1);
    gPad->SetLeftMargin(0.16); gPad->SetRightMargin(0.18); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    out2D_leading_1Subjet.hEff_vsThr_vsR->SetTitle(";Leading JetTagger LRJ E_{T} threshold [GeV];Max. #psi_{R,lead};Signal (hh#rightarrow4b) Efficiency [1 SUBJET ONLY]");
    out2D_leading_1Subjet.hEff_vsThr_vsR->Draw("COLZ");

    // Background-rate surface (log Z)
    c1_leading2D_1Subjet->cd(2);
    gPad->SetLeftMargin(0.16); gPad->SetRightMargin(0.16); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    gPad->SetLogz();
    out2D_leading_1Subjet.hRate_vsThr_vsR->SetTitle(";Leading JetTagger LRJ E_{T} threshold [GeV];Max. #psi_{R,lead};Estimated Background Rate [Hz] [1 SUBJET ONLY]");
    out2D_leading_1Subjet.hRate_vsThr_vsR->Draw("COLZ");
    c1_leading2D_1Subjet->SaveAs(rateVsEffFileDir + "surfaces_ETthr_vs_psi_R_leading_1Subjet.pdf");

    // Main plot: rate vs efficiency (all points from the 2D scan)
    auto c2_leading2D_1Subjet = new TCanvas("c2_leading2D_1Subjet","Rate vs Eff (2D scan, leading)",700,600);
    c2_leading2D_1Subjet->SetLeftMargin(0.16); c2_leading2D_1Subjet->SetBottomMargin(0.16); c2_leading2D_1Subjet->SetTicks(1,1);
    c2_leading2D_1Subjet->SetLogy();
    out2D_leading_1Subjet.gRate_vsEff_all->Draw("AP");   // A=axes, P=points
    c2_leading2D_1Subjet->SaveAs(rateVsEffFileDir + "rate_vs_eff_scan2D_leading_1Subjet.pdf");*/

    // INSTEAD SCAN ONLY OVER E_T FOR 1 SUBJET CASE!
    auto out_1subjetEtScan = MakeRateVsEff(sig_h_leading_LRJ_Et_With1ConeSubjet, back_h_leading_LRJ_Et_With1ConeSubjet);

    // Titles & colors for TH1s
    SetAxes(out_1subjetEtScan.hEff_vsThr ->GetXaxis(), "Leading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out_1subjetEtScan.hEff_vsThr ->GetYaxis(), "Signal (hh#rightarrow4b) Efficiency [1 SUBJET ONLY]");
    SetAxes(out_1subjetEtScan.hRate_vsThr->GetXaxis(), "Leading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out_1subjetEtScan.hRate_vsThr->GetYaxis(), "Estimated Background Rate [Hz] [1 SUBJET ONLY]");

    // Titles & colors for TGraph
    SetAxes(out_1subjetEtScan.gRate_vsEff->GetXaxis(), "Signal (hh#rightarrow4b) Efficiency [1 SUBJET ONLY]");
    SetAxes(out_1subjetEtScan.gRate_vsEff->GetYaxis(), "Estimated Background Rate [Hz] [1 SUBJET ONLY]");

    // Optional: vs-threshold views
    auto c1_1Subjet = new TCanvas("c1_1Subjet","vs threshold",1200,500);
    c1_1Subjet->Divide(2,1);
    c1_1Subjet->cd(1);
    gPad->SetLeftMargin(0.16); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    out_1subjetEtScan.hEff_vsThr->Draw("HIST");  // draw as histogram
    c1_1Subjet->cd(2);
    gPad->SetLeftMargin(0.16); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    gPad->SetLogy();
    out_1subjetEtScan.hRate_vsThr->Draw("HIST");
    c1_1Subjet->SaveAs(rateVsEffFileDir + "threshold_views_1Subjet_EtScan.pdf");

    // Main plot: rate vs efficiency (graph)
    auto c2_1Subjet = new TCanvas("c2_1Subjet","Rate vs Eff",700,600);
    c2_1Subjet->SetLeftMargin(0.16); c2_1Subjet->SetBottomMargin(0.16); c2_1Subjet->SetTicks(1,1);
    c2_1Subjet->SetLogy();
    out_1subjetEtScan.gRate_vsEff->Draw("AP");   // A=axes, P=points
    c2_1Subjet->SaveAs(rateVsEffFileDir + "rate_vs_eff_1Subjet_EtScan.pdf");

    // ===================== LEADING (ET_th vs Mass Approx [>= 2 Subjets!]) =======================
    auto out2D_leading_GrEq2Subjets = MakeRateVsEff_ScanRMin(
        sigJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet,    backJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet      // R = psi_lead/psi_subl
        //sigJetTaggerLeadingLRJEtvsDeltaRSubjets_WithGrEq2ConeSubjet,    backJetTaggerLeadingLRJEtvsDeltaRSubjets_WithGrEq2ConeSubjet
    );

    // Axis titles
    SetAxes(out2D_leading_GrEq2Subjets.hEff_vsThr_vsR ->GetXaxis(), "Leading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_leading_GrEq2Subjets.hEff_vsThr_vsR ->GetYaxis(), "Approx. Mass [>= 2 SUBJETS ONLY]");
    SetAxes(out2D_leading_GrEq2Subjets.hRate_vsThr_vsR->GetXaxis(), "Leading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_leading_GrEq2Subjets.hRate_vsThr_vsR->GetYaxis(), "Approx. Mass [>= 2 SUBJETS ONLY]");

    SetAxes(out2D_leading_GrEq2Subjets.gRate_vsEff_all->GetXaxis(), "Signal (hh#rightarrow4b) Efficiency [>= 2 SUBJETS ONLY]");
    SetAxes(out2D_leading_GrEq2Subjets.gRate_vsEff_all->GetYaxis(), "Estimated Background Rate [Hz] [>= 2 SUBJETS ONLY]");

    

    // 2D "vs-threshold & Rmax" views (surfaces)
    auto c1_leading2D_GrEq2Subjets = new TCanvas("c1_leading2D_GrEq2Subjets","ET_thr vs Rmax surfaces",1200,520);
    c1_leading2D_GrEq2Subjets->Divide(2,1);

    // Efficiency surface
    c1_leading2D_GrEq2Subjets->cd(1);
    gPad->SetLeftMargin(0.16); gPad->SetRightMargin(0.18); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    out2D_leading_GrEq2Subjets.hEff_vsThr_vsR->SetTitle(";Leading JetTagger LRJ E_{T} threshold [GeV];Min. Approx. Mass;Signal (hh#rightarrow4b) Efficiency [>= 2 SUBJETS ONLY]");
    out2D_leading_GrEq2Subjets.hEff_vsThr_vsR->Draw("COLZ");

    // Background-rate surface (log Z)
    c1_leading2D_GrEq2Subjets->cd(2);
    gPad->SetLeftMargin(0.16); gPad->SetRightMargin(0.16); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    gPad->SetLogz();
    out2D_leading_GrEq2Subjets.hRate_vsThr_vsR->SetTitle(";Leading JetTagger LRJ E_{T} threshold [GeV];Min. Approx. Mass;Estimated Background Rate [Hz] [>= 2 SUBJETS ONLY]");
    out2D_leading_GrEq2Subjets.hRate_vsThr_vsR->Draw("COLZ");
    c1_leading2D_GrEq2Subjets->SaveAs(rateVsEffFileDir + "surfaces_ETthr_vs_approxMass_GrEq2Subjets.pdf");

    // Main plot: rate vs efficiency (all points from the 2D scan)
    auto c2_leading2D_GrEq2Subjets = new TCanvas("c2_leading2D_GrEq2Subjets","Rate vs Eff (2D scan, leading)",700,600);
    c2_leading2D_GrEq2Subjets->SetLeftMargin(0.16); c2_leading2D_GrEq2Subjets->SetBottomMargin(0.16); c2_leading2D_GrEq2Subjets->SetTicks(1,1);
    c2_leading2D_GrEq2Subjets->SetLogy();
    out2D_leading_GrEq2Subjets.gRate_vsEff_all->Draw("AP");   // A=axes, P=points
    c2_leading2D_GrEq2Subjets->SaveAs(rateVsEffFileDir + "rate_vs_eff_scan2D_leading_GrEq2Subjets.pdf");
    if(leadingLRJSubjetScan){
        // Compute combined curve & best point for rate <= 10 kHz
        auto globalOut = MakeCombinedRateVsEff_AllSubjets(
            out_0subjetEtScan,
            out_1subjetEtScan,
            out2D_leading_GrEq2Subjets,
            sig_h_leading_LRJ_Et_NoConeSubjets,   
            sig_h_leading_LRJ_Et_With1ConeSubjet,          
            sigJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet, // >=2 subjets signal hist
            5.0e4  // 25 kHz
        );

        // Print best selections to stdout
        std::cout << "Best combined point with total rate <= 10 kHz:\n"
            << "  Global eff = " << globalOut.bestEff << "\n"
            << "  Total rate = " << globalOut.bestRate << " Hz\n"
            << "  Selections:\n"
            << "    0 subjets   : ET > " << globalOut.bestEtCut_0   << " GeV\n"
            << "    1 subjet    : ET > " << globalOut.bestEtCut_1   << " GeV\n"
            << "    >=2 subjets : ET > " << globalOut.bestEtCut_2
            << " GeV, massApprox > " << globalOut.bestMassCut_2 << " GeV\n"
            << "  Per-category at best point:\n"
            << "    0 subjets   : eff_cat = " << globalOut.bestEff0_cat
            << ", eff_tot = " << globalOut.bestEff0_tot
            << ", rate = " << globalOut.bestRate0 << " Hz\n"
            << "    1 subjet    : eff_cat = " << globalOut.bestEff1_cat
            << ", eff_tot = " << globalOut.bestEff1_tot
            << ", rate = " << globalOut.bestRate1 << " Hz\n"
            << "    >=2 subjets : eff_cat = " << globalOut.bestEff2_cat
            << ", eff_tot = " << globalOut.bestEff2_tot
            << ", rate = " << globalOut.bestRate2 << " Hz\n";


        auto c_combined = new TCanvas("c_combined","Combined Rate vs Eff",700,600);
        c_combined->SetLeftMargin(0.16);
        c_combined->SetBottomMargin(0.16);
        c_combined->SetTicks(1,1);
        c_combined->SetLogy();

        // Draw frontier
        globalOut.gRate_vsEff_combined->Draw("AP");

        // Highlight the best point
        auto* gBest = new TGraph();
        gBest->SetPoint(0, globalOut.bestEff, globalOut.bestRate);
        gBest->SetMarkerStyle(20);
        gBest->SetMarkerSize(1.5);
        gBest->Draw("P SAME");

        // Text box with selections + per-category efficiencies & rates
        auto* pt = new TPaveText(0.18, 0.18, 0.82, 0.82, "NDC");
        pt->SetFillColor(0);
        pt->SetBorderSize(1);
        //pt->SetTextSize(0.03);
        pt->SetTextFont(53); // Pixel-based font
        pt->SetTextSize(15); // Size in pixels

        pt->AddText(Form("Best point (rate #leq 10 kHz):"));
        pt->AddText(Form("#varepsilon_{tot} = %.3f, Rate_{tot} = %.1f Hz",
                        globalOut.bestEff, globalOut.bestRate));

        pt->AddText(Form("  0 subjets: E_{T} > %.1f GeV", globalOut.bestEtCut_0));
        pt->AddText(Form("  eff_{cat} = %.3f, eff_{tot} = %.3f, Rate_{0} = %.1f Hz",
                        globalOut.bestEff0_cat, globalOut.bestEff0_tot, globalOut.bestRate0));

        pt->AddText(Form("  1 subjet:  E_{T} > %.1f GeV", globalOut.bestEtCut_1));
        pt->AddText(Form("  eff_{cat} = %.3f, eff_{tot} = %.3f, Rate_{1} = %.1f Hz",
                        globalOut.bestEff1_cat, globalOut.bestEff1_tot, globalOut.bestRate1));

        pt->AddText(Form("  #geq 2 subjets: E_{T} > %.1f GeV, m_{approx} > %.3f GeV",
                        globalOut.bestEtCut_2, globalOut.bestMassCut_2));
        pt->AddText(Form("  eff_{cat} = %.3f, eff_{tot} = %.3f, Rate_{2} = %.1f Hz",
                        globalOut.bestEff2_cat, globalOut.bestEff2_tot, globalOut.bestRate2));

        pt->Draw("SAME");

        c_combined->SaveAs(rateVsEffFileDir + "rate_vs_eff_combined_allSubjets.pdf");
    }
    

    // Rates vs. Eff - selectons based on number of subjets using LEADING & SUBLEADING
    // Rates vs. Eff with different selections based on the number of subjets. // FIXME might need to split the 5 different selections into 9 for each case individually - might not be independent. 
    auto out_0subjetEtScan_LeadingEt = MakeRateVsEff(sig_h_leading_LRJ_Et_NoConeSubjets_Lead_or_1ConeJetLead, back_h_leading_LRJ_Et_NoConeSubjets_Lead_or_1ConeJetLead);

    // Titles & colors for TH1s
    SetAxes(out_0subjetEtScan_LeadingEt.hEff_vsThr ->GetXaxis(), "Leading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out_0subjetEtScan_LeadingEt.hEff_vsThr ->GetYaxis(), "Signal (hh#rightarrow4b) Efficiency [1 SUBJETS ONLY]");
    SetAxes(out_0subjetEtScan_LeadingEt.hRate_vsThr->GetXaxis(), "Leading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out_0subjetEtScan_LeadingEt.hRate_vsThr->GetYaxis(), "Estimated Background Rate [Hz] [1 SUBJETS ONLY]");

    // Titles & colors for TGraph
    SetAxes(out_0subjetEtScan_LeadingEt.gRate_vsEff->GetXaxis(), "Signal (hh#rightarrow4b) Efficiency [1 SUBJETS ONLY]");
    SetAxes(out_0subjetEtScan_LeadingEt.gRate_vsEff->GetYaxis(), "Estimated Background Rate [Hz] [1 SUBJETS ONLY]");

    // Optional: vs-threshold views
    auto c1_0Subjets_Leading  = new TCanvas("c1_0Subjets_Leading ","vs threshold",1200,500);
    c1_0Subjets_Leading ->Divide(2,1);
    c1_0Subjets_Leading ->cd(1);
    gPad->SetLeftMargin(0.16); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    out_0subjetEtScan_LeadingEt.hEff_vsThr->Draw("HIST");  // draw as histogram
    c1_0Subjets_Leading ->cd(2);
    gPad->SetLeftMargin(0.16); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    gPad->SetLogy();
    out_0subjetEtScan_LeadingEt.hRate_vsThr->Draw("HIST");
    c1_0Subjets_Leading ->SaveAs(rateVsEffFileDir + "threshold_views_0or1subjets_EtScan_Leading.pdf");

    // Main plot: rate vs efficiency (graph)
    auto c2_0Subjets_Leading = new TCanvas("c2_0Subjets_Leading ","Rate vs Eff",700,600);
    c2_0Subjets_Leading ->SetLeftMargin(0.16); c2_0Subjets_Leading ->SetBottomMargin(0.16); c2_0Subjets_Leading ->SetTicks(1,1);
    c2_0Subjets_Leading ->SetLogy();
    out_0subjetEtScan_LeadingEt.gRate_vsEff->Draw("AP");   // A=axes, P=points
    c2_0Subjets_Leading ->SaveAs(rateVsEffFileDir + "rate_vs_eff_0or1subjets_EtScan_Leading.pdf");

    // Rates vs. Eff with different selections based on the number of subjets.
    auto out_0subjetEtScan_SubleadingEt = MakeRateVsEff(sig_h_subleading_LRJ_Et_1ConeSubjet_Lead_or_1ConeJetLead_Sublead, back_h_subleading_LRJ_Et_1ConeSubjet_Lead_or_1ConeJetLead_Sublead);

    // Titles & colors for TH1s
    SetAxes(out_0subjetEtScan_SubleadingEt.hEff_vsThr ->GetXaxis(), "Subleading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out_0subjetEtScan_SubleadingEt.hEff_vsThr ->GetYaxis(), "Signal (hh#rightarrow4b) Efficiency [0, 1 SUBJETS ONLY]");
    SetAxes(out_0subjetEtScan_SubleadingEt.hRate_vsThr->GetXaxis(), "Subleading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out_0subjetEtScan_SubleadingEt.hRate_vsThr->GetYaxis(), "Estimated Background Rate [Hz] [0, 1 SUBJETS ONLY]");

    // Titles & colors for TGraph
    SetAxes(out_0subjetEtScan_SubleadingEt.gRate_vsEff->GetXaxis(), "Signal (hh#rightarrow4b) Efficiency [0, 1 SUBJETS ONLY]");
    SetAxes(out_0subjetEtScan_SubleadingEt.gRate_vsEff->GetYaxis(), "Estimated Background Rate [Hz] [0, 1 SUBJETS ONLY]");

    // Optional: vs-threshold views
    auto c1_0Subjets_Subleading  = new TCanvas("c1_0Subjets_Subleading ","vs threshold",1200,500);
    c1_0Subjets_Subleading ->Divide(2,1);
    c1_0Subjets_Subleading ->cd(1);
    gPad->SetLeftMargin(0.16); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    out_0subjetEtScan_SubleadingEt.hEff_vsThr->Draw("HIST");  // draw as histogram
    c1_0Subjets_Subleading ->cd(2);
    gPad->SetLeftMargin(0.16); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    gPad->SetLogy();
    out_0subjetEtScan_SubleadingEt.hRate_vsThr->Draw("HIST");
    c1_0Subjets_Subleading ->SaveAs(rateVsEffFileDir + "threshold_views_0or1subjets_EtScan_Subleading.pdf");

    // Main plot: rate vs efficiency (graph)
    auto c2_0Subjets_Subleading = new TCanvas("c2_0Subjets_Subleading ","Rate vs Eff",700,600);
    c2_0Subjets_Subleading ->SetLeftMargin(0.16); c2_0Subjets_Subleading ->SetBottomMargin(0.16); c2_0Subjets_Subleading ->SetTicks(1,1);
    c2_0Subjets_Subleading ->SetLogy();
    out_0subjetEtScan_SubleadingEt.gRate_vsEff->Draw("AP");   // A=axes, P=points
    c2_0Subjets_Subleading ->SaveAs(rateVsEffFileDir + "rate_vs_eff_0or1subjets_EtScan_Subleading.pdf");
    
    // FIXME update naming scheme within this scope
    {// Rates vs. Eff with different selections based on the number of subjets.
    
    }




    // FIXME allow controlling whether scanning over mass approx or tau21 - probably don't want to do both here as very computationally expensive
    // ===================== LEADING (ET_th vs Mass Approx [>= 2 Subjets!]) =======================
    auto out2D_leading_GrEq2Subjets_LeadingOnly = MakeRateVsEff_ScanRMin( 
        sigJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Lead,    backJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Lead      // R = psi_lead/psi_subl
    //    //sigJetTaggerLeadingLRJEtvsDeltaRSubjets_WithGrEq2ConeSubjet,    backJetTaggerLeadingLRJEtvsDeltaRSubjets_WithGrEq2ConeSubjet
    );

    //auto out2D_leading_GrEq2Subjets_LeadingOnly = MakeRateVsEff_ScanRMax(
    //    sigJetTaggerLeadingLRJEtvsTau21_WithGrEq2ConeSubjet_Lead,    backJetTaggerLeadingLRJEtvsTau21_WithGrEq2ConeSubjet_Lead      // R = psi_lead/psi_subl
    //);

    // Axis titles
    SetAxes(out2D_leading_GrEq2Subjets_LeadingOnly.hEff_vsThr_vsR ->GetXaxis(), "Leading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_leading_GrEq2Subjets_LeadingOnly.hEff_vsThr_vsR ->GetYaxis(), "Approx. Mass [>= 2 lead SUBJETS]");
    SetAxes(out2D_leading_GrEq2Subjets_LeadingOnly.hRate_vsThr_vsR->GetXaxis(), "Leading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_leading_GrEq2Subjets_LeadingOnly.hRate_vsThr_vsR->GetYaxis(), "Approx. Mass [>= 2 lead SUBJETS]");

    SetAxes(out2D_leading_GrEq2Subjets_LeadingOnly.gRate_vsEff_all->GetXaxis(), "Signal (hh#rightarrow4b) Efficiency [>= 2 lead SUBJETS]");
    SetAxes(out2D_leading_GrEq2Subjets_LeadingOnly.gRate_vsEff_all->GetYaxis(), "Estimated Background Rate [Hz] [>= 2 lead SUBJETS]");

    

    // 2D "vs-threshold & Rmax" views (surfaces)
    auto c1_leading2D_GrEq2Subjets_LeadingOnly = new TCanvas("c1_leading2D_GrEq2Subjets_LeadingOnly","ET_thr vs Rmax surfaces",1200,520);
    c1_leading2D_GrEq2Subjets_LeadingOnly->Divide(2,1);

    // Efficiency surface
    c1_leading2D_GrEq2Subjets_LeadingOnly->cd(1);
    gPad->SetLeftMargin(0.16); gPad->SetRightMargin(0.18); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    out2D_leading_GrEq2Subjets_LeadingOnly.hEff_vsThr_vsR->SetTitle(";Leading JetTagger LRJ E_{T} threshold [GeV];Min. Approx. Mass;Signal (hh#rightarrow4b) Efficiency [>= 2 lead SUBJETS]");
    out2D_leading_GrEq2Subjets_LeadingOnly.hEff_vsThr_vsR->Draw("COLZ");

    // Background-rate surface (log Z)
    c1_leading2D_GrEq2Subjets_LeadingOnly->cd(2);
    gPad->SetLeftMargin(0.16); gPad->SetRightMargin(0.16); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    gPad->SetLogz();
    out2D_leading_GrEq2Subjets_LeadingOnly.hRate_vsThr_vsR->SetTitle(";Leading JetTagger LRJ E_{T} threshold [GeV];Min. Approx. Mass;Estimated Background Rate [Hz] [>= 2 lead SUBJETS]");
    out2D_leading_GrEq2Subjets_LeadingOnly.hRate_vsThr_vsR->Draw("COLZ");
    c1_leading2D_GrEq2Subjets_LeadingOnly->SaveAs(rateVsEffFileDir + "surfaces_ETthr_vs_approxMass_GrEq2Subjets_LeadingOnly.pdf");

    // Main plot: rate vs efficiency (all points from the 2D scan)
    auto c2_leading2D_GrEq2Subjets_LeadingOnly = new TCanvas("c2_leading2D_GrEq2Subjets_LeadingOnly","Rate vs Eff (2D scan, leading)",700,600);
    c2_leading2D_GrEq2Subjets_LeadingOnly->SetLeftMargin(0.16); c2_leading2D_GrEq2Subjets_LeadingOnly->SetBottomMargin(0.16); c2_leading2D_GrEq2Subjets_LeadingOnly->SetTicks(1,1);
    c2_leading2D_GrEq2Subjets_LeadingOnly->SetLogy();
    out2D_leading_GrEq2Subjets_LeadingOnly.gRate_vsEff_all->Draw("AP");   // A=axes, P=points
    c2_leading2D_GrEq2Subjets_LeadingOnly->SaveAs(rateVsEffFileDir + "rate_vs_eff_scan2D_leading_GrEq2Subjets_LeadingOnly.pdf");

    // ===================== LEADING (ET_th vs Mass Approx [>= 2 Subjets!]) =======================
    auto out2D_leading_GrEq2Subjets_SubleadingOnly = MakeRateVsEff_ScanRMin(
        sigJetTaggerSubleadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Sublead,    backJetTaggerSubleadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Sublead      // R = psi_lead/psi_subl
    );

    //auto out2D_leading_GrEq2Subjets_SubleadingOnly = MakeRateVsEff_ScanRMax(
    //    sigJetTaggerSubleadingLRJEtvsTau21_WithGrEq2ConeSubjet_Sublead,    backJetTaggerSubleadingLRJEtvsTau21_WithGrEq2ConeSubjet_Sublead      // R = psi_lead/psi_subl
    //);

    // Axis titles
    SetAxes(out2D_leading_GrEq2Subjets_SubleadingOnly.hEff_vsThr_vsR ->GetXaxis(), "Subleading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_leading_GrEq2Subjets_SubleadingOnly.hEff_vsThr_vsR ->GetYaxis(), "Approx. Mass [>= 2 subl SUBJETS]");
    SetAxes(out2D_leading_GrEq2Subjets_SubleadingOnly.hRate_vsThr_vsR->GetXaxis(), "Subleading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_leading_GrEq2Subjets_SubleadingOnly.hRate_vsThr_vsR->GetYaxis(), "Approx. Mass [>= 2 subl SUBJETS]");

    SetAxes(out2D_leading_GrEq2Subjets_SubleadingOnly.gRate_vsEff_all->GetXaxis(), "Signal (hh#rightarrow4b) Efficiency [>= 2 subl SUBJETS]");
    SetAxes(out2D_leading_GrEq2Subjets_SubleadingOnly.gRate_vsEff_all->GetYaxis(), "Estimated Background Rate [Hz] [>= 2 subl SUBJETS]");

    

    // 2D "vs-threshold & Rmax" views (surfaces)
    auto c1_leading2D_GrEq2Subjets_SubleadingOnly = new TCanvas("c1_leading2D_GrEq2Subjets_SubleadingOnly","ET_thr vs Rmax surfaces",1200,520);
    c1_leading2D_GrEq2Subjets_SubleadingOnly->Divide(2,1);

    // Efficiency surface
    c1_leading2D_GrEq2Subjets_SubleadingOnly->cd(1);
    gPad->SetLeftMargin(0.16); gPad->SetRightMargin(0.18); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    out2D_leading_GrEq2Subjets_SubleadingOnly.hEff_vsThr_vsR->SetTitle(";Subleading JetTagger LRJ E_{T} threshold [GeV];Min. Approx. Mass;Signal (hh#rightarrow4b) Efficiency [>= 2 subl SUBJETS]");
    out2D_leading_GrEq2Subjets_SubleadingOnly.hEff_vsThr_vsR->Draw("COLZ");

    // Background-rate surface (log Z)
    c1_leading2D_GrEq2Subjets_SubleadingOnly->cd(2);
    gPad->SetLeftMargin(0.16); gPad->SetRightMargin(0.16); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    gPad->SetLogz();
    out2D_leading_GrEq2Subjets_SubleadingOnly.hRate_vsThr_vsR->SetTitle(";Subleading JetTagger LRJ E_{T} threshold [GeV];Min. Approx. Mass;Estimated Background Rate [Hz] [>= 2 subl SUBJETS]");
    out2D_leading_GrEq2Subjets_SubleadingOnly.hRate_vsThr_vsR->Draw("COLZ");
    c1_leading2D_GrEq2Subjets_SubleadingOnly->SaveAs(rateVsEffFileDir + "surfaces_ETthr_vs_approxMass_GrEq2Subjets_SubleadingOnly.pdf");

    // Main plot: rate vs efficiency (all points from the 2D scan)
    auto c2_leading2D_GrEq2Subjets_SubleadingOnly = new TCanvas("c2_leading2D_GrEq2Subjets_SubleadingOnly","Rate vs Eff (2D scan, leading)",700,600);
    c2_leading2D_GrEq2Subjets_SubleadingOnly->SetLeftMargin(0.16); c2_leading2D_GrEq2Subjets_SubleadingOnly->SetBottomMargin(0.16); c2_leading2D_GrEq2Subjets_SubleadingOnly->SetTicks(1,1);
    c2_leading2D_GrEq2Subjets_SubleadingOnly->SetLogy();
    out2D_leading_GrEq2Subjets_SubleadingOnly.gRate_vsEff_all->Draw("AP");   // A=axes, P=points
    c2_leading2D_GrEq2Subjets_SubleadingOnly->SaveAs(rateVsEffFileDir + "rate_vs_eff_scan2D_leading_GrEq2Subjets_SubleadingOnly.pdf");

    auto out2D_leading_GrEq2Subjets_Both = MakeRateVsEff_ScanRMax(
        sigJetTaggerLeadingLRJEtvsTau21_WithGrEq2ConeSubjet_Lead_Sublead,    backJetTaggerLeadingLRJEtvsTau21_WithGrEq2ConeSubjet_Lead_Sublead      // R = psi_lead/psi_subl
    );

    // Axis titles
    SetAxes(out2D_leading_GrEq2Subjets_Both.hEff_vsThr_vsR ->GetXaxis(), "Leading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_leading_GrEq2Subjets_Both.hEff_vsThr_vsR ->GetYaxis(), "Tau21 Product Mass [>= 2 subl SUBJETS]");
    SetAxes(out2D_leading_GrEq2Subjets_Both.hRate_vsThr_vsR->GetXaxis(), "Leading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_leading_GrEq2Subjets_Both.hRate_vsThr_vsR->GetYaxis(), "Tau21 Product [>= 2 SUBJETS]");

    SetAxes(out2D_leading_GrEq2Subjets_Both.gRate_vsEff_all->GetXaxis(), "Signal (hh#rightarrow4b) Efficiency [>= 2 subl SUBJETS]");
    SetAxes(out2D_leading_GrEq2Subjets_Both.gRate_vsEff_all->GetYaxis(), "Estimated Background Rate [Hz] [>= 2 subl SUBJETS]");

    

    // 2D "vs-threshold & Rmax" views (surfaces)
    auto c1_leading2D_GrEq2Subjets_Both = new TCanvas("c1_leading2D_GrEq2Subjets_Both","ET_thr vs Rmax surfaces",1200,520);
    c1_leading2D_GrEq2Subjets_Both->Divide(2,1);

    // Efficiency surface
    c1_leading2D_GrEq2Subjets_Both->cd(1);
    gPad->SetLeftMargin(0.16); gPad->SetRightMargin(0.18); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    out2D_leading_GrEq2Subjets_Both.hEff_vsThr_vsR->SetTitle(";Subleading JetTagger LRJ E_{T} threshold [GeV];Max. Tau21 Product;Signal (hh#rightarrow4b) Efficiency [>= 2 SUBJETS]");
    out2D_leading_GrEq2Subjets_Both.hEff_vsThr_vsR->Draw("COLZ");

    // Background-rate surface (log Z)
    c1_leading2D_GrEq2Subjets_Both->cd(2);
    gPad->SetLeftMargin(0.16); gPad->SetRightMargin(0.16); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    gPad->SetLogz();
    out2D_leading_GrEq2Subjets_Both.hRate_vsThr_vsR->SetTitle(";Subleading JetTagger LRJ E_{T} threshold [GeV];Max. Tau21 Product;Estimated Background Rate [Hz] [>= 2 SUBJETS]");
    out2D_leading_GrEq2Subjets_Both.hRate_vsThr_vsR->Draw("COLZ");
    c1_leading2D_GrEq2Subjets_Both->SaveAs(rateVsEffFileDir + "surfaces_ETthr_vs_approxMass_GrEq2Subjets_Tau21Product.pdf");

    // Main plot: rate vs efficiency (all points from the 2D scan)
    auto c2_leading2D_GrEq2Subjets_Both = new TCanvas("c2_leading2D_GrEq2Subjets_Both","Rate vs Eff (2D scan, leading)",700,600);
    c2_leading2D_GrEq2Subjets_Both->SetLeftMargin(0.16); c2_leading2D_GrEq2Subjets_Both->SetBottomMargin(0.16); c2_leading2D_GrEq2Subjets_Both->SetTicks(1,1);
    c2_leading2D_GrEq2Subjets_Both->SetLogy();
    out2D_leading_GrEq2Subjets_Both.gRate_vsEff_all->Draw("AP");   // A=axes, P=points
    c2_leading2D_GrEq2Subjets_Both->SaveAs(rateVsEffFileDir + "rate_vs_eff_scan2D_leading_GrEq2Subjets_Tau21Product.pdf");

    auto out3D_sublead_GrEq2Subjets_Lead_Sublead = MakeRateVsEff_Scan3DMin(
        sigJetTaggerSubleadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Lead_Sublead,
        backJetTaggerSubleadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Lead_Sublead);


    // 3D efficiency histogram
    SetAxes(out3D_sublead_GrEq2Subjets_Lead_Sublead.gRate_vsEff_frontier->GetXaxis(),
        "Signal (hh#rightarrow4b) Efficiency [>= 2 lead & subl SUBJETS]");
    SetAxes(out3D_sublead_GrEq2Subjets_Lead_Sublead.gRate_vsEff_frontier->GetYaxis(),
            "Estimated Background Rate [Hz] [>= 2 lead & subl SUBJETS]");

    auto c_rateEff_3D_frontier = new TCanvas("c_rateEff_3D_frontier",
        "Rate vs Eff (3D scan frontier: sublead Et, lead mass, sublead mass)",
        700, 600);
    c_rateEff_3D_frontier->SetLeftMargin(0.16);
    c_rateEff_3D_frontier->SetBottomMargin(0.16);
    c_rateEff_3D_frontier->SetTicks(1,1);
    c_rateEff_3D_frontier->SetLogy();

    out3D_sublead_GrEq2Subjets_Lead_Sublead.gRate_vsEff_frontier->Draw("AP");
    c_rateEff_3D_frontier->SaveAs(
        rateVsEffFileDir + "rate_vs_eff_scan3D_frontier_subleadingEt_leadSubleadMass_GrEq2Subjets.pdf");
    bool ScanNSubjetiness_5 = false;
    // For scan over N subjetiness 
    if(ScanNSubjetiness_5){
        // --- output name ---
        const TString outPdf = rateVsEffFileDir + "rate_vs_eff_combined_5selections.pdf";


        // For scan over N subjetiness 
        auto global5 = MakeCombinedRateVsEff_AllFive_NSubjetiness(
            out_0subjetEtScan_LeadingEt,
            out_0subjetEtScan_SubleadingEt,
            out2D_leading_GrEq2Subjets_LeadingOnly,
            out2D_leading_GrEq2Subjets_SubleadingOnly,
            out2D_leading_GrEq2Subjets_Both,
            sig_h_leading_LRJ_Et_NoConeSubjets_Lead_or_1ConeJetLead,
            sig_h_subleading_LRJ_Et_1ConeSubjet_Lead_or_1ConeJetLead_Sublead,
            sigJetTaggerLeadingLRJEtvsTau21_WithGrEq2ConeSubjet_Lead,
            sigJetTaggerSubleadingLRJEtvsTau21_WithGrEq2ConeSubjet_Sublead,
            sigJetTaggerLeadingLRJEtvsTau21_WithGrEq2ConeSubjet_Lead_Sublead,
            5.0e4,  // 25 kHz for plotting
            1.0e4   // 10 kHz for printing
        );

        std::cout << "Best combined point with total rate <= 10 kHz:\n"
                << "  Global eff = " << global5.bestEff << "\n"
                << "  Total rate = " << global5.bestRate << " Hz\n"
                << "  Selections:\n"
                << "    (0) 1 subjets lead/sublead, leading Et   : Et > " << global5.bestEtCut_0_lead << " GeV\n"
                << "    (1) 0/1 subjets, subleading Et: Et > " << global5.bestEtCut_0_sub  << " GeV\n"
                << "    (2) >=2 lead subjets          : Et > " << global5.bestEtCut_lead2
                << " GeV, #tau_{21} < " << global5.bestMassCut_lead2 << " GeV\n"
                << "    (3) >=2 subl subjets          : Et > " << global5.bestEtCut_sub2
                << " GeV, #tau_{21} < " << global5.bestMassCut_sub2 << " GeV\n"
                << "    (4) >=2 lead & subl subjets   : Et_sub > " << global5.bestEtCut_3D_sub
                << " GeV, #tau_{21} product < " << global5.bestMassCut_3D_lead << " GeV\n"
                << "  Per-category at best point (cat, eff_cat, eff_tot, rate [Hz]):\n";

        for (int c = 0; c < 5; ++c) {
        std::cout << "    cat " << c
                    << ": eff_cat = " << global5.bestEff_cat[c]
                    << ", eff_tot = " << global5.bestEff_tot[c]
                    << ", rate = "    << global5.bestRate_cat[c] << " Hz\n";
        }

        // --- PAGE 1: the plot ---
        auto c_combined5 = new TCanvas("c_combined5","Combined Rate vs Eff (5 selections)",700,600);
        c_combined5->SetLeftMargin(0.16);
        c_combined5->SetBottomMargin(0.16);
        c_combined5->SetTicks(1,1);
        c_combined5->SetLogy();

        global5.gRate_vsEff_combined->Draw("AP");

        // highlight best point
        auto* gBest5 = new TGraph();
        gBest5->SetPoint(0, global5.bestEff, global5.bestRate);
        gBest5->SetMarkerStyle(20);
        gBest5->SetMarkerSize(1.5);
        gBest5->Draw("P SAME");

        // open multipage pdf + print page 1
        c_combined5->Print(outPdf + "(");

        // --- PAGE 2: text-only canvas ---
        auto c_text5 = new TCanvas("c_text5","Summary (5 selections)",1400,900);
        c_text5->SetLeftMargin(0.08);
        c_text5->SetRightMargin(0.08);
        c_text5->SetTopMargin(0.06);
        c_text5->SetBottomMargin(0.06);

        // Big text box that fills most of the page
        auto* pt5 = new TPaveText(0.05, 0.05, 0.95, 1.0, "NDC");
        pt5->SetMargin(0.005); // default is ~0.05
        pt5->SetFillColor(0);
        pt5->SetBorderSize(1);
        pt5->SetTextAlign(12); // left-ish alignment
        pt5->SetTextFont(53); // Pixel-based font
        pt5->SetTextSize(15); // Size in pixels

        pt5->AddText(Form("Best point (Rate #leq 10 kHz): #varepsilon_{tot} = %.3f, Rate = %.1f Hz",
                        global5.bestEff, global5.bestRate));

        pt5->AddText(Form("(0) lead Et (0/1 subj): Et > %.1f GeV", global5.bestEtCut_0_lead));
        pt5->AddText(Form("f_{sig} = %.3f, eff_cat = %.3f, eff_tot = %.3f, Rate = %.1f Hz",
                        global5.fractionEventsPerCat[0],
                        global5.bestEff_cat[0], global5.bestEff_tot[0], global5.bestRate_cat[0]));

        pt5->AddText(Form("(1) subl Et (0/1 subj): Et > %.1f GeV", global5.bestEtCut_0_sub));
        pt5->AddText(Form("f_{sig} = %.3f, eff_cat = %.3f, eff_tot = %.3f, Rate = %.1f Hz",
                        global5.fractionEventsPerCat[1],
                        global5.bestEff_cat[1], global5.bestEff_tot[1], global5.bestRate_cat[1]));

        pt5->AddText(Form("(2) lead (>=2 subj): Et > %.1f GeV, #tau_{21} < %.2f",
                        global5.bestEtCut_lead2, global5.bestMassCut_lead2));
        pt5->AddText(Form("f_{sig} = %.3f, eff_cat = %.3f, eff_tot = %.3f, Rate = %.1f Hz",
                        global5.fractionEventsPerCat[2],
                        global5.bestEff_cat[2], global5.bestEff_tot[2], global5.bestRate_cat[2]));

        pt5->AddText(Form("(3) subl (>=2 subj): Et > %.1f GeV, #tau_{21} < %.2f",
                        global5.bestEtCut_sub2, global5.bestMassCut_sub2));
        pt5->AddText(Form("f_{sig} = %.3f, eff_cat = %.3f, eff_tot = %.3f, Rate = %.1f Hz",
                        global5.fractionEventsPerCat[3],
                        global5.bestEff_cat[3], global5.bestEff_tot[3], global5.bestRate_cat[3]));

        pt5->AddText(Form("(4) both (>=2 subj): E_{T} Lead. > %.1f GeV, #tau_{21} product < %.2f",
                        global5.bestEtCut_3D_sub, global5.bestMassCut_3D_lead));
        pt5->AddText(Form("f_{sig} = %.3f, eff_cat = %.3f, eff_tot = %.3f, Rate = %.1f Hz",
                        global5.fractionEventsPerCat[4],
                        global5.bestEff_cat[4], global5.bestEff_tot[4], global5.bestRate_cat[4]));

        pt5->Draw();

        // print page 2 + close pdf
        c_text5->Print(outPdf + ")");
    }
    else{
        if(substructure5CategoryScan){
            // --- output name ---
            const TString outPdf =
                rateVsEffFileDir + "rate_vs_eff_combined_5selections.pdf";

            // For scan over mass approximation
            auto global5 = MakeCombinedRateVsEff_AllFive(
                out_0subjetEtScan_LeadingEt,
                out_0subjetEtScan_SubleadingEt,
                out2D_leading_GrEq2Subjets_LeadingOnly,
                out2D_leading_GrEq2Subjets_SubleadingOnly,
                out3D_sublead_GrEq2Subjets_Lead_Sublead,
                sig_h_leading_LRJ_Et_NoConeSubjets_Lead_or_1ConeJetLead,
                sig_h_subleading_LRJ_Et_1ConeSubjet_Lead_or_1ConeJetLead_Sublead,
                sigJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Lead,
                sigJetTaggerSubleadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Sublead,
                sigJetTaggerSubleadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Lead_Sublead,
                2.5e4,  // 25 kHz for plotting
                1.0e4   // 10 kHz for printing
            );
            
            std::cout << "Best combined point with total rate <= 10 kHz:\n"
                    << "  Global eff = " << global5.bestEff << "\n"
                    << "  Total rate = " << global5.bestRate << " Hz\n"
                    << "  Selections:\n"
                    << "    (0) 0/1 subjets, leading Et   : Et > " << global5.bestEtCut_0_lead << " GeV\n"
                    << "    (1) 0/1 subjets, subleading Et: Et > " << global5.bestEtCut_0_sub  << " GeV\n"
                    << "    (2) >=2 lead subjets          : Et > " << global5.bestEtCut_lead2
                    << " GeV, m > " << global5.bestMassCut_lead2 << " GeV\n"
                    << "    (3) >=2 subl subjets          : Et > " << global5.bestEtCut_sub2
                    << " GeV, m > " << global5.bestMassCut_sub2 << " GeV\n"
                    << "    (4) >=2 lead & subl subjets   : Et_sub > " << global5.bestEtCut_3D_sub
                    << " GeV, m_lead > " << global5.bestMassCut_3D_lead
                    << " GeV, m_sub > "  << global5.bestMassCut_3D_sub << " GeV\n"
                    << "  Per-category at best point (cat, eff_cat, eff_tot, rate [Hz]):\n";

            for (int c = 0; c < 5; ++c) {
            std::cout << "    cat " << c
                        << ": eff_cat = " << global5.bestEff_cat[c]
                        << ", eff_tot = " << global5.bestEff_tot[c]
                        << ", rate = "    << global5.bestRate_cat[c] << " Hz\n";
            }
            // =======================
            // PAGE 1: PLOT ONLY
            // =======================
            auto c_combined5 = new TCanvas("c_combined5","Combined Rate vs Eff (5 selections)",700,600);
            c_combined5->SetLeftMargin(0.16);
            c_combined5->SetBottomMargin(0.16);
            c_combined5->SetTicks(1,1);
            c_combined5->SetLogy();

            global5.gRate_vsEff_combined->Draw("AP");

            // highlight best point
            auto* gBest5 = new TGraph();
            gBest5->SetPoint(0, global5.bestEff, global5.bestRate);
            gBest5->SetMarkerStyle(20);
            gBest5->SetMarkerSize(1.5);
            gBest5->Draw("P SAME");
            gStyle->SetPaperSize(20, 26);
            // open multipage pdf + write page 1
            c_combined5->Print(outPdf + "(");

            // =======================
            // PAGE 2: TEXT ONLY
            // =======================
            auto c_text5 = new TCanvas("c_text5","Summary (mass-approx selections)",1400,900);
            c_text5->SetLeftMargin(0.08);
            c_text5->SetRightMargin(0.08);
            c_text5->SetTopMargin(0.06);
            c_text5->SetBottomMargin(0.06);

            // --------------------
            // Build lines to print
            // --------------------
            std::vector<TString> lines;
            //lines.reserve(40);

            lines.push_back(Form("Best point (Rate #leq 10 kHz): #varepsilon_{tot} = %.3f, Rate = %.1f Hz",
                                global5.bestEff, global5.bestRate));

            lines.push_back(Form("(0) lead Et (0/1 subj): Et > %.1f GeV", global5.bestEtCut_0_lead));
            lines.push_back(Form("f_{sig} = %.3f, eff_{cat} = %.3f, eff_{tot} = %.3f, Rate = %.1f Hz",
                                global5.fractionEventsPerCat[0],
                                global5.bestEff_cat[0], global5.bestEff_tot[0], global5.bestRate_cat[0]));

            lines.push_back(Form("(1) subl Et (0/1 subj): Et > %.1f GeV", global5.bestEtCut_0_sub));
            lines.push_back(Form("f_{sig} = %.3f, eff_{cat} = %.3f, eff_{tot} = %.3f, Rate = %.1f Hz",
                                global5.fractionEventsPerCat[1],
                                global5.bestEff_cat[1], global5.bestEff_tot[1], global5.bestRate_cat[1]));

            lines.push_back(Form("(2) lead (>=2 subj): Et > %.1f GeV, m > %.1f GeV",
                                global5.bestEtCut_lead2, global5.bestMassCut_lead2));
            lines.push_back(Form("f_{sig} = %.3f, eff_{cat} = %.3f, eff_{tot} = %.3f, Rate = %.1f Hz",
                                global5.fractionEventsPerCat[2],
                                global5.bestEff_cat[2], global5.bestEff_tot[2], global5.bestRate_cat[2]));

            lines.push_back(Form("(3) subl (>=2 subj): Et > %.1f GeV, m > %.1f GeV",
                                global5.bestEtCut_sub2, global5.bestMassCut_sub2));
            lines.push_back(Form("f_{sig} = %.3f, eff_{cat} = %.3f, eff_{tot} = %.3f, Rate = %.1f Hz",
                                global5.fractionEventsPerCat[3],
                                global5.bestEff_cat[3], global5.bestEff_tot[3], global5.bestRate_cat[3]));

            lines.push_back(Form("(4) both (>=2 subj): Et_{sub} > %.1f GeV, m_{lead} > %.1f GeV, m_{sub} > %.1f GeV",
                                global5.bestEtCut_3D_sub,
                                global5.bestMassCut_3D_lead,
                                global5.bestMassCut_3D_sub));
            lines.push_back(Form("f_{sig} = %.3f, eff_{cat} = %.3f, eff_{tot} = %.3f, Rate = %.1f Hz",
                                global5.fractionEventsPerCat[4],
                                global5.bestEff_cat[4], global5.bestEff_tot[4], global5.bestRate_cat[4]));

            // --------------------
            // Draw with TLatex (RELIABLY fits: pixel font + pixel spacing)
            // --------------------
            TLatex lat;
            lat.SetNDC();
            lat.SetTextAlign(13);   // left + top
            lat.SetTextFont(43);    // pixel font (critical for predictable spacing)

            const double xL   = 0.07;
            const double yTop = 0.95;
            const double yBot = 0.06;

            const int n = (int)lines.size();

            // Pad height in pixels
            const double padPixH   = gPad->GetWh();
            const double availPixH = (yTop - yBot) * padPixH;

            // Choose a font size in pixels that guarantees fit (tune 0.750.90)
            const double linePix = availPixH / std::max(1, n);
            const int fontPix = std::max(5, (int)std::floor(0.2 * linePix));
            std::cout << "fontPix: " << fontPix << "\n";
            lat.SetTextSize(fontPix);

            // Step in NDC using pixel-derived spacing (matches font height)
            const double dy = (double)fontPix / padPixH;

            double y = yTop;
            for (const auto& s : lines) {
                if (s.Length() == 0) { y -= dy; continue; }  // blank line
                lat.DrawLatex(xL, y, s);
                y -= dy;
            }

            gStyle->SetPaperSize(40, 20);
            // write page 2 + close pdf
            c_text5->Print(outPdf + ")");
        }
        

        }

        // ============================
        // (A) lead>=2, sublead<2
        // ============================
        auto out_EtScan_A_leadGe2_subleadLt2 = MakeRateVsEff(
            /*sig*/ sig_h_leading_LRJ_Et_WithGrEq2ConeSubjet_Lead,
            /*bkg*/ back_h_leading_LRJ_Et_WithGrEq2ConeSubjet_Lead
        );

        // Titles & axes for TH1s
        SetAxes(out_EtScan_A_leadGe2_subleadLt2.hEff_vsThr->GetXaxis(),
                "Leading JetTagger LRJ E_{T} threshold [GeV]");
        SetAxes(out_EtScan_A_leadGe2_subleadLt2.hEff_vsThr->GetYaxis(),
                "Signal (hh#rightarrow4b) Efficiency [Lead #geq2 subjets, Sublead <2]");
        SetAxes(out_EtScan_A_leadGe2_subleadLt2.hRate_vsThr->GetXaxis(),
                "Leading JetTagger LRJ E_{T} threshold [GeV]");
        SetAxes(out_EtScan_A_leadGe2_subleadLt2.hRate_vsThr->GetYaxis(),
                "Estimated Background Rate [Hz] [Lead #geq2 subjets, Sublead <2]");

        // Titles & axes for TGraph
        SetAxes(out_EtScan_A_leadGe2_subleadLt2.gRate_vsEff->GetXaxis(),
                "Signal (hh#rightarrow4b) Efficiency [Lead #geq2 subjets, Sublead <2]");
        SetAxes(out_EtScan_A_leadGe2_subleadLt2.gRate_vsEff->GetYaxis(),
                "Estimated Background Rate [Hz] [Lead #geq2 subjets, Sublead <2]");

        // Optional: vs-threshold views
        auto c_thr_A_leadGe2_subleadLt2 = new TCanvas("c_thr_A_leadGe2_subleadLt2",
                                                    "A: vs threshold (lead>=2, sublead<2)",
                                                    1200, 500);
        c_thr_A_leadGe2_subleadLt2->Divide(2,1);

        c_thr_A_leadGe2_subleadLt2->cd(1);
        gPad->SetLeftMargin(0.16); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
        out_EtScan_A_leadGe2_subleadLt2.hEff_vsThr->Draw("HIST");

        c_thr_A_leadGe2_subleadLt2->cd(2);
        gPad->SetLeftMargin(0.16); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
        gPad->SetLogy();
        out_EtScan_A_leadGe2_subleadLt2.hRate_vsThr->Draw("HIST");

        c_thr_A_leadGe2_subleadLt2->SaveAs(
            rateVsEffFileDir + "threshold_views_EtScan_A_leadGe2_subleadLt2.pdf"
        );

        // Main plot: rate vs efficiency
        auto c_re_A_leadGe2_subleadLt2 = new TCanvas("c_re_A_leadGe2_subleadLt2",
                                                    "A: Rate vs Eff (lead>=2, sublead<2)",
                                                    700, 600);
        c_re_A_leadGe2_subleadLt2->SetLeftMargin(0.16);
        c_re_A_leadGe2_subleadLt2->SetBottomMargin(0.16);
        c_re_A_leadGe2_subleadLt2->SetTicks(1,1);
        c_re_A_leadGe2_subleadLt2->SetLogy();

        out_EtScan_A_leadGe2_subleadLt2.gRate_vsEff->Draw("AP");

        // Legend (selection label)
        auto leg_A = new TLegend(0.18, 0.78, 0.70, 0.88);
        leg_A->SetBorderSize(0);
        leg_A->SetFillStyle(0);
        leg_A->SetTextSize(0.03);
        leg_A->AddEntry(out_EtScan_A_leadGe2_subleadLt2.gRate_vsEff,
                        "A: Lead #geq 2 subjets, Sublead < 2 (E_{T}-only)",
                        "p");
        leg_A->Draw();

        c_re_A_leadGe2_subleadLt2->SaveAs(
            rateVsEffFileDir + "rate_vs_eff_EtScan_A_leadGe2_subleadLt2.pdf"
        );


        // ============================
        // (B) sublead>=2, lead<2
        // ============================
        auto out_EtScan_B_subleadGe2_leadLt2 = MakeRateVsEff(
            /*sig*/ sig_h_leading_LRJ_Et_WithGrEq2ConeSubjet_Sublead,
            /*bkg*/ back_h_leading_LRJ_Et_WithGrEq2ConeSubjet_Sublead
        );

        // Titles & axes for TH1s
        SetAxes(out_EtScan_B_subleadGe2_leadLt2.hEff_vsThr->GetXaxis(),
                "Subleading JetTagger LRJ E_{T} threshold [GeV]");
        SetAxes(out_EtScan_B_subleadGe2_leadLt2.hEff_vsThr->GetYaxis(),
                "Signal (hh#rightarrow4b) Efficiency [Sublead #geq2 subjets, Lead <2]");
        SetAxes(out_EtScan_B_subleadGe2_leadLt2.hRate_vsThr->GetXaxis(),
                "Subleading JetTagger LRJ E_{T} threshold [GeV]");
        SetAxes(out_EtScan_B_subleadGe2_leadLt2.hRate_vsThr->GetYaxis(),
                "Estimated Background Rate [Hz] [Sublead #geq2 subjets, Lead <2]");

        // Titles & axes for TGraph
        SetAxes(out_EtScan_B_subleadGe2_leadLt2.gRate_vsEff->GetXaxis(),
                "Signal (hh#rightarrow4b) Efficiency [Sublead #geq2 subjets, Lead <2]");
        SetAxes(out_EtScan_B_subleadGe2_leadLt2.gRate_vsEff->GetYaxis(),
                "Estimated Background Rate [Hz] [Sublead #geq2 subjets, Lead <2]");

        // Optional: vs-threshold views
        auto c_thr_B_subleadGe2_leadLt2 = new TCanvas("c_thr_B_subleadGe2_leadLt2",
                                                    "B: vs threshold (sublead>=2, lead<2)",
                                                    1200, 500);
        c_thr_B_subleadGe2_leadLt2->Divide(2,1);

        c_thr_B_subleadGe2_leadLt2->cd(1);
        gPad->SetLeftMargin(0.16); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
        out_EtScan_B_subleadGe2_leadLt2.hEff_vsThr->Draw("HIST");

        c_thr_B_subleadGe2_leadLt2->cd(2);
        gPad->SetLeftMargin(0.16); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
        gPad->SetLogy();
        out_EtScan_B_subleadGe2_leadLt2.hRate_vsThr->Draw("HIST");

        c_thr_B_subleadGe2_leadLt2->SaveAs(
            rateVsEffFileDir + "threshold_views_EtScan_B_subleadGe2_leadLt2.pdf"
        );

        // Main plot: rate vs efficiency
        auto c_re_B_subleadGe2_leadLt2 = new TCanvas("c_re_B_subleadGe2_leadLt2",
                                                    "B: Rate vs Eff (sublead>=2, lead<2)",
                                                    700, 600);
        c_re_B_subleadGe2_leadLt2->SetLeftMargin(0.16);
        c_re_B_subleadGe2_leadLt2->SetBottomMargin(0.16);
        c_re_B_subleadGe2_leadLt2->SetTicks(1,1);
        c_re_B_subleadGe2_leadLt2->SetLogy();

        out_EtScan_B_subleadGe2_leadLt2.gRate_vsEff->Draw("AP");

        // Legend
        auto leg_B = new TLegend(0.18, 0.78, 0.70, 0.88);
        leg_B->SetBorderSize(0);
        leg_B->SetFillStyle(0);
        leg_B->SetTextSize(0.03);
        leg_B->AddEntry(out_EtScan_B_subleadGe2_leadLt2.gRate_vsEff,
                        "B: Sublead #geq 2 subjets, Lead < 2 (E_{T}-only)",
                        "p");
        leg_B->Draw();

        c_re_B_subleadGe2_leadLt2->SaveAs(
            rateVsEffFileDir + "rate_vs_eff_EtScan_B_subleadGe2_leadLt2.pdf"
        );


        // ============================
        // (C) lead>=2, sublead>=2
        // ============================
        auto out_EtScan_C_leadGe2_subleadGe2 = MakeRateVsEff(
            /*sig*/ sig_h_subleading_LRJ_Et_WithGrEq2ConeSubjet_Lead_Sublead,
            /*bkg*/ back_h_subleading_LRJ_Et_WithGrEq2ConeSubjet_Lead_Sublead
        );

        // Titles & axes for TH1s
        SetAxes(out_EtScan_C_leadGe2_subleadGe2.hEff_vsThr->GetXaxis(),
                "Subleading JetTagger LRJ E_{T} threshold [GeV]");
        SetAxes(out_EtScan_C_leadGe2_subleadGe2.hEff_vsThr->GetYaxis(),
                "Signal (hh#rightarrow4b) Efficiency [Lead #geq2 subjets, Sublead #geq2]");
        SetAxes(out_EtScan_C_leadGe2_subleadGe2.hRate_vsThr->GetXaxis(),
                "Subleading JetTagger LRJ E_{T} threshold [GeV]");
        SetAxes(out_EtScan_C_leadGe2_subleadGe2.hRate_vsThr->GetYaxis(),
                "Estimated Background Rate [Hz] [Lead #geq2 subjets, Sublead #geq2]");

        // Titles & axes for TGraph
        SetAxes(out_EtScan_C_leadGe2_subleadGe2.gRate_vsEff->GetXaxis(),
                "Signal (hh#rightarrow4b) Efficiency [Lead #geq2 subjets, Sublead #geq2]");
        SetAxes(out_EtScan_C_leadGe2_subleadGe2.gRate_vsEff->GetYaxis(),
                "Estimated Background Rate [Hz] [Lead #geq2 subjets, Sublead #geq2]");

        // Optional: vs-threshold views
        auto c_thr_C_leadGe2_subleadGe2 = new TCanvas("c_thr_C_leadGe2_subleadGe2",
                                                    "C: vs threshold (lead>=2, sublead>=2)",
                                                    1200, 500);
        c_thr_C_leadGe2_subleadGe2->Divide(2,1);

        c_thr_C_leadGe2_subleadGe2->cd(1);
        gPad->SetLeftMargin(0.16); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
        out_EtScan_C_leadGe2_subleadGe2.hEff_vsThr->Draw("HIST");

        c_thr_C_leadGe2_subleadGe2->cd(2);
        gPad->SetLeftMargin(0.16); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
        gPad->SetLogy();
        out_EtScan_C_leadGe2_subleadGe2.hRate_vsThr->Draw("HIST");

        c_thr_C_leadGe2_subleadGe2->SaveAs(
            rateVsEffFileDir + "threshold_views_EtScan_C_leadGe2_subleadGe2.pdf"
        );

        // Main plot: rate vs efficiency
        auto c_re_C_leadGe2_subleadGe2 = new TCanvas("c_re_C_leadGe2_subleadGe2",
                                                    "C: Rate vs Eff (lead>=2, sublead>=2)",
                                                    700, 600);
        c_re_C_leadGe2_subleadGe2->SetLeftMargin(0.16);
        c_re_C_leadGe2_subleadGe2->SetBottomMargin(0.16);
        c_re_C_leadGe2_subleadGe2->SetTicks(1,1);
        c_re_C_leadGe2_subleadGe2->SetLogy();

        out_EtScan_C_leadGe2_subleadGe2.gRate_vsEff->Draw("AP");

        // Legend
        auto leg_C = new TLegend(0.18, 0.78, 0.70, 0.88);
        leg_C->SetBorderSize(0);
        leg_C->SetFillStyle(0);
        leg_C->SetTextSize(0.03);
        leg_C->AddEntry(out_EtScan_C_leadGe2_subleadGe2.gRate_vsEff,
                        "C: Lead #geq 2 subjets, Sublead #geq 2 (E_{T}-only)",
                        "p");
        leg_C->Draw();

        c_re_C_leadGe2_subleadGe2->SaveAs(
            rateVsEffFileDir + "rate_vs_eff_EtScan_C_leadGe2_subleadGe2.pdf"
        );
        
        // Et-only combined scan (5 categories)
        {
        // --- output name ---
        const TString outPdf =
            rateVsEffFileDir + "rate_vs_eff_combined_5selections_EtOnly.pdf";

        auto global5 = MakeCombinedRateVsEff_AllFive_EtOnly(
            out_0subjetEtScan_LeadingEt,
            out_0subjetEtScan_SubleadingEt,
            out_EtScan_A_leadGe2_subleadLt2,
            out_EtScan_B_subleadGe2_leadLt2,
            out_EtScan_C_leadGe2_subleadGe2,
            sig_h_leading_LRJ_Et_NoConeSubjets_Lead_or_1ConeJetLead,
            sig_h_subleading_LRJ_Et_1ConeSubjet_Lead_or_1ConeJetLead_Sublead,
            sig_h_leading_LRJ_Et_WithGrEq2ConeSubjet_Lead,
            sig_h_leading_LRJ_Et_WithGrEq2ConeSubjet_Sublead,
            sig_h_subleading_LRJ_Et_WithGrEq2ConeSubjet_Lead_Sublead,
            5.0e4, // 25 kHz (a bit beyond max allowed rate),
            1.0e4 // 10 kHz (upper limit of expected allowed large-R jet rate)
        );

        std::cout << "Best combined point with total rate <= 10 kHz:\n" << 
        " Global eff = " << global5.bestEff << "\n" << 
        " Total rate = " << global5.bestRate << " Hz\n" 
        << " Selections (E_T only):\n" << " (0) cat0: E_{T} > " << global5.bestEtCut[0] << " GeV\n" 
        << " (1) 1 subjet lead&subl: E_{T} > " << global5.bestEtCut[1] << " GeV\n" 
        << " (2) cat2: E_{T} > " << global5.bestEtCut[2] << " GeV\n" 
        << " (3) cat3: E_{T} > " << global5.bestEtCut[3] << " GeV\n" 
        << " (4) cat4: E_{T} > " << global5.bestEtCut[4] << " GeV\n" 
        << " Per-category at best point (cat, eff_cat, eff_tot, rate [Hz]):\n";
        for (int c = 0; c < 5; ++c) { 
            std::cout << " cat " << c 
                << ": eff_cat = " << global5.bestEff_cat[c] <<
                ", eff_tot = " << global5.bestEff_tot[c] <<
                ", rate = " << global5.bestRate_cat[c] << " Hz\n"; 
        }


        TH1F* sig_h_offlineLRJ_Et_num10kHz_SubjetBased = new TH1F("sig_h_offlineLRJ_Et_num10kHz_SubjetBased", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 95, 50, 1000);
        TH1F* sig_h_offlineLRJ_Et_denom10kHz_SubjetBased = new TH1F("sig_h_offlineLRJ_Et_denom10kHz_SubjetBased", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 95, 50, 1000);

        TH1F* sig_h_offlineLRJ_Et_num10kHz_1OfflineSubjet_SubjetBased = new TH1F("sig_h_offlineLRJ_Et_num10kHz_1OfflineSubjet_SubjetBased", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 95, 50, 1000);
        TH1F* sig_h_offlineLRJ_Et_denom10kHz_1OfflineSubjet_SubjetBased = new TH1F("sig_h_offlineLRJ_Et_denom10kHz_1OfflineSubjet_SubjetBased", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 95, 50, 1000);

        TH1F* sig_h_offlineLRJ_Et_num10kHz_GrEq2OfflineSubjet_SubjetBased = new TH1F("sig_h_offlineLRJ_Et_num10kHz_GrEq2OfflineSubjet_SubjetBased", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 95, 50, 1000);
        TH1F* sig_h_offlineLRJ_Et_denom10kHz_GrEq2OfflineSubjet_SubjetBased = new TH1F("sig_h_offlineLRJ_Et_denom10kHz_GrEq2OfflineSubjet_SubjetBased", "LRJ Et Distribution;Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)", 95, 50, 1000);
        // use the thresholds to compute efficiency turn-on curves & before & after leading offline LRJ E_T distributions
        for(unsigned int iEvt = 0; iEvt < num_processed_events_signal; iEvt ++ ){
            unsigned int nSubjetConeCellsTowersJetTaggerLeading = nSubjetsLeadingLRJSignal[iEvt];
            unsigned int nSubjetConeCellsTowersJetTaggerSubleading = nSubjetsSubleadingLRJSignal[iEvt];
            unsigned int nOfflineLeadingLRJSubjets = nOfflineSubjetsLeadingLRJSignal[iEvt];
            jetTaggerLeadingLRJsSignal->GetEntry(iEvt);
            jetTaggerSubleadingLRJsSignal->GetEntry(iEvt);
            leadingRecoAntiKt10UFOCSSKJetsSignal->GetEntry(iEvt);
            subleadingRecoAntiKt10UFOCSSKJetsSignal->GetEntry(iEvt);
            if(recoAntiKt10LRJLeadingEtValuesSignal->size() == 0) continue;

            if(nOfflineLeadingLRJSubjets >= 2) sig_h_offlineLRJ_Et_denom10kHz_GrEq2OfflineSubjet_SubjetBased->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
            else sig_h_offlineLRJ_Et_denom10kHz_1OfflineSubjet_SubjetBased->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));

            if((nSubjetConeCellsTowersJetTaggerLeading < 1 && nSubjetConeCellsTowersJetTaggerSubleading < 1) || (nSubjetConeCellsTowersJetTaggerLeading == 0 && nSubjetConeCellsTowersJetTaggerSubleading == 1) || (nSubjetConeCellsTowersJetTaggerLeading == 1 && nSubjetConeCellsTowersJetTaggerSubleading == 0)){
                // do nothing for computing efficiency, reject these events
            } 

            if(nSubjetConeCellsTowersJetTaggerLeading == 1 && nSubjetConeCellsTowersJetTaggerSubleading == 1){
                if(jetTaggerLeadingLRJEtValuesSignal->at(0) >= global5.bestEtCut[0]){
                    sig_h_offlineLRJ_Et_num10kHz_SubjetBased->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                    if(nOfflineLeadingLRJSubjets >= 2) sig_h_offlineLRJ_Et_num10kHz_GrEq2OfflineSubjet_SubjetBased->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                    else sig_h_offlineLRJ_Et_num10kHz_1OfflineSubjet_SubjetBased->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                }
                
            }

            if(nSubjetConeCellsTowersJetTaggerLeading >= 2 && nSubjetConeCellsTowersJetTaggerSubleading <= 1){
                if(jetTaggerLeadingLRJEtValuesSignal->at(0) >= global5.bestEtCut[2]){
                    sig_h_offlineLRJ_Et_num10kHz_SubjetBased->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                    if(nOfflineLeadingLRJSubjets >= 2) sig_h_offlineLRJ_Et_num10kHz_GrEq2OfflineSubjet_SubjetBased->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                    else sig_h_offlineLRJ_Et_num10kHz_1OfflineSubjet_SubjetBased->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                }
            }

            if(nSubjetConeCellsTowersJetTaggerLeading <= 1 && nSubjetConeCellsTowersJetTaggerSubleading >= 2){
                if(jetTaggerSubleadingLRJEtValuesSignal->at(0) >= global5.bestEtCut[3]){
                    sig_h_offlineLRJ_Et_num10kHz_SubjetBased->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                    if(nOfflineLeadingLRJSubjets >= 2) sig_h_offlineLRJ_Et_num10kHz_GrEq2OfflineSubjet_SubjetBased->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                    else sig_h_offlineLRJ_Et_num10kHz_1OfflineSubjet_SubjetBased->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                }
            }

            if(nSubjetConeCellsTowersJetTaggerLeading >= 2 && nSubjetConeCellsTowersJetTaggerSubleading >= 2){
                if(jetTaggerSubleadingLRJEtValuesSignal->at(0) >= global5.bestEtCut[4]){
                    sig_h_offlineLRJ_Et_num10kHz_SubjetBased->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                    if(nOfflineLeadingLRJSubjets >= 2) sig_h_offlineLRJ_Et_num10kHz_GrEq2OfflineSubjet_SubjetBased->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                    else sig_h_offlineLRJ_Et_num10kHz_1OfflineSubjet_SubjetBased->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0));
                }
            }
            sig_h_offlineLRJ_Et_denom10kHz_SubjetBased->Fill(recoAntiKt10LRJLeadingEtValuesSignal->at(0)); // fill denom each event

        }
        TCanvas c;
        TH1F* sig_eff_offlineLRJ10kHz_SubjetBased = (TH1F*)sig_h_offlineLRJ_Et_num10kHz_SubjetBased->Clone();
        sig_eff_offlineLRJ10kHz_SubjetBased->SetName("eff_LRJ10kHz_SubjetBased");
        sig_eff_offlineLRJ10kHz_SubjetBased->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
        sig_eff_offlineLRJ10kHz_SubjetBased->Divide(sig_h_offlineLRJ_Et_num10kHz_SubjetBased, sig_h_offlineLRJ_Et_denom10kHz_SubjetBased, 1.0, 1.0, "B");
        
        sig_eff_offlineLRJ10kHz_SubjetBased->SetAxisRange(0, 1.1, "Y");

        sig_eff_offlineLRJ10kHz_SubjetBased->Draw();

        c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ10kHz_SubjetBased.pdf");

        TH1F* sig_eff_offlineLRJ10kHz_SubjetBased_1OfflineSubjet = (TH1F*)sig_h_offlineLRJ_Et_num10kHz_1OfflineSubjet_SubjetBased->Clone();
        sig_eff_offlineLRJ10kHz_SubjetBased_1OfflineSubjet->SetName("eff_LRJ10kHz_SubjetBased_1OfflineSubjet");
        sig_eff_offlineLRJ10kHz_SubjetBased_1OfflineSubjet->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
        sig_eff_offlineLRJ10kHz_SubjetBased_1OfflineSubjet->Divide(sig_h_offlineLRJ_Et_num10kHz_1OfflineSubjet_SubjetBased, sig_h_offlineLRJ_Et_denom10kHz_1OfflineSubjet_SubjetBased, 1.0, 1.0, "B");
        
        sig_eff_offlineLRJ10kHz_SubjetBased_1OfflineSubjet->SetAxisRange(0, 1.1, "Y");

        sig_eff_offlineLRJ10kHz_SubjetBased_1OfflineSubjet->Draw();

        c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ10kHz_SubjetBased_1OfflineSubjet.pdf");

        TH1F* sig_eff_offlineLRJ10kHz_SubjetBased_GrEq2OfflineSubjet = (TH1F*)sig_h_offlineLRJ_Et_num10kHz_GrEq2OfflineSubjet_SubjetBased->Clone();
        sig_eff_offlineLRJ10kHz_SubjetBased_GrEq2OfflineSubjet->SetName("eff_LRJ10kHz_SubjetBased_GrEq2OfflineSubjet");
        sig_eff_offlineLRJ10kHz_SubjetBased_GrEq2OfflineSubjet->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
        sig_eff_offlineLRJ10kHz_SubjetBased_GrEq2OfflineSubjet->Divide(sig_h_offlineLRJ_Et_num10kHz_GrEq2OfflineSubjet_SubjetBased, sig_h_offlineLRJ_Et_denom10kHz_GrEq2OfflineSubjet_SubjetBased, 1.0, 1.0, "B");
        
        sig_eff_offlineLRJ10kHz_SubjetBased_GrEq2OfflineSubjet->SetAxisRange(0, 1.1, "Y");

        sig_eff_offlineLRJ10kHz_SubjetBased_GrEq2OfflineSubjet->Draw();

        c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ10kHz_SubjetBased_GrEq2OfflineSubjet.pdf");

        // --- Styling ---
        // --- Style background histogram (shaded) ---
        sig_h_leading_offlineLRJ_Et->SetFillColorAlpha(kGray+1, 0.35); // gray with 35% opacity
        sig_h_leading_offlineLRJ_Et->SetLineColor(kGray+2);            // slightly darker outline
        sig_h_leading_offlineLRJ_Et->SetLineWidth(1);

        // Normalize or rescale if needed to roughly fit in visible range
        sig_h_leading_offlineLRJ_Et->Scale(1.0 / sig_h_leading_offlineLRJ_Et->Integral());

        sig_eff_offlineLRJ10kHz_SubjetBased->SetLineColor(kBlack);
        sig_eff_offlineLRJ10kHz_SubjetBased->SetMarkerColor(kBlack);
        sig_eff_offlineLRJ10kHz_SubjetBased->SetMarkerStyle(20);
        sig_eff_offlineLRJ10kHz_SubjetBased->SetMarkerSize(1.0);

        //sig_eff_offline_jFEX_LRJ10kHz->SetLineColor(kGreen+2);
        //sig_eff_offline_jFEX_LRJ10kHz->SetMarkerColor(kGreen+2);
        //sig_eff_offline_jFEX_LRJ10kHz->SetMarkerStyle(22);
        //sig_eff_offline_jFEX_LRJ10kHz->SetMarkerSize(1.0);

        // Axis range / cosmetics
        sig_eff_offlineLRJ10kHz_SubjetBased->SetAxisRange(0.0, 1.1, "Y");
        //sig_eff_offline_jFEX_LRJ10kHz->SetAxisRange(0.0, 1.1, "Y");
        sig_eff_offlineLRJ10kHz_SubjetBased->GetXaxis()->SetTitleOffset(1.1);
        sig_eff_offlineLRJ10kHz_SubjetBased->GetYaxis()->SetTitleOffset(1.2);

        // --- Draw overlay ---
        TCanvas c_effLRJ10kHz("c_effLRJ10kHz","LRJ Efficiencies @ 10 kHz bkg",900,700);

        
        sig_eff_offlineLRJ10kHz_SubjetBased->Draw("P");          // first: JetTagger (offline)
        sig_h_leading_offlineLRJ_Et->Draw("HIST SAME");
        //sig_eff_offline_jFEX_LRJ10kHz->Draw("P SAME");

        // --- Legend with proper labels and note about 10 kHz ---
        TLegend *leg_10kHz_effs = new TLegend(0.35, 0.2, 0.73, 0.4);
        leg_10kHz_effs->SetBorderSize(0);
        leg_10kHz_effs->SetFillStyle(0);
        leg_10kHz_effs->SetTextSize(0.03);
        leg_10kHz_effs->SetHeader("Cuts tuned to 10 kHz background","C"); // clearly states the rate
        leg_10kHz_effs->AddEntry(sig_eff_offlineLRJ10kHz_SubjetBased,
            Form("JetTagger Subjet-varied E_{T} Thresholds"), "lp");

        //leg_10kHz_effs->AddEntry(sig_eff_offline_jFEX_LRJ10kHz, 
        //    Form("jFEX ( > %.1f GeV)", jFEX_10kHz_Threshold_Leading), "lp");
        leg_10kHz_effs->Draw();

        // --- Save overlay ---
        c_effLRJ10kHz.SaveAs(rateVsEffFileDir + "sig_eff_offline_LRJ10kHz_overlay_subjetbased.pdf");



        // For mass window applied
        sig_eff_offlineLRJ10kHz_SubjetBased_1OfflineSubjet->SetLineColor(kBlack);
        sig_eff_offlineLRJ10kHz_SubjetBased_1OfflineSubjet->SetMarkerColor(kBlack);
        sig_eff_offlineLRJ10kHz_SubjetBased_1OfflineSubjet->SetMarkerStyle(20); // filled in circle
        sig_eff_offlineLRJ10kHz_SubjetBased_1OfflineSubjet->SetMarkerSize(1.0);

        sig_eff_offlineLRJ10kHz_SubjetBased_GrEq2OfflineSubjet->SetLineColor(kBlack);
        sig_eff_offlineLRJ10kHz_SubjetBased_GrEq2OfflineSubjet->SetMarkerColor(kBlack);
        sig_eff_offlineLRJ10kHz_SubjetBased_GrEq2OfflineSubjet->SetMarkerStyle(24); // open circle
        sig_eff_offlineLRJ10kHz_SubjetBased_GrEq2OfflineSubjet->SetMarkerSize(1.0);

        // Axis range / cosmetics
        sig_eff_offlineLRJ10kHz_SubjetBased_1OfflineSubjet->SetAxisRange(0.0, 1.1, "Y");
        sig_eff_offlineLRJ10kHz_SubjetBased_1OfflineSubjet->GetXaxis()->SetTitleOffset(1.1);

        // --- Draw overlay ---
        TCanvas c_effLRJ10kHz_Subjet("c_effLRJ10kHz_Subjet","LRJ Efficiencies @ 10 kHz bkg",900,700);

        
        sig_eff_offlineLRJ10kHz_SubjetBased_1OfflineSubjet->Draw("P");          // first: JetTagger (offline)
        sig_eff_offlineLRJ10kHz_SubjetBased_GrEq2OfflineSubjet->Draw("P SAME"); 
        sig_h_leading_offlineLRJ_Et->Draw("HIST SAME");

        // --- Legend with proper labels and note about 10 kHz ---
        TLegend *leg_10kHz_effs_Subjets = new TLegend(0.32, 0.28, 0.7, 0.48);
        leg_10kHz_effs_Subjets->SetBorderSize(0);
        leg_10kHz_effs_Subjets->SetFillStyle(0);
        leg_10kHz_effs_Subjets->SetTextSize(0.025);
        leg_10kHz_effs_Subjets->SetHeader("Cuts tuned to 10 kHz background","C"); // clearly states the rate

        leg_10kHz_effs_Subjets->AddEntry(sig_eff_offlineLRJ10kHz_SubjetBased_1OfflineSubjet,
            Form("JetTagger Subjet-varied E_{T} Thresholds [1 Lead. Offline LRJ Subjet]"), "lp");

        leg_10kHz_effs_Subjets->AddEntry(sig_eff_offlineLRJ10kHz_SubjetBased_GrEq2OfflineSubjet,
            Form("JetTagger Subjet-varied E_{T} Thresholds [>= 2 Lead. Offline LRJ Subjets]"), "lp");

        leg_10kHz_effs_Subjets->Draw();

        // --- Save overlay ---
        c_effLRJ10kHz_Subjet.SaveAs(rateVsEffFileDir + "sig_eff_offline_LRJ10kHz_overlay_Subjets_subjetbased.pdf");


        TH1F* back_h_leading_offlineLRJ_Mass_beforeselection = new TH1F("back_h_leading_offlineLRJ_Mass_beforeselection", "Leading LRJ Et Distribution;Leading Offline LRJ Mass (Before Selection) [GeV];Fraction of Events / 10 GeV", 40, 0, 400); // moved outside scope of file loop for use afterwards
        TH1F* back_h_leading_offlineLRJ_Mass_afterselection = new TH1F("back_h_leading_offlineLRJ_Mass_afterselection", "Subleading LRJ Et Distribution;Leading Offline LRJ Mass (After Selection) [GeV];Fraction of Events / 10 GeV", 40, 0, 400); // now will only fill for first file as is same for each

        for(unsigned int iEvt = 0; iEvt < num_processed_events_background; iEvt ++ ){
            unsigned int nSubjetConeCellsTowersJetTaggerLeading = nSubjetsLeadingLRJBack[iEvt];
            unsigned int nSubjetConeCellsTowersJetTaggerSubleading = nSubjetsSubleadingLRJBack[iEvt];
            jetTaggerLeadingLRJsBack->GetEntry(iEvt);
            jetTaggerSubleadingLRJsBack->GetEntry(iEvt);
            leadingRecoAntiKt10UFOCSSKJetsBack->GetEntry(iEvt);
            subleadingRecoAntiKt10UFOCSSKJetsBack->GetEntry(iEvt);
            eventInfoTreeBack->GetEntry(iEvt);
            double backgroundEventWeight = eventWeightsValuesBack->at(0);
            if(recoAntiKt10LRJLeadingMassValuesBack->size() == 0) continue;
            back_h_leading_offlineLRJ_Mass_beforeselection->Fill(recoAntiKt10LRJLeadingMassValuesBack->at(0), backgroundEventWeight);

           
    

            if((nSubjetConeCellsTowersJetTaggerLeading < 1 && nSubjetConeCellsTowersJetTaggerSubleading < 1) || (nSubjetConeCellsTowersJetTaggerLeading == 0 && nSubjetConeCellsTowersJetTaggerSubleading == 1) || (nSubjetConeCellsTowersJetTaggerLeading == 1 && nSubjetConeCellsTowersJetTaggerSubleading == 0)){
                // do nothing for computing efficiency, reject these events
            } 

            if(nSubjetConeCellsTowersJetTaggerLeading == 1 && nSubjetConeCellsTowersJetTaggerSubleading == 1){
                if(jetTaggerLeadingLRJEtValuesBack->at(0) >= global5.bestEtCut[0]){
                    back_h_leading_offlineLRJ_Mass_afterselection->Fill(recoAntiKt10LRJLeadingMassValuesBack->at(0), backgroundEventWeight);
                }
            }

            if(nSubjetConeCellsTowersJetTaggerLeading >= 2 && nSubjetConeCellsTowersJetTaggerSubleading <= 1){
                if(jetTaggerLeadingLRJEtValuesBack->at(0) >= global5.bestEtCut[2]){
                    back_h_leading_offlineLRJ_Mass_afterselection->Fill(recoAntiKt10LRJLeadingMassValuesBack->at(0), backgroundEventWeight);
                }
            }

            if(nSubjetConeCellsTowersJetTaggerLeading <= 1 && nSubjetConeCellsTowersJetTaggerSubleading >= 2){
                if(jetTaggerSubleadingLRJEtValuesBack->at(0) >= global5.bestEtCut[3]){
                    back_h_leading_offlineLRJ_Mass_afterselection->Fill(recoAntiKt10LRJLeadingMassValuesBack->at(0), backgroundEventWeight);
                }
            }

            if(nSubjetConeCellsTowersJetTaggerLeading >= 2 && nSubjetConeCellsTowersJetTaggerSubleading >= 2){
                if(jetTaggerSubleadingLRJEtValuesBack->at(0) >= global5.bestEtCut[4]){
                    back_h_leading_offlineLRJ_Mass_afterselection->Fill(recoAntiKt10LRJLeadingMassValuesBack->at(0), backgroundEventWeight);
                }
            }

        }
        // Compute ratio of leading offline LRJ mass before and after selection by subjet-based scan

        // ----------------------------
        // Ensure proper sumw2 FIRST
        // ----------------------------
        back_h_leading_offlineLRJ_Mass_beforeselection->Sumw2();
        back_h_leading_offlineLRJ_Mass_afterselection->Sumw2();

        // ----------------------------
        // Normalize to unit area (shape comparison)
        // ----------------------------
        if (back_h_leading_offlineLRJ_Mass_beforeselection->Integral() > 0)
            back_h_leading_offlineLRJ_Mass_beforeselection->Scale(
                1.0 / back_h_leading_offlineLRJ_Mass_beforeselection->Integral()
            );

        if (back_h_leading_offlineLRJ_Mass_afterselection->Integral() > 0)
            back_h_leading_offlineLRJ_Mass_afterselection->Scale(
                1.0 / back_h_leading_offlineLRJ_Mass_afterselection->Integral()
            );

        // ----------------------------
        // Ratio: after / before
        // ----------------------------
        TH1F* h_ratio = (TH1F*)back_h_leading_offlineLRJ_Mass_afterselection->Clone("h_ratio_after_over_before");
        h_ratio->SetTitle("");
        h_ratio->Divide(back_h_leading_offlineLRJ_Mass_beforeselection);

        // For log-y ratio plot: enforce strictly positive bins; blank bins with denom<=0 or ratio<=0
        for (int b = 1; b <= h_ratio->GetNbinsX(); ++b) {
            const double denom = back_h_leading_offlineLRJ_Mass_beforeselection->GetBinContent(b);
            const double r     = h_ratio->GetBinContent(b);
            if (denom <= 0.0 || r <= 0.0) {
                h_ratio->SetBinContent(b, 0.0);
                h_ratio->SetBinError(b, 0.0);
            }
        }

        // ----------------------------
        // Style
        // ----------------------------
        back_h_leading_offlineLRJ_Mass_beforeselection->SetLineColor(kBlack);
        back_h_leading_offlineLRJ_Mass_beforeselection->SetLineWidth(2);

        back_h_leading_offlineLRJ_Mass_afterselection->SetLineColor(kRed + 1);
        back_h_leading_offlineLRJ_Mass_afterselection->SetLineWidth(2);

        h_ratio->SetLineColor(kBlack);
        h_ratio->SetLineWidth(2);
        h_ratio->SetMarkerStyle(20);
        h_ratio->SetMarkerSize(0.7);

        // ----------------------------
        // Canvas + pads
        // ----------------------------
        TCanvas* c_mass = new TCanvas("c_mass", "Offline LRJ mass: before/after + ratio", 900, 850);
        c_mass->cd();

        TPad* p_top = new TPad("p_top", "p_top", 0.0, 0.30, 1.0, 1.0);
        TPad* p_bot = new TPad("p_bot", "p_bot", 0.0, 0.00, 1.0, 0.30);

        p_top->SetBottomMargin(0.02);
        p_bot->SetTopMargin(0.03);
        p_bot->SetBottomMargin(0.35);

        p_top->Draw();
        p_bot->Draw();

        // ----------------------------
        // TOP pad: overlay + legend (LOG Y)
        // ----------------------------
        p_top->cd();
        p_top->SetLogy(true);

        // Choose a safe positive min for log y.
        // If you have bins with 0, you still want the axis min > 0.
        const double topMin = 1e-6;  // tweak if you want (depends on normalization/statistics)
        double ymax = std::max(back_h_leading_offlineLRJ_Mass_beforeselection->GetMaximum(),
                            back_h_leading_offlineLRJ_Mass_afterselection->GetMaximum());

        back_h_leading_offlineLRJ_Mass_beforeselection->SetMinimum(topMin);
        back_h_leading_offlineLRJ_Mass_beforeselection->SetMaximum(1.25 * ymax);

        back_h_leading_offlineLRJ_Mass_beforeselection->GetXaxis()->SetLabelSize(0);
        back_h_leading_offlineLRJ_Mass_beforeselection->GetXaxis()->SetTitleSize(0);

        back_h_leading_offlineLRJ_Mass_beforeselection->Draw("HIST");
        back_h_leading_offlineLRJ_Mass_afterselection->Draw("HIST SAME");

        TLegend* leg_selections = new TLegend(0.60, 0.70, 0.88, 0.88);
        leg_selections->SetBorderSize(0);
        leg_selections->SetFillStyle(0);
        leg_selections->AddEntry(back_h_leading_offlineLRJ_Mass_beforeselection, "Before selection", "l");
        leg_selections->AddEntry(back_h_leading_offlineLRJ_Mass_afterselection,  "After selection",  "l");
        leg_selections->Draw();

        // ----------------------------
        // BOTTOM pad: ratio (LOG Y + dynamic range)
        // ----------------------------
        p_bot->cd();
        p_bot->SetLogy(true);

        h_ratio->GetYaxis()->SetTitle("After / Before");
        h_ratio->GetYaxis()->SetNdivisions(505);
        h_ratio->GetYaxis()->SetTitleSize(0.10);
        h_ratio->GetYaxis()->SetTitleOffset(0.50);
        h_ratio->GetYaxis()->SetLabelSize(0.09);

        h_ratio->GetXaxis()->SetTitle("Leading Offline LRJ Mass [GeV]");
        h_ratio->GetXaxis()->SetTitleSize(0.12);
        h_ratio->GetXaxis()->SetTitleOffset(1.10);
        h_ratio->GetXaxis()->SetLabelSize(0.10);

        // --- Compute dynamic min/max for ratio, ignoring zeros (needed for log y)
        double rmin = 1e99, rmax = -1e99;
        for (int b = 1; b <= h_ratio->GetNbinsX(); ++b) {
            const double r = h_ratio->GetBinContent(b);
            if (r > 0.0) { // only positive bins for log axis
                rmin = std::min(rmin, r);
                rmax = std::max(rmax, r);
            }
        }

        // Fallback if everything is zero
        if (rmax <= 0.0 || rmin >= 1e98) {
            rmin = 0.5;
            rmax = 2.0;
        }

        // Add padding (multiplicative makes sense on log scale)
        const double padLow  = 0.8;   // show a bit below min
        const double padHigh = 1.25;  // show a bit above max
        h_ratio->SetMinimum(std::max(1e-6, rmin * padLow));
        h_ratio->SetMaximum(rmax * padHigh);

        h_ratio->Draw("E1");

        // line at 1 (works fine on log axis too)
        TLine* l1 = new TLine(h_ratio->GetXaxis()->GetXmin(), 1.0,
                            h_ratio->GetXaxis()->GetXmax(), 1.0);
        l1->SetLineStyle(2);
        l1->SetLineWidth(2);
        l1->SetLineColor(kGray + 2);
        l1->Draw("SAME");

        // save
        c_mass->SaveAs(modifiedOutputFileDir + "back_leading_offlineLRJ_mass_before_after_ratio.pdf");



        // =======================
        // PAGE 1: PLOT ONLY
        // =======================
        auto c_combined5 = new TCanvas(
            "c_combined5",
            "Combined Rate vs Eff (5 Et-only selections)",
            700, 600
        );
        c_combined5->SetLeftMargin(0.16);
        c_combined5->SetBottomMargin(0.16);
        c_combined5->SetTicks(1,1);
        c_combined5->SetLogy();

        global5.gRate_vsEff_combined->Draw("AP");

        // highlight best point
        auto* gBest5 = new TGraph();
        gBest5->SetPoint(0, global5.bestEff, global5.bestRate);
        gBest5->SetMarkerStyle(20);
        gBest5->SetMarkerSize(1.5);
        gBest5->Draw("P SAME");

        // open multipage pdf + write page 1
        c_combined5->Print(outPdf + "(");

        // =======================
        // PAGE 2: TEXT ONLY (Legend-based, wraps nicely)
        // =======================
        auto* c_text5 = new TCanvas("c_text5", "Summary (5 Et-only selections)", 700, 900);
        c_text5->SetLeftMargin(0.08);
        c_text5->SetRightMargin(0.08);
        c_text5->SetTopMargin(0.06);
        c_text5->SetBottomMargin(0.06);
        c_text5->cd();

        // Full-page legend used as a text container
        auto* leg = new TLegend(0.04, 0.5, 0.94, 0.94);
        leg->SetBorderSize(0);
        leg->SetFillStyle(0);
        leg->SetTextAlign(12);
        leg->SetTextSize(0.025);      // slightly smaller
        leg->SetEntrySeparation(0.01); // <<< THIS fixes the vertical overflow
        leg->SetMargin(0.02);         // reduce internal left padding

        // Helper: add pure text line (no marker/line)
        auto add = [&](const TString& s){
            leg->AddEntry((TObject*)0, s, "");
        };
        

        add(Form("Best point (Rate #leq 10 kHz): #varepsilon_{tot} = %.3f, Rate = %.0f Hz",
        global5.bestEff, global5.bestRate));

        add(Form("(0) lead Et (1 subj): E_{T,lead} > %.1f GeV \n"
                "f_{sig}=%.3f, eff_{cat}=%.3f, eff_{tot}=%.3f, Rate=%.0f Hz",
                global5.bestEtCut[0],
                global5.fractionEventsPerCat[0],
                global5.bestEff_cat[0], global5.bestEff_tot[0], global5.bestRate_cat[0]));

        add(Form("(1) subl Et (0/1 subj): Category disabled \n"
                "f_{sig}=%.3f, eff_{cat}=%.3f, eff_{tot}=%.3f, Rate=%.0f Hz",
                global5.fractionEventsPerCat[1],
                global5.bestEff_cat[1], global5.bestEff_tot[1], global5.bestRate_cat[1]));

        add(Form("(2) lead (>=2 subj): E_{T,lead} > %.1f GeV \n"
                "f_{sig}=%.3f, eff_{cat}=%.3f, eff_{tot}=%.3f, Rate=%.0f Hz",
                global5.bestEtCut[2],
                global5.fractionEventsPerCat[2],
                global5.bestEff_cat[2], global5.bestEff_tot[2], global5.bestRate_cat[2]));

        add(Form("(3) subl (>=2 subj): E_{T,subl} > %.1f GeV \n"
                "f_{sig}=%.3f, eff_{cat}=%.3f, eff_{tot}=%.3f, Rate=%.0f Hz",
                global5.bestEtCut[3],
                global5.fractionEventsPerCat[3],
                global5.bestEff_cat[3], global5.bestEff_tot[3], global5.bestRate_cat[3]));

        add(Form("(4) both (>=2 subj): E_{T,subl} > %.1f GeV \n"
                "f_{sig}=%.3f, eff_{cat}=%.3f, eff_{tot}=%.3f, Rate=%.0f Hz",
                global5.bestEtCut[4],
                global5.fractionEventsPerCat[4],
                global5.bestEff_cat[4], global5.bestEff_tot[4], global5.bestRate_cat[4]));

        leg->Draw();

        // write page 2 + close pdf
        c_text5->Print(outPdf + ")");



        // Main plot: rate vs efficiency (graph)
        auto c_overlay_subjetbased =
            new TCanvas("c_overlay_subjetbased", "Rate vs Eff", 700, 600);

        c_overlay_subjetbased->SetLeftMargin(0.16);
        c_overlay_subjetbased->SetBottomMargin(0.16);
        c_overlay_subjetbased->SetTicks(1,1);
        c_overlay_subjetbased->SetLogy();

        subjetBased_ET_Scan_RatesVsEff_vec.push_back(global5.gRate_vsEff_combined);

        // --- Style graphs ---
        global5.gRate_vsEff_combined->SetMarkerColor(kBlue+1);
        global5.gRate_vsEff_combined->SetLineColor(kBlue+1);
        global5.gRate_vsEff_combined->SetMarkerStyle(20);

        out.gRate_vsEff->SetMarkerColor(kRed+1);
        out.gRate_vsEff->SetLineColor(kRed+1);
        out.gRate_vsEff->SetMarkerStyle(21);

        // --- Draw ---
        // draw ONE graph with axes
        out.gRate_vsEff->SetMinimum(50.);
        out.gRate_vsEff->SetMaximum(50000.);
        out.gRate_vsEff->Draw("AP");                 // standard Et (red)
        //out.gRate_vsEff->GetYaxis()->SetRangeUser(100., 25000.);
        // overlay second graph without axes
        global5.gRate_vsEff_combined->Draw("P SAME"); // subjet-based Et (blue)

        // --- Legend ---
        auto* leg_SubjetSelectionOverlay = new TLegend(0.4, 0.22, 0.73, 0.38);
        leg_SubjetSelectionOverlay->SetBorderSize(0);
        leg_SubjetSelectionOverlay->SetFillStyle(0);
        leg_SubjetSelectionOverlay->SetTextSize(0.035);

        leg_SubjetSelectionOverlay->AddEntry(global5.gRate_vsEff_combined,
                        "Subjet-based E_{T} selection", "lp");
        leg_SubjetSelectionOverlay->AddEntry(out.gRate_vsEff,
                        "Standard E_{T} selection", "lp");

        leg_SubjetSelectionOverlay->Draw();

        c_overlay_subjetbased->SaveAs(rateVsEffFileDir + "rate_vs_eff_SubjetBasedSelectionOverlay.pdf");

    }

    if(categorySubjetEtScan_8){
        auto out_category0_subjetEtScan = MakeRateVsEff(sig_h_leading_LRJ_Et_Category0, back_h_leading_LRJ_Et_Category0);
        auto out_category1_subjetEtScan = MakeRateVsEff(sig_h_leading_LRJ_Et_Category1, back_h_leading_LRJ_Et_Category1);
        auto out_category2_subjetEtScan = MakeRateVsEff(sig_h_leading_LRJ_Et_Category2, back_h_leading_LRJ_Et_Category2);
        auto out_category3_subjetEtScan = MakeRateVsEff(sig_h_leading_LRJ_Et_Category3, back_h_leading_LRJ_Et_Category3);
        auto out_category4_subjetEtScan = MakeRateVsEff(sig_h_leading_LRJ_Et_Category4, back_h_leading_LRJ_Et_Category4);
        auto out_category5_subjetEtScan = MakeRateVsEff(sig_h_leading_LRJ_Et_Category5, back_h_leading_LRJ_Et_Category5);
        auto out_category6_subjetEtScan = MakeRateVsEff(sig_h_leading_LRJ_Et_Category6, back_h_leading_LRJ_Et_Category6);
        auto out_category7_subjetEtScan = MakeRateVsEff(sig_h_leading_LRJ_Et_Category7, back_h_leading_LRJ_Et_Category7);


        // Et-only combined scan (8 categories)
    {
        // --- output name ---
        const TString outPdf =
            rateVsEffFileDir + "rate_vs_eff_combined_8selections_EtOnly.pdf";

        auto global8 = MakeCombinedRateVsEff_AllEight_EtOnly(
            out_category0_subjetEtScan,
            out_category1_subjetEtScan,
            out_category2_subjetEtScan,
            out_category3_subjetEtScan,
            out_category4_subjetEtScan,
            out_category5_subjetEtScan,
            out_category6_subjetEtScan,
            out_category7_subjetEtScan,
            sig_h_leading_LRJ_Et_Category0,
            sig_h_leading_LRJ_Et_Category1,
            sig_h_leading_LRJ_Et_Category2,
            sig_h_leading_LRJ_Et_Category3,
            sig_h_leading_LRJ_Et_Category4,
            sig_h_leading_LRJ_Et_Category5,
            sig_h_leading_LRJ_Et_Category6,
            sig_h_leading_LRJ_Et_Category7,
            5.0e4,  // draw up to 50 kHz
            1.0e4   // best-point constraint: 10 kHz
        );

        std::cout
            << "Best combined point with total rate <= 10 kHz:\n"
            << " Global eff = " << global8.bestEff << "\n"
            << " Total rate = " << global8.bestRate << " Hz\n"
            << " Selections (E_T only):\n"
            << " (0) cat0: E_{T} > " << global8.bestEtCut[0] << " GeV\n"
            << " (1) cat1: E_{T} > " << global8.bestEtCut[1] << " GeV\n"
            << " (2) cat2: E_{T} > " << global8.bestEtCut[2] << " GeV\n"
            << " (3) cat3: E_{T} > " << global8.bestEtCut[3] << " GeV\n"
            << " (4) cat4: E_{T} > " << global8.bestEtCut[4] << " GeV\n"
            << " (5) cat5: E_{T} > " << global8.bestEtCut[5] << " GeV\n"
            << " (6) cat6: E_{T} > " << global8.bestEtCut[6] << " GeV\n"
            << " (7) cat7: E_{T} > " << global8.bestEtCut[7] << " GeV\n"
            << " Per-category at best point (cat, eff_cat, eff_tot, rate [Hz]):\n";
        for (int c = 0; c < 8; ++c) {
            std::cout << " cat " << c
                    << ": eff_cat = " << global8.bestEff_cat[c]
                    << ", eff_tot = " << global8.bestEff_tot[c]
                    << ", rate = " << global8.bestRate_cat[c] << " Hz\n";
        }

        // =======================
        // PAGE 1: PLOT ONLY
        // =======================
        auto* c_combined8 = new TCanvas(
            "c_combined8",
            "Combined Rate vs Eff (8 Et-only selections)",
            700, 600
        );
        c_combined8->SetLeftMargin(0.16);
        c_combined8->SetBottomMargin(0.16);
        c_combined8->SetTicks(1,1);
        c_combined8->SetLogy();

        global8.gRate_vsEff_combined->Draw("AP");

        // highlight best point
        auto* gBest8 = new TGraph();
        gBest8->SetPoint(0, global8.bestEff, global8.bestRate);
        gBest8->SetMarkerStyle(20);
        gBest8->SetMarkerSize(1.5);
        gBest8->Draw("P SAME");

        // open multipage pdf + write page 1
        c_combined8->Print(outPdf + "(");

        // =======================
        // PAGE 2: TEXT ONLY (Legend-based, wraps nicely)
        // =======================
        auto* c_text8 = new TCanvas("c_text8", "Summary (8 Et-only selections)", 700, 900);
        c_text8->SetLeftMargin(0.08);
        c_text8->SetRightMargin(0.08);
        c_text8->SetTopMargin(0.06);
        c_text8->SetBottomMargin(0.06);
        c_text8->cd();

        auto* leg8 = new TLegend(0.04, 0.4, 0.94, 0.94);
        leg8->SetBorderSize(0);
        leg8->SetFillStyle(0);
        leg8->SetTextAlign(12);
        leg8->SetTextSize(0.015);
        leg8->SetEntrySeparation(0.004);
        leg8->SetMargin(0.02);

        auto add8 = [&](const TString& s){
            leg8->AddEntry((TObject*)0, s, "");
        };

        add8(Form("Best point (Rate #leq 10 kHz): #varepsilon_{tot} = %.3f, Rate = %.0f Hz",
                    global8.bestEff, global8.bestRate));

        // NOTE: cat0 is disabled in numerator by construction in the 8-cat function
        add8(Form("(0) cat0: Category disabled (no events pass) \n"
                    "f_{sig}=%.3f, eff_{cat}=%.3f, eff_{tot}=%.3f, Rate=%.0f Hz",
                    global8.fractionEventsPerCat[0],
                    global8.bestEff_cat[0], global8.bestEff_tot[0], global8.bestRate_cat[0]));

        add8(Form("(1) cat1: E_{T} > %.1f GeV \n"
                    "f_{sig}=%.3f, eff_{cat}=%.3f, eff_{tot}=%.3f, Rate=%.0f Hz",
                    global8.bestEtCut[1],
                    global8.fractionEventsPerCat[1],
                    global8.bestEff_cat[1], global8.bestEff_tot[1], global8.bestRate_cat[1]));

        add8(Form("(2) cat2: E_{T} > %.1f GeV \n"
                    "f_{sig}=%.3f, eff_{cat}=%.3f, eff_{tot}=%.3f, Rate=%.0f Hz",
                    global8.bestEtCut[2],
                    global8.fractionEventsPerCat[2],
                    global8.bestEff_cat[2], global8.bestEff_tot[2], global8.bestRate_cat[2]));

        add8(Form("(3) cat3: E_{T} > %.1f GeV \n"
                    "f_{sig}=%.3f, eff_{cat}=%.3f, eff_{tot}=%.3f, Rate=%.0f Hz",
                    global8.bestEtCut[3],
                    global8.fractionEventsPerCat[3],
                    global8.bestEff_cat[3], global8.bestEff_tot[3], global8.bestRate_cat[3]));

        add8(Form("(4) cat4: E_{T} > %.1f GeV \n"
                    "f_{sig}=%.3f, eff_{cat}=%.3f, eff_{tot}=%.3f, Rate=%.0f Hz",
                    global8.bestEtCut[4],
                    global8.fractionEventsPerCat[4],
                    global8.bestEff_cat[4], global8.bestEff_tot[4], global8.bestRate_cat[4]));

        add8(Form("(5) cat5: E_{T} > %.1f GeV \n"
                    "f_{sig}=%.3f, eff_{cat}=%.3f, eff_{tot}=%.3f, Rate=%.0f Hz",
                    global8.bestEtCut[5],
                    global8.fractionEventsPerCat[5],
                    global8.bestEff_cat[5], global8.bestEff_tot[5], global8.bestRate_cat[5]));

        add8(Form("(6) cat6: E_{T} > %.1f GeV \n"
                    "f_{sig}=%.3f, eff_{cat}=%.3f, eff_{tot}=%.3f, Rate=%.0f Hz",
                    global8.bestEtCut[6],
                    global8.fractionEventsPerCat[6],
                    global8.bestEff_cat[6], global8.bestEff_tot[6], global8.bestRate_cat[6]));

        add8(Form("(7) cat7: E_{T} > %.1f GeV \n"
                    "f_{sig}=%.3f, eff_{cat}=%.3f, eff_{tot}=%.3f, Rate=%.0f Hz",
                    global8.bestEtCut[7],
                    global8.fractionEventsPerCat[7],
                    global8.bestEff_cat[7], global8.bestEff_tot[7], global8.bestRate_cat[7]));

        leg8->Draw();

        // write page 2 + close pdf
        c_text8->Print(outPdf + ")");

        // =======================
        // OPTIONAL: overlay on your "standard Et" curve (same style as your 5-cat)
        // (assumes you still have `out.gRate_vsEff` in scope from the standard Et selection)
        // =======================
        auto* c_overlay_subjetbased8 =
            new TCanvas("c_overlay_subjetbased8", "Rate vs Eff", 700, 600);

        c_overlay_subjetbased8->SetLeftMargin(0.16);
        c_overlay_subjetbased8->SetBottomMargin(0.16);
        c_overlay_subjetbased8->SetTicks(1,1);
        c_overlay_subjetbased8->SetLogy();

        subjetBased_ET_Scan_RatesVsEff_vec.push_back(global8.gRate_vsEff_combined);

        global8.gRate_vsEff_combined->SetMarkerColor(kBlue+1);
        global8.gRate_vsEff_combined->SetLineColor(kBlue+1);
        global8.gRate_vsEff_combined->SetMarkerStyle(20);

        out.gRate_vsEff->SetMarkerColor(kRed+1);
        out.gRate_vsEff->SetLineColor(kRed+1);
        out.gRate_vsEff->SetMarkerStyle(21);

        out.gRate_vsEff->SetMinimum(50.);
        out.gRate_vsEff->SetMaximum(50000.);
        out.gRate_vsEff->Draw("AP");
        global8.gRate_vsEff_combined->Draw("P SAME");

        auto* leg_SubjetSelectionOverlay8 = new TLegend(0.4, 0.22, 0.73, 0.38);
        leg_SubjetSelectionOverlay8->SetBorderSize(0);
        leg_SubjetSelectionOverlay8->SetFillStyle(0);
        leg_SubjetSelectionOverlay8->SetTextSize(0.035);

        leg_SubjetSelectionOverlay8->AddEntry(global8.gRate_vsEff_combined,
                                                "Subjet-based E_{T} selection (8 cats)", "lp");
        leg_SubjetSelectionOverlay8->AddEntry(out.gRate_vsEff,
                                                "Standard E_{T} selection", "lp");
        leg_SubjetSelectionOverlay8->Draw();

        c_overlay_subjetbased8->SaveAs(rateVsEffFileDir + "rate_vs_eff_SubjetBasedSelectionOverlay_8cats.pdf");
        }

    }
    

    



    // ===================== LEADING (ET_th vs R_max scan) ======================= (R_max == psi_R_leading / psi_R_sublead)
    auto out2D_leading = MakeRateVsEff_ScanRMax(
        sigJetTaggerLeadingLRJEtvsPsi_12,    backJetTaggerLeadingLRJEtvsPsi_12      // R = psi_lead/psi_subl
    );

    // Axis titles
    SetAxes(out2D_leading.hEff_vsThr_vsR ->GetXaxis(), "Leading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_leading.hEff_vsThr_vsR ->GetYaxis(), "R_{max} = #psi_{R,lead}/#psi_{R,subl}");
    SetAxes(out2D_leading.hRate_vsThr_vsR->GetXaxis(), "Leading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_leading.hRate_vsThr_vsR->GetYaxis(), "R_{max} = #psi_{R,lead}/#psi_{R,subl}");

    SetAxes(out2D_leading.gRate_vsEff_all->GetXaxis(), "Signal (hh#rightarrow4b) Efficiency");
    SetAxes(out2D_leading.gRate_vsEff_all->GetYaxis(), "Estimated Background Rate [Hz]");

    

    // 2D "vs-threshold & Rmax" views (surfaces)
    auto c1_leading2D = new TCanvas("c1_leading2D","ET_thr vs Rmax surfaces",1200,520);
    c1_leading2D->Divide(2,1);

    // Efficiency surface
    c1_leading2D->cd(1);
    gPad->SetLeftMargin(0.16); gPad->SetRightMargin(0.18); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    out2D_leading.hEff_vsThr_vsR->SetTitle(";Leading JetTagger LRJ E_{T} threshold [GeV];R_{max};Signal (hh#rightarrow4b) Efficiency");
    out2D_leading.hEff_vsThr_vsR->Draw("COLZ");

    // Background-rate surface (log Z)
    c1_leading2D->cd(2);
    gPad->SetLeftMargin(0.16); gPad->SetRightMargin(0.16); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    gPad->SetLogz();
    out2D_leading.hRate_vsThr_vsR->SetTitle(";Leading JetTagger LRJ E_{T} threshold [GeV];R_{max};Estimated Background Rate [Hz]");
    out2D_leading.hRate_vsThr_vsR->Draw("COLZ");
    c1_leading2D->SaveAs(rateVsEffFileDir + "surfaces_ETthr_vs_Rmax_leading.pdf");

    // Main plot: rate vs efficiency (all points from the 2D scan)
    auto c2_leading2D = new TCanvas("c2_leading2D","Rate vs Eff (2D scan, leading)",700,600);
    c2_leading2D->SetLeftMargin(0.16); c2_leading2D->SetBottomMargin(0.16); c2_leading2D->SetTicks(1,1);
    c2_leading2D->SetLogy();
    out2D_leading.gRate_vsEff_all->Draw("AP");   // A=axes, P=points
    c2_leading2D->SaveAs(rateVsEffFileDir + "rate_vs_eff_scan2D_leading.pdf");


    // ================== SUBLEADING (ET_th vs R_max scan) =======================
    auto out2D_subl = MakeRateVsEff_ScanRMax(
        sigJetTaggerSubleadingLRJEtvsPsi_12,      backJetTaggerSubleadingLRJEtvsPsi_12        // same R histos
    );

    // Axis titles
    SetAxes(out2D_subl.hEff_vsThr_vsR ->GetXaxis(), "Subleading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_subl.hEff_vsThr_vsR ->GetYaxis(), "R_{max} = #psi_{R,lead}/#psi_{R,subl}");
    SetAxes(out2D_subl.hRate_vsThr_vsR->GetXaxis(), "Subleading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_subl.hRate_vsThr_vsR->GetYaxis(), "R_{max} = #psi_{R,lead}/#psi_{R,subl}");

    SetAxes(out2D_subl.gRate_vsEff_all->GetXaxis(), "Signal (hh#rightarrow4b) Efficiency");
    SetAxes(out2D_subl.gRate_vsEff_all->GetYaxis(), "Estimated Background Rate [Hz]");

    

    // 2D surfaces
    auto c1_subl2D = new TCanvas("c1_subl2D","ET_thr vs Rmax surfaces (subleading)",1200,520);
    c1_subl2D->Divide(2,1);

    // Efficiency surface
    c1_subl2D->cd(1);
    gPad->SetLeftMargin(0.16); gPad->SetRightMargin(0.18); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    out2D_subl.hEff_vsThr_vsR->SetTitle(";Subleading JetTagger LRJ E_{T} threshold [GeV];R_{max};Signal (hh#rightarrow4b) Efficiency");
    out2D_subl.hEff_vsThr_vsR->Draw("COLZ");

    // Background-rate surface (log Z)
    c1_subl2D->cd(2);
    gPad->SetLeftMargin(0.16); gPad->SetRightMargin(0.18); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    gPad->SetLogz();
    out2D_subl.hRate_vsThr_vsR->SetTitle(";Subleading JetTagger LRJ E_{T} threshold [GeV];R_{max};Estimated Background Rate [Hz]");
    out2D_subl.hRate_vsThr_vsR->Draw("COLZ");
    c1_subl2D->SaveAs(rateVsEffFileDir + "surfaces_ETthr_vs_Rmax_subleading.pdf");

    // Main plot: rate vs efficiency (all points)
    auto c2_subl2D = new TCanvas("c2_subl2D","Rate vs Eff (2D scan, subleading)",700,600);
    c2_subl2D->SetLeftMargin(0.16); c2_subl2D->SetBottomMargin(0.16); c2_subl2D->SetTicks(1,1);
    c2_subl2D->SetLogy();
    out2D_subl.gRate_vsEff_all->Draw("AP");
    c2_subl2D->SaveAs(rateVsEffFileDir + "rate_vs_eff_scan2D_subleading.pdf");

    // ===================== LEADING (ET_thr vs P_min scan) =======================
    auto out2D_leading_Pmin = MakeRateVsEff_ScanRMin(
        sigJetTaggerLeadingLRJEtvsPsi_R_squared,     backJetTaggerLeadingLRJEtvsPsi_R_squared       // P = psiR_lead * psiR_subl
    );

    // Axis titles
    SetAxes(out2D_leading_Pmin.hEff_vsThr_vsR ->GetXaxis(), "Leading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_leading_Pmin.hEff_vsThr_vsR ->GetYaxis(), "P_{min} = #psi_{R,lead}#times#psi_{R,subl}");
    SetAxes(out2D_leading_Pmin.hRate_vsThr_vsR->GetXaxis(), "Leading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_leading_Pmin.hRate_vsThr_vsR->GetYaxis(), "P_{min} = #psi_{R,lead}#times#psi_{R,subl}");

    SetAxes(out2D_leading_Pmin.gRate_vsEff_all->GetXaxis(), "Signal (hh#rightarrow4b) Efficiency");
    SetAxes(out2D_leading_Pmin.gRate_vsEff_all->GetYaxis(), "Estimated Background Rate [Hz]");

    //lead_ET_Pmin_Scan_RatesVsEff_vec.push_back(out2D_leading.gRate_vsEff_all);
    lead_ET_Pmin_Scan_RatesVsEff_vec.push_back(
        (TGraphErrors*) out2D_leading_Pmin.gRate_vsEff_all->Clone(
            Form("%s_clone_%u", out2D_leading.gRate_vsEff_all->GetName(), fileIt)
        )
    );

    out2D_leading_Pmin.hEff_vsThr_vsR->GetZaxis()->SetTitleOffset(1.4);
    out2D_leading_Pmin.hRate_vsThr_vsR->GetZaxis()->SetTitleOffset(1.6);

    // 2D "vs-threshold & Pmin" views (surfaces)
    auto c1_leading2D_Pmin = new TCanvas("c1_leading2D_Pmin","ET_thr vs Pmin surfaces (leading)",1200,520);
    c1_leading2D_Pmin->Divide(2,1);

    // Efficiency surface
    c1_leading2D_Pmin->cd(1);
    gPad->SetLeftMargin(0.16); gPad->SetRightMargin(0.18); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    out2D_leading_Pmin.hEff_vsThr_vsR->SetTitle(";Leading JetTagger LRJ E_{T} threshold [GeV];P_{min};Signal (hh#rightarrow4b) Efficiency");
    out2D_leading_Pmin.hEff_vsThr_vsR->Draw("COLZ");

    // Background-rate surface (log Z)
    c1_leading2D_Pmin->cd(2);
    gPad->SetLeftMargin(0.12); gPad->SetRightMargin(0.2); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    gPad->SetLogz();
    out2D_leading_Pmin.hRate_vsThr_vsR->SetTitle(";Leading JetTagger LRJ E_{T} threshold [GeV];P_{min};Estimated Background Rate [Hz]");
    out2D_leading_Pmin.hRate_vsThr_vsR->Draw("COLZ");
    c1_leading2D_Pmin->SaveAs(rateVsEffFileDir + "surfaces_ETthr_vs_Pmin_leading.pdf");

    // Main plot: rate vs efficiency (all points from the 2D scan)
    auto c2_leading2D_Pmin = new TCanvas("c2_leading2D_Pmin","Rate vs Eff (2D scan, leading, Pmin)",700,600);
    c2_leading2D_Pmin->SetLeftMargin(0.16); c2_leading2D_Pmin->SetBottomMargin(0.16); c2_leading2D_Pmin->SetTicks(1,1);
    c2_leading2D_Pmin->SetLogy();
    out2D_leading_Pmin.gRate_vsEff_all->Draw("AP");   // A=axes, P=points
    c2_leading2D_Pmin->SaveAs(rateVsEffFileDir + "rate_vs_eff_scan2D_Pmin_leading.pdf");

    // ===================== LEADING (ET_thr vs P_max scan) =======================
    auto out2D_leading_Pmax = MakeRateVsEff_ScanRMax(
        sigJetTaggerLeadingLRJEtvsPsi_R_squared,     backJetTaggerLeadingLRJEtvsPsi_R_squared       // P = psiR_lead * psiR_subl
    );

    // Axis titles
    SetAxes(out2D_leading_Pmax.hEff_vsThr_vsR ->GetXaxis(), "Leading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_leading_Pmax.hEff_vsThr_vsR ->GetYaxis(), "P_{max} = #psi_{R,lead}#times#psi_{R,subl}");
    SetAxes(out2D_leading_Pmax.hRate_vsThr_vsR->GetXaxis(), "Leading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_leading_Pmax.hRate_vsThr_vsR->GetYaxis(), "P_{max} = #psi_{R,lead}#times#psi_{R,subl}");

    SetAxes(out2D_leading_Pmax.gRate_vsEff_all->GetXaxis(), "Signal (hh#rightarrow4b) Efficiency");
    SetAxes(out2D_leading_Pmax.gRate_vsEff_all->GetYaxis(), "Estimated Background Rate [Hz]");

    //lead_ET_Pmax_Scan_RatesVsEff_vec.push_back(out2D_leading.gRate_vsEff_all);
    lead_ET_Pmax_Scan_RatesVsEff_vec.push_back(
        (TGraphErrors*) out2D_leading_Pmax.gRate_vsEff_all->Clone(
            Form("%s_clone_%u", out2D_leading.gRate_vsEff_all->GetName(), fileIt)
        )
    );

    out2D_leading_Pmax.hEff_vsThr_vsR->GetZaxis()->SetTitleOffset(1.4);
    out2D_leading_Pmax.hRate_vsThr_vsR->GetZaxis()->SetTitleOffset(1.6);

    // 2D "vs-threshold & Pmax" views (surfaces)
    auto c1_leading2D_Pmax = new TCanvas("c1_leading2D_Pmax","ET_thr vs Pmax surfaces (leading)",1200,520);
    c1_leading2D_Pmax->Divide(2,1);

    // Efficiency surface
    c1_leading2D_Pmax->cd(1);
    gPad->SetLeftMargin(0.16); gPad->SetRightMargin(0.18); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    out2D_leading_Pmax.hEff_vsThr_vsR->SetTitle(";Leading JetTagger LRJ E_{T} threshold [GeV];P_{max};Signal (hh#rightarrow4b) Efficiency");
    out2D_leading_Pmax.hEff_vsThr_vsR->Draw("COLZ");

    // Background-rate surface (log Z)
    c1_leading2D_Pmax->cd(2);
    gPad->SetLeftMargin(0.12); gPad->SetRightMargin(0.2); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    gPad->SetLogz();
    out2D_leading_Pmax.hRate_vsThr_vsR->SetTitle(";Leading JetTagger LRJ E_{T} threshold [GeV];P_{max};Estimated Background Rate [Hz]");
    out2D_leading_Pmax.hRate_vsThr_vsR->Draw("COLZ");
    c1_leading2D_Pmax->SaveAs(rateVsEffFileDir + "surfaces_ETthr_vs_Pmax_leading.pdf");

    // Main plot: rate vs efficiency (all points from the 2D scan)
    auto c2_leading2D_Pmax = new TCanvas("c2_leading2D_Pmax","Rate vs Eff (2D scan, leading, Pmax)",700,600);
    c2_leading2D_Pmax->SetLeftMargin(0.16); c2_leading2D_Pmax->SetBottomMargin(0.16); c2_leading2D_Pmax->SetTicks(1,1);
    c2_leading2D_Pmax->SetLogy();
    out2D_leading_Pmax.gRate_vsEff_all->Draw("AP");   // A=axes, P=points
    c2_leading2D_Pmax->SaveAs(rateVsEffFileDir + "rate_vs_eff_scan2D_Pmax_leading.pdf");


    // ================== SUBLEADING (ET_thr vs P_max scan) ======================
    auto out2D_subl_Pmax = MakeRateVsEff_ScanRMax(
        sigJetTaggerSubleadingLRJEtvsPsi_R_squared,     backJetTaggerSubleadingLRJEtvsPsi_R_squared      // same P histos
    );

    // Axis titles
    SetAxes(out2D_subl_Pmax.hEff_vsThr_vsR ->GetXaxis(), "Subleading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_subl_Pmax.hEff_vsThr_vsR ->GetYaxis(), "P_{max} = #psi_{R,lead}#times#psi_{R,subl}");
    SetAxes(out2D_subl_Pmax.hRate_vsThr_vsR->GetXaxis(), "Subleading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_subl_Pmax.hRate_vsThr_vsR->GetYaxis(), "P_{max} = #psi_{R,lead}#times#psi_{R,subl}");

    SetAxes(out2D_subl_Pmax.gRate_vsEff_all->GetXaxis(), "Signal (hh#rightarrow4b) Efficiency");
    SetAxes(out2D_subl_Pmax.gRate_vsEff_all->GetYaxis(), "Estimated Background Rate [Hz]");
    out2D_subl_Pmax.hEff_vsThr_vsR->GetZaxis()->SetTitleOffset(1.4);
    out2D_subl_Pmax.hRate_vsThr_vsR->GetZaxis()->SetTitleOffset(1.6);

    //sublead_ET_Pmax_Scan_RatesVsEff_vec.push_back(out2D_subl.gRate_vsEff_all);
    sublead_ET_Pmax_Scan_RatesVsEff_vec.push_back(
        (TGraphErrors*) out2D_subl_Pmax.gRate_vsEff_all->Clone(
            Form("%s_clone_%u", out2D_subl_Pmax.gRate_vsEff_all->GetName(), fileIt)
        )
    );

    // 2D surfaces
    auto c1_subl2D_Pmax = new TCanvas("c1_subl2D_Pmax","ET_thr vs Pmax surfaces (subleading)",1200,520);
    c1_subl2D_Pmax->Divide(2,1);

    // Efficiency surface
    c1_subl2D_Pmax->cd(1);
    gPad->SetLeftMargin(0.16); gPad->SetRightMargin(0.18); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    out2D_subl_Pmax.hEff_vsThr_vsR->SetTitle(";Subleading JetTagger LRJ E_{T} threshold [GeV];P_{max};Signal (hh#rightarrow4b) Efficiency");
    out2D_subl_Pmax.hEff_vsThr_vsR->Draw("COLZ");

    // Background-rate surface (log Z)
    c1_subl2D_Pmax->cd(2);
    gPad->SetLeftMargin(0.16); gPad->SetRightMargin(0.18); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    gPad->SetLogz();
    out2D_subl_Pmax.hRate_vsThr_vsR->SetTitle(";Subleading JetTagger LRJ E_{T} threshold [GeV];P_{max};Estimated Background Rate [Hz]");
    out2D_subl_Pmax.hRate_vsThr_vsR->Draw("COLZ");
    c1_subl2D_Pmax->SaveAs(rateVsEffFileDir + "surfaces_ETthr_vs_Pmax_subleading.pdf");

    // Main plot: rate vs efficiency (all points)
    auto c2_subl2D_Pmax = new TCanvas("c2_subl2D_Pmax","Rate vs Eff (2D scan, subleading, Pmax)",700,600);
    c2_subl2D_Pmax->SetLeftMargin(0.16); c2_subl2D_Pmax->SetBottomMargin(0.16); c2_subl2D_Pmax->SetTicks(1,1);
    c2_subl2D_Pmax->SetLogy();
    out2D_subl_Pmax.gRate_vsEff_all->Draw("AP");
    c2_subl2D_Pmax->SaveAs(rateVsEffFileDir + "rate_vs_eff_scan2D_Pmax_subleading.pdf");

    // ===================== LEADING (ET_thr vs P_max scan) =======================
    auto out2D_leading_Pmax_R2 = MakeRateVsEff_ScanRMax(
        sigJetTaggerLeadingLRJEtvsPsi_R2_squared,     backJetTaggerLeadingLRJEtvsPsi_R2_squared       // P = psiR_lead * psiR_subl
    );

    // Axis titles
    SetAxes(out2D_leading_Pmax_R2.hEff_vsThr_vsR ->GetXaxis(), "Leading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_leading_Pmax_R2.hEff_vsThr_vsR ->GetYaxis(), "P_{max} = #psi_{R,lead}#times#psi_{R,subl}");
    SetAxes(out2D_leading_Pmax_R2.hRate_vsThr_vsR->GetXaxis(), "Leading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_leading_Pmax_R2.hRate_vsThr_vsR->GetYaxis(), "P_{max} = #psi_{R,lead}#times#psi_{R,subl}");

    SetAxes(out2D_leading_Pmax_R2.gRate_vsEff_all->GetXaxis(), "Signal (hh#rightarrow4b) Efficiency");
    SetAxes(out2D_leading_Pmax_R2.gRate_vsEff_all->GetYaxis(), "Estimated Background Rate [Hz]");

    out2D_leading_Pmax_R2.hEff_vsThr_vsR->GetZaxis()->SetTitleOffset(1.4);
    out2D_leading_Pmax_R2.hRate_vsThr_vsR->GetZaxis()->SetTitleOffset(1.6);

    // 2D "vs-threshold & Pmax" views (surfaces)
    auto c1_leading2D_Pmax_R2 = new TCanvas("c1_leading2D_Pmax_R2","ET_thr vs Pmax surfaces (leading)",1200,520);
    c1_leading2D_Pmax_R2->Divide(2,1);

    // Efficiency surface
    c1_leading2D_Pmax_R2->cd(1);
    gPad->SetLeftMargin(0.16); gPad->SetRightMargin(0.18); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    out2D_leading_Pmax_R2.hEff_vsThr_vsR->SetTitle(";Leading JetTagger LRJ E_{T} threshold [GeV];P_{max};Signal (hh#rightarrow4b) Efficiency");
    out2D_leading_Pmax_R2.hEff_vsThr_vsR->Draw("COLZ");

    // Background-rate surface (log Z)
    c1_leading2D_Pmax_R2->cd(2);
    gPad->SetLeftMargin(0.12); gPad->SetRightMargin(0.2); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    gPad->SetLogz();
    out2D_leading_Pmax_R2.hRate_vsThr_vsR->SetTitle(";Leading JetTagger LRJ E_{T} threshold [GeV];P_{max};Estimated Background Rate [Hz]");
    out2D_leading_Pmax_R2.hRate_vsThr_vsR->Draw("COLZ");
    c1_leading2D_Pmax_R2->SaveAs(rateVsEffFileDir + "surfaces_ETthr_vs_Pmax_leading_R2.pdf");

    // Main plot: rate vs efficiency (all points from the 2D scan)
    auto c2_leading2D_Pmax_R2 = new TCanvas("c2_leading2D_Pmax_R2","Rate vs Eff (2D scan, leading, Pmax)",700,600);
    c2_leading2D_Pmax_R2->SetLeftMargin(0.16); c2_leading2D_Pmax_R2->SetBottomMargin(0.16); c2_leading2D_Pmax_R2->SetTicks(1,1);
    c2_leading2D_Pmax_R2->SetLogy();
    out2D_leading_Pmax_R2.gRate_vsEff_all->Draw("AP");   // A=axes, P=points
    c2_leading2D_Pmax_R2->SaveAs(rateVsEffFileDir + "rate_vs_eff_scan2D_Pmax_leading_R2.pdf");


    // ================== SUBLEADING (ET_thr vs P_max scan) ======================
    auto out2D_subl_Pmax_R2 = MakeRateVsEff_ScanRMax(
        sigJetTaggerSubleadingLRJEtvsPsi_R2_squared,     backJetTaggerSubleadingLRJEtvsPsi_R2_squared      // same P histos
    );

    // Axis titles
    SetAxes(out2D_subl_Pmax_R2.hEff_vsThr_vsR ->GetXaxis(), "Subleading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_subl_Pmax_R2.hEff_vsThr_vsR ->GetYaxis(), "P_{max} = #psi_{R,lead}#times#psi_{R,subl}");
    SetAxes(out2D_subl_Pmax_R2.hRate_vsThr_vsR->GetXaxis(), "Subleading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_subl_Pmax_R2.hRate_vsThr_vsR->GetYaxis(), "P_{max} = #psi_{R,lead}#times#psi_{R,subl}");

    SetAxes(out2D_subl_Pmax_R2.gRate_vsEff_all->GetXaxis(), "Signal (hh#rightarrow4b) Efficiency");
    SetAxes(out2D_subl_Pmax_R2.gRate_vsEff_all->GetYaxis(), "Estimated Background Rate [Hz]");
    out2D_subl_Pmax_R2.hEff_vsThr_vsR->GetZaxis()->SetTitleOffset(1.4);
    out2D_subl_Pmax_R2.hRate_vsThr_vsR->GetZaxis()->SetTitleOffset(1.6);

    // 2D surfaces
    auto c1_subl2D_Pmax_R2 = new TCanvas("c1_subl2D_Pmax_R2","ET_thr vs Pmax surfaces (subleading)",1200,520);
    c1_subl2D_Pmax_R2->Divide(2,1);

    // Efficiency surface
    c1_subl2D_Pmax_R2->cd(1);
    gPad->SetLeftMargin(0.16); gPad->SetRightMargin(0.18); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    out2D_subl_Pmax_R2.hEff_vsThr_vsR->SetTitle(";Subleading JetTagger LRJ E_{T} threshold [GeV];P_{max};Signal (hh#rightarrow4b) Efficiency");
    out2D_subl_Pmax_R2.hEff_vsThr_vsR->Draw("COLZ");

    // Background-rate surface (log Z)
    c1_subl2D_Pmax_R2->cd(2);
    gPad->SetLeftMargin(0.16); gPad->SetRightMargin(0.18); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    gPad->SetLogz();
    out2D_subl_Pmax_R2.hRate_vsThr_vsR->SetTitle(";Subleading JetTagger LRJ E_{T} threshold [GeV];P_{max};Estimated Background Rate [Hz]");
    out2D_subl_Pmax_R2.hRate_vsThr_vsR->Draw("COLZ");
    c1_subl2D_Pmax_R2->SaveAs(rateVsEffFileDir + "surfaces_ETthr_vs_Pmax_subleading_R2.pdf");

    // Main plot: rate vs efficiency (all points)
    auto c2_subl2D_Pmax_R2 = new TCanvas("c2_subl2D_Pmax_R2","Rate vs Eff (2D scan, subleading, Pmax)",700,600);
    c2_subl2D_Pmax_R2->SetLeftMargin(0.16); c2_subl2D_Pmax_R2->SetBottomMargin(0.16); c2_subl2D_Pmax_R2->SetTicks(1,1);
    c2_subl2D_Pmax_R2->SetLogy();
    out2D_subl_Pmax_R2.gRate_vsEff_all->Draw("AP");
    c2_subl2D_Pmax_R2->SaveAs(rateVsEffFileDir + "rate_vs_eff_scan2D_Pmax_subleading_R2.pdf");

    // ===================== LEADING (ET_thr vs P_max scan, N=2) =======================
    auto out2D_leading_Pmax_N2 = MakeRateVsEff_ScanRMax(
        sigJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_2, backJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_2
    );

    SetAxes(out2D_leading_Pmax_N2.hEff_vsThr_vsR ->GetXaxis(), "Leading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_leading_Pmax_N2.hEff_vsThr_vsR ->GetYaxis(), "P_{max} = #psi_{R,lead}#times#psi_{R,subl}");
    SetAxes(out2D_leading_Pmax_N2.hRate_vsThr_vsR->GetXaxis(), "Leading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_leading_Pmax_N2.hRate_vsThr_vsR->GetYaxis(), "P_{max} = #psi_{R,lead}#times#psi_{R,subl}");

    SetAxes(out2D_leading_Pmax_N2.gRate_vsEff_all->GetXaxis(), "Signal (hh#rightarrow4b) Efficiency");
    SetAxes(out2D_leading_Pmax_N2.gRate_vsEff_all->GetYaxis(), "Estimated Background Rate [Hz]");
    out2D_leading_Pmax_N2.hEff_vsThr_vsR->GetZaxis()->SetTitleOffset(1.4);
    out2D_leading_Pmax_N2.hRate_vsThr_vsR->GetZaxis()->SetTitleOffset(1.6);

    auto c1_leading2D_Pmax_N2 = new TCanvas("c1_leading2D_Pmax_N2","ET_thr vs Pmax surfaces (leading, N=2)",1200,520);
    c1_leading2D_Pmax_N2->Divide(2,1);

    c1_leading2D_Pmax_N2->cd(1);
    gPad->SetLeftMargin(0.16); gPad->SetRightMargin(0.18); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    out2D_leading_Pmax_N2.hEff_vsThr_vsR->SetTitle(";Leading JetTagger LRJ E_{T} threshold [GeV];P_{max};Signal (hh#rightarrow4b) Efficiency");
    out2D_leading_Pmax_N2.hEff_vsThr_vsR->Draw("COLZ");

    c1_leading2D_Pmax_N2->cd(2);
    gPad->SetLeftMargin(0.12); gPad->SetRightMargin(0.2); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    gPad->SetLogz();
    out2D_leading_Pmax_N2.hRate_vsThr_vsR->SetTitle(";Leading JetTagger LRJ E_{T} threshold [GeV];P_{max};Estimated Background Rate [Hz]");
    out2D_leading_Pmax_N2.hRate_vsThr_vsR->Draw("COLZ");
    c1_leading2D_Pmax_N2->SaveAs(rateVsEffFileDir + "surfaces_ETthr_vs_Pmax_leading_N2.pdf");

    auto c2_leading2D_Pmax_N2 = new TCanvas("c2_leading2D_Pmax_N2","Rate vs Eff (2D scan, leading, Pmax, N=2)",700,600);
    c2_leading2D_Pmax_N2->SetLeftMargin(0.16); c2_leading2D_Pmax_N2->SetBottomMargin(0.16); c2_leading2D_Pmax_N2->SetTicks(1,1);
    c2_leading2D_Pmax_N2->SetLogy();
    out2D_leading_Pmax_N2.gRate_vsEff_all->Draw("AP");
    c2_leading2D_Pmax_N2->SaveAs(rateVsEffFileDir + "rate_vs_eff_scan2D_Pmax_leading_N2.pdf");

    // ================== SUBLEADING (ET_thr vs P_max scan, N=2) ======================
    auto out2D_subl_Pmax_N2 = MakeRateVsEff_ScanRMax(
        sigJetTaggerSubleadingLRJEtvsPsi_R_VariableIOs_2, backJetTaggerSubleadingLRJEtvsPsi_R_VariableIOs_2
    );

    SetAxes(out2D_subl_Pmax_N2.hEff_vsThr_vsR ->GetXaxis(), "Subleading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_subl_Pmax_N2.hEff_vsThr_vsR ->GetYaxis(), "P_{max} = #psi_{R,lead}#times#psi_{R,subl}");
    SetAxes(out2D_subl_Pmax_N2.hRate_vsThr_vsR->GetXaxis(), "Subleading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_subl_Pmax_N2.hRate_vsThr_vsR->GetYaxis(), "P_{max} = #psi_{R,lead}#times#psi_{R,subl}");

    SetAxes(out2D_subl_Pmax_N2.gRate_vsEff_all->GetXaxis(), "Signal (hh#rightarrow4b) Efficiency");
    SetAxes(out2D_subl_Pmax_N2.gRate_vsEff_all->GetYaxis(), "Estimated Background Rate [Hz]");
    out2D_subl_Pmax_N2.hEff_vsThr_vsR->GetZaxis()->SetTitleOffset(1.4);
    out2D_subl_Pmax_N2.hRate_vsThr_vsR->GetZaxis()->SetTitleOffset(1.6);

    auto c1_subl2D_Pmax_N2 = new TCanvas("c1_subl2D_Pmax_N2","ET_thr vs Pmax surfaces (subleading, N=2)",1200,520);
    c1_subl2D_Pmax_N2->Divide(2,1);

    c1_subl2D_Pmax_N2->cd(1);
    gPad->SetLeftMargin(0.16); gPad->SetRightMargin(0.18); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    out2D_subl_Pmax_N2.hEff_vsThr_vsR->SetTitle(";Subleading JetTagger LRJ E_{T} threshold [GeV];P_{max};Signal (hh#rightarrow4b) Efficiency");
    out2D_subl_Pmax_N2.hEff_vsThr_vsR->Draw("COLZ");

    c1_subl2D_Pmax_N2->cd(2);
    gPad->SetLeftMargin(0.16); gPad->SetRightMargin(0.18); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    gPad->SetLogz();
    out2D_subl_Pmax_N2.hRate_vsThr_vsR->SetTitle(";Subleading JetTagger LRJ E_{T} threshold [GeV];P_{max};Estimated Background Rate [Hz]");
    out2D_subl_Pmax_N2.hRate_vsThr_vsR->Draw("COLZ");
    c1_subl2D_Pmax_N2->SaveAs(rateVsEffFileDir + "surfaces_ETthr_vs_Pmax_subleading_N2.pdf");

    auto c2_subl2D_Pmax_N2 = new TCanvas("c2_subl2D_Pmax_N2","Rate vs Eff (2D scan, subleading, Pmax, N=2)",700,600);
    c2_subl2D_Pmax_N2->SetLeftMargin(0.16); c2_subl2D_Pmax_N2->SetBottomMargin(0.16); c2_subl2D_Pmax_N2->SetTicks(1,1);
    c2_subl2D_Pmax_N2->SetLogy();
    out2D_subl_Pmax_N2.gRate_vsEff_all->Draw("AP");
    c2_subl2D_Pmax_N2->SaveAs(rateVsEffFileDir + "rate_vs_eff_scan2D_Pmax_subleading_N2.pdf");


    // ===================== LEADING (ET_thr vs P_max scan, N=3) =======================
    auto out2D_leading_Pmax_N3 = MakeRateVsEff_ScanRMax(
        sigJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_3, backJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_3
    );

    // Axis titles
    SetAxes(out2D_leading_Pmax_N3.hEff_vsThr_vsR ->GetXaxis(), "Leading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_leading_Pmax_N3.hEff_vsThr_vsR ->GetYaxis(), "P_{max} = #psi_{R,lead}#times#psi_{R,subl}");
    SetAxes(out2D_leading_Pmax_N3.hRate_vsThr_vsR->GetXaxis(), "Leading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_leading_Pmax_N3.hRate_vsThr_vsR->GetYaxis(), "P_{max} = #psi_{R,lead}#times#psi_{R,subl}");
    SetAxes(out2D_leading_Pmax_N3.gRate_vsEff_all->GetXaxis(), "Signal (hh#rightarrow4b) Efficiency");
    SetAxes(out2D_leading_Pmax_N3.gRate_vsEff_all->GetYaxis(), "Estimated Background Rate [Hz]");

    out2D_leading_Pmax_N3.hEff_vsThr_vsR->GetZaxis()->SetTitleOffset(1.4);
    out2D_leading_Pmax_N3.hRate_vsThr_vsR->GetZaxis()->SetTitleOffset(1.6);

    // 2D "vs-threshold & Pmax" views (surfaces)
    auto c1_leading2D_Pmax_N3 = new TCanvas("c1_leading2D_Pmax_N3","ET_thr vs Pmax surfaces (leading, N=3)",1200,520);
    c1_leading2D_Pmax_N3->Divide(2,1);

    // Efficiency surface
    c1_leading2D_Pmax_N3->cd(1);
    gPad->SetLeftMargin(0.16); gPad->SetRightMargin(0.18); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    out2D_leading_Pmax_N3.hEff_vsThr_vsR->SetTitle(";Leading JetTagger LRJ E_{T} threshold [GeV];P_{max};Signal (hh#rightarrow4b) Efficiency");
    out2D_leading_Pmax_N3.hEff_vsThr_vsR->Draw("COLZ");

    // Background-rate surface (log Z)
    c1_leading2D_Pmax_N3->cd(2);
    gPad->SetLeftMargin(0.12); gPad->SetRightMargin(0.2); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    gPad->SetLogz();
    out2D_leading_Pmax_N3.hRate_vsThr_vsR->SetTitle(";Leading JetTagger LRJ E_{T} threshold [GeV];P_{max};Estimated Background Rate [Hz]");
    out2D_leading_Pmax_N3.hRate_vsThr_vsR->Draw("COLZ");
    c1_leading2D_Pmax_N3->SaveAs(rateVsEffFileDir + "surfaces_ETthr_vs_Pmax_leading_N3.pdf");

    // Main plot: rate vs efficiency
    auto c2_leading2D_Pmax_N3 = new TCanvas("c2_leading2D_Pmax_N3","Rate vs Eff (2D scan, leading, Pmax, N=3)",700,600);
    c2_leading2D_Pmax_N3->SetLeftMargin(0.16); c2_leading2D_Pmax_N3->SetBottomMargin(0.16); c2_leading2D_Pmax_N3->SetTicks(1,1);
    c2_leading2D_Pmax_N3->SetLogy();
    out2D_leading_Pmax_N3.gRate_vsEff_all->Draw("AP");
    c2_leading2D_Pmax_N3->SaveAs(rateVsEffFileDir + "rate_vs_eff_scan2D_Pmax_leading_N3.pdf");

    // ================== SUBLEADING (ET_thr vs P_max scan, N=3) ======================
    auto out2D_subl_Pmax_N3 = MakeRateVsEff_ScanRMax(
        sigJetTaggerSubleadingLRJEtvsPsi_R_VariableIOs_3, backJetTaggerSubleadingLRJEtvsPsi_R_VariableIOs_3
    );

    SetAxes(out2D_subl_Pmax_N3.hEff_vsThr_vsR ->GetXaxis(), "Subleading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_subl_Pmax_N3.hEff_vsThr_vsR ->GetYaxis(), "P_{max} = #psi_{R,lead}#times#psi_{R,subl}");
    SetAxes(out2D_subl_Pmax_N3.hRate_vsThr_vsR->GetXaxis(), "Subleading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_subl_Pmax_N3.hRate_vsThr_vsR->GetYaxis(), "P_{max} = #psi_{R,lead}#times#psi_{R,subl}");
    SetAxes(out2D_subl_Pmax_N3.gRate_vsEff_all->GetXaxis(), "Signal (hh#rightarrow4b) Efficiency");
    SetAxes(out2D_subl_Pmax_N3.gRate_vsEff_all->GetYaxis(), "Estimated Background Rate [Hz]");

    out2D_subl_Pmax_N3.hEff_vsThr_vsR->GetZaxis()->SetTitleOffset(1.4);
    out2D_subl_Pmax_N3.hRate_vsThr_vsR->GetZaxis()->SetTitleOffset(1.6);

    // 2D surfaces
    auto c1_subl2D_Pmax_N3 = new TCanvas("c1_subl2D_Pmax_N3","ET_thr vs Pmax surfaces (subleading, N=3)",1200,520);
    c1_subl2D_Pmax_N3->Divide(2,1);

    c1_subl2D_Pmax_N3->cd(1);
    gPad->SetLeftMargin(0.16); gPad->SetRightMargin(0.18); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    out2D_subl_Pmax_N3.hEff_vsThr_vsR->SetTitle(";Subleading JetTagger LRJ E_{T} threshold [GeV];P_{max};Signal (hh#rightarrow4b) Efficiency");
    out2D_subl_Pmax_N3.hEff_vsThr_vsR->Draw("COLZ");

    c1_subl2D_Pmax_N3->cd(2);
    gPad->SetLeftMargin(0.16); gPad->SetRightMargin(0.18); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    gPad->SetLogz();
    out2D_subl_Pmax_N3.hRate_vsThr_vsR->SetTitle(";Subleading JetTagger LRJ E_{T} threshold [GeV];P_{max};Estimated Background Rate [Hz]");
    out2D_subl_Pmax_N3.hRate_vsThr_vsR->Draw("COLZ");
    c1_subl2D_Pmax_N3->SaveAs(rateVsEffFileDir + "surfaces_ETthr_vs_Pmax_subleading_N3.pdf");

    auto c2_subl2D_Pmax_N3 = new TCanvas("c2_subl2D_Pmax_N3","Rate vs Eff (2D scan, subleading, Pmax, N=3)",700,600);
    c2_subl2D_Pmax_N3->SetLeftMargin(0.16); c2_subl2D_Pmax_N3->SetBottomMargin(0.16); c2_subl2D_Pmax_N3->SetTicks(1,1);
    c2_subl2D_Pmax_N3->SetLogy();
    out2D_subl_Pmax_N3.gRate_vsEff_all->Draw("AP");
    c2_subl2D_Pmax_N3->SaveAs(rateVsEffFileDir + "rate_vs_eff_scan2D_Pmax_subleading_N3.pdf");

    // ===================== LEADING (ET_thr vs P_max scan, N=4) =======================
    auto out2D_leading_Pmax_N4 = MakeRateVsEff_ScanRMax(
        sigJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_4, backJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_4
    );

    // Axis titles
    SetAxes(out2D_leading_Pmax_N4.hEff_vsThr_vsR ->GetXaxis(), "Leading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_leading_Pmax_N4.hEff_vsThr_vsR ->GetYaxis(), "P_{max} = #psi_{R,lead}#times#psi_{R,subl}");
    SetAxes(out2D_leading_Pmax_N4.hRate_vsThr_vsR->GetXaxis(), "Leading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_leading_Pmax_N4.hRate_vsThr_vsR->GetYaxis(), "P_{max} = #psi_{R,lead}#times#psi_{R,subl}");
    SetAxes(out2D_leading_Pmax_N4.gRate_vsEff_all->GetXaxis(), "Signal (hh#rightarrow4b) Efficiency");
    SetAxes(out2D_leading_Pmax_N4.gRate_vsEff_all->GetYaxis(), "Estimated Background Rate [Hz]");

    out2D_leading_Pmax_N4.hEff_vsThr_vsR->GetZaxis()->SetTitleOffset(1.4);
    out2D_leading_Pmax_N4.hRate_vsThr_vsR->GetZaxis()->SetTitleOffset(1.6);

    // 2D "vs-threshold & Pmax" views (surfaces)
    auto c1_leading2D_Pmax_N4 = new TCanvas("c1_leading2D_Pmax_N4","ET_thr vs Pmax surfaces (leading, N=4)",1200,520);
    c1_leading2D_Pmax_N4->Divide(2,1);

    // Efficiency surface
    c1_leading2D_Pmax_N4->cd(1);
    gPad->SetLeftMargin(0.16); gPad->SetRightMargin(0.18); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    out2D_leading_Pmax_N4.hEff_vsThr_vsR->SetTitle(";Leading JetTagger LRJ E_{T} threshold [GeV];P_{max};Signal (hh#rightarrow4b) Efficiency");
    out2D_leading_Pmax_N4.hEff_vsThr_vsR->Draw("COLZ");

    // Background-rate surface (log Z)
    c1_leading2D_Pmax_N4->cd(2);
    gPad->SetLeftMargin(0.12); gPad->SetRightMargin(0.2); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    gPad->SetLogz();
    out2D_leading_Pmax_N4.hRate_vsThr_vsR->SetTitle(";Leading JetTagger LRJ E_{T} threshold [GeV];P_{max};Estimated Background Rate [Hz]");
    out2D_leading_Pmax_N4.hRate_vsThr_vsR->Draw("COLZ");
    c1_leading2D_Pmax_N4->SaveAs(rateVsEffFileDir + "surfaces_ETthr_vs_Pmax_leading_N4.pdf");

    // Main plot: rate vs efficiency
    auto c2_leading2D_Pmax_N4 = new TCanvas("c2_leading2D_Pmax_N4","Rate vs Eff (2D scan, leading, Pmax, N=4)",700,600);
    c2_leading2D_Pmax_N4->SetLeftMargin(0.16); c2_leading2D_Pmax_N4->SetBottomMargin(0.16); c2_leading2D_Pmax_N4->SetTicks(1,1);
    c2_leading2D_Pmax_N4->SetLogy();
    out2D_leading_Pmax_N4.gRate_vsEff_all->Draw("AP");
    c2_leading2D_Pmax_N4->SaveAs(rateVsEffFileDir + "rate_vs_eff_scan2D_Pmax_leading_N4.pdf");

    // ================== SUBLEADING (ET_thr vs P_max scan, N=4) ======================
    auto out2D_subl_Pmax_N4 = MakeRateVsEff_ScanRMax(
        sigJetTaggerSubleadingLRJEtvsPsi_R_VariableIOs_4, backJetTaggerSubleadingLRJEtvsPsi_R_VariableIOs_4
    );

    SetAxes(out2D_subl_Pmax_N4.hEff_vsThr_vsR ->GetXaxis(), "Subleading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_subl_Pmax_N4.hEff_vsThr_vsR ->GetYaxis(), "P_{max} = #psi_{R,lead}#times#psi_{R,subl}");
    SetAxes(out2D_subl_Pmax_N4.hRate_vsThr_vsR->GetXaxis(), "Subleading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_subl_Pmax_N4.hRate_vsThr_vsR->GetYaxis(), "P_{max} = #psi_{R,lead}#times#psi_{R,subl}");
    SetAxes(out2D_subl_Pmax_N4.gRate_vsEff_all->GetXaxis(), "Signal (hh#rightarrow4b) Efficiency");
    SetAxes(out2D_subl_Pmax_N4.gRate_vsEff_all->GetYaxis(), "Estimated Background Rate [Hz]");

    out2D_subl_Pmax_N4.hEff_vsThr_vsR->GetZaxis()->SetTitleOffset(1.4);
    out2D_subl_Pmax_N4.hRate_vsThr_vsR->GetZaxis()->SetTitleOffset(1.6);

    // 2D surfaces
    auto c1_subl2D_Pmax_N4 = new TCanvas("c1_subl2D_Pmax_N4","ET_thr vs Pmax surfaces (subleading, N=4)",1200,520);
    c1_subl2D_Pmax_N4->Divide(2,1);

    c1_subl2D_Pmax_N4->cd(1);
    gPad->SetLeftMargin(0.16); gPad->SetRightMargin(0.18); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    out2D_subl_Pmax_N4.hEff_vsThr_vsR->SetTitle(";Subleading JetTagger LRJ E_{T} threshold [GeV];P_{max};Signal (hh#rightarrow4b) Efficiency");
    out2D_subl_Pmax_N4.hEff_vsThr_vsR->Draw("COLZ");

    c1_subl2D_Pmax_N4->cd(2);
    gPad->SetLeftMargin(0.16); gPad->SetRightMargin(0.18); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    gPad->SetLogz();
    out2D_subl_Pmax_N4.hRate_vsThr_vsR->SetTitle(";Subleading JetTagger LRJ E_{T} threshold [GeV];P_{max};Estimated Background Rate [Hz]");
    out2D_subl_Pmax_N4.hRate_vsThr_vsR->Draw("COLZ");
    c1_subl2D_Pmax_N4->SaveAs(rateVsEffFileDir + "surfaces_ETthr_vs_Pmax_subleading_N4.pdf");

    auto c2_subl2D_Pmax_N4 = new TCanvas("c2_subl2D_Pmax_N4","Rate vs Eff (2D scan, subleading, Pmax, N=4)",700,600);
    c2_subl2D_Pmax_N4->SetLeftMargin(0.16); c2_subl2D_Pmax_N4->SetBottomMargin(0.16); c2_subl2D_Pmax_N4->SetTicks(1,1);
    c2_subl2D_Pmax_N4->SetLogy();
    out2D_subl_Pmax_N4.gRate_vsEff_all->Draw("AP");
    c2_subl2D_Pmax_N4->SaveAs(rateVsEffFileDir + "rate_vs_eff_scan2D_Pmax_subleading_N4.pdf");


    // ===================== LEADING (ET_thr vs P_max scan, N=5) =======================
    auto out2D_leading_Pmax_N5 = MakeRateVsEff_ScanRMax(
        sigJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_5, backJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_5
    );

    // Axis titles
    SetAxes(out2D_leading_Pmax_N5.hEff_vsThr_vsR ->GetXaxis(), "Leading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_leading_Pmax_N5.hEff_vsThr_vsR ->GetYaxis(), "P_{max} = #psi_{R,lead}#times#psi_{R,subl}");
    SetAxes(out2D_leading_Pmax_N5.hRate_vsThr_vsR->GetXaxis(), "Leading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_leading_Pmax_N5.hRate_vsThr_vsR->GetYaxis(), "P_{max} = #psi_{R,lead}#times#psi_{R,subl}");
    SetAxes(out2D_leading_Pmax_N5.gRate_vsEff_all->GetXaxis(), "Signal (hh#rightarrow4b) Efficiency");
    SetAxes(out2D_leading_Pmax_N5.gRate_vsEff_all->GetYaxis(), "Estimated Background Rate [Hz]");

    out2D_leading_Pmax_N5.hEff_vsThr_vsR->GetZaxis()->SetTitleOffset(1.4);
    out2D_leading_Pmax_N5.hRate_vsThr_vsR->GetZaxis()->SetTitleOffset(1.6);

    // 2D "vs-threshold & Pmax" views (surfaces)
    auto c1_leading2D_Pmax_N5 = new TCanvas("c1_leading2D_Pmax_N5","ET_thr vs Pmax surfaces (leading, N=5)",1200,520);
    c1_leading2D_Pmax_N5->Divide(2,1);

    // Efficiency surface
    c1_leading2D_Pmax_N5->cd(1);
    gPad->SetLeftMargin(0.16); gPad->SetRightMargin(0.18); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    out2D_leading_Pmax_N5.hEff_vsThr_vsR->SetTitle(";Leading JetTagger LRJ E_{T} threshold [GeV];P_{max};Signal (hh#rightarrow4b) Efficiency");
    out2D_leading_Pmax_N5.hEff_vsThr_vsR->Draw("COLZ");

    // Background-rate surface (log Z)
    c1_leading2D_Pmax_N5->cd(2);
    gPad->SetLeftMargin(0.12); gPad->SetRightMargin(0.2); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    gPad->SetLogz();
    out2D_leading_Pmax_N5.hRate_vsThr_vsR->SetTitle(";Leading JetTagger LRJ E_{T} threshold [GeV];P_{max};Estimated Background Rate [Hz]");
    out2D_leading_Pmax_N5.hRate_vsThr_vsR->Draw("COLZ");
    c1_leading2D_Pmax_N5->SaveAs(rateVsEffFileDir + "surfaces_ETthr_vs_Pmax_leading_N5.pdf");

    // Main plot: rate vs efficiency
    auto c2_leading2D_Pmax_N5 = new TCanvas("c2_leading2D_Pmax_N5","Rate vs Eff (2D scan, leading, Pmax, N=5)",700,600);
    c2_leading2D_Pmax_N5->SetLeftMargin(0.16); c2_leading2D_Pmax_N5->SetBottomMargin(0.16); c2_leading2D_Pmax_N5->SetTicks(1,1);
    c2_leading2D_Pmax_N5->SetLogy();
    out2D_leading_Pmax_N5.gRate_vsEff_all->Draw("AP");
    c2_leading2D_Pmax_N5->SaveAs(rateVsEffFileDir + "rate_vs_eff_scan2D_Pmax_leading_N5.pdf");

    // ================== SUBLEADING (ET_thr vs P_max scan, N=5) ======================
    auto out2D_subl_Pmax_N5 = MakeRateVsEff_ScanRMax(
        sigJetTaggerSubleadingLRJEtvsPsi_R_VariableIOs_5, backJetTaggerSubleadingLRJEtvsPsi_R_VariableIOs_5
    );

    SetAxes(out2D_subl_Pmax_N5.hEff_vsThr_vsR ->GetXaxis(), "Subleading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_subl_Pmax_N5.hEff_vsThr_vsR ->GetYaxis(), "P_{max} = #psi_{R,lead}#times#psi_{R,subl}");
    SetAxes(out2D_subl_Pmax_N5.hRate_vsThr_vsR->GetXaxis(), "Subleading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_subl_Pmax_N5.hRate_vsThr_vsR->GetYaxis(), "P_{max} = #psi_{R,lead}#times#psi_{R,subl}");
    SetAxes(out2D_subl_Pmax_N5.gRate_vsEff_all->GetXaxis(), "Signal (hh#rightarrow4b) Efficiency");
    SetAxes(out2D_subl_Pmax_N5.gRate_vsEff_all->GetYaxis(), "Estimated Background Rate [Hz]");

    out2D_subl_Pmax_N5.hEff_vsThr_vsR->GetZaxis()->SetTitleOffset(1.4);
    out2D_subl_Pmax_N5.hRate_vsThr_vsR->GetZaxis()->SetTitleOffset(1.6);

    // 2D surfaces
    auto c1_subl2D_Pmax_N5 = new TCanvas("c1_subl2D_Pmax_N5","ET_thr vs Pmax surfaces (subleading, N=5)",1200,520);
    c1_subl2D_Pmax_N5->Divide(2,1);

    c1_subl2D_Pmax_N5->cd(1);
    gPad->SetLeftMargin(0.16); gPad->SetRightMargin(0.18); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    out2D_subl_Pmax_N5.hEff_vsThr_vsR->SetTitle(";Subleading JetTagger LRJ E_{T} threshold [GeV];P_{max};Signal (hh#rightarrow4b) Efficiency");
    out2D_subl_Pmax_N5.hEff_vsThr_vsR->Draw("COLZ");

    c1_subl2D_Pmax_N5->cd(2);
    gPad->SetLeftMargin(0.16); gPad->SetRightMargin(0.18); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    gPad->SetLogz();
    out2D_subl_Pmax_N5.hRate_vsThr_vsR->SetTitle(";Subleading JetTagger LRJ E_{T} threshold [GeV];P_{max};Estimated Background Rate [Hz]");
    out2D_subl_Pmax_N5.hRate_vsThr_vsR->Draw("COLZ");
    c1_subl2D_Pmax_N5->SaveAs(rateVsEffFileDir + "surfaces_ETthr_vs_Pmax_subleading_N5.pdf");

    auto c2_subl2D_Pmax_N5 = new TCanvas("c2_subl2D_Pmax_N5","Rate vs Eff (2D scan, subleading, Pmax, N=5)",700,600);
    c2_subl2D_Pmax_N5->SetLeftMargin(0.16); c2_subl2D_Pmax_N5->SetBottomMargin(0.16); c2_subl2D_Pmax_N5->SetTicks(1,1);
    c2_subl2D_Pmax_N5->SetLogy();
    out2D_subl_Pmax_N5.gRate_vsEff_all->Draw("AP");
    c2_subl2D_Pmax_N5->SaveAs(rateVsEffFileDir + "rate_vs_eff_scan2D_Pmax_subleading_N5.pdf");





    // ---------- Overlay: Leading (1D vs 2D scan) ----------
    TGraph*       gLead1D  = out.gRate_vsEff;            // standard leading (ET threshold only)
    TGraphErrors* gLead2D  = out2D_leading.gRate_vsEff_all; // 2D scan (ET, Rmax)

    // --- Styling ---
    gLead1D->SetMarkerStyle(20);   // filled circle
    gLead1D->SetMarkerSize(1.8);
    gLead1D->SetMarkerColor(kRed+1);
    gLead1D->SetLineColor(kRed+1);
    gLead1D->SetLineWidth(2);

    gLead2D->SetMarkerStyle(24);   // open circle
    gLead2D->SetMarkerColor(kBlack);
    gLead2D->SetLineColor(kBlack);
    gLead2D->SetLineWidth(1);
    gLead2D->SetMarkerSize(0.9);
    //gLead2D->SetMarkerColorAlpha(kBlack, 0.3);  // ROOT >=6.26


    // --- Canvas setup ---
    auto cLeadOverlay = new TCanvas("cLeadOverlay","Leading: 1D vs 2D Scan",700,600);
    cLeadOverlay->SetLeftMargin(0.16);
    cLeadOverlay->SetBottomMargin(0.16);
    cLeadOverlay->SetTicks(1,1);
    cLeadOverlay->SetLogy();

    // Draw with axes
    gLead1D->SetTitle("Trigger Rate vs Signal Efficiency;Signal (hh#rightarrow4b) Efficiency;Estimated Background Rate [Hz]");
    gLead1D->Draw("AP");     // axes + points (filled)
    gLead2D->Draw("P SAME"); // overlay open circles

    // Draw a horizontal line at y = 1e4
    TLine *line_Rmax_leading = new TLine(gLead1D->GetXaxis()->GetXmin(), 1e4, gLead1D->GetXaxis()->GetXmax(), 1e4);
    line_Rmax_leading->SetLineColor(kGray + 2);
    line_Rmax_leading->SetLineStyle(2);
    line_Rmax_leading->SetLineWidth(2);
    line_Rmax_leading->Draw("same");

    // --- Legend ---
    auto legLead = new TLegend(0.40,0.22,0.78,0.38);
    legLead->SetBorderSize(0);
    legLead->SetFillStyle(0);
    legLead->SetTextSize(0.04);
    legLead->AddEntry(gLead1D, "Leading: E_{T}^{thr} only",        "lp");
    legLead->AddEntry(gLead2D, "Leading: (E_{T}^{thr}, R_{max}) scan", "p");
    legLead->Draw();

    // --- Save ---
    cLeadOverlay->SaveAs(rateVsEffFileDir + "overlay_leading_1D_vs_2D_Rmax_scan.pdf");

    // ---------- Overlay: Subleading (1D ET-only vs 2D (ET_thr, R_max) scan) ----------
    TGraph*       gSub1D = out_subleading.gRate_vsEff;          // ET-only
    TGraphErrors* gSub2D = out2D_subl.gRate_vsEff_all;          // 2D scan points

    // Style: ET-only curve
    gSub1D->SetMarkerStyle(20);     // filled circle
    gSub1D->SetMarkerSize(1.8);
    gSub1D->SetMarkerColor(kRed+1);
    gSub1D->SetLineColor(kRed+1);
    gSub1D->SetLineWidth(2);

    // Style: 2D scan points (open black circles, smaller)
    gSub2D->SetMarkerStyle(24);     // open circle
    gSub2D->SetMarkerSize(0.9);
    gSub2D->SetMarkerColor(kBlack);
    gSub2D->SetLineColor(kBlack);
    gSub2D->SetLineWidth(1);

    // Canvas
    auto cSubOverlay = new TCanvas("cSubOverlay","Subleading: 1D vs 2D Scan",700,600);
    cSubOverlay->SetLeftMargin(0.16);
    cSubOverlay->SetBottomMargin(0.16);
    cSubOverlay->SetTicks(1,1);
    cSubOverlay->SetLogy();

    // Axes from 1D curve; then overlay 2D scan points
    gSub1D->SetTitle("Trigger Rate vs Signal Efficiency;Signal (hh#rightarrow4b) Efficiency;Estimated Background Rate [Hz]");
    gSub1D->Draw("AP");      // axes + points (filled red)
    gSub2D->Draw("P SAME");  // open black

    // Legend
    auto legSub = new TLegend(0.40,0.32,0.78,0.48);
    legSub->SetBorderSize(0);
    legSub->SetFillStyle(0);
    legSub->SetTextSize(0.04);
    legSub->AddEntry(gSub1D, "Subleading: E_{T}^{thr} only",         "lp");
    legSub->AddEntry(gSub2D, "Subleading: (E_{T}^{thr}, R_{max}) scan","p");
    legSub->Draw();

    cSubOverlay->SaveAs(rateVsEffFileDir + "overlay_subleading_1D_vs_2D_Rmax_scan.pdf");

    // ===================== OVERLAY: LEADING (ET-only vs 2D Pmax scan) =====================
    TGraph*       gLead1D_Pmax = out.gRate_vsEff;                 // ET-only (leading)
    TGraphErrors* gLead2D_Pmax = out2D_leading_Pmax.gRate_vsEff_all; // 2D scan (ET_thr, Pmax)

    // --- Styling ---
    gLead1D_Pmax->SetMarkerStyle(20);   // filled circle
    gLead1D_Pmax->SetMarkerSize(1.8);
    gLead1D_Pmax->SetMarkerColor(kRed+1);
    gLead1D_Pmax->SetLineColor(kRed+1);
    gLead1D_Pmax->SetLineWidth(2);

    gLead2D_Pmax->SetMarkerStyle(24);   // open circle
    gLead2D_Pmax->SetMarkerSize(0.9);
    gLead2D_Pmax->SetMarkerColor(kBlack);
    gLead2D_Pmax->SetLineColor(kBlack);
    gLead2D_Pmax->SetLineWidth(1);

    // --- Canvas ---
    auto cLeadOverlay_Pmax = new TCanvas("cLeadOverlay_Pmax","Leading: 1D vs 2D Pmax Scan",700,600);
    cLeadOverlay_Pmax->SetLeftMargin(0.16);
    cLeadOverlay_Pmax->SetBottomMargin(0.16);
    cLeadOverlay_Pmax->SetTicks(1,1);
    cLeadOverlay_Pmax->SetLogy();

    

    // Draw
    gLead1D_Pmax->SetTitle("Trigger Rate vs Signal Efficiency;Signal (hh#rightarrow4b) Efficiency;Estimated Background Rate [Hz]");
    gLead1D_Pmax->Draw("AP");            // axes + points
    gLead2D_Pmax->Draw("P SAME");        // overlay open circles

    // Draw a horizontal line at y = 1e4
    TLine *line_Pmax_leading = new TLine(gLead1D_Pmax->GetXaxis()->GetXmin(), 1e4, gLead1D_Pmax->GetXaxis()->GetXmax(), 1e4);
    line_Pmax_leading->SetLineColor(kGray + 2);
    line_Pmax_leading->SetLineStyle(2);
    line_Pmax_leading->SetLineWidth(2);
    line_Pmax_leading->Draw("same");

    auto best2D = FindBestPointBelowRate(gLead2D_Pmax, 1e4);
    double bestEff_2D = best2D.first;
    double bestRate_2D = best2D.second;

    // Draw vertical line at that efficiency
    cLeadOverlay_Pmax->Update();
    double ymin = gPad->GetUymin();
    double ymax = gPad->GetUymax();

    TLine *vline_2D = new TLine(bestEff_2D, ymin, bestEff_2D, 1e4);
    vline_2D->SetLineColor(kGray + 2);
    vline_2D->SetLineStyle(2);
    vline_2D->SetLineWidth(2);
    vline_2D->Draw("SAME");

    // Legend
    auto legLead_Pmax = new TLegend(0.1,0.76,0.48,0.92);
    legLead_Pmax->SetBorderSize(0); legLead_Pmax->SetFillStyle(0); legLead_Pmax->SetTextSize(0.04);
    legLead_Pmax->AddEntry(gLead1D_Pmax, "Leading: E_{T}^{thr} only",            "lp");
    legLead_Pmax->AddEntry(gLead2D_Pmax, "Leading: (E_{T}^{thr}, P_{max}) scan", "p");
    legLead_Pmax->Draw();

    cLeadOverlay_Pmax->SaveAs(rateVsEffFileDir + "overlay_leading_1D_vs_2D_Pmax_scan.pdf");

    // ===================== OVERLAY: LEADING (ET-only vs 2D Pmax scan) =====================
    TGraph*       gLead1D_Pmax_R2 = out.gRate_vsEff;                 // ET-only (leading)
    TGraphErrors* gLead2D_Pmax_R2 = out2D_leading_Pmax_R2.gRate_vsEff_all; // 2D scan (ET_thr, Pmax)

    // --- Styling ---
    gLead1D_Pmax_R2->SetMarkerStyle(20);   // filled circle
    gLead1D_Pmax_R2->SetMarkerSize(1.8);
    gLead1D_Pmax_R2->SetMarkerColor(kRed+1);
    gLead1D_Pmax_R2->SetLineColor(kRed+1);
    gLead1D_Pmax_R2->SetLineWidth(2);

    gLead2D_Pmax_R2->SetMarkerStyle(24);   // open circle
    gLead2D_Pmax_R2->SetMarkerSize(0.9);
    gLead2D_Pmax_R2->SetMarkerColor(kBlack);
    gLead2D_Pmax_R2->SetLineColor(kBlack);
    gLead2D_Pmax_R2->SetLineWidth(1);

    // --- Canvas ---
    auto cLeadOverlay_Pmax_R2 = new TCanvas("cLeadOverlay_Pmax_R2","Leading: 1D vs 2D Pmax Scan",700,600);
    cLeadOverlay_Pmax_R2->SetLeftMargin(0.16);
    cLeadOverlay_Pmax_R2->SetBottomMargin(0.16);
    cLeadOverlay_Pmax_R2->SetTicks(1,1);
    cLeadOverlay_Pmax_R2->SetLogy();

    

    // Draw
    gLead1D_Pmax_R2->SetTitle("Trigger Rate vs Signal Efficiency;Signal (hh#rightarrow4b) Efficiency;Estimated Background Rate [Hz]");
    gLead1D_Pmax_R2->Draw("AP");            // axes + points
    gLead2D_Pmax_R2->Draw("P SAME");        // overlay open circles

    // Draw a horizontal line at y = 1e4
    TLine *line_Pmax_leading_R2 = new TLine(gLead1D_Pmax_R2->GetXaxis()->GetXmin(), 1e4, gLead1D_Pmax_R2->GetXaxis()->GetXmax(), 1e4);
    line_Pmax_leading_R2->SetLineColor(kGray + 2);
    line_Pmax_leading_R2->SetLineStyle(2);
    line_Pmax_leading_R2->SetLineWidth(2);
    line_Pmax_leading_R2->Draw("same");

    // Legend
    auto legLead_Pmax_R2 = new TLegend(0.40,0.26,0.78,0.42);
    legLead_Pmax_R2->SetBorderSize(0); legLead_Pmax_R2->SetFillStyle(0); legLead_Pmax_R2->SetTextSize(0.04);
    legLead_Pmax_R2->AddEntry(gLead1D_Pmax_R2, "Leading: E_{T}^{thr} only",            "lp");
    legLead_Pmax_R2->AddEntry(gLead2D_Pmax_R2, "Leading: (E_{T}^{thr}, P_{max}) scan", "p");
    legLead_Pmax_R2->Draw();

    cLeadOverlay_Pmax_R2->SaveAs(rateVsEffFileDir + "overlay_leading_1D_vs_2D_Pmax_scan_R2.pdf");


    // ===================== OVERLAY: SUBLEADING (ET-only vs 2D Pmax scan) =====================
    TGraph*       gSub1D_Pmax = out_subleading.gRate_vsEff;           // ET-only (subleading)
    TGraphErrors* gSub2D_Pmax = out2D_subl_Pmax.gRate_vsEff_all;      // 2D scan (ET_thr, Pmax)

    // --- Styling ---
    gSub1D_Pmax->SetMarkerStyle(20);   // filled circle
    gSub1D_Pmax->SetMarkerSize(1.8);
    gSub1D_Pmax->SetMarkerColor(kRed+1);
    gSub1D_Pmax->SetLineColor(kRed+1);
    gSub1D_Pmax->SetLineWidth(2);

    gSub2D_Pmax->SetMarkerStyle(24);   // open circle
    gSub2D_Pmax->SetMarkerSize(0.9);
    gSub2D_Pmax->SetMarkerColor(kBlack);
    gSub2D_Pmax->SetLineColor(kBlack);
    gSub2D_Pmax->SetLineWidth(1);

    // --- Canvas ---
    auto cSubOverlay_Pmax = new TCanvas("cSubOverlay_Pmax","Subleading: 1D vs 2D Pmax Scan",700,600);
    cSubOverlay_Pmax->SetLeftMargin(0.16);
    cSubOverlay_Pmax->SetBottomMargin(0.16);
    cSubOverlay_Pmax->SetTicks(1,1);
    cSubOverlay_Pmax->SetLogy();

    // Draw
    gSub1D_Pmax->SetTitle("Trigger Rate vs Signal Efficiency;Signal (hh#rightarrow4b) Efficiency;Estimated Background Rate [Hz]");
    gSub1D_Pmax->Draw("AP");
    gSub2D_Pmax->Draw("P SAME");

    // Legend
    auto legSub_Pmax = new TLegend(0.35,0.22,0.73,0.38);
    legSub_Pmax->SetBorderSize(0); legSub_Pmax->SetFillStyle(0); legSub_Pmax->SetTextSize(0.04);
    legSub_Pmax->AddEntry(gSub1D_Pmax, "Subleading: E_{T}^{thr} only",             "lp");
    legSub_Pmax->AddEntry(gSub2D_Pmax, "Subleading: (E_{T}^{thr}, P_{max}) scan",  "p");
    legSub_Pmax->Draw();

    line_Pmax_leading->Draw("same");

    cSubOverlay_Pmax->SaveAs(rateVsEffFileDir + "overlay_subleading_1D_vs_2D_Pmax_scan.pdf");

    // ===================== OVERLAY: LEADING (ET-only vs 2D Pmax scan, N=2) =====================
    TGraph*       gLead1D_Pmax_N2 = out.gRate_vsEff;                        // ET-only (leading)
    TGraphErrors* gLead2D_Pmax_N2 = out2D_leading_Pmax_N2.gRate_vsEff_all;  // 2D scan (ET_thr, Pmax)

    // --- Styling ---
    gLead1D_Pmax_N2->SetMarkerStyle(20);   // filled circle
    gLead1D_Pmax_N2->SetMarkerSize(1.8);
    gLead1D_Pmax_N2->SetMarkerColor(kRed+1);
    gLead1D_Pmax_N2->SetLineColor(kRed+1);
    gLead1D_Pmax_N2->SetLineWidth(2);

    gLead2D_Pmax_N2->SetMarkerStyle(24);   // open circle
    gLead2D_Pmax_N2->SetMarkerSize(0.9);
    gLead2D_Pmax_N2->SetMarkerColor(kBlack);
    gLead2D_Pmax_N2->SetLineColor(kBlack);
    gLead2D_Pmax_N2->SetLineWidth(1);

    // --- Canvas ---
    auto cLeadOverlay_Pmax_N2 = new TCanvas("cLeadOverlay_Pmax_N2","Leading: 1D vs 2D Pmax Scan (N=2)",700,600);
    cLeadOverlay_Pmax_N2->SetLeftMargin(0.16);
    cLeadOverlay_Pmax_N2->SetBottomMargin(0.16);
    cLeadOverlay_Pmax_N2->SetTicks(1,1);
    cLeadOverlay_Pmax_N2->SetLogy();

    

    // Draw
    gLead1D_Pmax_N2->SetTitle("Trigger Rate vs Signal Efficiency;Signal (hh#rightarrow4b) Efficiency;Estimated Background Rate [Hz]");
    gLead1D_Pmax_N2->Draw("AP");            // axes + points
    gLead2D_Pmax_N2->Draw("P SAME");        // overlay open circles

    // Draw a horizontal line at y = 1e4
    TLine *line_Pmax_leading_N2 = new TLine(gLead1D_Pmax_N2->GetXaxis()->GetXmin(), 1e4, gLead1D_Pmax_N2->GetXaxis()->GetXmax(), 1e4);
    line_Pmax_leading_N2->SetLineColor(kGray + 2);
    line_Pmax_leading_N2->SetLineStyle(2);
    line_Pmax_leading_N2->SetLineWidth(2);
    line_Pmax_leading_N2->Draw("same");

    // Legend
    auto legLead_Pmax_N2 = new TLegend(0.40,0.26,0.78,0.42);
    legLead_Pmax_N2->SetBorderSize(0); legLead_Pmax_N2->SetFillStyle(0); legLead_Pmax_N2->SetTextSize(0.04);
    legLead_Pmax_N2->AddEntry(gLead1D_Pmax_N2, "Leading: E_{T}^{thr} only",            "lp");
    legLead_Pmax_N2->AddEntry(gLead2D_Pmax_N2, "Leading: (E_{T}^{thr}, P_{max}) scan", "p");
    legLead_Pmax_N2->Draw();

    cLeadOverlay_Pmax_N2->SaveAs(rateVsEffFileDir + "overlay_leading_1D_vs_2D_Pmax_scan_N2.pdf");

    // ===================== OVERLAY: SUBLEADING (ET-only vs 2D Pmax scan, N=2) =====================
    TGraph*       gSub1D_Pmax_N2 = out_subleading.gRate_vsEff;                 // ET-only (subleading)
    TGraphErrors* gSub2D_Pmax_N2 = out2D_subl_Pmax_N2.gRate_vsEff_all;         // 2D scan (ET_thr, Pmax)

    // --- Styling ---
    gSub1D_Pmax_N2->SetMarkerStyle(20);   // filled circle
    gSub1D_Pmax_N2->SetMarkerSize(1.8);
    gSub1D_Pmax_N2->SetMarkerColor(kRed+1);
    gSub1D_Pmax_N2->SetLineColor(kRed+1);
    gSub1D_Pmax_N2->SetLineWidth(2);

    gSub2D_Pmax_N2->SetMarkerStyle(24);   // open circle
    gSub2D_Pmax_N2->SetMarkerSize(0.9);
    gSub2D_Pmax_N2->SetMarkerColor(kBlack);
    gSub2D_Pmax_N2->SetLineColor(kBlack);
    gSub2D_Pmax_N2->SetLineWidth(1);

    // --- Canvas ---
    auto cSubOverlay_Pmax_N2 = new TCanvas("cSubOverlay_Pmax_N2","Subleading: 1D vs 2D Pmax Scan (N=2)",700,600);
    cSubOverlay_Pmax_N2->SetLeftMargin(0.16);
    cSubOverlay_Pmax_N2->SetBottomMargin(0.16);
    cSubOverlay_Pmax_N2->SetTicks(1,1);
    cSubOverlay_Pmax_N2->SetLogy();

    // Draw
    gSub1D_Pmax_N2->SetTitle("Trigger Rate vs Signal Efficiency;Signal (hh#rightarrow4b) Efficiency;Estimated Background Rate [Hz]");
    gSub1D_Pmax_N2->Draw("AP");
    gSub2D_Pmax_N2->Draw("P SAME");

    // Legend
    auto legSub_Pmax_N2 = new TLegend(0.35,0.22,0.73,0.38);
    legSub_Pmax_N2->SetBorderSize(0); legSub_Pmax_N2->SetFillStyle(0); legSub_Pmax_N2->SetTextSize(0.04);
    legSub_Pmax_N2->AddEntry(gSub1D_Pmax_N2, "Subleading: E_{T}^{thr} only",             "lp");
    legSub_Pmax_N2->AddEntry(gSub2D_Pmax_N2, "Subleading: (E_{T}^{thr}, P_{max}) scan",  "p");
    legSub_Pmax_N2->Draw();

    line_Pmax_leading_N2->Draw("same");

    cSubOverlay_Pmax_N2->SaveAs(rateVsEffFileDir + "overlay_subleading_1D_vs_2D_Pmax_scan_N2.pdf");

    // ===================== OVERLAY: LEADING (ET-only vs 2D Pmax scan, N=3) =====================
    TGraph*       gLead1D_Pmax_N3 = out.gRate_vsEff;
    TGraphErrors* gLead2D_Pmax_N3 = out2D_leading_Pmax_N3.gRate_vsEff_all;

    gLead1D_Pmax_N3->SetMarkerStyle(20);
    gLead1D_Pmax_N3->SetMarkerSize(1.8);
    gLead1D_Pmax_N3->SetMarkerColor(kRed+1);
    gLead1D_Pmax_N3->SetLineColor(kRed+1);
    gLead1D_Pmax_N3->SetLineWidth(2);

    gLead2D_Pmax_N3->SetMarkerStyle(24);
    gLead2D_Pmax_N3->SetMarkerSize(0.9);
    gLead2D_Pmax_N3->SetMarkerColor(kBlack);
    gLead2D_Pmax_N3->SetLineColor(kBlack);
    gLead2D_Pmax_N3->SetLineWidth(1);

    auto cLeadOverlay_Pmax_N3 = new TCanvas("cLeadOverlay_Pmax_N3","Leading: 1D vs 2D Pmax Scan (N=3)",700,600);
    cLeadOverlay_Pmax_N3->SetLeftMargin(0.16);
    cLeadOverlay_Pmax_N3->SetBottomMargin(0.16);
    cLeadOverlay_Pmax_N3->SetTicks(1,1);
    cLeadOverlay_Pmax_N3->SetLogy();

    gLead1D_Pmax_N3->SetTitle("Trigger Rate vs Signal Efficiency;Signal (hh#rightarrow4b) Efficiency;Estimated Background Rate [Hz]");
    gLead1D_Pmax_N3->Draw("AP");
    gLead2D_Pmax_N3->Draw("P SAME");

    auto legLead_Pmax_N3 = new TLegend(0.40,0.26,0.78,0.42);
    legLead_Pmax_N3->SetBorderSize(0); legLead_Pmax_N3->SetFillStyle(0); legLead_Pmax_N3->SetTextSize(0.04);
    legLead_Pmax_N3->AddEntry(gLead1D_Pmax_N3, "Leading: E_{T}^{thr} only",            "lp");
    legLead_Pmax_N3->AddEntry(gLead2D_Pmax_N3, "Leading: (E_{T}^{thr}, P_{max}) scan", "p");
    legLead_Pmax_N3->Draw();

    TLine *line_Pmax_leading_N3 = new TLine(gLead1D_Pmax_N3->GetXaxis()->GetXmin(), 1e4, gLead1D_Pmax_N3->GetXaxis()->GetXmax(), 1e4);
    line_Pmax_leading_N3->SetLineColor(kGray + 2);
    line_Pmax_leading_N3->SetLineStyle(2);
    line_Pmax_leading_N3->SetLineWidth(2);
    line_Pmax_leading_N3->Draw("same");

    cLeadOverlay_Pmax_N3->SaveAs(rateVsEffFileDir + "overlay_leading_1D_vs_2D_Pmax_scan_N3.pdf");

    // ===================== OVERLAY: SUBLEADING (ET-only vs 2D Pmax scan, N=3) =====================
    TGraph*       gSub1D_Pmax_N3 = out_subleading.gRate_vsEff;
    TGraphErrors* gSub2D_Pmax_N3 = out2D_subl_Pmax_N3.gRate_vsEff_all;

    gSub1D_Pmax_N3->SetMarkerStyle(20);
    gSub1D_Pmax_N3->SetMarkerSize(1.8);
    gSub1D_Pmax_N3->SetMarkerColor(kRed+1);
    gSub1D_Pmax_N3->SetLineColor(kRed+1);
    gSub1D_Pmax_N3->SetLineWidth(2);

    gSub2D_Pmax_N3->SetMarkerStyle(24);
    gSub2D_Pmax_N3->SetMarkerSize(0.9);
    gSub2D_Pmax_N3->SetMarkerColor(kBlack);
    gSub2D_Pmax_N3->SetLineColor(kBlack);
    gSub2D_Pmax_N3->SetLineWidth(1);

    auto cSubOverlay_Pmax_N3 = new TCanvas("cSubOverlay_Pmax_N3","Subleading: 1D vs 2D Pmax Scan (N=3)",700,600);
    cSubOverlay_Pmax_N3->SetLeftMargin(0.16);
    cSubOverlay_Pmax_N3->SetBottomMargin(0.16);
    cSubOverlay_Pmax_N3->SetTicks(1,1);
    cSubOverlay_Pmax_N3->SetLogy();

    gSub1D_Pmax_N3->SetTitle("Trigger Rate vs Signal Efficiency;Signal (hh#rightarrow4b) Efficiency;Estimated Background Rate [Hz]");
    gSub1D_Pmax_N3->Draw("AP");
    gSub2D_Pmax_N3->Draw("P SAME");

    auto legSub_Pmax_N3 = new TLegend(0.35,0.22,0.73,0.38);
    legSub_Pmax_N3->SetBorderSize(0); legSub_Pmax_N3->SetFillStyle(0); legSub_Pmax_N3->SetTextSize(0.04);
    legSub_Pmax_N3->AddEntry(gSub1D_Pmax_N3, "Subleading: E_{T}^{thr} only",            "lp");
    legSub_Pmax_N3->AddEntry(gSub2D_Pmax_N3, "Subleading: (E_{T}^{thr}, P_{max}) scan", "p");
    legSub_Pmax_N3->Draw();

    line_Pmax_leading_N3->Draw("same");

    cSubOverlay_Pmax_N3->SaveAs(rateVsEffFileDir + "overlay_subleading_1D_vs_2D_Pmax_scan_N3.pdf");

    // ===================== OVERLAY: LEADING (ET-only vs 2D Pmax scan, N=4) =====================
    TGraph*       gLead1D_Pmax_N4 = out.gRate_vsEff;
    TGraphErrors* gLead2D_Pmax_N4 = out2D_leading_Pmax_N4.gRate_vsEff_all;

    gLead1D_Pmax_N4->SetMarkerStyle(20);
    gLead1D_Pmax_N4->SetMarkerSize(1.8);
    gLead1D_Pmax_N4->SetMarkerColor(kRed+1);
    gLead1D_Pmax_N4->SetLineColor(kRed+1);
    gLead1D_Pmax_N4->SetLineWidth(2);

    gLead2D_Pmax_N4->SetMarkerStyle(24);
    gLead2D_Pmax_N4->SetMarkerSize(0.9);
    gLead2D_Pmax_N4->SetMarkerColor(kBlack);
    gLead2D_Pmax_N4->SetLineColor(kBlack);
    gLead2D_Pmax_N4->SetLineWidth(1);

    auto cLeadOverlay_Pmax_N4 = new TCanvas("cLeadOverlay_Pmax_N4","Leading: 1D vs 2D Pmax Scan (N=4)",700,600);
    cLeadOverlay_Pmax_N4->SetLeftMargin(0.16);
    cLeadOverlay_Pmax_N4->SetBottomMargin(0.16);
    cLeadOverlay_Pmax_N4->SetTicks(1,1);
    cLeadOverlay_Pmax_N4->SetLogy();

    gLead1D_Pmax_N4->SetTitle("Trigger Rate vs Signal Efficiency;Signal (hh#rightarrow4b) Efficiency;Estimated Background Rate [Hz]");
    gLead1D_Pmax_N4->Draw("AP");
    gLead2D_Pmax_N4->Draw("P SAME");

    auto legLead_Pmax_N4 = new TLegend(0.40,0.26,0.78,0.42);
    legLead_Pmax_N4->SetBorderSize(0); legLead_Pmax_N4->SetFillStyle(0); legLead_Pmax_N4->SetTextSize(0.04);
    legLead_Pmax_N4->AddEntry(gLead1D_Pmax_N4, "Leading: E_{T}^{thr} only",            "lp");
    legLead_Pmax_N4->AddEntry(gLead2D_Pmax_N4, "Leading: (E_{T}^{thr}, P_{max}) scan", "p");
    legLead_Pmax_N4->Draw();

    TLine *line_Pmax_leading_N4 = new TLine(gLead1D_Pmax_N4->GetXaxis()->GetXmin(), 1e4, gLead1D_Pmax_N4->GetXaxis()->GetXmax(), 1e4);
    line_Pmax_leading_N4->SetLineColor(kGray + 2);
    line_Pmax_leading_N4->SetLineStyle(2);
    line_Pmax_leading_N4->SetLineWidth(2);
    line_Pmax_leading_N4->Draw("same");

    cLeadOverlay_Pmax_N4->SaveAs(rateVsEffFileDir + "overlay_leading_1D_vs_2D_Pmax_scan_N4.pdf");

    // ===================== OVERLAY: SUBLEADING (ET-only vs 2D Pmax scan, N=4) =====================
    TGraph*       gSub1D_Pmax_N4 = out_subleading.gRate_vsEff;
    TGraphErrors* gSub2D_Pmax_N4 = out2D_subl_Pmax_N4.gRate_vsEff_all;

    gSub1D_Pmax_N4->SetMarkerStyle(20);
    gSub1D_Pmax_N4->SetMarkerSize(1.8);
    gSub1D_Pmax_N4->SetMarkerColor(kRed+1);
    gSub1D_Pmax_N4->SetLineColor(kRed+1);
    gSub1D_Pmax_N4->SetLineWidth(2);

    gSub2D_Pmax_N4->SetMarkerStyle(24);
    gSub2D_Pmax_N4->SetMarkerSize(0.9);
    gSub2D_Pmax_N4->SetMarkerColor(kBlack);
    gSub2D_Pmax_N4->SetLineColor(kBlack);
    gSub2D_Pmax_N4->SetLineWidth(1);

    auto cSubOverlay_Pmax_N4 = new TCanvas("cSubOverlay_Pmax_N4","Subleading: 1D vs 2D Pmax Scan (N=4)",700,600);
    cSubOverlay_Pmax_N4->SetLeftMargin(0.16);
    cSubOverlay_Pmax_N4->SetBottomMargin(0.16);
    cSubOverlay_Pmax_N4->SetTicks(1,1);
    cSubOverlay_Pmax_N4->SetLogy();

    gSub1D_Pmax_N4->SetTitle("Trigger Rate vs Signal Efficiency;Signal (hh#rightarrow4b) Efficiency;Estimated Background Rate [Hz]");
    gSub1D_Pmax_N4->Draw("AP");
    gSub2D_Pmax_N4->Draw("P SAME");

    auto legSub_Pmax_N4 = new TLegend(0.35,0.22,0.73,0.38);
    legSub_Pmax_N4->SetBorderSize(0); legSub_Pmax_N4->SetFillStyle(0); legSub_Pmax_N4->SetTextSize(0.04);
    legSub_Pmax_N4->AddEntry(gSub1D_Pmax_N4, "Subleading: E_{T}^{thr} only",            "lp");
    legSub_Pmax_N4->AddEntry(gSub2D_Pmax_N4, "Subleading: (E_{T}^{thr}, P_{max}) scan", "p");
    legSub_Pmax_N4->Draw();

    line_Pmax_leading_N4->Draw("same");

    cSubOverlay_Pmax_N4->SaveAs(rateVsEffFileDir + "overlay_subleading_1D_vs_2D_Pmax_scan_N4.pdf");

    // ===================== OVERLAY: LEADING (ET-only vs 2D Pmax scan, N=5) =====================
    TGraph*       gLead1D_Pmax_N5 = out.gRate_vsEff;
    TGraphErrors* gLead2D_Pmax_N5 = out2D_leading_Pmax_N5.gRate_vsEff_all;

    gLead1D_Pmax_N5->SetMarkerStyle(20);
    gLead1D_Pmax_N5->SetMarkerSize(1.8);
    gLead1D_Pmax_N5->SetMarkerColor(kRed+1);
    gLead1D_Pmax_N5->SetLineColor(kRed+1);
    gLead1D_Pmax_N5->SetLineWidth(2);

    gLead2D_Pmax_N5->SetMarkerStyle(24);
    gLead2D_Pmax_N5->SetMarkerSize(0.9);
    gLead2D_Pmax_N5->SetMarkerColor(kBlack);
    gLead2D_Pmax_N5->SetLineColor(kBlack);
    gLead2D_Pmax_N5->SetLineWidth(1);

    auto cLeadOverlay_Pmax_N5 = new TCanvas("cLeadOverlay_Pmax_N5","Leading: 1D vs 2D Pmax Scan (N=5)",700,600);
    cLeadOverlay_Pmax_N5->SetLeftMargin(0.16);
    cLeadOverlay_Pmax_N5->SetBottomMargin(0.16);
    cLeadOverlay_Pmax_N5->SetTicks(1,1);
    cLeadOverlay_Pmax_N5->SetLogy();

    gLead1D_Pmax_N5->SetTitle("Trigger Rate vs Signal Efficiency;Signal (hh#rightarrow4b) Efficiency;Estimated Background Rate [Hz]");
    gLead1D_Pmax_N5->Draw("AP");
    gLead2D_Pmax_N5->Draw("P SAME");

    auto legLead_Pmax_N5 = new TLegend(0.40,0.26,0.78,0.42);
    legLead_Pmax_N5->SetBorderSize(0); legLead_Pmax_N5->SetFillStyle(0); legLead_Pmax_N5->SetTextSize(0.04);
    legLead_Pmax_N5->AddEntry(gLead1D_Pmax_N5, "Leading: E_{T}^{thr} only",            "lp");
    legLead_Pmax_N5->AddEntry(gLead2D_Pmax_N5, "Leading: (E_{T}^{thr}, P_{max}) scan", "p");
    legLead_Pmax_N5->Draw();

    TLine *line_Pmax_leading_N5 = new TLine(gLead1D_Pmax_N5->GetXaxis()->GetXmin(), 1e4, gLead1D_Pmax_N5->GetXaxis()->GetXmax(), 1e4);
    line_Pmax_leading_N5->SetLineColor(kGray + 2);
    line_Pmax_leading_N5->SetLineStyle(2);
    line_Pmax_leading_N5->SetLineWidth(2);
    line_Pmax_leading_N5->Draw("same");

    cLeadOverlay_Pmax_N5->SaveAs(rateVsEffFileDir + "overlay_leading_1D_vs_2D_Pmax_scan_N5.pdf");

    // ===================== OVERLAY: SUBLEADING (ET-only vs 2D Pmax scan, N=5) =====================
    TGraph*       gSub1D_Pmax_N5 = out_subleading.gRate_vsEff;
    TGraphErrors* gSub2D_Pmax_N5 = out2D_subl_Pmax_N5.gRate_vsEff_all;

    gSub1D_Pmax_N5->SetMarkerStyle(20);
    gSub1D_Pmax_N5->SetMarkerSize(1.8);
    gSub1D_Pmax_N5->SetMarkerColor(kRed+1);
    gSub1D_Pmax_N5->SetLineColor(kRed+1);
    gSub1D_Pmax_N5->SetLineWidth(2);

    gSub2D_Pmax_N5->SetMarkerStyle(24);
    gSub2D_Pmax_N5->SetMarkerSize(0.9);
    gSub2D_Pmax_N5->SetMarkerColor(kBlack);
    gSub2D_Pmax_N5->SetLineColor(kBlack);
    gSub2D_Pmax_N5->SetLineWidth(1);

    auto cSubOverlay_Pmax_N5 = new TCanvas("cSubOverlay_Pmax_N5","Subleading: 1D vs 2D Pmax Scan (N=5)",700,600);
    cSubOverlay_Pmax_N5->SetLeftMargin(0.16);
    cSubOverlay_Pmax_N5->SetBottomMargin(0.16);
    cSubOverlay_Pmax_N5->SetTicks(1,1);
    cSubOverlay_Pmax_N5->SetLogy();

    gSub1D_Pmax_N5->SetTitle("Trigger Rate vs Signal Efficiency;Signal (hh#rightarrow4b) Efficiency;Estimated Background Rate [Hz]");
    gSub1D_Pmax_N5->Draw("AP");
    gSub2D_Pmax_N5->Draw("P SAME");

    auto legSub_Pmax_N5 = new TLegend(0.35,0.22,0.73,0.38);
    legSub_Pmax_N5->SetBorderSize(0); legSub_Pmax_N5->SetFillStyle(0); legSub_Pmax_N5->SetTextSize(0.04);
    legSub_Pmax_N5->AddEntry(gSub1D_Pmax_N5, "Subleading: E_{T}^{thr} only",            "lp");
    legSub_Pmax_N5->AddEntry(gSub2D_Pmax_N5, "Subleading: (E_{T}^{thr}, P_{max}) scan", "p");
    legSub_Pmax_N5->Draw();

    cSubOverlay_Pmax_N5->SaveAs(rateVsEffFileDir + "overlay_subleading_1D_vs_2D_Pmax_scan_N5.pdf");

    // SCAN ON tau2/tau1 
    // ================== Leading (ET_thr vs tau2/tau1 scan) ======================
    auto out2D_lead_tau21_jFEXsubjet = MakeRateVsEff_ScanRMax_AllowZeroR(
        sig_h_leading_LRJ_Et, back_h_leading_LRJ_Et,
        sig_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_12, back_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_12
    );

    // Axis titles
    SetAxes(out2D_lead_tau21_jFEXsubjet.hEff_vsThr_vsR ->GetXaxis(), "Leading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_lead_tau21_jFEXsubjet.hEff_vsThr_vsR ->GetYaxis(), " #tau_{2,lead}/#tau_{1,lead}");
    SetAxes(out2D_lead_tau21_jFEXsubjet.hRate_vsThr_vsR->GetXaxis(), "Leading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_lead_tau21_jFEXsubjet.hRate_vsThr_vsR->GetYaxis(), " Max #tau_{2,lead}/#tau_{1,lead}");

    SetAxes(out2D_lead_tau21_jFEXsubjet.gRate_vsEff_all->GetXaxis(), "Signal (hh#rightarrow4b) Efficiency");
    SetAxes(out2D_lead_tau21_jFEXsubjet.gRate_vsEff_all->GetYaxis(), "Estimated Background Rate [Hz]");

    // 2D "vs-threshold & Rmax" views (surfaces)
    auto c1_leading2D_tau21_jFEX = new TCanvas("c1_leading2D_tau21_jFEX","ET_thr vs tau21 surfaces",1200,520);
    c1_leading2D_tau21_jFEX->Divide(2,1);

    // Efficiency surface
    c1_leading2D_tau21_jFEX->cd(1);
    gPad->SetLeftMargin(0.16); gPad->SetRightMargin(0.18); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    out2D_lead_tau21_jFEXsubjet.hEff_vsThr_vsR->SetTitle(";Leading JetTagger LRJ E_{T} threshold [GeV];Max #tau_{2,lead}/#tau_{1,lead};Signal (hh#rightarrow4b) Efficiency");
    out2D_lead_tau21_jFEXsubjet.hEff_vsThr_vsR->Draw("COLZ");

    // Background-rate surface (log Z)
    c1_leading2D_tau21_jFEX->cd(2);
    gPad->SetLeftMargin(0.16); gPad->SetRightMargin(0.16); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    gPad->SetLogz();
    out2D_lead_tau21_jFEXsubjet.hRate_vsThr_vsR->SetTitle(";Leading JetTagger LRJ E_{T} threshold [GeV]; Max #tau_{2,lead}/#tau_{1,lead};Estimated Background Rate [Hz]");
    out2D_lead_tau21_jFEXsubjet.hRate_vsThr_vsR->Draw("COLZ");
    c1_leading2D_tau21_jFEX->SaveAs(rateVsEffFileDir + "surfaces_ETthr_vs_tau21_leading_jFEX.pdf");

    // Main plot: rate vs efficiency (all points from the 2D scan)
    auto c2_leading2D_tau21_jFEX = new TCanvas("c2_leading2D_tau21_jFEX","Rate vs Eff (2D scan, leading)",700,600);
    c2_leading2D_tau21_jFEX->SetLeftMargin(0.16); c2_leading2D_tau21_jFEX->SetBottomMargin(0.16); c2_leading2D->SetTicks(1,1);
    c2_leading2D_tau21_jFEX->SetLogy();
    out2D_lead_tau21_jFEXsubjet.gRate_vsEff_all->Draw("AP");   // A=axes, P=points
    c2_leading2D_tau21_jFEX->SaveAs(rateVsEffFileDir + "rate_vs_eff_scan2D_tau21_leading_jFEX.pdf");
    
    // ===================== OVERLAY: LEADING (ET-only vs 2D tau21 max scan) =====================
    TGraph*       gLead1D_tau21max_jFEX = out.gRate_vsEff;
    TGraphErrors* gLead2D_tau21max_jFEX = out2D_lead_tau21_jFEXsubjet.gRate_vsEff_all;

    gLead1D_tau21max_jFEX->SetMarkerStyle(20);
    gLead1D_tau21max_jFEX->SetMarkerSize(1.8);
    gLead1D_tau21max_jFEX->SetMarkerColor(kRed+1);
    gLead1D_tau21max_jFEX->SetLineColor(kRed+1);
    gLead1D_tau21max_jFEX->SetLineWidth(2);

    gLead2D_tau21max_jFEX->SetMarkerStyle(24);
    gLead2D_tau21max_jFEX->SetMarkerSize(0.9);
    gLead2D_tau21max_jFEX->SetMarkerColor(kBlack);
    gLead2D_tau21max_jFEX->SetLineColor(kBlack);
    gLead2D_tau21max_jFEX->SetLineWidth(1);

    auto cLeadOverlay_tau21_jFEX_leading = new TCanvas("cLeadOverlay_tau21_jFEX_leading","Leading: 1D vs 2D Pmax Scan (N=5)",700,600);
    cLeadOverlay_tau21_jFEX_leading->SetLeftMargin(0.16);
    cLeadOverlay_tau21_jFEX_leading->SetBottomMargin(0.16);
    cLeadOverlay_tau21_jFEX_leading->SetTicks(1,1);
    cLeadOverlay_tau21_jFEX_leading->SetLogy();

    gLead1D_tau21max_jFEX->SetTitle("Trigger Rate vs Signal Efficiency;Signal (hh#rightarrow4b) Efficiency;Estimated Background Rate [Hz]");
    gLead1D_tau21max_jFEX->Draw("AP");
    gLead2D_tau21max_jFEX->Draw("P SAME");

    auto legLead_tau21_jFEX_leading = new TLegend(0.40,0.26,0.78,0.42);
    legLead_tau21_jFEX_leading->SetBorderSize(0); legLead_Pmax_N5->SetFillStyle(0); legLead_Pmax_N5->SetTextSize(0.04);
    legLead_tau21_jFEX_leading->AddEntry(gLead1D_tau21max_jFEX, "Leading: E_{T}^{thr} only",            "lp");
    legLead_tau21_jFEX_leading->AddEntry(gLead2D_tau21max_jFEX, "Leading: (E_{T}^{thr}, Max #tau_{2} / #tau_{1}) scan", "p");
    legLead_tau21_jFEX_leading->Draw();

    TLine *line_tau21_jFEX_leading  = new TLine(gLead1D_tau21max_jFEX->GetXaxis()->GetXmin(), 1e4, gLead1D_Pmax_N5->GetXaxis()->GetXmax(), 1e4);
    line_tau21_jFEX_leading->SetLineColor(kGray + 2);
    line_tau21_jFEX_leading->SetLineStyle(2);
    line_tau21_jFEX_leading->SetLineWidth(2);
    line_tau21_jFEX_leading->Draw("same");

    cLeadOverlay_tau21_jFEX_leading->SaveAs(rateVsEffFileDir + "overlay_leading_1D_vs_2D_tau21_jFEX_scan.pdf");


    // SCAN ON tau2/tau1_lead * tau2/tau1_sublead
    // ================== Leading (ET_thr vs tau2/tau1 scan) ======================
    auto out2D_lead_tau21_jFEXsubjetProduct = MakeRateVsEff_ScanRMax(
        sig_h_JetTaggerLRJ_jFEX_Subjet_Tau_21_Product_vsLeadingLRJEt, back_h_JetTaggerLRJ_jFEX_Subjet_Tau_21_Product_vsLeadingLRJEt
    );

    // Axis titles
    SetAxes(out2D_lead_tau21_jFEXsubjetProduct.hEff_vsThr_vsR ->GetXaxis(), "Leading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_lead_tau21_jFEXsubjetProduct.hEff_vsThr_vsR ->GetYaxis(), " #tau_{2,lead}/#tau_{1,lead} #times #tau_{2,subl.}/#tau_{1,subl.}");
    SetAxes(out2D_lead_tau21_jFEXsubjetProduct.hRate_vsThr_vsR->GetXaxis(), "Leading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_lead_tau21_jFEXsubjetProduct.hRate_vsThr_vsR->GetYaxis(), " Max #tau_{2,lead}/#tau_{1,lead} #times #tau_{2,subl.}/#tau_{1,subl.}");

    SetAxes(out2D_lead_tau21_jFEXsubjetProduct.gRate_vsEff_all->GetXaxis(), "Signal (hh#rightarrow4b) Efficiency");
    SetAxes(out2D_lead_tau21_jFEXsubjetProduct.gRate_vsEff_all->GetYaxis(), "Estimated Background Rate [Hz]");

    // 2D "vs-threshold & Rmax" views (surfaces)
    auto c1_leading2D_tau21_jFEX_Product = new TCanvas("c1_leading2D_tau21_jFEX_Product","ET_thr vs tau21 surfaces",1200,520);
    c1_leading2D_tau21_jFEX_Product->Divide(2,1);

    // Efficiency surface
    c1_leading2D_tau21_jFEX_Product->cd(1);
    gPad->SetLeftMargin(0.16); gPad->SetRightMargin(0.18); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    out2D_lead_tau21_jFEXsubjetProduct.hEff_vsThr_vsR->SetTitle(";Leading JetTagger LRJ E_{T} threshold [GeV];Max #tau_{2,lead}/#tau_{1,lead} #times #tau_{2,subl.}/#tau_{1,subl.};Signal (hh#rightarrow4b) Efficiency");
    out2D_lead_tau21_jFEXsubjetProduct.hEff_vsThr_vsR->Draw("COLZ");

    // Background-rate surface (log Z)
    c1_leading2D_tau21_jFEX_Product->cd(2);
    gPad->SetLeftMargin(0.16); gPad->SetRightMargin(0.16); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    gPad->SetLogz();
    out2D_lead_tau21_jFEXsubjetProduct.hRate_vsThr_vsR->SetTitle(";Leading JetTagger LRJ E_{T} threshold [GeV]; Max #tau_{2,lead}/#tau_{1,lead} #times #tau_{2,subl.}/#tau_{1,subl.};Estimated Background Rate [Hz]");
    out2D_lead_tau21_jFEXsubjetProduct.hRate_vsThr_vsR->Draw("COLZ");
    c1_leading2D_tau21_jFEX_Product->SaveAs(rateVsEffFileDir + "surfaces_ETthr_vs_tau21_leading_jFEX_Product.pdf");

    // Main plot: rate vs efficiency (all points from the 2D scan)
    auto c2_leading2D_tau21_jFEX_Product = new TCanvas("c2_leading2D_tau21_jFEX_Product","Rate vs Eff (2D scan, leading)",700,600);
    c2_leading2D_tau21_jFEX_Product->SetLeftMargin(0.16); c2_leading2D_tau21_jFEX_Product->SetBottomMargin(0.16); c2_leading2D_tau21_jFEX_Product->SetTicks(1,1);
    c2_leading2D_tau21_jFEX_Product->SetLogy();
    out2D_lead_tau21_jFEXsubjetProduct.gRate_vsEff_all->Draw("AP");   // A=axes, P=points
    c2_leading2D_tau21_jFEX_Product->SaveAs(rateVsEffFileDir + "rate_vs_eff_scan2D_tau21_leading_jFEX_Product.pdf");
    
    // ===================== OVERLAY: LEADING (ET-only vs 2D tau21 max scan) =====================
    TGraph*       gLead1D_tau21max_jFEX_Product = out.gRate_vsEff;
    TGraphErrors* gLead2D_tau21max_jFEX_Product = out2D_lead_tau21_jFEXsubjetProduct.gRate_vsEff_all;

    gLead1D_tau21max_jFEX_Product->SetMarkerStyle(20);
    gLead1D_tau21max_jFEX_Product->SetMarkerSize(1.8);
    gLead1D_tau21max_jFEX_Product->SetMarkerColor(kRed+1);
    gLead1D_tau21max_jFEX_Product->SetLineColor(kRed+1);
    gLead1D_tau21max_jFEX_Product->SetLineWidth(2);

    gLead2D_tau21max_jFEX_Product->SetMarkerStyle(24);
    gLead2D_tau21max_jFEX_Product->SetMarkerSize(0.9);
    gLead2D_tau21max_jFEX_Product->SetMarkerColor(kBlack);
    gLead2D_tau21max_jFEX_Product->SetLineColor(kBlack);
    gLead2D_tau21max_jFEX_Product->SetLineWidth(1);

    auto cLeadOverlay_tau21_jFEX_leading_Product = new TCanvas("cLeadOverlay_tau21_jFEX_leading_Product","Leading: 1D vs 2D Pmax Scan (N=5)",700,600);
    cLeadOverlay_tau21_jFEX_leading_Product->SetLeftMargin(0.16);
    cLeadOverlay_tau21_jFEX_leading_Product->SetBottomMargin(0.16);
    cLeadOverlay_tau21_jFEX_leading_Product->SetTicks(1,1);
    cLeadOverlay_tau21_jFEX_leading_Product->SetLogy();

    gLead1D_tau21max_jFEX_Product->SetTitle("Trigger Rate vs Signal Efficiency;Signal (hh#rightarrow4b) Efficiency;Estimated Background Rate [Hz]");
    gLead1D_tau21max_jFEX_Product->Draw("AP");
    gLead2D_tau21max_jFEX_Product->Draw("P SAME");

    auto legLead_tau21_jFEX_leading_Product = new TLegend(0.40,0.26,0.78,0.42);
    legLead_tau21_jFEX_leading_Product->SetBorderSize(0); legLead_tau21_jFEX_leading_Product->SetFillStyle(0); legLead_tau21_jFEX_leading_Product->SetTextSize(0.04);
    legLead_tau21_jFEX_leading_Product->AddEntry(gLead1D_tau21max_jFEX_Product, "Leading: E_{T}^{thr} only",            "lp");
    legLead_tau21_jFEX_leading_Product->AddEntry(gLead2D_tau21max_jFEX_Product, "Leading: (E_{T}^{thr}, Max #tau_{2} / #tau_{1}) scan", "p");
    legLead_tau21_jFEX_leading_Product->Draw();

    TLine *line_tau21_jFEX_leading_Product  = new TLine(gLead1D_tau21max_jFEX_Product->GetXaxis()->GetXmin(), 1e4, gLead1D_tau21max_jFEX_Product->GetXaxis()->GetXmax(), 1e4);
    line_tau21_jFEX_leading_Product->SetLineColor(kGray + 2);
    line_tau21_jFEX_leading_Product->SetLineStyle(2);
    line_tau21_jFEX_leading_Product->SetLineWidth(2);
    line_tau21_jFEX_leading_Product->Draw("same");

    cLeadOverlay_tau21_jFEX_leading_Product->SaveAs(rateVsEffFileDir + "overlay_leading_1D_vs_2D_tau21_jFEX_scan_Product.pdf");

    // SCAN ON tau2/tau1_lead * tau2/tau1_sublead
    // ================== Leading (ET_thr vs tau2/tau1 scan) ======================
    auto out2D_lead_tau21_ConesubjetProduct = MakeRateVsEff_ScanRMax(
        sig_h_JetTaggerLRJ_ConeCellsTowers_Subjet_Tau_21_Product_vsLeadingLRJEt, back_h_JetTaggerLRJ_ConeCellsTowers_Subjet_Tau_21_Product_vsLeadingLRJEt
    );

    // Axis titles
    SetAxes(out2D_lead_tau21_ConesubjetProduct.hEff_vsThr_vsR ->GetXaxis(), "Leading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_lead_tau21_ConesubjetProduct.hEff_vsThr_vsR ->GetYaxis(), " #tau_{2,lead}/#tau_{1,lead} #times #tau_{2,subl.}/#tau_{1,subl.}");
    SetAxes(out2D_lead_tau21_ConesubjetProduct.hRate_vsThr_vsR->GetXaxis(), "Leading JetTagger LRJ E_{T} threshold [GeV]");
    SetAxes(out2D_lead_tau21_ConesubjetProduct.hRate_vsThr_vsR->GetYaxis(), " Max #tau_{2,lead}/#tau_{1,lead} #times #tau_{2,subl.}/#tau_{1,subl.}");

    SetAxes(out2D_lead_tau21_ConesubjetProduct.gRate_vsEff_all->GetXaxis(), "Signal (hh#rightarrow4b) Efficiency");
    SetAxes(out2D_lead_tau21_ConesubjetProduct.gRate_vsEff_all->GetYaxis(), "Estimated Background Rate [Hz]");

    // 2D "vs-threshold & Rmax" views (surfaces)
    auto c1_leading2D_tau21_Cone_Product = new TCanvas("c1_leading2D_tau21_Cone_Product","ET_thr vs tau21 surfaces",1200,520);
    c1_leading2D_tau21_Cone_Product->Divide(2,1);

    // Efficiency surface
    c1_leading2D_tau21_Cone_Product->cd(1);
    gPad->SetLeftMargin(0.16); gPad->SetRightMargin(0.18); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    out2D_lead_tau21_ConesubjetProduct.hEff_vsThr_vsR->SetTitle(";Leading JetTagger LRJ E_{T} threshold [GeV];Max #tau_{2,lead}/#tau_{1,lead} #times #tau_{2,subl.}/#tau_{1,subl.};Signal (hh#rightarrow4b) Efficiency");
    out2D_lead_tau21_ConesubjetProduct.hEff_vsThr_vsR->Draw("COLZ");

    // Background-rate surface (log Z)
    c1_leading2D_tau21_Cone_Product->cd(2);
    gPad->SetLeftMargin(0.16); gPad->SetRightMargin(0.16); gPad->SetBottomMargin(0.16); gPad->SetTicks(1,1);
    gPad->SetLogz();
    out2D_lead_tau21_ConesubjetProduct.hRate_vsThr_vsR->SetTitle(";Leading JetTagger LRJ E_{T} threshold [GeV]; Max #tau_{2,lead}/#tau_{1,lead} #times #tau_{2,subl.}/#tau_{1,subl.};Estimated Background Rate [Hz]");
    out2D_lead_tau21_ConesubjetProduct.hRate_vsThr_vsR->Draw("COLZ");
    c1_leading2D_tau21_Cone_Product->SaveAs(rateVsEffFileDir + "surfaces_ETthr_vs_tau21_leading_Cone_Product.pdf");

    // Main plot: rate vs efficiency (all points from the 2D scan)
    auto c2_leading2D_tau21_Cone_Product = new TCanvas("c2_leading2D_tau21_Cone_Product","Rate vs Eff (2D scan, leading)",700,600);
    c2_leading2D_tau21_Cone_Product->SetLeftMargin(0.16); c2_leading2D_tau21_Cone_Product->SetBottomMargin(0.16); c2_leading2D_tau21_Cone_Product->SetTicks(1,1);
    c2_leading2D_tau21_Cone_Product->SetLogy();
    out2D_lead_tau21_ConesubjetProduct.gRate_vsEff_all->Draw("AP");   // A=axes, P=points
    c2_leading2D_tau21_Cone_Product->SaveAs(rateVsEffFileDir + "rate_vs_eff_scan2D_tau21_leading_Cone_Product.pdf");
    
    // ===================== OVERLAY: LEADING (ET-only vs 2D tau21 max scan) =====================
    TGraph*       gLead1D_tau21max_Cone_Product = out.gRate_vsEff;
    TGraphErrors* gLead2D_tau21max_Cone_Product = out2D_lead_tau21_ConesubjetProduct.gRate_vsEff_all;

    gLead1D_tau21max_Cone_Product->SetMarkerStyle(20);
    gLead1D_tau21max_Cone_Product->SetMarkerSize(1.8);
    gLead1D_tau21max_Cone_Product->SetMarkerColor(kRed+1);
    gLead1D_tau21max_Cone_Product->SetLineColor(kRed+1);
    gLead1D_tau21max_Cone_Product->SetLineWidth(2);

    gLead2D_tau21max_Cone_Product->SetMarkerStyle(24);
    gLead2D_tau21max_Cone_Product->SetMarkerSize(0.9);
    gLead2D_tau21max_Cone_Product->SetMarkerColor(kBlack);
    gLead2D_tau21max_Cone_Product->SetLineColor(kBlack);
    gLead2D_tau21max_Cone_Product->SetLineWidth(1);

    auto cLeadOverlay_tau21_Cone_leading_Product = new TCanvas("cLeadOverlay_tau21_Cone_leading_Product","Leading: 1D vs 2D Pmax Scan (N=5)",700,600);
    cLeadOverlay_tau21_Cone_leading_Product->SetLeftMargin(0.16);
    cLeadOverlay_tau21_Cone_leading_Product->SetBottomMargin(0.16);
    cLeadOverlay_tau21_Cone_leading_Product->SetTicks(1,1);
    cLeadOverlay_tau21_Cone_leading_Product->SetLogy();

    gLead1D_tau21max_Cone_Product->SetTitle("Trigger Rate vs Signal Efficiency;Signal (hh#rightarrow4b) Efficiency;Estimated Background Rate [Hz]");
    gLead1D_tau21max_Cone_Product->Draw("AP");
    gLead2D_tau21max_Cone_Product->Draw("P SAME");

    auto legLead_tau21_Cone_leading_Product = new TLegend(0.40,0.26,0.78,0.42);
    legLead_tau21_Cone_leading_Product->SetBorderSize(0); legLead_tau21_Cone_leading_Product->SetFillStyle(0); legLead_tau21_Cone_leading_Product->SetTextSize(0.04);
    legLead_tau21_Cone_leading_Product->AddEntry(gLead1D_tau21max_Cone_Product, "Leading: E_{T}^{thr} only",            "lp");
    legLead_tau21_Cone_leading_Product->AddEntry(gLead2D_tau21max_Cone_Product, "Leading: (E_{T}^{thr}, Max #tau_{2} / #tau_{1}) scan", "p");
    legLead_tau21_Cone_leading_Product->Draw();

    TLine *line_tau21_Cone_leading_Product  = new TLine(gLead1D_tau21max_Cone_Product->GetXaxis()->GetXmin(), 1e4, gLead1D_tau21max_Cone_Product->GetXaxis()->GetXmax(), 1e4);
    line_tau21_Cone_leading_Product->SetLineColor(kGray + 2);
    line_tau21_Cone_leading_Product->SetLineStyle(2);
    line_tau21_Cone_leading_Product->SetLineWidth(2);
    line_tau21_Cone_leading_Product->Draw("same");

    {auto best2D = FindBestPointBelowRate(gLead2D_tau21max_Cone_Product, 1e4);
    double bestEff_2D = best2D.first;
    double bestRate_2D = best2D.second;

    // Draw vertical line at that efficiency
    cLeadOverlay_Pmax->Update();
    double ymin = gPad->GetUymin();
    double ymax = gPad->GetUymax();

    TLine *vline_2D = new TLine(bestEff_2D, ymin, bestEff_2D, 1e4);
    vline_2D->SetLineColor(kGray + 2);
    vline_2D->SetLineStyle(2);
    vline_2D->SetLineWidth(2);
    vline_2D->Draw("SAME");}

    cLeadOverlay_tau21_Cone_leading_Product->SaveAs(rateVsEffFileDir + "overlay_leading_1D_vs_2D_tau21_Cone_scan_Product.pdf");


    //gSystem->RedirectOutput(0); // back to normal
    // Save histograms
    TCanvas c;
    TCanvas cSigEffb;
    TCanvas cSigEffLRJ;
    TCanvas cSigEffLRJ_Mass100to150;
    TCanvas cSigEffLRJ_1Subjet;
    TCanvas cBackEffLRJ_1Subjet;
    TCanvas cSigEffLRJ_Dijet;
    TCanvas cSigEffLRJ_GrEq2Subjets;
    TCanvas cBackEffLRJ_GrEq2Subjets;
    TCanvas cBackEffLRJ;
    TCanvas cSigEffLRJ_gFex;
    TCanvas cSigEffLRJ_jFex;
    TCanvas cSigEffLRJ_gFex_Dijet;
    TCanvas cBackEffLRJ_gFex;
    TCanvas cBackEffLRJ_jFex;
    TCanvas cSigEffLRJ_gFex_LRJ_overlay;
    TCanvas cSigEffLRJ_jFex_LRJ_overlay;
    TCanvas cSigEffLRJ_gFex_LRJ_Dijet_overlay;
    TCanvas cSigEffLRJ_Mass100to150_LRJ_overlay;
    TCanvas cSigEffLRJ_Overlay_1Subjet_GrEq2Subjets;
    TCanvas cBackEffLRJ_Overlay_1Subjet_GrEq2Subjets;
    TCanvas cBackEffLRJ_gFex_LRJ_overlay;
    TCanvas cBackEffLRJ_jFex_LRJ_overlay;
    
    //gStyle->SetOptTitle(1); // Enable title
    TLegend *leg = new TLegend(0.7,0.8,0.85,0.95);
    leg->SetTextSize(0.025);

    leg->AddEntry(sig_h_LRJ_Et, "Signal", "l");
    leg->AddEntry(back_h_LRJ_Et, "Background", "l");

    TLegend *leg_Psi_R = new TLegend(0.4,0.8,0.55,0.95);
    leg_Psi_R->SetTextSize(0.025);

    leg_Psi_R->AddEntry(sig_h_LRJ_Et, "Signal", "l");
    leg_Psi_R->AddEntry(back_h_LRJ_Et, "Background", "l");

    TLegend *legEffb = new TLegend(0.8,0.2,0.95,0.35);
    legEffb->SetTextSize(0.025);

    TLegend *sigLegEffLRJ = new TLegend(0.7,0.2,1.0,0.525);
    sigLegEffLRJ->SetTextSize(0.03);

    TLegend *sigLegEffLRJ_mass100to150 = new TLegend(0.7,0.2,1.0,0.525);
    sigLegEffLRJ_mass100to150->SetTextSize(0.03);

    TLegend *sigLegEffLRJ_1Subjet = new TLegend(0.7,0.2,1.0,0.525);
    sigLegEffLRJ_1Subjet->SetTextSize(0.03);

    TLegend *backLegEffLRJ_1Subjet = new TLegend(0.7,0.2,1.0,0.525);
    backLegEffLRJ_1Subjet->SetTextSize(0.03);

    TLegend *sigLegEffLRJ_Dijet = new TLegend(0.6,0.2,0.9,0.525);
    sigLegEffLRJ_Dijet->SetTextSize(0.03);

    TLegend *sigLegEffLRJ_GrEq2Subjets = new TLegend(0.7,0.2,1.0,0.525);
    sigLegEffLRJ_GrEq2Subjets->SetTextSize(0.03);

    TLegend *backLegEffLRJ_GrEq2Subjets = new TLegend(0.7,0.2,1.0,0.525);
    backLegEffLRJ_GrEq2Subjets->SetTextSize(0.03);

    TLegend *backLegEffLRJ = new TLegend(0.7,0.2,1.0,0.525);
    backLegEffLRJ->SetTextSize(0.03);

    TLegend *sigLegEffLRJ_gFex = new TLegend(0.7,0.2,1.0,0.525);
    sigLegEffLRJ_gFex->SetTextSize(0.03);

    TLegend *sigLegEffLRJ_jFex = new TLegend(0.7,0.2,1.0,0.525);
    sigLegEffLRJ_jFex->SetTextSize(0.03);

    TLegend *sigLegEffLRJ_gFex_Dijet = new TLegend(0.7,0.2,1.0,0.525);
    sigLegEffLRJ_gFex_Dijet->SetTextSize(0.03);

    TLegend *backLegEffLRJ_gFex = new TLegend(0.7,0.2,1.0,0.525);
    backLegEffLRJ_gFex->SetTextSize(0.03);

    TLegend *backLegEffLRJ_jFex = new TLegend(0.7,0.2,1.0,0.525);
    backLegEffLRJ_jFex->SetTextSize(0.03);

    c.cd();

    std::cout << "--------------------------------" << "\n";
    std::cout << "for: " << algorithmConfigurations[fileIt] << "\n";
    //std::cout << "Signal mean: " << sig_h_LRJ_Et->GetMean() << " and background mean: " << back_h_LRJ_Et->GetMean() << "\n";
    sig_h_LRJ_Et->Scale(1.0 / sig_h_LRJ_Et->Integral());
    back_h_LRJ_Et->Scale(1.0 / back_h_LRJ_Et->Integral());
    sig_h_LRJ_Et->SetLineColor(kRed);
    back_h_LRJ_Et->SetLineColor(kBlue);
    sig_h_LRJ_Et->Draw("HIST");
    back_h_LRJ_Et->Draw("HIST SAME");
    
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "LRJ_Et.pdf");
    //gStyle->SetOptTitle(0); // disable title
    std::cout << "test1" << "\n";
    sig_h_leading_LRJ_psi_R->Scale(1.0 / sig_h_leading_LRJ_psi_R->Integral());
    back_h_leading_LRJ_psi_R->Scale(1.0 / back_h_leading_LRJ_psi_R->Integral());
    sig_h_leading_LRJ_psi_R->SetLineColor(kRed);
    back_h_leading_LRJ_psi_R->SetLineColor(kBlue);
    
    back_h_leading_LRJ_psi_R->Draw("HIST");
    sig_h_leading_LRJ_psi_R->Draw("HIST SAME");
    
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "leading_LRJ_psi_R_JetTagger.pdf");

    TLegend *legBackPsi_R_MassOverlay_Back = new TLegend(0.6,0.8,0.85,0.95);
    legBackPsi_R_MassOverlay_Back->SetTextSize(0.025);
    
    back_h_leading_LRJ_psi_R->Scale(1.0 / back_h_leading_LRJ_psi_R->Integral());
    back_h_leading_LRJ_psi_R_MassWindow->Scale(1.0 / back_h_leading_LRJ_psi_R_MassWindow->Integral());
    back_h_leading_LRJ_psi_R_OutsideMassWindow->Scale(1.0 / back_h_leading_LRJ_psi_R_OutsideMassWindow->Integral());

    back_h_leading_LRJ_psi_R->SetLineStyle(kSolid);
    back_h_leading_LRJ_psi_R->SetLineStyle(kBlack);
    back_h_leading_LRJ_psi_R_MassWindow->SetLineStyle(kDashed);
    back_h_leading_LRJ_psi_R_MassWindow->SetLineColor(kRed);
    back_h_leading_LRJ_psi_R_OutsideMassWindow->SetLineStyle(kDashed);
    back_h_leading_LRJ_psi_R_OutsideMassWindow->SetLineColor(kBlue);

    back_h_leading_LRJ_psi_R->Draw("HIST");
    back_h_leading_LRJ_psi_R_MassWindow->Draw("HIST SAME");
    back_h_leading_LRJ_psi_R_OutsideMassWindow->Draw("HIST SAME");
    legBackPsi_R_MassOverlay_Back->AddEntry(back_h_leading_LRJ_psi_R, "All Events", "l");
    legBackPsi_R_MassOverlay_Back->AddEntry(back_h_leading_LRJ_psi_R_MassWindow, "m_{Lead. Offline} >= 50 GeV", "l");
    legBackPsi_R_MassOverlay_Back->AddEntry(back_h_leading_LRJ_psi_R_OutsideMassWindow, "m_{Lead. Offline} < 50 GeV", "l");
    legBackPsi_R_MassOverlay_Back->Draw();
    c.SaveAs(modifiedOutputFileDir + "leading_LRJ_psi_R_JetTagger_Back_MassOverlay.pdf");

    TLegend *legBackPsi_R_MassOverlay_Sig = new TLegend(0.7,0.8,0.85,0.95);
    legBackPsi_R_MassOverlay_Sig->SetTextSize(0.025);

    sig_h_leading_LRJ_psi_R->Scale(1.0 / sig_h_leading_LRJ_psi_R->Integral());
    sig_h_leading_LRJ_psi_R_MassWindow->Scale(1.0 / sig_h_leading_LRJ_psi_R_MassWindow->Integral());
    sig_h_leading_LRJ_psi_R_OutsideMassWindow->Scale(1.0 / sig_h_leading_LRJ_psi_R_OutsideMassWindow->Integral());
    
    sig_h_leading_LRJ_psi_R->SetLineStyle(kSolid);
    sig_h_leading_LRJ_psi_R->SetLineStyle(kBlack);
    sig_h_leading_LRJ_psi_R_MassWindow->SetLineColor(kRed);
    sig_h_leading_LRJ_psi_R_MassWindow->SetLineStyle(kDashed);
    sig_h_leading_LRJ_psi_R_OutsideMassWindow->SetLineColor(kBlue);
    sig_h_leading_LRJ_psi_R_OutsideMassWindow->SetLineStyle(kDashed);

    sig_h_leading_LRJ_psi_R->Draw("HIST");
    sig_h_leading_LRJ_psi_R_OutsideMassWindow->Draw("HIST SAME");
    sig_h_leading_LRJ_psi_R_MassWindow->Draw("HIST SAME");
    legBackPsi_R_MassOverlay_Sig->AddEntry(sig_h_leading_LRJ_psi_R, "All Events", "l");
    legBackPsi_R_MassOverlay_Sig->AddEntry(sig_h_leading_LRJ_psi_R_MassWindow, "m_{Lead. Offline} in [100, 150] GeV", "l");
    legBackPsi_R_MassOverlay_Sig->AddEntry(sig_h_leading_LRJ_psi_R_OutsideMassWindow, "m_{Lead. Offline} outside [100, 150] GeV", "l");
    legBackPsi_R_MassOverlay_Sig->Draw();
    c.SaveAs(modifiedOutputFileDir + "leading_LRJ_psi_R_JetTagger_Signal_MassOverlay.pdf");
    
    //sigOfflineLeadingLRJMassvsPsi_R->Draw("COLZ");
    //sigOfflineLeadingLRJMassvsPsi_R->Scale(1.0 / sigOfflineLeadingLRJMassvsPsi_R->Integral());
    //c.SaveAs(modifiedOutputFileDir + "sigOfflineLeadingLRJMassvsPsi_R.pdf");

    sig_h_leading_LRJ_psi_R_VariableIOs_2->Scale(1.0 / sig_h_leading_LRJ_psi_R_VariableIOs_2->Integral());
    back_h_leading_LRJ_psi_R_VariableIOs_2->Scale(1.0 / back_h_leading_LRJ_psi_R_VariableIOs_2->Integral());
    sig_h_leading_LRJ_psi_R_VariableIOs_2->SetLineColor(kRed);
    back_h_leading_LRJ_psi_R_VariableIOs_2->SetLineColor(kBlue);
    
    back_h_leading_LRJ_psi_R_VariableIOs_2->Draw("HIST");
    sig_h_leading_LRJ_psi_R_VariableIOs_2->Draw("HIST SAME");
    
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "leading_LRJ_psi_R_VariableIOs_2.pdf");

    sig_h_subleading_LRJ_psi_R_VariableIOs_2->Scale(1.0 / sig_h_subleading_LRJ_psi_R_VariableIOs_2->Integral());
    back_h_subleading_LRJ_psi_R_VariableIOs_2->Scale(1.0 / back_h_subleading_LRJ_psi_R_VariableIOs_2->Integral());
    sig_h_subleading_LRJ_psi_R_VariableIOs_2->SetLineColor(kRed);
    back_h_subleading_LRJ_psi_R_VariableIOs_2->SetLineColor(kBlue);
    
    back_h_subleading_LRJ_psi_R_VariableIOs_2->Draw("HIST");
    sig_h_subleading_LRJ_psi_R_VariableIOs_2->Draw("HIST SAME");
    
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "subleading_LRJ_psi_R_VariableIOs_2.pdf");

    sig_h_LRJ_psi_R_squared_VariableIOs_2->Scale(1.0 / sig_h_LRJ_psi_R_squared_VariableIOs_2->Integral());
    back_h_LRJ_psi_R_squared_VariableIOs_2->Scale(1.0 / back_h_LRJ_psi_R_squared_VariableIOs_2->Integral());
    sig_h_LRJ_psi_R_squared_VariableIOs_2->SetLineColor(kRed);
    back_h_LRJ_psi_R_squared_VariableIOs_2->SetLineColor(kBlue);
    
    back_h_LRJ_psi_R_squared_VariableIOs_2->Draw("HIST");
    sig_h_LRJ_psi_R_squared_VariableIOs_2->Draw("HIST SAME");
    
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "LRJ_psi_R_squared_VariableIOs_2.pdf");

    sig_h_leading_LRJ_psi_R_VariableIOs_3->Scale(1.0 / sig_h_leading_LRJ_psi_R_VariableIOs_3->Integral());
    back_h_leading_LRJ_psi_R_VariableIOs_3->Scale(1.0 / back_h_leading_LRJ_psi_R_VariableIOs_3->Integral());
    sig_h_leading_LRJ_psi_R_VariableIOs_3->SetLineColor(kRed);
    back_h_leading_LRJ_psi_R_VariableIOs_3->SetLineColor(kBlue);
    
    back_h_leading_LRJ_psi_R_VariableIOs_3->Draw("HIST");
    sig_h_leading_LRJ_psi_R_VariableIOs_3->Draw("HIST SAME");
    
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "leading_LRJ_psi_R_VariableIOs_3.pdf");

    sig_h_subleading_LRJ_psi_R_VariableIOs_3->Scale(1.0 / sig_h_subleading_LRJ_psi_R_VariableIOs_3->Integral());
    back_h_subleading_LRJ_psi_R_VariableIOs_3->Scale(1.0 / back_h_subleading_LRJ_psi_R_VariableIOs_3->Integral());
    sig_h_subleading_LRJ_psi_R_VariableIOs_3->SetLineColor(kRed);
    back_h_subleading_LRJ_psi_R_VariableIOs_3->SetLineColor(kBlue);
    
    back_h_subleading_LRJ_psi_R_VariableIOs_3->Draw("HIST");
    sig_h_subleading_LRJ_psi_R_VariableIOs_3->Draw("HIST SAME");
    
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "subleading_LRJ_psi_R_VariableIOs_3.pdf");

    sig_h_LRJ_psi_R_squared_VariableIOs_3->Scale(1.0 / sig_h_LRJ_psi_R_squared_VariableIOs_3->Integral());
    back_h_LRJ_psi_R_squared_VariableIOs_3->Scale(1.0 / back_h_LRJ_psi_R_squared_VariableIOs_3->Integral());
    sig_h_LRJ_psi_R_squared_VariableIOs_3->SetLineColor(kRed);
    back_h_LRJ_psi_R_squared_VariableIOs_3->SetLineColor(kBlue);
    
    back_h_LRJ_psi_R_squared_VariableIOs_3->Draw("HIST");
    sig_h_LRJ_psi_R_squared_VariableIOs_3->Draw("HIST SAME");
    
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "LRJ_psi_R_squared_VariableIOs_3.pdf");

    sig_h_leading_LRJ_psi_R_VariableIOs_4->Scale(1.0 / sig_h_leading_LRJ_psi_R_VariableIOs_4->Integral());
    back_h_leading_LRJ_psi_R_VariableIOs_4->Scale(1.0 / back_h_leading_LRJ_psi_R_VariableIOs_4->Integral());
    sig_h_leading_LRJ_psi_R_VariableIOs_4->SetLineColor(kRed);
    back_h_leading_LRJ_psi_R_VariableIOs_4->SetLineColor(kBlue);
    
    back_h_leading_LRJ_psi_R_VariableIOs_4->Draw("HIST");
    sig_h_leading_LRJ_psi_R_VariableIOs_4->Draw("HIST SAME");
    
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "leading_LRJ_psi_R_VariableIOs_4.pdf");

    sig_h_subleading_LRJ_psi_R_VariableIOs_4->Scale(1.0 / sig_h_subleading_LRJ_psi_R_VariableIOs_4->Integral());
    back_h_subleading_LRJ_psi_R_VariableIOs_4->Scale(1.0 / back_h_subleading_LRJ_psi_R_VariableIOs_4->Integral());
    sig_h_subleading_LRJ_psi_R_VariableIOs_4->SetLineColor(kRed);
    back_h_subleading_LRJ_psi_R_VariableIOs_4->SetLineColor(kBlue);
    
    back_h_subleading_LRJ_psi_R_VariableIOs_4->Draw("HIST");
    sig_h_subleading_LRJ_psi_R_VariableIOs_4->Draw("HIST SAME");
    
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "subleading_LRJ_psi_R_VariableIOs_4.pdf");

    sig_h_LRJ_psi_R_squared_VariableIOs_4->Scale(1.0 / sig_h_LRJ_psi_R_squared_VariableIOs_4->Integral());
    back_h_LRJ_psi_R_squared_VariableIOs_4->Scale(1.0 / back_h_LRJ_psi_R_squared_VariableIOs_4->Integral());
    sig_h_LRJ_psi_R_squared_VariableIOs_4->SetLineColor(kRed);
    back_h_LRJ_psi_R_squared_VariableIOs_4->SetLineColor(kBlue);
    
    back_h_LRJ_psi_R_squared_VariableIOs_4->Draw("HIST");
    sig_h_LRJ_psi_R_squared_VariableIOs_4->Draw("HIST SAME");
    
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "LRJ_psi_R_squared_VariableIOs_4.pdf");

    sig_h_leading_LRJ_psi_R_VariableIOs_5->Scale(1.0 / sig_h_leading_LRJ_psi_R_VariableIOs_5->Integral());
    back_h_leading_LRJ_psi_R_VariableIOs_5->Scale(1.0 / back_h_leading_LRJ_psi_R_VariableIOs_5->Integral());
    sig_h_leading_LRJ_psi_R_VariableIOs_5->SetLineColor(kRed);
    back_h_leading_LRJ_psi_R_VariableIOs_5->SetLineColor(kBlue);
    
    back_h_leading_LRJ_psi_R_VariableIOs_5->Draw("HIST");
    sig_h_leading_LRJ_psi_R_VariableIOs_5->Draw("HIST SAME");
    
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "leading_LRJ_psi_R_VariableIOs_5.pdf");

    sig_h_subleading_LRJ_psi_R_VariableIOs_5->Scale(1.0 / sig_h_subleading_LRJ_psi_R_VariableIOs_5->Integral());
    back_h_subleading_LRJ_psi_R_VariableIOs_5->Scale(1.0 / back_h_subleading_LRJ_psi_R_VariableIOs_5->Integral());
    sig_h_subleading_LRJ_psi_R_VariableIOs_5->SetLineColor(kRed);
    back_h_subleading_LRJ_psi_R_VariableIOs_5->SetLineColor(kBlue);
    
    back_h_subleading_LRJ_psi_R_VariableIOs_5->Draw("HIST");
    sig_h_subleading_LRJ_psi_R_VariableIOs_5->Draw("HIST SAME");
    
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "subleading_LRJ_psi_R_VariableIOs_5.pdf");

    sig_h_LRJ_psi_R_squared_VariableIOs_5->Scale(1.0 / sig_h_LRJ_psi_R_squared_VariableIOs_5->Integral());
    back_h_LRJ_psi_R_squared_VariableIOs_5->Scale(1.0 / back_h_LRJ_psi_R_squared_VariableIOs_5->Integral());
    sig_h_LRJ_psi_R_squared_VariableIOs_5->SetLineColor(kRed);
    back_h_LRJ_psi_R_squared_VariableIOs_5->SetLineColor(kBlue);
    
    back_h_LRJ_psi_R_squared_VariableIOs_5->Draw("HIST");
    sig_h_LRJ_psi_R_squared_VariableIOs_5->Draw("HIST SAME");
    
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "LRJ_psi_R_squared_VariableIOs_5.pdf");

    sig_h_LRJ_psi_R_12->Scale(1.0 / sig_h_LRJ_psi_R_12->Integral());
    back_h_LRJ_psi_R_12->Scale(1.0 / back_h_LRJ_psi_R_12->Integral());
    sig_h_LRJ_psi_R_12->SetLineColor(kRed);
    back_h_LRJ_psi_R_12->SetLineColor(kBlue);
    
    back_h_LRJ_psi_R_12->Draw("HIST");
    sig_h_LRJ_psi_R_12->Draw("HIST SAME");
    
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "LRJ_psi_R_Leading_over_Subleading.pdf");

    sig_h_LRJ_psi_R2_12->Scale(1.0 / sig_h_LRJ_psi_R2_12->Integral());
    back_h_LRJ_psi_R2_12->Scale(1.0 / back_h_LRJ_psi_R2_12->Integral());
    sig_h_LRJ_psi_R2_12->SetLineColor(kRed);
    back_h_LRJ_psi_R2_12->SetLineColor(kBlue);
    
    back_h_LRJ_psi_R2_12->Draw("HIST");
    sig_h_LRJ_psi_R2_12->Draw("HIST SAME");
    
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "LRJ_psi_R2_Leading_over_Subleading.pdf");

    TCanvas cLogY2;
    cLogY2.SetLogy();
    sig_h_LRJ_psi_R_squared->Scale(1.0 / sig_h_LRJ_psi_R_squared->Integral());
    back_h_LRJ_psi_R_squared->Scale(1.0 / back_h_LRJ_psi_R_squared->Integral());
    sig_h_LRJ_psi_R_squared->SetLineColor(kRed);
    back_h_LRJ_psi_R_squared->SetLineColor(kBlue);
    
    back_h_LRJ_psi_R_squared->Draw("HIST");
    sig_h_LRJ_psi_R_squared->Draw("HIST SAME");
    
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "leading_LRJ_psi_R_squared_JetTagger.pdf");

    
    sig_h_LRJ_psi_R2_squared->Scale(1.0 / sig_h_LRJ_psi_R2_squared->Integral());
    back_h_LRJ_psi_R2_squared->Scale(1.0 / back_h_LRJ_psi_R2_squared->Integral());
    sig_h_LRJ_psi_R2_squared->SetLineColor(kRed);
    back_h_LRJ_psi_R2_squared->SetLineColor(kBlue);
    sig_h_LRJ_psi_R2_squared->Draw("HIST");
    back_h_LRJ_psi_R2_squared->Draw("HIST SAME");
    
    
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "leading_LRJ_psi_R2_squared_JetTagger.pdf");

    c.cd();

    sig_h_subleading_LRJ_psi_R->Scale(1.0 / sig_h_subleading_LRJ_psi_R->Integral());
    back_h_subleading_LRJ_psi_R->Scale(1.0 / back_h_subleading_LRJ_psi_R->Integral());
    sig_h_subleading_LRJ_psi_R->SetLineColor(kRed);
    back_h_subleading_LRJ_psi_R->SetLineColor(kBlue);
    back_h_subleading_LRJ_psi_R->Draw("HIST");
    sig_h_subleading_LRJ_psi_R->Draw("HIST SAME");
    
    
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "subleading_LRJ_psi_R_JetTagger.pdf");

    sig_h_LRJ1_deltaEt_digitized_double->Scale(1.0 / sig_h_LRJ1_deltaEt_digitized_double->Integral());
    back_h_LRJ1_deltaEt_digitized_double->Scale(1.0 / back_h_LRJ1_deltaEt_digitized_double->Integral());
    sig_h_LRJ1_deltaEt_digitized_double->SetLineColor(kRed);
    back_h_LRJ1_deltaEt_digitized_double->SetLineColor(kBlue);
    sig_h_LRJ1_deltaEt_digitized_double->Draw("HIST");
    back_h_LRJ1_deltaEt_digitized_double->Draw("HIST SAME");
    
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "LRJ1_JetTagger_deltaEt_digitized_floatingpoint.pdf");

    sig_h_LRJ2_deltaEt_digitized_double->Scale(1.0 / sig_h_LRJ2_deltaEt_digitized_double->Integral());
    back_h_LRJ2_deltaEt_digitized_double->Scale(1.0 / back_h_LRJ2_deltaEt_digitized_double->Integral());
    sig_h_LRJ2_deltaEt_digitized_double->SetLineColor(kRed);
    back_h_LRJ2_deltaEt_digitized_double->SetLineColor(kBlue);
    sig_h_LRJ2_deltaEt_digitized_double->Draw("HIST");
    back_h_LRJ2_deltaEt_digitized_double->Draw("HIST SAME");
    
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "LRJ2_JetTagger_deltaEt_digitized_floatingpoint.pdf");

    sig_h_Mjj->Scale(1.0 / sig_h_Mjj->Integral());
    back_h_Mjj->Scale(1.0 / back_h_Mjj->Integral());
    sig_h_Mjj->SetLineColor(kRed);
    back_h_Mjj->SetLineColor(kBlue);
    back_h_Mjj->Draw("HIST");
    sig_h_Mjj->Draw("HIST SAME");
    
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "Mjj.pdf");

    sig_h_LeadingOfflineLRJ_SubjetMultiplicity->SetLineColor(kRed);
    back_h_LeadingOfflineLRJ_SubjetMultiplicity->SetLineColor(kBlue);
    back_h_LeadingOfflineLRJ_SubjetMultiplicity->Scale(1.0 / back_h_LeadingOfflineLRJ_SubjetMultiplicity->Integral());
    back_h_LeadingOfflineLRJ_SubjetMultiplicity->Draw("HIST");
    sig_h_LeadingOfflineLRJ_SubjetMultiplicity->Scale(1.0 / sig_h_LeadingOfflineLRJ_SubjetMultiplicity->Integral());
    sig_h_LeadingOfflineLRJ_SubjetMultiplicity->Draw("HIST SAME");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "LeadingOfflineLRJ_SubjetMultiplicity.pdf");

    
    sig_h_SubleadingOfflineLRJ_SubjetMultiplicity->SetLineColor(kRed);
    back_h_SubleadingOfflineLRJ_SubjetMultiplicity->SetLineColor(kBlue);
    back_h_SubleadingOfflineLRJ_SubjetMultiplicity->Scale(1.0 / back_h_SubleadingOfflineLRJ_SubjetMultiplicity->Integral());
    back_h_SubleadingOfflineLRJ_SubjetMultiplicity->Draw("HIST");
    sig_h_SubleadingOfflineLRJ_SubjetMultiplicity->Scale(1.0 / sig_h_SubleadingOfflineLRJ_SubjetMultiplicity->Integral());
    sig_h_SubleadingOfflineLRJ_SubjetMultiplicity->Draw("HIST SAME");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "SubleadingOfflineLRJ_SubjetMultiplicity.pdf");

    sig_h_JetTagger_Leading_MergedIO_Multiplicity->SetLineColor(kRed);
    back_h_JetTagger_Leading_MergedIO_Multiplicity->SetLineColor(kBlue);
    back_h_JetTagger_Leading_MergedIO_Multiplicity->Scale(1.0 / back_h_JetTagger_Leading_MergedIO_Multiplicity->Integral());
    sig_h_JetTagger_Leading_MergedIO_Multiplicity->Scale(1.0 / sig_h_JetTagger_Leading_MergedIO_Multiplicity->Integral());
    sig_h_JetTagger_Leading_MergedIO_Multiplicity->Draw("HIST");
    back_h_JetTagger_Leading_MergedIO_Multiplicity->Draw("HIST SAME");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "JetTagger_Leading_MergedIO_Multiplicity.pdf");


    std::cout << "test2" << "\n";
    sig_h_JetTagger_CellTowerSK_Multiplicity->SetLineColor(kRed);
    back_h_JetTagger_CellTowerSK_Multiplicity->SetLineColor(kBlue);
    back_h_JetTagger_CellTowerSK_Multiplicity->Scale(1.0 / back_h_JetTagger_CellTowerSK_Multiplicity->Integral());
    sig_h_JetTagger_CellTowerSK_Multiplicity->Scale(1.0 / sig_h_JetTagger_CellTowerSK_Multiplicity->Integral());
    sig_h_JetTagger_CellTowerSK_Multiplicity->Draw("HIST");
    back_h_JetTagger_CellTowerSK_Multiplicity->Draw("HIST SAME");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "JetTagger_CellTowersSK_Multiplicity.pdf");

    sig_h_JetTagger_Subleading_MergedIO_Multiplicity->SetLineColor(kRed);
    back_h_JetTagger_Subleading_MergedIO_Multiplicity->SetLineColor(kBlue);
    back_h_JetTagger_Subleading_MergedIO_Multiplicity->Scale(1.0 / back_h_JetTagger_Subleading_MergedIO_Multiplicity->Integral());
    back_h_JetTagger_Subleading_MergedIO_Multiplicity->Draw("HIST");
    sig_h_JetTagger_Subleading_MergedIO_Multiplicity->Scale(1.0 / sig_h_JetTagger_Subleading_MergedIO_Multiplicity->Integral());
    sig_h_JetTagger_Subleading_MergedIO_Multiplicity->Draw("HIST SAME");
    
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "JetTagger_Subleading_MergedIO_Multiplicity.pdf");

    TCanvas cLogYLogX;
    cLogYLogX.SetLogy();
    cLogYLogX.SetLogx();
    cLogYLogX.cd();

    sig_h_JetTagger_Leading_MergedIO_Et->SetLineColor(kRed);
    back_h_JetTagger_Leading_MergedIO_Et->SetLineColor(kBlue);
    back_h_JetTagger_Leading_MergedIO_Et->Scale(1.0 / sumOfBackgroundEventWeight);
    back_h_JetTagger_Leading_MergedIO_Et->Draw("HIST");
    sig_h_JetTagger_Leading_MergedIO_Et->Scale(1.0 / num_processed_events_signal);
    sig_h_JetTagger_Leading_MergedIO_Et->Draw("HIST SAME");
    leg->Draw();
    cLogYLogX.SaveAs(modifiedOutputFileDir + "JetTagger_Leading_MergedIO_Et.pdf");

    sig_h_JetTagger_CellsTowersEt->SetLineColor(kRed);
    back_h_JetTagger_CellsTowersEt->SetLineColor(kBlue);
    sig_h_JetTagger_CellsTowersEt->Scale(1.0 / num_processed_events_signal);
    back_h_JetTagger_CellsTowersEt->Scale(1.0 / sumOfBackgroundEventWeight);
    sig_h_JetTagger_CellsTowersEt->Draw("HIST");
    back_h_JetTagger_CellsTowersEt->Draw("HIST SAME");
    leg->Draw();
    cLogYLogX.SaveAs(modifiedOutputFileDir + "cellsTowersEtByEvent.pdf");

    sig_h_JetTagger_Considered_CellsTowersEt->SetLineColor(kRed);
    back_h_JetTagger_Considered_CellsTowersEt->SetLineColor(kBlue);
    sig_h_JetTagger_Considered_CellsTowersEt->Scale(1.0 / num_processed_events_signal);
    back_h_JetTagger_Considered_CellsTowersEt->Scale(1.0 / sumOfBackgroundEventWeight);
    sig_h_JetTagger_Considered_CellsTowersEt->Draw("HIST");
    back_h_JetTagger_Considered_CellsTowersEt->Draw("HIST SAME");
    leg->Draw();
    cLogYLogX.SaveAs(modifiedOutputFileDir + "consideredCellsTowersEtByEvent.pdf");
    
    sig_h_JetTagger_Subleading_MergedIO_Et->SetLineColor(kRed);
    back_h_JetTagger_Subleading_MergedIO_Et->SetLineColor(kBlue);
    back_h_JetTagger_Subleading_MergedIO_Et->Scale(1.0 / sumOfBackgroundEventWeight);
    back_h_JetTagger_Subleading_MergedIO_Et->Draw("HIST");
    sig_h_JetTagger_Subleading_MergedIO_Et->Scale(1.0 / num_processed_events_signal);
    sig_h_JetTagger_Subleading_MergedIO_Et->Draw("HIST SAME");
    leg->Draw();
    cLogYLogX.SaveAs(modifiedOutputFileDir + "JetTagger_Subleading_MergedIO_Et.pdf");

    cLogY2.cd();

    sig_h_LeadingJetTaggerLRJ_jFEX_SubjetMultiplicity->SetLineColor(kRed);
    back_h_LeadingJetTaggerLRJ_jFEX_SubjetMultiplicity->SetLineColor(kBlue);
    back_h_LeadingJetTaggerLRJ_jFEX_SubjetMultiplicity->Scale(1.0 / back_h_LeadingJetTaggerLRJ_jFEX_SubjetMultiplicity->Integral());
    back_h_LeadingJetTaggerLRJ_jFEX_SubjetMultiplicity->Draw("HIST");
    sig_h_LeadingJetTaggerLRJ_jFEX_SubjetMultiplicity->Scale(1.0 / sig_h_LeadingJetTaggerLRJ_jFEX_SubjetMultiplicity->Integral());
    sig_h_LeadingJetTaggerLRJ_jFEX_SubjetMultiplicity->Draw("HIST SAME");
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "LeadingJetTaggerLRJ_jFEX_SubjetMultiplicity.pdf");

    sig_h_LeadingJetTaggerLRJ_ConeCellsTowers_SubjetMultiplicity->SetLineColor(kRed);
    back_h_LeadingJetTaggerLRJ_ConeCellsTowers_SubjetMultiplicity->SetLineColor(kBlue);
    back_h_LeadingJetTaggerLRJ_ConeCellsTowers_SubjetMultiplicity->Scale(1.0 / back_h_LeadingJetTaggerLRJ_ConeCellsTowers_SubjetMultiplicity->Integral());
    back_h_LeadingJetTaggerLRJ_ConeCellsTowers_SubjetMultiplicity->Draw("HIST");
    sig_h_LeadingJetTaggerLRJ_ConeCellsTowers_SubjetMultiplicity->Scale(1.0 / sig_h_LeadingJetTaggerLRJ_ConeCellsTowers_SubjetMultiplicity->Integral());
    sig_h_LeadingJetTaggerLRJ_ConeCellsTowers_SubjetMultiplicity->Draw("HIST SAME");
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "LeadingJetTaggerLRJ_ConeCellsTowers_SubjetMultiplicity.pdf");

    sig_h_SubleadingJetTaggerLRJ_ConeCellsTowers_SubjetMultiplicity->SetLineColor(kRed);
    back_h_SubleadingJetTaggerLRJ_ConeCellsTowers_SubjetMultiplicity->SetLineColor(kBlue);
    back_h_SubleadingJetTaggerLRJ_ConeCellsTowers_SubjetMultiplicity->Scale(1.0 / back_h_SubleadingJetTaggerLRJ_ConeCellsTowers_SubjetMultiplicity->Integral());
    back_h_SubleadingJetTaggerLRJ_ConeCellsTowers_SubjetMultiplicity->Draw("HIST");
    sig_h_SubleadingJetTaggerLRJ_ConeCellsTowers_SubjetMultiplicity->Scale(1.0 / sig_h_SubleadingJetTaggerLRJ_ConeCellsTowers_SubjetMultiplicity->Integral());
    sig_h_SubleadingJetTaggerLRJ_ConeCellsTowers_SubjetMultiplicity->Draw("HIST SAME");
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "SubleadingJetTaggerLRJ_ConeCellsTowers_SubjetMultiplicity.pdf");

    sig_h_SubleadingJetTaggerLRJ_jFEX_SubjetMultiplicity->SetLineColor(kRed);
    back_h_SubleadingJetTaggerLRJ_jFEX_SubjetMultiplicity->SetLineColor(kBlue);
    back_h_SubleadingJetTaggerLRJ_jFEX_SubjetMultiplicity->Scale(1.0 / back_h_SubleadingJetTaggerLRJ_jFEX_SubjetMultiplicity->Integral());
    back_h_SubleadingJetTaggerLRJ_jFEX_SubjetMultiplicity->Draw("HIST");
    sig_h_SubleadingJetTaggerLRJ_jFEX_SubjetMultiplicity->Scale(1.0 / sig_h_SubleadingJetTaggerLRJ_jFEX_SubjetMultiplicity->Integral());
    sig_h_SubleadingJetTaggerLRJ_jFEX_SubjetMultiplicity->Draw("HIST SAME");
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "SubleadingJetTaggerLRJ_jFEX_SubjetMultiplicity.pdf");

    sig_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_1->SetLineColor(kRed);
    back_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_1->SetLineColor(kBlue);
    back_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_1->Scale(1.0 / back_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_1->Integral());
    back_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_1->Draw("HIST");
    sig_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_1->Scale(1.0 / sig_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_1->Integral());
    sig_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_1->Draw("HIST SAME");
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "LeadingJetTaggerLRJ_jFEX_Subjet_Tau_1.pdf"); 

    sig_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_2->SetLineColor(kRed);
    back_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_2->SetLineColor(kBlue);
    back_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_2->Scale(1.0 / back_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_2->Integral());
    back_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_2->Draw("HIST");
    sig_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_2->Scale(1.0 / sig_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_2->Integral());
    sig_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_2->Draw("HIST SAME");
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "LeadingJetTaggerLRJ_jFEX_Subjet_Tau_2.pdf"); 

    sig_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_12->SetLineColor(kRed);
    back_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_12->SetLineColor(kBlue);
    back_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_12->Scale(1.0 / back_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_12->Integral());
    back_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_12->Draw("HIST");
    sig_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_12->Scale(1.0 / sig_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_12->Integral());
    sig_h_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_12->Draw("HIST SAME");
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "LeadingJetTaggerLRJ_jFEX_Subjet_Tau_12.pdf"); 

    sig_h_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_12->SetLineColor(kRed);
    back_h_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_12->SetLineColor(kBlue);
    back_h_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_12->Scale(1.0 / back_h_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_12->Integral());
    back_h_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_12->Draw("HIST");
    sig_h_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_12->Scale(1.0 / sig_h_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_12->Integral());
    sig_h_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_12->Draw("HIST SAME");
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_12.pdf"); 

    sig_h_JetTaggerLRJ_jFEX_Subjet_Tau_21_Product->SetLineColor(kRed);
    back_h_JetTaggerLRJ_jFEX_Subjet_Tau_21_Product->SetLineColor(kBlue);
    back_h_JetTaggerLRJ_jFEX_Subjet_Tau_21_Product->Scale(1.0 / back_h_JetTaggerLRJ_jFEX_Subjet_Tau_21_Product->Integral());
    back_h_JetTaggerLRJ_jFEX_Subjet_Tau_21_Product->Draw("HIST");
    sig_h_JetTaggerLRJ_jFEX_Subjet_Tau_21_Product->Scale(1.0 / sig_h_JetTaggerLRJ_jFEX_Subjet_Tau_21_Product->Integral());
    sig_h_JetTaggerLRJ_jFEX_Subjet_Tau_21_Product->Draw("HIST SAME");
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "JetTaggerLRJ_jFEX_Subjet_Tau_21_Product.pdf"); 
    
    sig_h_JetTaggerLRJ_ConeCellsTowers_Subjet_Tau_21_Product->SetLineColor(kRed);
    back_h_JetTaggerLRJ_ConeCellsTowers_Subjet_Tau_21_Product->SetLineColor(kBlue);
    back_h_JetTaggerLRJ_ConeCellsTowers_Subjet_Tau_21_Product->Scale(1.0 / back_h_JetTaggerLRJ_ConeCellsTowers_Subjet_Tau_21_Product->Integral());
    back_h_JetTaggerLRJ_ConeCellsTowers_Subjet_Tau_21_Product->Draw("HIST");
    sig_h_JetTaggerLRJ_ConeCellsTowers_Subjet_Tau_21_Product->Scale(1.0 / sig_h_JetTaggerLRJ_ConeCellsTowers_Subjet_Tau_21_Product->Integral());
    sig_h_JetTaggerLRJ_ConeCellsTowers_Subjet_Tau_21_Product->Draw("HIST SAME");
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "JetTaggerLRJ_Cone_Subjet_Tau_21_Product.pdf"); 
    
    sig_h_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1->SetLineColor(kRed);
    back_h_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1->SetLineColor(kBlue);
    back_h_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1->Scale(1.0 / back_h_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1->Integral());
    back_h_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1->Draw("HIST");
    sig_h_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1->Scale(1.0 / sig_h_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1->Integral());
    sig_h_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1->Draw("HIST SAME");
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1.pdf"); 

    sig_h_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_2->SetLineColor(kRed);
    back_h_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_2->SetLineColor(kBlue);
    back_h_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_2->Scale(1.0 / back_h_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_2->Integral());
    back_h_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_2->Draw("HIST");
    sig_h_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_2->Scale(1.0 / sig_h_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_2->Integral());
    sig_h_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_2->Draw("HIST SAME");
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_2.pdf"); 

    sig_h_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_12->SetLineColor(kRed);
    back_h_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_12->SetLineColor(kBlue);
    back_h_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_12->Scale(1.0 / back_h_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_12->Integral());
    back_h_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_12->Draw("HIST");
    sig_h_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_12->Scale(1.0 / sig_h_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_12->Integral());
    sig_h_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_12->Draw("HIST SAME");
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_12.pdf"); 

    sig_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_12->SetLineColor(kRed);
    back_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_12->SetLineColor(kBlue);
    back_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_12->Scale(1.0 / back_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_12->Integral());
    back_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_12->Draw("HIST");
    sig_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_12->Scale(1.0 / sig_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_12->Integral());
    sig_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_12->Draw("HIST SAME");
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_12.pdf"); 

    back_h_leading_LRJ_psi_R_squared_NoConeSubjets->Draw("HIST");
    cLogY2.SaveAs(modifiedOutputFileDir + "Back_Leading_LRJ_psi_R_squared_NoConeSubjets.pdf"); 

    sig_h_leading_LRJ_psi_R_squared_NoConeSubjets->Draw("HIST");
    cLogY2.SaveAs(modifiedOutputFileDir + "Sig_Leading_LRJ_psi_R_squared_NoConeSubjets.pdf"); 

    back_h_leading_LRJ_psi_R_squared_NojFEXSubjets->Draw("HIST");
    cLogY2.SaveAs(modifiedOutputFileDir + "Back_Leading_LRJ_psi_R_squared_NojFEXSubjets.pdf"); 

    sig_h_leading_LRJ_psi_R_squared_NojFEXSubjets->Draw("HIST");
    cLogY2.SaveAs(modifiedOutputFileDir + "Sig_Leading_LRJ_psi_R_squared_NojFEXSubjets.pdf"); 

    sig_h_leading_LRJ_psi_R_squared_NoConeSubjets->SetLineColor(kRed);
    back_h_leading_LRJ_psi_R_squared_NoConeSubjets->SetLineColor(kBlue);
    back_h_leading_LRJ_psi_R_squared_NoConeSubjets->Scale(1.0 / back_h_leading_LRJ_psi_R_squared_NoConeSubjets->Integral());
    back_h_leading_LRJ_psi_R_squared_NoConeSubjets->Draw("HIST");
    sig_h_leading_LRJ_psi_R_squared_NoConeSubjets->Scale(1.0 / sig_h_leading_LRJ_psi_R_squared_NoConeSubjets->Integral());
    sig_h_leading_LRJ_psi_R_squared_NoConeSubjets->Draw("HIST SAME"); // FIXME add n events
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "Leading_LRJ_psi_R_squared_NoConeSubjets.pdf"); 

    sig_h_leading_LRJ_psi_R_squared_NojFEXSubjets->SetLineColor(kRed);
    back_h_leading_LRJ_psi_R_squared_NojFEXSubjets->SetLineColor(kBlue);
    back_h_leading_LRJ_psi_R_squared_NojFEXSubjets->Scale(1.0 / back_h_leading_LRJ_psi_R_squared_NojFEXSubjets->Integral());
    back_h_leading_LRJ_psi_R_squared_NojFEXSubjets->Draw("HIST");
    sig_h_leading_LRJ_psi_R_squared_NojFEXSubjets->Scale(1.0 / sig_h_leading_LRJ_psi_R_squared_NojFEXSubjets->Integral());
    sig_h_leading_LRJ_psi_R_squared_NojFEXSubjets->Draw("HIST SAME");
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "Leading_LRJ_psi_R_squared_NojFEXSubjets.pdf"); 

    sig_h_leading_LRJ_psi_R_squared_With1ConeSubjet->SetLineColor(kRed);
    back_h_leading_LRJ_psi_R_squared_With1ConeSubjet->SetLineColor(kBlue);
    back_h_leading_LRJ_psi_R_squared_With1ConeSubjet->Scale(1.0 / back_h_leading_LRJ_psi_R_squared_With1ConeSubjet->Integral());
    back_h_leading_LRJ_psi_R_squared_With1ConeSubjet->Draw("HIST");
    sig_h_leading_LRJ_psi_R_squared_With1ConeSubjet->Scale(1.0 / sig_h_leading_LRJ_psi_R_squared_With1ConeSubjet->Integral());
    sig_h_leading_LRJ_psi_R_squared_With1ConeSubjet->Draw("HIST SAME"); // FIXME add n events
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "Leading_LRJ_psi_R_squared_With1ConeSubjet.pdf"); 

    sig_h_leading_LRJ_psi_R_squared_With1jFEXSubjet->SetLineColor(kRed);
    back_h_leading_LRJ_psi_R_squared_With1jFEXSubjet->SetLineColor(kBlue);
    back_h_leading_LRJ_psi_R_squared_With1jFEXSubjet->Scale(1.0 / back_h_leading_LRJ_psi_R_squared_With1jFEXSubjet->Integral());
    back_h_leading_LRJ_psi_R_squared_With1jFEXSubjet->Draw("HIST");
    sig_h_leading_LRJ_psi_R_squared_With1jFEXSubjet->Scale(1.0 / sig_h_leading_LRJ_psi_R_squared_With1jFEXSubjet->Integral());
    sig_h_leading_LRJ_psi_R_squared_With1jFEXSubjet->Draw("HIST SAME");
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "Leading_LRJ_psi_R_squared_With1jFEXSubjet.pdf"); 

    sig_h_leading_LRJ_psi_R_squared_WithGrEq2ConeSubjet->SetLineColor(kRed);
    back_h_leading_LRJ_psi_R_squared_WithGrEq2ConeSubjet->SetLineColor(kBlue);
    back_h_leading_LRJ_psi_R_squared_WithGrEq2ConeSubjet->Scale(1.0 / back_h_leading_LRJ_psi_R_squared_WithGrEq2ConeSubjet->Integral());
    back_h_leading_LRJ_psi_R_squared_WithGrEq2ConeSubjet->Draw("HIST");
    sig_h_leading_LRJ_psi_R_squared_WithGrEq2ConeSubjet->Scale(1.0 / sig_h_leading_LRJ_psi_R_squared_WithGrEq2ConeSubjet->Integral());
    sig_h_leading_LRJ_psi_R_squared_WithGrEq2ConeSubjet->Draw("HIST SAME"); // FIXME add n events
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "Leading_LRJ_psi_R_squared_WithGrEq2ConeSubjet.pdf"); 
    
    sig_h_leading_LRJ_psi_R_SubleadingSubjet_WithGrEq2ConeSubjet->SetLineColor(kRed);
    back_h_leading_LRJ_psi_R_SubleadingSubjet_WithGrEq2ConeSubjet->SetLineColor(kBlue);
    back_h_leading_LRJ_psi_R_SubleadingSubjet_WithGrEq2ConeSubjet->Scale(1.0 / back_h_leading_LRJ_psi_R_SubleadingSubjet_WithGrEq2ConeSubjet->Integral());
    back_h_leading_LRJ_psi_R_SubleadingSubjet_WithGrEq2ConeSubjet->Draw("HIST");
    sig_h_leading_LRJ_psi_R_SubleadingSubjet_WithGrEq2ConeSubjet->Scale(1.0 / sig_h_leading_LRJ_psi_R_SubleadingSubjet_WithGrEq2ConeSubjet->Integral());
    sig_h_leading_LRJ_psi_R_SubleadingSubjet_WithGrEq2ConeSubjet->Draw("HIST SAME"); // FIXME add n events
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "Leading_LRJ_psi_R_SubleadingSubjet_WithGrEq2ConeSubjet.pdf"); 

    sig_h_leading_LRJ_psi_R_squared_WithGrEq2jFEXSubjet->SetLineColor(kRed);
    back_h_leading_LRJ_psi_R_squared_WithGrEq2jFEXSubjet->SetLineColor(kBlue);
    back_h_leading_LRJ_psi_R_squared_WithGrEq2jFEXSubjet->Scale(1.0 / back_h_leading_LRJ_psi_R_squared_WithGrEq2jFEXSubjet->Integral());
    back_h_leading_LRJ_psi_R_squared_WithGrEq2jFEXSubjet->Draw("HIST");
    sig_h_leading_LRJ_psi_R_squared_WithGrEq2jFEXSubjet->Scale(1.0 / sig_h_leading_LRJ_psi_R_squared_WithGrEq2jFEXSubjet->Integral());
    sig_h_leading_LRJ_psi_R_squared_WithGrEq2jFEXSubjet->Draw("HIST SAME");
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "Leading_LRJ_psi_R_squared_WithGrEq2jFEXSubjet.pdf"); 

    sig_h_leading_LRJ_DeltaRSubjets_WithGrEq2ConeSubjet->SetLineColor(kRed);
    back_h_leading_LRJ_DeltaRSubjets_WithGrEq2ConeSubjet->SetLineColor(kBlue);
    back_h_leading_LRJ_DeltaRSubjets_WithGrEq2ConeSubjet->Scale(1.0 / back_h_leading_LRJ_DeltaRSubjets_WithGrEq2ConeSubjet->Integral());
    back_h_leading_LRJ_DeltaRSubjets_WithGrEq2ConeSubjet->Draw("HIST");
    sig_h_leading_LRJ_DeltaRSubjets_WithGrEq2ConeSubjet->Scale(1.0 / sig_h_leading_LRJ_DeltaRSubjets_WithGrEq2ConeSubjet->Integral());
    sig_h_leading_LRJ_DeltaRSubjets_WithGrEq2ConeSubjet->Draw("HIST SAME"); // FIXME add n events
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "Leading_LRJ_DeltaRSubjets_WithGrEq2ConeSubjet.pdf"); 

    sig_h_leading_LRJ_MassApprox_WithGrEq2ConeSubjet->SetLineColor(kRed);
    back_h_leading_LRJ_MassApprox_WithGrEq2ConeSubjet->SetLineColor(kBlue);
    back_h_leading_LRJ_MassApprox_WithGrEq2ConeSubjet->Scale(1.0 / back_h_leading_LRJ_MassApprox_WithGrEq2ConeSubjet->Integral());
    back_h_leading_LRJ_MassApprox_WithGrEq2ConeSubjet->Draw("HIST");
    sig_h_leading_LRJ_MassApprox_WithGrEq2ConeSubjet->Scale(1.0 / sig_h_leading_LRJ_MassApprox_WithGrEq2ConeSubjet->Integral());
    sig_h_leading_LRJ_MassApprox_WithGrEq2ConeSubjet->Draw("HIST SAME"); // FIXME add n events
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "Leading_LRJ_MassApprox_WithGrEq2ConeSubjet.pdf"); 

    sig_h_leading_LRJ_MassApprox_WithGrEq2jFEXSubjet->SetLineColor(kRed);
    back_h_leading_LRJ_MassApprox_WithGrEq2jFEXSubjet->SetLineColor(kBlue);
    back_h_leading_LRJ_MassApprox_WithGrEq2jFEXSubjet->Scale(1.0 / back_h_leading_LRJ_MassApprox_WithGrEq2jFEXSubjet->Integral());
    back_h_leading_LRJ_MassApprox_WithGrEq2jFEXSubjet->Draw("HIST");
    sig_h_leading_LRJ_MassApprox_WithGrEq2jFEXSubjet->Scale(1.0 / sig_h_leading_LRJ_MassApprox_WithGrEq2jFEXSubjet->Integral());
    sig_h_leading_LRJ_MassApprox_WithGrEq2jFEXSubjet->Draw("HIST SAME");
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "Leading_LRJ_MassApprox_WithGrEq2jFEXSubjet.pdf"); 

    sig_h_leading_LRJ_Z->SetLineColor(kRed);
    back_h_leading_LRJ_Z->SetLineColor(kBlue);
    back_h_leading_LRJ_Z->Scale(1.0 / back_h_leading_LRJ_Z->Integral());
    back_h_leading_LRJ_Z->Draw("HIST");
    sig_h_leading_LRJ_Z->Scale(1.0 / sig_h_leading_LRJ_Z->Integral());
    sig_h_leading_LRJ_Z->Draw("HIST SAME"); // FIXME add n events
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "Leading_LRJ_Z.pdf"); 

    sig_h_subleading_LRJ_Z->SetLineColor(kRed);
    back_h_subleading_LRJ_Z->SetLineColor(kBlue);
    back_h_subleading_LRJ_Z->Scale(1.0 / back_h_subleading_LRJ_Z->Integral());
    back_h_subleading_LRJ_Z->Draw("HIST");
    sig_h_subleading_LRJ_Z->Scale(1.0 / sig_h_subleading_LRJ_Z->Integral());
    sig_h_subleading_LRJ_Z->Draw("HIST SAME"); // FIXME add n events
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "Subleading_LRJ_Z.pdf"); 

    sig_h_leading_LRJ_Et_NojFEXSubjets->Draw("HIST");
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "sig_Leading_LRJ_Et_NojFEXSubjets.pdf"); 

    back_h_leading_LRJ_Et_NojFEXSubjets->Draw("HIST");
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "back_Leading_LRJ_Et_NojFEXSubjets.pdf"); 

    sig_h_leading_LRJ_Et_NoConeSubjets->Draw("HIST");
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "sig_Leading_LRJ_Et_NoConeSubjets.pdf"); 

    back_h_leading_LRJ_Et_NoConeSubjets->Draw("HIST");
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "back_Leading_LRJ_Et_NoConeSubjets.pdf"); 

    sig_h_leading_LRJ_Et_With1jFEXSubjet->Draw("HIST");
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "sig_Leading_LRJ_Et_With1jFEXSubjet.pdf"); 

    back_h_leading_LRJ_Et_With1jFEXSubjet->Draw("HIST");
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "back_Leading_LRJ_Et_With1jFEXSubjet.pdf"); 

    sig_h_leading_LRJ_Et_With1ConeSubjet->Draw("HIST");
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "sig_Leading_LRJ_Et_With1ConeSubjet.pdf"); 

    back_h_leading_LRJ_Et_With1ConeSubjet->Draw("HIST");
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "back_Leading_LRJ_Et_With1ConeSubjet.pdf"); 

    sig_h_leading_LRJ_Et_WithGrEq2jFEXSubjet->Draw("HIST");
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "sig_Leading_LRJ_Et_WithGrEq2jFEXSubjet.pdf"); 

    back_h_leading_LRJ_Et_WithGrEq2jFEXSubjet->Draw("HIST");
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "back_Leading_LRJ_Et_WithGrEq2jFEXSubjet.pdf"); 

    sig_h_leading_LRJ_Et_WithGrEq2ConeSubjet->Draw("HIST");
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "sig_Leading_LRJ_Et_WithGrEq2ConeSubjet.pdf"); 

    back_h_leading_LRJ_Et_WithGrEq2ConeSubjet->Draw("HIST");
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "back_Leading_LRJ_Et_WithGrEq2ConeSubjet.pdf"); 

    sig_h_leading_LRJ_Et_NoConeSubjets->SetLineColor(kRed);
    back_h_leading_LRJ_Et_NoConeSubjets->SetLineColor(kBlue);
    back_h_leading_LRJ_Et_NoConeSubjets->Scale(1.0 / back_h_leading_LRJ_Et_NoConeSubjets->Integral());
    back_h_leading_LRJ_Et_NoConeSubjets->Draw("HIST");
    sig_h_leading_LRJ_Et_NoConeSubjets->Scale(1.0 / sig_h_leading_LRJ_Et_NoConeSubjets->Integral());
    sig_h_leading_LRJ_Et_NoConeSubjets->Draw("HIST SAME"); // FIXME add n events
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "Leading_LRJ_Et_NoConeSubjets.pdf"); 

    sig_h_leading_LRJ_Et_NojFEXSubjets->SetLineColor(kRed);
    back_h_leading_LRJ_Et_NojFEXSubjets->SetLineColor(kBlue);
    back_h_leading_LRJ_Et_NojFEXSubjets->Scale(1.0 / back_h_leading_LRJ_Et_NojFEXSubjets->Integral());
    back_h_leading_LRJ_Et_NojFEXSubjets->Draw("HIST");
    sig_h_leading_LRJ_Et_NojFEXSubjets->Scale(1.0 / sig_h_leading_LRJ_Et_NojFEXSubjets->Integral());
    sig_h_leading_LRJ_Et_NojFEXSubjets->Draw("HIST SAME");
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "Leading_LRJ_Et_NojFEXSubjets.pdf"); 

    sig_h_leading_LRJ_Et_With1ConeSubjet->SetLineColor(kRed);
    back_h_leading_LRJ_Et_With1ConeSubjet->SetLineColor(kBlue);
    back_h_leading_LRJ_Et_With1ConeSubjet->Scale(1.0 / back_h_leading_LRJ_Et_With1ConeSubjet->Integral());
    back_h_leading_LRJ_Et_With1ConeSubjet->Draw("HIST");
    sig_h_leading_LRJ_Et_With1ConeSubjet->Scale(1.0 / sig_h_leading_LRJ_Et_With1ConeSubjet->Integral());
    sig_h_leading_LRJ_Et_With1ConeSubjet->Draw("HIST SAME"); // FIXME add n events
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "Leading_LRJ_Et_With1ConeSubjet.pdf"); 

    sig_h_leading_LRJ_Et_With1jFEXSubjet->SetLineColor(kRed);
    back_h_leading_LRJ_Et_With1jFEXSubjet->SetLineColor(kBlue);
    back_h_leading_LRJ_Et_With1jFEXSubjet->Scale(1.0 / back_h_leading_LRJ_Et_With1jFEXSubjet->Integral());
    back_h_leading_LRJ_Et_With1jFEXSubjet->Draw("HIST");
    sig_h_leading_LRJ_Et_With1jFEXSubjet->Scale(1.0 / sig_h_leading_LRJ_Et_With1jFEXSubjet->Integral());
    sig_h_leading_LRJ_Et_With1jFEXSubjet->Draw("HIST SAME");
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "Leading_LRJ_Et_With1jFEXSubjet.pdf"); 

    sig_h_leading_LRJ_Et_WithGrEq2ConeSubjet->SetLineColor(kRed);
    back_h_leading_LRJ_Et_WithGrEq2ConeSubjet->SetLineColor(kBlue);
    back_h_leading_LRJ_Et_WithGrEq2ConeSubjet->Scale(1.0 / back_h_leading_LRJ_Et_WithGrEq2ConeSubjet->Integral());
    back_h_leading_LRJ_Et_WithGrEq2ConeSubjet->Draw("HIST");
    sig_h_leading_LRJ_Et_WithGrEq2ConeSubjet->Scale(1.0 / sig_h_leading_LRJ_Et_WithGrEq2ConeSubjet->Integral());
    sig_h_leading_LRJ_Et_WithGrEq2ConeSubjet->Draw("HIST SAME"); // FIXME add n events
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "Leading_LRJ_Et_WithGrEq2ConeSubjet.pdf"); 

    sig_h_leading_LRJ_DeltaRSubjetsTimesSubjetEtRatio_WithGrEq2ConeSubjet->SetLineColor(kRed);
    back_h_leading_LRJ_DeltaRSubjetsTimesSubjetEtRatio_WithGrEq2ConeSubjet->SetLineColor(kBlue);
    back_h_leading_LRJ_DeltaRSubjetsTimesSubjetEtRatio_WithGrEq2ConeSubjet->Scale(1.0 / back_h_leading_LRJ_DeltaRSubjetsTimesSubjetEtRatio_WithGrEq2ConeSubjet->Integral());
    back_h_leading_LRJ_DeltaRSubjetsTimesSubjetEtRatio_WithGrEq2ConeSubjet->Draw("HIST");
    sig_h_leading_LRJ_DeltaRSubjetsTimesSubjetEtRatio_WithGrEq2ConeSubjet->Scale(1.0 / sig_h_leading_LRJ_DeltaRSubjetsTimesSubjetEtRatio_WithGrEq2ConeSubjet->Integral());
    sig_h_leading_LRJ_DeltaRSubjetsTimesSubjetEtRatio_WithGrEq2ConeSubjet->Draw("HIST SAME"); // FIXME add n events
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "Leading_LRJ_DeltaRSubjetsTimesSubjetEtRatio_WithGrEq2ConeSubjet.pdf"); 

    sig_h_leading_LRJ_Et_WithGrEq2jFEXSubjet->SetLineColor(kRed);
    back_h_leading_LRJ_Et_WithGrEq2jFEXSubjet->SetLineColor(kBlue);
    back_h_leading_LRJ_Et_WithGrEq2jFEXSubjet->Scale(1.0 / back_h_leading_LRJ_Et_WithGrEq2jFEXSubjet->Integral());
    back_h_leading_LRJ_Et_WithGrEq2jFEXSubjet->Draw("HIST");
    sig_h_leading_LRJ_Et_WithGrEq2jFEXSubjet->Scale(1.0 / sig_h_leading_LRJ_Et_WithGrEq2jFEXSubjet->Integral());
    sig_h_leading_LRJ_Et_WithGrEq2jFEXSubjet->Draw("HIST SAME");
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "Leading_LRJ_Et_WithGrEq2jFEXSubjet.pdf"); 

    sig_h_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_1->SetLineColor(kRed);
    back_h_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_1->SetLineColor(kBlue);
    back_h_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_1->Scale(1.0 / back_h_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_1->Integral());
    back_h_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_1->Draw("HIST");
    sig_h_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_1->Scale(1.0 / sig_h_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_1->Integral());
    sig_h_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_1->Draw("HIST SAME");
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_1.pdf"); 
    std::cout << "test3" << "\n";
    sig_h_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_2->SetLineColor(kRed);
    back_h_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_2->SetLineColor(kBlue);
    back_h_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_2->Scale(1.0 / back_h_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_2->Integral());
    back_h_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_2->Draw("HIST");
    sig_h_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_2->Scale(1.0 / sig_h_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_2->Integral());
    sig_h_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_2->Draw("HIST SAME");
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_2.pdf"); 

    sig_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1->SetLineColor(kRed);
    back_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1->SetLineColor(kBlue);
    back_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1->Scale(1.0 / back_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1->Integral());
    back_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1->Draw("HIST");
    sig_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1->Scale(1.0 / sig_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1->Integral());
    sig_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1->Draw("HIST SAME");
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1.pdf"); 

    sig_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_2->SetLineColor(kRed);
    back_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_2->SetLineColor(kBlue);
    back_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_2->Scale(1.0 / back_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_2->Integral());
    back_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_2->Draw("HIST");
    sig_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_2->Scale(1.0 / sig_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_2->Integral());
    sig_h_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_2->Draw("HIST SAME");
    leg->Draw();
    cLogY2.SaveAs(modifiedOutputFileDir + "SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_2.pdf"); 
    std::cout << "test3.1" << "\n";    
    TCanvas cLogZ_NSubjetiness;
    cLogZ_NSubjetiness.SetLogz();
    cLogZ_NSubjetiness.cd();

    
    
    sigJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_2->Draw("COLZ");
    sigJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_2->Scale(1.0 / sigJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_2->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_2.pdf");

    backJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_2->Draw("COLZ");
    backJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_2->Scale(1.0 / backJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_2->Integral());
    backJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_2->SetMinimum(1e-14);
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_2.pdf");

    sigJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_3->Draw("COLZ");
    sigJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_3->Scale(1.0 / sigJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_3->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_3.pdf");

    backJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_3->Draw("COLZ");
    backJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_3->Scale(1.0 / backJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_3->Integral());
    backJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_3->SetMinimum(1e-14);
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_3.pdf");

    sigJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_4->Draw("COLZ");
    sigJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_4->Scale(1.0 / sigJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_4->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_4.pdf");

    backJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_4->Draw("COLZ");
    backJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_4->Scale(1.0 / backJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_4->Integral());
    backJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_4->SetMinimum(1e-14);
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_4.pdf");
    std::cout << "test3.2" << "\n";    
    sigJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_5->Draw("COLZ");
    sigJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_5->Scale(1.0 / sigJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_5->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_5.pdf");

    backJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_5->Draw("COLZ");
    backJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_5->Scale(1.0 / backJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_5->Integral());
    backJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_5->SetMinimum(1e-14);
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvsPsi_R_VariableIOs_5.pdf");

    sig_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_1_vs_Tau_2->Draw("COLZ");
    sig_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_1_vs_Tau_2->Scale(1.0 / sig_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_1_vs_Tau_2->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sig_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_1_vs_Tau_2.pdf");

    back_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_1_vs_Tau_2->Draw("COLZ");
    back_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_1_vs_Tau_2->Scale(1.0 / back_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_1_vs_Tau_2->Integral());
    back_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_1_vs_Tau_2->SetMinimum(1e-14);
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "back_LeadingJetTaggerLRJ_jFEX_Subjet_Tau_1_vs_Tau_2.pdf");

    sig_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_1_vs_Tau_2->Draw("COLZ");
    sig_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_1_vs_Tau_2->Scale(1.0 / sig_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_1_vs_Tau_2->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sig_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_1_vs_Tau_2.pdf");

    back_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_1_vs_Tau_2->Draw("COLZ");
    back_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_1_vs_Tau_2->Scale(1.0 / back_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_1_vs_Tau_2->Integral());
    back_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_1_vs_Tau_2->SetMinimum(1e-14);
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "back_SubleadingJetTaggerLRJ_jFEX_Subjet_Tau_1_vs_Tau_2.pdf");
    std::cout << "test3.3" << "\n";    
    sig_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1_vs_Tau_2->Draw("COLZ");
    sig_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1_vs_Tau_2->Scale(1.0 / sig_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1_vs_Tau_2->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sig_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1_vs_Tau_2.pdf");
    std::cout << "test3.31" << "\n";   
    back_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1_vs_Tau_2->Draw("COLZ");
    back_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1_vs_Tau_2->Scale(1.0 / back_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1_vs_Tau_2->Integral());
    back_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1_vs_Tau_2->SetMinimum(1e-14);
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "back_LeadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1_vs_Tau_2.pdf");

    sig_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1_vs_Tau_2->Draw("COLZ");
    sig_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1_vs_Tau_2->Scale(1.0 / sig_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1_vs_Tau_2->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sig_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1_vs_Tau_2.pdf");
    std::cout << "test3.32" << "\n";   
    back_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1_vs_Tau_2->Draw("COLZ");
    back_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1_vs_Tau_2->Scale(1.0 / back_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1_vs_Tau_2->Integral());
    back_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1_vs_Tau_2->SetMinimum(1e-14);
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "back_SubleadingJetTaggerLRJ_ConeCellsTowers_Subjet_Tau_1_vs_Tau_2.pdf");
    std::cout << "test3.321" << "\n";   
    sig_JetTaggerLRJ_jFEX_Subjet_LeadingTau_12_vs_SubleadingTau12->Draw("COLZ");
    sig_JetTaggerLRJ_jFEX_Subjet_LeadingTau_12_vs_SubleadingTau12->Scale(1.0 / sig_JetTaggerLRJ_jFEX_Subjet_LeadingTau_12_vs_SubleadingTau12->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sig_JetTaggerLRJ_jFEX_Subjet_LeadingTau_12_vs_SubleadingTau12.pdf");
    std::cout << "test3.322" << "\n";   
    sig_JetTaggerLRJ_ConeCellsTowers_Subjet_LeadingTau_12_vs_SubleadingTau12->Draw("COLZ");
    sig_JetTaggerLRJ_ConeCellsTowers_Subjet_LeadingTau_12_vs_SubleadingTau12->Scale(1.0 / sig_JetTaggerLRJ_ConeCellsTowers_Subjet_LeadingTau_12_vs_SubleadingTau12->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sig_JetTaggerLRJ_ConeCellsTowers_Subjet_LeadingTau_12_vs_SubleadingTau12.pdf");
    std::cout << "test3.33" << "\n";   
    back_JetTaggerLRJ_jFEX_Subjet_LeadingTau_12_vs_SubleadingTau12->Draw("COLZ");
    back_JetTaggerLRJ_jFEX_Subjet_LeadingTau_12_vs_SubleadingTau12->Scale(1.0 / back_JetTaggerLRJ_jFEX_Subjet_LeadingTau_12_vs_SubleadingTau12->Integral());
    back_JetTaggerLRJ_jFEX_Subjet_LeadingTau_12_vs_SubleadingTau12->SetMinimum(1e-14);
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "back_JetTaggerLRJ_jFEX_Subjet_LeadingTau_12_vs_SubleadingTau12.pdf");
    std::cout << "test3.331" << "\n";   
    back_JetTaggerLRJ_jFEX_Subjet_LeadingTau_12_vs_SubleadingTau12->Draw("COLZ");
    back_JetTaggerLRJ_jFEX_Subjet_LeadingTau_12_vs_SubleadingTau12->Scale(1.0 / back_JetTaggerLRJ_jFEX_Subjet_LeadingTau_12_vs_SubleadingTau12->Integral());
    back_JetTaggerLRJ_jFEX_Subjet_LeadingTau_12_vs_SubleadingTau12->SetMinimum(1e-14);
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "back_JetTaggerLRJ_jFEX_Subjet_LeadingTau_12_vs_SubleadingTau12.pdf");
    std::cout << "test3.34" << "\n";   
    back_JetTaggerLRJ_jFEX_Subjet_LeadingTau_12_vs_LeadingJetTaggerEt->Draw("COLZ");
    back_JetTaggerLRJ_jFEX_Subjet_LeadingTau_12_vs_LeadingJetTaggerEt->Scale(1.0 / back_JetTaggerLRJ_jFEX_Subjet_LeadingTau_12_vs_LeadingJetTaggerEt->Integral());
    back_JetTaggerLRJ_jFEX_Subjet_LeadingTau_12_vs_LeadingJetTaggerEt->SetMinimum(1e-14);
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "back_JetTaggerLRJ_jFEX_Subjet_LeadingTau_12_vs_LeadingJetTaggerEt.pdf");
    std::cout << "test3.4" << "\n";    
    back_JetTaggerLRJ_ConeCellsTowers_Subjet_LeadingTau_12_vs_LeadingJetTaggerEt->Draw("COLZ");
    back_JetTaggerLRJ_ConeCellsTowers_Subjet_LeadingTau_12_vs_LeadingJetTaggerEt->Scale(1.0 / back_JetTaggerLRJ_ConeCellsTowers_Subjet_LeadingTau_12_vs_LeadingJetTaggerEt->Integral());
    back_JetTaggerLRJ_ConeCellsTowers_Subjet_LeadingTau_12_vs_LeadingJetTaggerEt->SetMinimum(1e-14);
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "back_JetTaggerLRJ_ConeCellsTowers_Subjet_LeadingTau_12_vs_LeadingJetTaggerEt.pdf");
    std::cout << "test3.41" << "\n";    
    back_h_JetTaggerLRJ_ConeCellsTowers_Subjet_Tau_21_Product_vsLeadingLRJEt->Draw("COLZ");
    //back_h_JetTaggerLRJ_ConeCellsTowers_Subjet_Tau_21_Product_vsLeadingLRJEt->Scale(1.0 / back_h_JetTaggerLRJ_ConeCellsTowers_Subjet_Tau_21_Product_vsLeadingLRJEt->Integral());
    //back_h_JetTaggerLRJ_ConeCellsTowers_Subjet_Tau_21_Product_vsLeadingLRJEt->SetMinimum(1e-14);
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "back_h_JetTaggerLRJ_ConeCellsTowers_Subjet_Tau_21_Product_vsLeadingLRJEt.pdf");
    std::cout << "test3.42" << "\n";
    back_h_JetTaggerLRJ_jFEX_Subjet_Tau_21_Product_vsLeadingLRJEt->Draw("COLZ");
    //back_h_JetTaggerLRJ_jFEX_Subjet_Tau_21_Product_vsLeadingLRJEt->Scale(1.0 / back_h_JetTaggerLRJ_jFEX_Subjet_Tau_21_Product_vsLeadingLRJEt->Integral());
    //back_h_JetTaggerLRJ_jFEX_Subjet_Tau_21_Product_vsLeadingLRJEt->SetMinimum(1e-14);
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "back_h_JetTaggerLRJ_jFEX_Subjet_Tau_21_Product_vsLeadingLRJEt.pdf");
    std::cout << "test3.43" << "\n";
    sig_JetTaggerLRJ_jFEX_Subjet_LeadingTau_12_vs_LeadingJetTaggerEt->Draw("COLZ");
    sig_JetTaggerLRJ_jFEX_Subjet_LeadingTau_12_vs_LeadingJetTaggerEt->Scale(1.0 / sig_JetTaggerLRJ_jFEX_Subjet_LeadingTau_12_vs_LeadingJetTaggerEt->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sig_JetTaggerLRJ_jFEX_Subjet_LeadingTau_12_vs_LeadingJetTaggerEt.pdf");

    sig_h_JetTaggerLRJ_ConeCellsTowers_Subjet_Tau_21_Product_vsLeadingLRJEt->Draw("COLZ");
    sig_h_JetTaggerLRJ_ConeCellsTowers_Subjet_Tau_21_Product_vsLeadingLRJEt->Scale(1.0 / sig_h_JetTaggerLRJ_ConeCellsTowers_Subjet_Tau_21_Product_vsLeadingLRJEt->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sig_h_JetTaggerLRJ_ConeCellsTowers_Subjet_Tau_21_Product_vsLeadingLRJEt.pdf");

    sig_h_JetTaggerLRJ_jFEX_Subjet_Tau_21_Product_vsLeadingLRJEt->Draw("COLZ");
    sig_h_JetTaggerLRJ_jFEX_Subjet_Tau_21_Product_vsLeadingLRJEt->Scale(1.0 / sig_h_JetTaggerLRJ_jFEX_Subjet_Tau_21_Product_vsLeadingLRJEt->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sig_h_JetTaggerLRJ_jFEX_Subjet_Tau_21_Product_vsLeadingLRJEt.pdf");

    std::cout << "test3.44" << "\n";    
    /*sigJetTaggerLeadingLRJEtvsPsi_R_squaredvsTau21jFEXProduct->Draw("COLZ");
    sigJetTaggerLeadingLRJEtvsPsi_R_squaredvsTau21jFEXProduct->Scale(1.0 / sigJetTaggerLeadingLRJEtvsPsi_R_squaredvsTau21jFEXProduct->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvsPsi_R_squaredvsTau21jFEXProduct.pdf");
    std::cout << "test3.441" << "\n";    
    sigJetTaggerLeadingLRJvsPsi_R_squaredvsTau21jFEXProduct->Draw("COLZ");
    sigJetTaggerLeadingLRJvsPsi_R_squaredvsTau21jFEXProduct->Scale(1.0 / sigJetTaggerLeadingLRJvsPsi_R_squaredvsTau21jFEXProduct->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJvsPsi_R_squaredvsTau21jFEXProduct.pdf");
    std::cout << "test3.442" << "\n";    
    backJetTaggerLeadingLRJEtvsPsi_R_squaredvsTau21jFEXProduct->Draw("COLZ");
    backJetTaggerLeadingLRJEtvsPsi_R_squaredvsTau21jFEXProduct->Scale(1.0 / backJetTaggerLeadingLRJEtvsPsi_R_squaredvsTau21jFEXProduct->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvsPsi_R_squaredvsTau21jFEXProduct.pdf");
    std::cout << "test3.4421" << "\n";    
    backJetTaggerLeadingLRJvsPsi_R_squaredvsTau21jFEXProduct->Draw("COLZ");
    backJetTaggerLeadingLRJvsPsi_R_squaredvsTau21jFEXProduct->Scale(1.0 / backJetTaggerLeadingLRJvsPsi_R_squaredvsTau21jFEXProduct->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJvsPsi_R_squaredvsTau21jFEXProduct.pdf");
    std::cout << "test3.443" << "\n";    
    sigJetTaggerLeadingLRJEtvsPsi_R_squaredvsTau21ConeProduct->Draw("COLZ");
    sigJetTaggerLeadingLRJEtvsPsi_R_squaredvsTau21ConeProduct->Scale(1.0 / sigJetTaggerLeadingLRJEtvsPsi_R_squaredvsTau21ConeProduct->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvsPsi_R_squaredvsTau21ConeProduct.pdf");
    std::cout << "test3.444" << "\n";   
    sigJetTaggerLeadingLRJvsPsi_R_squaredvsTau21ConeProduct->Draw("COLZ");
    sigJetTaggerLeadingLRJvsPsi_R_squaredvsTau21ConeProduct->Scale(1.0 / sigJetTaggerLeadingLRJvsPsi_R_squaredvsTau21ConeProduct->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJvsPsi_R_squaredvsTau21ConeProduct.pdf");
    std::cout << "test3.445" << "\n";   
    backJetTaggerLeadingLRJEtvsPsi_R_squaredvsTau21ConeProduct->Draw("COLZ");
    backJetTaggerLeadingLRJEtvsPsi_R_squaredvsTau21ConeProduct->Scale(1.0 / backJetTaggerLeadingLRJEtvsPsi_R_squaredvsTau21ConeProduct->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvsPsi_R_squaredvsTau21ConeProduct.pdf");

    sigJetTaggerLeadingLRJEtvsPsi_R_squared_NoConeSubjets->Draw("COLZ");
    //sigJetTaggerLeadingLRJEtvsPsi_R_squared_NoConeSubjets->Scale(1.0 / sigJetTaggerLeadingLRJEtvsPsi_R_squared_NoConeSubjets->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvsPsi_R_squared_NoConeSubjets.pdf");*/

    sigJetTaggerSubleadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet_Sublead->Draw("COLZ");
    //sigJetTaggerSubleadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet_Sublead->Scale(1.0 / sigJetTaggerSubleadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet_Sublead->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerSubleadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet_Sublead.pdf");

    backJetTaggerSubleadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet_Sublead->Draw("COLZ");
    //backJetTaggerSubleadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet_Sublead->Scale(1.0 / backJetTaggerSubleadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet_Sublead->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerSubleadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet_Sublead.pdf");

    sigJetTaggerLeadingLRJEtvsTau21_WithGrEq2ConeSubjet_Lead->Draw("COLZ");
    //sigJetTaggerLeadingLRJEtvsTau21_WithGrEq2ConeSubjet_Lead->Scale(1.0 / sigJetTaggerLeadingLRJEtvsTau21_WithGrEq2ConeSubjet_Lead->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvsTau21_WithGrEq2ConeSubjet_Lead.pdf");

    backJetTaggerLeadingLRJEtvsTau21_WithGrEq2ConeSubjet_Lead->Draw("COLZ");
    //backJetTaggerLeadingLRJEtvsTau21_WithGrEq2ConeSubjet_Lead->Scale(1.0 / backJetTaggerLeadingLRJEtvsTau21_WithGrEq2ConeSubjet_Lead->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvsTau21_WithGrEq2ConeSubjet_Lead.pdf");

    sigJetTaggerSubleadingLRJEtvsTau21_WithGrEq2ConeSubjet_Sublead->Draw("COLZ");
    //sigJetTaggerSubleadingLRJEtvsTau21_WithGrEq2ConeSubjet_Sublead->Scale(1.0 / sigJetTaggerSubleadingLRJEtvsTau21_WithGrEq2ConeSubjet_Sublead->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerSubleadingLRJEtvsTau21_WithGrEq2ConeSubjet_Sublead.pdf");
    
    sigJetTaggerSubleadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Sublead->GetXaxis()->SetRangeUser(0.0, 700.0);
    sigJetTaggerSubleadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Sublead->GetYaxis()->SetRangeUser(0.0, 400.0);
    sigJetTaggerSubleadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Sublead->Draw("COLZ");
    //sigJetTaggerSubleadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Sublead->Scale(1.0 / sigJetTaggerSubleadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Sublead->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerSubleadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Sublead.pdf");
    std::cout << "test3.5" << "\n";    
    backJetTaggerSubleadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Sublead->GetXaxis()->SetRangeUser(0.0, 700.0);
    backJetTaggerSubleadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Sublead->GetYaxis()->SetRangeUser(0.0, 400.0);
    backJetTaggerSubleadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Sublead->Draw("COLZ");
    //backJetTaggerSubleadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Sublead->Scale(1.0 / backJetTaggerSubleadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Sublead->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerSubleadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Sublead.pdf");
    

    sigJetTaggerLeadingLRJMassApproxvsSubjetEtRatio_WithGrEq2ConeSubjet_Lead->Draw("COLZ");
    //sigJetTaggerLeadingLRJMassApproxvsSubjetEtRatio_WithGrEq2ConeSubjet_Lead->Scale(1.0 / sigJetTaggerLeadingLRJMassApproxvsSubjetEtRatio_WithGrEq2ConeSubjet_Lead->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJMassApproxvsSubjetEtRatio_WithGrEq2ConeSubjet_Lead.pdf");

    backJetTaggerLeadingLRJMassApproxvsSubjetEtRatio_WithGrEq2ConeSubjet_Lead->Draw("COLZ");
    //backJetTaggerLeadingLRJMassApproxvsSubjetEtRatio_WithGrEq2ConeSubjet_Lead->Scale(1.0 / backJetTaggerLeadingLRJMassApproxvsSubjetEtRatio_WithGrEq2ConeSubjet_Lead->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJMassApproxvsSubjetEtRatio_WithGrEq2ConeSubjet_Lead.pdf");
    std::cout << "test3.51" << "\n";   
    sigJetTaggerLeadingLRJEtvsSubjetEtRatio_WithGrEq2ConeSubjet_Lead->Draw("COLZ");
    //sigJetTaggerLeadingLRJEtvsSubjetEtRatio_WithGrEq2ConeSubjet_Lead->Scale(1.0 / sigJetTaggerLeadingLRJEtvsSubjetEtRatio_WithGrEq2ConeSubjet_Lead->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvsSubjetEtRatio_WithGrEq2ConeSubjet_Lead.pdf");

    backJetTaggerLeadingLRJEtvsSubjetEtRatio_WithGrEq2ConeSubjet_Lead->Draw("COLZ");
    //backJetTaggerLeadingLRJEtvsSubjetEtRatio_WithGrEq2ConeSubjet_Lead->Scale(1.0 / backJetTaggerLeadingLRJEtvsSubjetEtRatio_WithGrEq2ConeSubjet_Lead->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvsSubjetEtRatio_WithGrEq2ConeSubjet_Lead.pdf");
    
    sigJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Lead->GetXaxis()->SetRangeUser(0.0, 700.0);
    sigJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Lead->GetYaxis()->SetRangeUser(0.0, 400.0);
    sigJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Lead->Draw("COLZ");
    //sigJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Lead->Scale(1.0 / sigJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Lead->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Lead.pdf");
    
    backJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Lead->GetXaxis()->SetRangeUser(0.0, 700.0);
    backJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Lead->GetYaxis()->SetRangeUser(0.0, 400.0);
    backJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Lead->Draw("COLZ");
    //backJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Lead->Scale(1.0 / backJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Lead->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet_Lead.pdf");

    sigJetTaggerLeadingLRJEtvsd12_WithGrEq2ConeSubjet_Lead->GetXaxis()->SetRangeUser(0.0, 700.0);
    sigJetTaggerLeadingLRJEtvsd12_WithGrEq2ConeSubjet_Lead->GetYaxis()->SetRangeUser(0.0, 400.0);
    sigJetTaggerLeadingLRJEtvsd12_WithGrEq2ConeSubjet_Lead->Draw("COLZ");
    //sigJetTaggerLeadingLRJEtvsd12_WithGrEq2ConeSubjet_Lead->Scale(1.0 / sigJetTaggerLeadingLRJEtvsd12_WithGrEq2ConeSubjet_Lead->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvsd12_WithGrEq2ConeSubjet_Lead.pdf");

    backJetTaggerLeadingLRJEtvsd12_WithGrEq2ConeSubjet_Lead->GetXaxis()->SetRangeUser(0.0, 700.0);
    backJetTaggerLeadingLRJEtvsd12_WithGrEq2ConeSubjet_Lead->GetYaxis()->SetRangeUser(0.0, 400.0);
    backJetTaggerLeadingLRJEtvsd12_WithGrEq2ConeSubjet_Lead->Draw("COLZ");
    //backJetTaggerLeadingLRJEtvsd12_WithGrEq2ConeSubjet_Lead->Scale(1.0 / backJetTaggerLeadingLRJEtvsd12_WithGrEq2ConeSubjet_Lead->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvsd12_WithGrEq2ConeSubjet_Lead.pdf");

    sigJetTaggerSubleadingLRJEtvsd12_WithGrEq2ConeSubjet_Sublead->GetXaxis()->SetRangeUser(0.0, 700.0);
    sigJetTaggerSubleadingLRJEtvsd12_WithGrEq2ConeSubjet_Sublead->GetYaxis()->SetRangeUser(0.0, 400.0);
    sigJetTaggerSubleadingLRJEtvsd12_WithGrEq2ConeSubjet_Sublead->Draw("COLZ");
    //sigJetTaggerSubleadingLRJEtvsd12_WithGrEq2ConeSubjet_Sublead->Scale(1.0 / sigJetTaggerSubleadingLRJEtvsd12_WithGrEq2ConeSubjet_Sublead->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerSubleadingLRJEtvsd12_WithGrEq2ConeSubjet_Sublead.pdf");

    backJetTaggerSubleadingLRJEtvsd12_WithGrEq2ConeSubjet_Sublead->GetXaxis()->SetRangeUser(0.0, 700.0);
    backJetTaggerSubleadingLRJEtvsd12_WithGrEq2ConeSubjet_Sublead->GetYaxis()->SetRangeUser(0.0, 400.0);
    backJetTaggerSubleadingLRJEtvsd12_WithGrEq2ConeSubjet_Sublead->Draw("COLZ");
    //backJetTaggerSubleadingLRJEtvsd12_WithGrEq2ConeSubjet_Sublead->Scale(1.0 / backJetTaggerSubleadingLRJEtvsd12_WithGrEq2ConeSubjet_Sublead->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerSubleadingLRJEtvsd12_WithGrEq2ConeSubjet_Sublead.pdf");

    sigJetTaggerLeadingSubjetEtvsSubleadingSubjetEt_Lead->Draw("COLZ");
    //sigJetTaggerLeadingSubjetEtvsSubleadingSubjetEt_Lead->Scale(1.0 / sigJetTaggerLeadingSubjetEtvsSubleadingSubjetEt_Lead->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingSubjetEtvsSubleadingSubjetEt_Lead.pdf");

    backJetTaggerLeadingSubjetEtvsSubleadingSubjetEt_Lead->Draw("COLZ");
    //backJetTaggerLeadingSubjetEtvsSubleadingSubjetEt_Lead->Scale(1.0 / backJetTaggerLeadingSubjetEtvsSubleadingSubjetEt_Lead->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingSubjetEtvsSubleadingSubjetEt_Lead.pdf");

    sigJetTaggerLeadingSubjetEtvsSubleadingSubjetEt_Sublead->Draw("COLZ");
    //sigJetTaggerLeadingSubjetEtvsSubleadingSubjetEt_Sublead->Scale(1.0 / sigJetTaggerLeadingSubjetEtvsSubleadingSubjetEt_Sublead->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingSubjetEtvsSubleadingSubjetEt_Sublead.pdf");

    backJetTaggerLeadingSubjetEtvsSubleadingSubjetEt_Sublead->Draw("COLZ");
    //backJetTaggerLeadingSubjetEtvsSubleadingSubjetEt_Sublead->Scale(1.0 / backJetTaggerLeadingSubjetEtvsSubleadingSubjetEt_Sublead->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingSubjetEtvsSubleadingSubjetEt_Sublead.pdf");
    /*
    sigJetTaggerSubleadingMassApproxvsTau21_WithGrEq2ConeSubjet_Sublead->Draw("COLZ");
    //sigJetTaggerSubleadingMassApproxvsTau21_WithGrEq2ConeSubjet_Sublead->Scale(1.0 / sigJetTaggerSubleadingMassApproxvsTau21_WithGrEq2ConeSubjet_Sublead->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerSubleadingMassApproxvsTau21_WithGrEq2ConeSubjet_Sublead.pdf");
    std::cout << "test3.52" << "\n";   
    backJetTaggerSubleadingMassApproxvsTau21_WithGrEq2ConeSubjet_Sublead->Draw("COLZ");
    //backJetTaggerSubleadingMassApproxvsTau21_WithGrEq2ConeSubjet_Sublead->Scale(1.0 / backJetTaggerSubleadingMassApproxvsTau21_WithGrEq2ConeSubjet_Sublead->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerSubleadingMassApproxvsTau21_WithGrEq2ConeSubjet_Sublead.pdf");
    
    sigJetTaggerLeadingMassApproxvsTau21_WithGrEq2ConeSubjet_Lead->GetXaxis()->SetRangeUser(0.0, 400.0);
    sigJetTaggerLeadingMassApproxvsTau21_WithGrEq2ConeSubjet_Lead->Draw("COLZ");
    sigJetTaggerLeadingMassApproxvsTau21_WithGrEq2ConeSubjet_Lead->Scale(1.0 / sigJetTaggerLeadingMassApproxvsTau21_WithGrEq2ConeSubjet_Lead->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingMassApproxvsTau21_WithGrEq2ConeSubjet_Lead.pdf");
    
    backJetTaggerLeadingMassApproxvsTau21_WithGrEq2ConeSubjet_Lead->GetXaxis()->SetRangeUser(0.0, 400.0);
    backJetTaggerLeadingMassApproxvsTau21_WithGrEq2ConeSubjet_Lead->Draw("COLZ");
    backJetTaggerLeadingMassApproxvsTau21_WithGrEq2ConeSubjet_Lead->Scale(1.0 / backJetTaggerLeadingMassApproxvsTau21_WithGrEq2ConeSubjet_Lead->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingMassApproxvsTau21_WithGrEq2ConeSubjet_Lead.pdf");
    
    sigJetTaggerLeadingMassApproxvsTau21Product_WithGrEq2ConeSubjet_Lead_Sublead->Draw("COLZ");
    //sigJetTaggerLeadingMassApproxvsTau21Product_WithGrEq2ConeSubjet_Lead_Sublead->Scale(1.0 / sigJetTaggerLeadingMassApproxvsTau21Product_WithGrEq2ConeSubjet_Lead_Sublead->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingMassApproxvsTau21Product_WithGrEq2ConeSubjet_Lead_Sublead.pdf");

    backJetTaggerLeadingMassApproxvsTau21Product_WithGrEq2ConeSubjet_Lead_Sublead->Draw("COLZ");
    //backJetTaggerLeadingMassApproxvsTau21Product_WithGrEq2ConeSubjet_Lead_Sublead->Scale(1.0 / backJetTaggerLeadingMassApproxvsTau21Product_WithGrEq2ConeSubjet_Lead_Sublead->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingMassApproxvsTau21Product_WithGrEq2ConeSubjet_Lead_Sublead.pdf");

    sigJetTaggerLeadingLRJEtvsTau21_WithGrEq2ConeSubjet_Lead_Sublead->Draw("COLZ");
    //sigJetTaggerLeadingLRJEtvsTau21_WithGrEq2ConeSubjet_Lead_Sublead->Scale(1.0 / sigJetTaggerLeadingLRJEtvsTau21_WithGrEq2ConeSubjet_Lead_Sublead->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvsTau21_WithGrEq2ConeSubjet_Lead_Sublead.pdf");

    backJetTaggerLeadingLRJEtvsTau21_WithGrEq2ConeSubjet_Lead_Sublead->Draw("COLZ");
    //backJetTaggerLeadingLRJEtvsTau21_WithGrEq2ConeSubjet_Lead_Sublead->Scale(1.0 / backJetTaggerLeadingLRJEtvsTau21_WithGrEq2ConeSubjet_Lead_Sublead->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvsTau21_WithGrEq2ConeSubjet_Lead_Sublead.pdf");

    
    
    std::cout << "test3.6" << "\n";    
    backJetTaggerSubleadingLRJEtvsTau21_WithGrEq2ConeSubjet_Sublead->Draw("COLZ");
    //backJetTaggerSubleadingLRJEtvsTau21_WithGrEq2ConeSubjet_Sublead->Scale(1.0 / backJetTaggerSubleadingLRJEtvsTau21_WithGrEq2ConeSubjet_Sublead->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerSubleadingLRJEtvsTau21_WithGrEq2ConeSubjet_Sublead.pdf");
    */
    sigJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet_Sublead->Draw("COLZ");
    //sigJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet_Sublead->Scale(1.0 / sigJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet_Sublead->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet_Sublead.pdf");

    backJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet_Sublead->Draw("COLZ");
    //backJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet_Sublead->Scale(1.0 / backJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet_Sublead->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet_Sublead.pdf");

    backJetTaggerLeadingLRJEtvsPsi_R_squared_NoConeSubjets->Draw("COLZ");
    //backJetTaggerLeadingLRJEtvsPsi_R_squared_NoConeSubjets->Scale(1.0 / backJetTaggerLeadingLRJEtvsPsi_R_squared_NoConeSubjets->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvsPsi_R_squared_NoConeSubjets.pdf");

    // Also draw the actual fraction of events within each bin

    backJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult->Draw("COLZ");
    //backJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult->Scale(1.0 / backJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult->Integral());
    DrawBinValues(backJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult, true);
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult.pdf");
    cLogZ_NSubjetiness.Clear(); // clears primitives on the canvas

    backJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult_3->Draw("COLZ");
    //backJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult_3->Scale(1.0 / backJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult_3->Integral());
    DrawBinValues(backJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult_3, true);
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult_3.pdf");
    cLogZ_NSubjetiness.Clear(); // clears primitives on the canvas
    std::cout << "test4" << "\n";

    // Also draw the actual fraction of events within each bin
    sigJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult->Draw("COLZ");
    sigJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult->Scale(1.0 / sigJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult->Integral());
    DrawBinValues(sigJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult, false);
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult.pdf");
    cLogZ_NSubjetiness.Clear(); // clears primitives on the canvas

    sigJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult_3->Draw("COLZ");
    sigJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult_3->Scale(1.0 / sigJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult_3->Integral());
    DrawBinValues(sigJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult_3, false);
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult_3.pdf");
    cLogZ_NSubjetiness.Clear(); // clears primitives on the canvas

    // FIXME this likelihood ratio doesn't seem to be computed correctly, unsure why - don't use for now! 
    /*{ // use separate scope to avoid conflicts with other areas of code - FIXME this should be turned into a function to avoid this issue. 
        // ===========================================================
        // Compute Likelihood Ratio (Signal / Background) for subjet distributions
        // ===========================================================
        std::cout << "making likelihood ratio plots for subjet mult plots " << "\n";
        // Small protection value for empty bins
        const double epsilon = 1e-12;

        // --- large-R jets subjet multiplicity, up to >= 2 subjets ---
        backJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult->Scale(1.0 / backJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult->Integral());
        TH2F* LR_Leading = (TH2F*)sigJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult->Clone("LR_Leading");
        LR_Leading->SetTitle("Likelihood Ratio (Signal/Background) - Leading");
        for (int i = 1; i <= LR_Leading->GetNbinsX(); ++i) {
            for (int j = 1; j <= LR_Leading->GetNbinsY(); ++j) {
                double s = sigJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult->GetBinContent(i,j);
                double b = backJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult->GetBinContent(i,j);
                double ratio = (b > 0) ? s / (b + epsilon) : 0.0;
                LR_Leading->SetBinContent(i, j, ratio);
            }
        }

        // Optionally take log10 of LR for dynamic range clarity
        TH2F* logLR_Leading = (TH2F*)LR_Leading->Clone("logLR_Leading");
        logLR_Leading->SetTitle("log10(Likelihood Ratio) - Leading");
        for (int i = 1; i <= logLR_Leading->GetNbinsX(); ++i) {
            for (int j = 1; j <= logLR_Leading->GetNbinsY(); ++j) {
                double val = LR_Leading->GetBinContent(i,j);
                logLR_Leading->SetBinContent(i,j, (val > 0) ? std::log10(val) : -10); // clip low bins
            }
        }

        // ===========================================================
        // Draw and save
        // ===========================================================
        TCanvas cLR("cLR", "Likelihood Ratios", 800, 700);
        cLR.SetLogz(); // log scale color map for clarity

        logLR_Leading->Draw("COLZ");
        logLR_Leading->GetXaxis()->SetTitle("Cone Subjet Multiplcity [Lead. JetTagger LRJ]");
        logLR_Leading->GetYaxis()->SetTitle("Cone Subjet Multiplcity [Subl. JetTagger LRJ]");
        cLR.SaveAs(modifiedOutputFileDir + "JetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult_Likelihood.pdf");
    }

    { // use separate scope to avoid conflicts with other areas of code - FIXME this should be turned into a function to avoid this issue. 
        // ===========================================================
        // Compute Likelihood Ratio (Signal / Background) for subjet distributions
        // ===========================================================
        std::cout << "making likelihood ratio plots for subjet mult plots >= 3 subjets" << "\n";
        // Small protection value for empty bins
        const double epsilon = 1e-12;

        // --- large-R jets subjet multiplicity, up to >= 3 subjets ---
        backJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult_3->Scale(1.0 / backJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult_3->Integral());
        TH2F* LR_Leading = (TH2F*)sigJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult_3->Clone("LR_Leading");
        LR_Leading->SetTitle("Likelihood Ratio (Signal/Background) - Leading");
        for (int i = 1; i <= LR_Leading->GetNbinsX(); ++i) {
            for (int j = 1; j <= LR_Leading->GetNbinsY(); ++j) {
                double s = sigJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult_3->GetBinContent(i,j);
                double b = backJetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult_3->GetBinContent(i,j);
                double ratio = (b > 0) ? s / (b + epsilon) : 0.0;
                LR_Leading->SetBinContent(i, j, ratio);
            }
        }

        // Optionally take log10 of LR for dynamic range clarity
        TH2F* logLR_Leading = (TH2F*)LR_Leading->Clone("logLR_Leading");
        logLR_Leading->SetTitle("log10(Likelihood Ratio) - Leading");
        for (int i = 1; i <= logLR_Leading->GetNbinsX(); ++i) {
            for (int j = 1; j <= logLR_Leading->GetNbinsY(); ++j) {
                double val = LR_Leading->GetBinContent(i,j);
                logLR_Leading->SetBinContent(i,j, (val > 0) ? std::log10(val) : -10); // clip low bins
            }
        }

        // ===========================================================
        // Draw and save
        // ===========================================================
        TCanvas cLR("cLR", "Likelihood Ratios", 800, 700);
        cLR.SetLogz(); // log scale color map for clarity

        logLR_Leading->Draw("COLZ");
        logLR_Leading->GetXaxis()->SetTitle("Cone Subjet Multiplcity [Lead. JetTagger LRJ]");
        logLR_Leading->GetYaxis()->SetTitle("Cone Subjet Multiplcity [Subl. JetTagger LRJ]");
        cLR.SaveAs(modifiedOutputFileDir + "JetTaggerLeadingLRJConeSubjetMultvsSubleadingLRJConeSubjetMult_Likelihood_3.pdf");
    }*/
    

    sigJetTaggerLeadingLRJEtvsZ->Draw("COLZ");
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvsZ.pdf");

    backJetTaggerLeadingLRJEtvsZ->Draw("COLZ");
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvsZ.pdf");

    sigJetTaggerSubleadingLRJEtvsZ->Draw("COLZ");
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerSubleadingLRJEtvsZ.pdf");

    backJetTaggerSubleadingLRJEtvsZ->Draw("COLZ");
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerSubleadingLRJEtvsZ.pdf");

    sigJetTaggerLeadingLRJEtvs1MinusZ->Draw("COLZ");
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvs1MinusZ.pdf");

    backJetTaggerLeadingLRJEtvs1MinusZ->Draw("COLZ");
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvs1MinusZ.pdf");

    sigJetTaggerLeadingLRJEtvsEtOutsideSubjets->Draw("COLZ");
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvsEtOutsideSubjets.pdf");

    backJetTaggerLeadingLRJEtvsEtOutsideSubjets->Draw("COLZ");
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvsEtOutsideSubjets.pdf");
    

    sigJetTaggerLeadingLRJEtvsPsi_R_squared_NojFEXSubjets->Draw("COLZ");
    //sigJetTaggerLeadingLRJEtvsPsi_R_squared_NojFEXSubjets->Scale(1.0 / sigJetTaggerLeadingLRJEtvsPsi_R_squared_NojFEXSubjets->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvsPsi_R_squared_NojFEXSubjets.pdf");

    backJetTaggerLeadingLRJEtvsPsi_R_squared_NojFEXSubjets->Draw("COLZ");
    //backJetTaggerLeadingLRJEtvsPsi_R_squared_NojFEXSubjets->Scale(1.0 / backJetTaggerLeadingLRJEtvsPsi_R_squared_NojFEXSubjets->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvsPsi_R_squared_NojFEXSubjets.pdf");
    std::cout << "test5" << "\n";
    sigJetTaggerLeadingLRJEtvsPsi_R_squared_With1ConeSubjet->Draw("COLZ");
    //sigJetTaggerLeadingLRJEtvsPsi_R_squared_With1ConeSubjet->Scale(1.0 / sigJetTaggerLeadingLRJEtvsPsi_R_squared_With1ConeSubjet->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvsPsi_R_squared_With1ConeSubjet.pdf");

    backJetTaggerLeadingLRJEtvsPsi_R_squared_With1ConeSubjet->Draw("COLZ");
    //backJetTaggerLeadingLRJEtvsPsi_R_squared_With1ConeSubjet->Scale(1.0 / backJetTaggerLeadingLRJEtvsPsi_R_squared_With1ConeSubjet->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvsPsi_R_squared_With1ConeSubjet.pdf");

    sigJetTaggerLeadingLRJEtvsPsi_R_squared_With1jFEXSubjet->Draw("COLZ");
    //sigJetTaggerLeadingLRJEtvsPsi_R_squared_With1jFEXSubjet->Scale(1.0 / sigJetTaggerLeadingLRJEtvsPsi_R_squared_With1jFEXSubjet->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvsPsi_R_squared_With1jFEXSubjet.pdf");

    backJetTaggerLeadingLRJEtvsPsi_R_squared_With1jFEXSubjet->Draw("COLZ");
    //backJetTaggerLeadingLRJEtvsPsi_R_squared_With1jFEXSubjet->Scale(1.0 / backJetTaggerLeadingLRJEtvsPsi_R_squared_With1jFEXSubjet->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvsPsi_R_squared_With1jFEXSubjet.pdf");

    sigJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet->Draw("COLZ");
    //sigJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet->Scale(1.0 / sigJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet.pdf");

    backJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet->Draw("COLZ");
    //backJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet->Scale(1.0 / backJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2ConeSubjet.pdf");

    sigJetTaggerLeadingLRJEtvspsi_R_SubleadingSubjet_WithGrEq2ConeSubjet->Draw("COLZ");
    //sigJetTaggerLeadingLRJEtvspsi_R_SubleadingSubjet_WithGrEq2ConeSubjet->Scale(1.0 / sigJetTaggerLeadingLRJEtvspsi_R_SubleadingSubjet_WithGrEq2ConeSubjet->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvspsi_R_SubleadingSubjet_WithGrEq2ConeSubjet.pdf");

    backJetTaggerLeadingLRJEtvspsi_R_SubleadingSubjet_WithGrEq2ConeSubjet->Draw("COLZ");
    //backJetTaggerLeadingLRJEtvspsi_R_SubleadingSubjet_WithGrEq2ConeSubjet->Scale(1.0 / backJetTaggerLeadingLRJEtvspsi_R_SubleadingSubjet_WithGrEq2ConeSubjet->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvspsi_R_SubleadingSubjet_WithGrEq2ConeSubjet.pdf");
    
    sigJetTaggerLeadingLRJDeltaRSubjetsvsSubjetEtRatio_WithGrEq2ConeSubjet->Draw("COLZ");
    //sigJetTaggerLeadingLRJDeltaRSubjetsvsSubjetEtRatio_WithGrEq2ConeSubjet->Scale(1.0 / sigJetTaggerLeadingLRJDeltaRSubjetsvsSubjetEtRatio_WithGrEq2ConeSubjet->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJDeltaRSubjetsvsSubjetEtRatio_WithGrEq2ConeSubjet.pdf");

    backJetTaggerLeadingLRJDeltaRSubjetsvsSubjetEtRatio_WithGrEq2ConeSubjet->Draw("COLZ");
    //backJetTaggerLeadingLRJDeltaRSubjetsvsSubjetEtRatio_WithGrEq2ConeSubjet->Scale(1.0 / backJetTaggerLeadingLRJDeltaRSubjetsvsSubjetEtRatio_WithGrEq2ConeSubjet->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJDeltaRSubjetsvsSubjetEtRatio_WithGrEq2ConeSubjet.pdf");

    sigJetTaggerLeadingLRJEtvsSubjetEtRatioTimesDeltaRSubjets_WithGrEq2ConeSubjet->Draw("COLZ");
    //sigJetTaggerLeadingLRJEtvsSubjetEtRatioTimesDeltaRSubjets_WithGrEq2ConeSubjet->Scale(1.0 / sigJetTaggerLeadingLRJEtvsSubjetEtRatioTimesDeltaRSubjets_WithGrEq2ConeSubjet->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvsSubjetEtRatioTimesDeltaRSubjets_WithGrEq2ConeSubjet.pdf");

    backJetTaggerLeadingLRJEtvsSubjetEtRatioTimesDeltaRSubjets_WithGrEq2ConeSubjet->Draw("COLZ");
    //backJetTaggerLeadingLRJEtvsSubjetEtRatioTimesDeltaRSubjets_WithGrEq2ConeSubjet->Scale(1.0 / backJetTaggerLeadingLRJEtvsSubjetEtRatioTimesDeltaRSubjets_WithGrEq2ConeSubjet->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvsSubjetEtRatioTimesDeltaRSubjets_WithGrEq2ConeSubjet.pdf");

    
    

    sigJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2jFEXSubjet->Draw("COLZ");
    //sigJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2jFEXSubjet->Scale(1.0 / sigJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2jFEXSubjet->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2jFEXSubjet.pdf");

    backJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2jFEXSubjet->Draw("COLZ");
    //backJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2jFEXSubjet->Scale(1.0 / backJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2jFEXSubjet->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2jFEXSubjet.pdf");

    sigJetTaggerLeadingLRJEtvsPsi_R_NoConeSubjets->Draw("COLZ");
    //sigJetTaggerLeadingLRJEtvsPsi_R_NoConeSubjets->Scale(1.0 / sigJetTaggerLeadingLRJEtvsPsi_R_NoConeSubjets->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvsPsi_R_NoConeSubjets.pdf");

    backJetTaggerLeadingLRJEtvsPsi_R_NoConeSubjets->Draw("COLZ");
    //backJetTaggerLeadingLRJEtvsPsi_R_NoConeSubjets->Scale(1.0 / backJetTaggerLeadingLRJEtvsPsi_R_NoConeSubjets->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvsPsi_R_NoConeSubjets.pdf");

    sigJetTaggerLeadingLRJEtvsPsi_R_NojFEXSubjets->Draw("COLZ");
    //sigJetTaggerLeadingLRJEtvsPsi_R_NojFEXSubjets->Scale(1.0 / sigJetTaggerLeadingLRJEtvsPsi_R_NojFEXSubjets->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvsPsi_R_NojFEXSubjets.pdf");

    backJetTaggerLeadingLRJEtvsPsi_R_NojFEXSubjets->Draw("COLZ");
    //backJetTaggerLeadingLRJEtvsPsi_R_NojFEXSubjets->Scale(1.0 / backJetTaggerLeadingLRJEtvsPsi_R_NojFEXSubjets->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvsPsi_R_NojFEXSubjets.pdf");

    sigJetTaggerLeadingLRJEtvsPsi_R_With1ConeSubjet->Draw("COLZ");
    //sigJetTaggerLeadingLRJEtvsPsi_R_With1ConeSubjet->Scale(1.0 / sigJetTaggerLeadingLRJEtvsPsi_R_With1ConeSubjet->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvsPsi_R_With1ConeSubjet.pdf");

    backJetTaggerLeadingLRJEtvsPsi_R_With1ConeSubjet->Draw("COLZ");
    //backJetTaggerLeadingLRJEtvsPsi_R_With1ConeSubjet->Scale(1.0 / backJetTaggerLeadingLRJEtvsPsi_R_With1ConeSubjet->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvsPsi_R_With1ConeSubjet.pdf");

    sigJetTaggerLeadingLRJEtvsPsi_R_With1jFEXSubjet->Draw("COLZ");
    //sigJetTaggerLeadingLRJEtvsPsi_R_With1jFEXSubjet->Scale(1.0 / sigJetTaggerLeadingLRJEtvsPsi_R_With1jFEXSubjet->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvsPsi_R_With1jFEXSubjet.pdf");

    backJetTaggerLeadingLRJEtvsPsi_R_With1jFEXSubjet->Draw("COLZ");
    //backJetTaggerLeadingLRJEtvsPsi_R_With1jFEXSubjet->Scale(1.0 / backJetTaggerLeadingLRJEtvsPsi_R_With1jFEXSubjet->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvsPsi_R_With1jFEXSubjet.pdf");

    sigJetTaggerLeadingLRJEtvsPsi_R_WithGrEq2ConeSubjet->Draw("COLZ");
    //sigJetTaggerLeadingLRJEtvsPsi_R_WithGrEq2ConeSubjet->Scale(1.0 / sigJetTaggerLeadingLRJEtvsPsi_R_WithGrEq2ConeSubjet->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvsPsi_R_WithGrEq2ConeSubjet.pdf");

    backJetTaggerLeadingLRJEtvsPsi_R_WithGrEq2ConeSubjet->Draw("COLZ");
    //backJetTaggerLeadingLRJEtvsPsi_R_WithGrEq2ConeSubjet->Scale(1.0 / backJetTaggerLeadingLRJEtvsPsi_R_WithGrEq2ConeSubjet->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvsPsi_R_WithGrEq2ConeSubjet.pdf");

    sigJetTaggerLeadingLRJEtvsPsi_R_WithGrEq2jFEXSubjet->Draw("COLZ");
    //sigJetTaggerLeadingLRJEtvsPsi_R_WithGrEq2jFEXSubjet->Scale(1.0 / sigJetTaggerLeadingLRJEtvsPsi_R_WithGrEq2jFEXSubjet->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvsPsi_R_WithGrEq2jFEXSubjet.pdf");

    backJetTaggerLeadingLRJEtvsPsi_R_WithGrEq2jFEXSubjet->Draw("COLZ");
    //backJetTaggerLeadingLRJEtvsPsi_R_WithGrEq2jFEXSubjet->Scale(1.0 / backJetTaggerLeadingLRJEtvsPsi_R_WithGrEq2jFEXSubjet->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvsPsi_R_WithGrEq2jFEXSubjet.pdf");

    sigJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet->GetXaxis()->SetRangeUser(0.0, 700.0);
    sigJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet->GetYaxis()->SetRangeUser(0.0, 400.0);
    sigJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet->Draw("COLZ");
    //sigJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet->Scale(1.0 / sigJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet.pdf");

    sigJetTaggerLeadingLRJEtvsDeltaRSubjets_WithGrEq2ConeSubjet->Draw("COLZ");
    //sigJetTaggerLeadingLRJEtvsDeltaRSubjets_WithGrEq2ConeSubjet->Scale(1.0 / sigJetTaggerLeadingLRJEtvsDeltaRSubjets_WithGrEq2ConeSubjet->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvsDeltaRSubjets_WithGrEq2ConeSubjet.pdf");

    
    

    backJetTaggerLeadingLRJEtvsDeltaRSubjets_WithGrEq2ConeSubjet->Draw("COLZ");
    //backJetTaggerLeadingLRJEtvsDeltaRSubjets_WithGrEq2ConeSubjet->Scale(1.0 / backJetTaggerLeadingLRJEtvsDeltaRSubjets_WithGrEq2ConeSubjet->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvsDeltaRSubjets_WithGrEq2ConeSubjet.pdf");

    sigJetTaggerLeadingLRJEtvsd12_WithGrEq2ConeSubjet->GetXaxis()->SetRangeUser(0.0, 700.0);
    sigJetTaggerLeadingLRJEtvsd12_WithGrEq2ConeSubjet->GetYaxis()->SetRangeUser(0.0, 400.0);
    sigJetTaggerLeadingLRJEtvsd12_WithGrEq2ConeSubjet->Draw("COLZ");
    //sigJetTaggerLeadingLRJEtvsd12_WithGrEq2ConeSubjet->Scale(1.0 / sigJetTaggerLeadingLRJEtvsd12_WithGrEq2ConeSubjet->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvsd12_WithGrEq2ConeSubjet.pdf");

    backJetTaggerLeadingLRJEtvsd12_WithGrEq2ConeSubjet->GetXaxis()->SetRangeUser(0.0, 700.0);
    backJetTaggerLeadingLRJEtvsd12_WithGrEq2ConeSubjet->GetYaxis()->SetRangeUser(0.0, 400.0);
    backJetTaggerLeadingLRJEtvsd12_WithGrEq2ConeSubjet->Draw("COLZ");
    //backJetTaggerLeadingLRJEtvsd12_WithGrEq2ConeSubjet->Scale(1.0 / backJetTaggerLeadingLRJEtvsd12_WithGrEq2ConeSubjet->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvsd12_WithGrEq2ConeSubjet.pdf");

    sigJetTaggerLeadingLRJEtvsZ_WithGrEq2ConeSubjet->GetXaxis()->SetRangeUser(0.0, 700.0);
    sigJetTaggerLeadingLRJEtvsZ_WithGrEq2ConeSubjet->Draw("COLZ");
    //sigJetTaggerLeadingLRJEtvsZ_WithGrEq2ConeSubjet->Scale(1.0 / sigJetTaggerLeadingLRJEtvsZ_WithGrEq2ConeSubjet->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvsZ_WithGrEq2ConeSubjet.pdf");

    backJetTaggerLeadingLRJEtvsZ_WithGrEq2ConeSubjet->GetXaxis()->SetRangeUser(0.0, 700.0);
    backJetTaggerLeadingLRJEtvsZ_WithGrEq2ConeSubjet->Draw("COLZ");
    //backJetTaggerLeadingLRJEtvsZ_WithGrEq2ConeSubjet->Scale(1.0 / backJetTaggerLeadingLRJEtvsZ_WithGrEq2ConeSubjet->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvsZ_WithGrEq2ConeSubjet.pdf");

    sigJetTaggerLeadingLRJEtvsZ_With1ConeSubjet->GetXaxis()->SetRangeUser(0.0, 700.0);
    sigJetTaggerLeadingLRJEtvsZ_With1ConeSubjet->Draw("COLZ");
    //sigJetTaggerLeadingLRJEtvsZ_With1ConeSubjet->Scale(1.0 / sigJetTaggerLeadingLRJEtvsZ_With1ConeSubjet->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvsZ_With1ConeSubjet.pdf");

    backJetTaggerLeadingLRJEtvsZ_With1ConeSubjet->GetXaxis()->SetRangeUser(0.0, 700.0);
    backJetTaggerLeadingLRJEtvsZ_With1ConeSubjet->Draw("COLZ");
    //backJetTaggerLeadingLRJEtvsZ_With1ConeSubjet->Scale(1.0 / backJetTaggerLeadingLRJEtvsZ_With1ConeSubjet->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvsZ_With1ConeSubjet.pdf");

    backJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet->GetXaxis()->SetRangeUser(0.0, 700.0);
    backJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet->GetYaxis()->SetRangeUser(0.0, 400.0);
    backJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet->Draw("COLZ");
    //backJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet->Scale(1.0 / backJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2ConeSubjet.pdf");

    sigJetTaggerLeadingLRJEtvsMassApprox_SubjetEt_WithGrEq2ConeSubjet->GetXaxis()->SetRangeUser(0.0, 700.0);
    sigJetTaggerLeadingLRJEtvsMassApprox_SubjetEt_WithGrEq2ConeSubjet->GetYaxis()->SetRangeUser(0.0, 400.0);
    sigJetTaggerLeadingLRJEtvsMassApprox_SubjetEt_WithGrEq2ConeSubjet->Draw("COLZ");
    //sigJetTaggerLeadingLRJEtvsMassApprox_SubjetEt_WithGrEq2ConeSubjet->Scale(1.0 / sigJetTaggerLeadingLRJEtvsMassApprox_SubjetEt_WithGrEq2ConeSubjet->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvsMassApprox_SubjetEt_WithGrEq2ConeSubjet.pdf");

    backJetTaggerLeadingLRJEtvsMassApprox_SubjetEt_WithGrEq2ConeSubjet->GetXaxis()->SetRangeUser(0.0, 700.0);
    backJetTaggerLeadingLRJEtvsMassApprox_SubjetEt_WithGrEq2ConeSubjet->GetYaxis()->SetRangeUser(0.0, 400.0);
    backJetTaggerLeadingLRJEtvsMassApprox_SubjetEt_WithGrEq2ConeSubjet->Draw("COLZ");
    //backJetTaggerLeadingLRJEtvsMassApprox_SubjetEt_WithGrEq2ConeSubjet->Scale(1.0 / backJetTaggerLeadingLRJEtvsMassApprox_SubjetEt_WithGrEq2ConeSubjet->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvsMassApprox_SubjetEt_WithGrEq2ConeSubjet.pdf");

    sigJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2jFEXSubjet->GetXaxis()->SetRangeUser(0.0, 700.0);
    sigJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2jFEXSubjet->GetYaxis()->SetRangeUser(0.0, 400.0);
    sigJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2jFEXSubjet->Draw("COLZ");
    //sigJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2jFEXSubjet->Scale(1.0 / sigJetTaggerLeadingLRJEtvsPsi_R_squared_WithGrEq2jFEXSubjet->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2jFEXSubjet.pdf");
    
    backJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2jFEXSubjet->GetXaxis()->SetRangeUser(0.0, 700.0);
    backJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2jFEXSubjet->GetYaxis()->SetRangeUser(0.0, 400.0);
    backJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2jFEXSubjet->Draw("COLZ");
    //backJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2jFEXSubjet->Scale(1.0 / backJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2jFEXSubjet->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvsMassApprox_WithGrEq2jFEXSubjet.pdf");

    backJetTaggerLeadingLRJvsPsi_R_squaredvsTau21ConeProduct->Draw("COLZ");
    backJetTaggerLeadingLRJvsPsi_R_squaredvsTau21ConeProduct->Scale(1.0 / backJetTaggerLeadingLRJvsPsi_R_squaredvsTau21ConeProduct->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJvsPsi_R_squaredvsTau21ConeProduct.pdf");

    sig_JetTaggerLRJ_ConeCellsTowers_Subjet_LeadingTau_12_vs_LeadingJetTaggerEt->Draw("COLZ");
    sig_JetTaggerLRJ_ConeCellsTowers_Subjet_LeadingTau_12_vs_LeadingJetTaggerEt->Scale(1.0 / sig_JetTaggerLRJ_ConeCellsTowers_Subjet_LeadingTau_12_vs_LeadingJetTaggerEt->Integral());
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "sig_JetTaggerLRJ_ConeCellsTowers_Subjet_LeadingTau_12_vs_LeadingJetTaggerEt.pdf");

    back_JetTaggerLRJ_ConeCellsTowers_Subjet_LeadingTau_12_vs_SubleadingTau12->Draw("COLZ");
    back_JetTaggerLRJ_ConeCellsTowers_Subjet_LeadingTau_12_vs_SubleadingTau12->Scale(1.0 / back_JetTaggerLRJ_ConeCellsTowers_Subjet_LeadingTau_12_vs_SubleadingTau12->Integral());
    back_JetTaggerLRJ_ConeCellsTowers_Subjet_LeadingTau_12_vs_SubleadingTau12->SetMinimum(1e-14);
    cLogZ_NSubjetiness.SaveAs(modifiedOutputFileDir + "back_JetTaggerLRJ_ConeCellsTowers_Subjet_LeadingTau_12_vs_SubleadingTau12.pdf");

    c.cd();
    sig_h_LeadingOfflineLRJ_SubjetEt->SetLineColor(kRed);
    back_h_LeadingOfflineLRJ_SubjetEt->SetLineColor(kBlue);
    back_h_LeadingOfflineLRJ_SubjetEt->Scale(1.0 / num_processed_events_background);
    back_h_LeadingOfflineLRJ_SubjetEt->Draw("HIST");
    sig_h_LeadingOfflineLRJ_SubjetEt->Scale(1.0 / num_processed_events_signal);
    sig_h_LeadingOfflineLRJ_SubjetEt->Draw("HIST SAME");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "LeadingOfflineLRJ_SubjetEt.pdf");

    sig_h_SubleadingOfflineLRJ_SubjetEt->SetLineColor(kRed);
    back_h_SubleadingOfflineLRJ_SubjetEt->SetLineColor(kBlue);
    back_h_SubleadingOfflineLRJ_SubjetEt->Scale(1.0 / num_processed_events_background);
    back_h_SubleadingOfflineLRJ_SubjetEt->Draw("HIST");
    sig_h_SubleadingOfflineLRJ_SubjetEt->Scale(1.0 / num_processed_events_signal);
    sig_h_SubleadingOfflineLRJ_SubjetEt->Draw("HIST SAME");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "SubleadingOfflineLRJ_SubjetEt.pdf");

    sig_h_leading_LRJ_gFexLRJ_deltaEt->Scale(1.0 / sig_h_leading_LRJ_gFexLRJ_deltaEt->Integral());
    back_h_leading_LRJ_gFexLRJ_deltaEt->Scale(1.0 / back_h_leading_LRJ_gFexLRJ_deltaEt->Integral());
    sig_h_leading_LRJ_gFexLRJ_deltaEt->SetLineColor(kRed);
    back_h_leading_LRJ_gFexLRJ_deltaEt->SetLineColor(kBlue);
    back_h_leading_LRJ_gFexLRJ_deltaEt->Draw("HIST");
    sig_h_leading_LRJ_gFexLRJ_deltaEt->Draw("HIST SAME");
    
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "leading_LRJ_gFexLRJ_deltaEt.pdf");

    sig_h_leading_offlineLRJ_gFexLRJ_deltaEt->Scale(1.0 / sig_h_leading_offlineLRJ_gFexLRJ_deltaEt->Integral());
    back_h_leading_offlineLRJ_gFexLRJ_deltaEt->Scale(1.0 / back_h_leading_offlineLRJ_gFexLRJ_deltaEt->Integral());
    sig_h_leading_offlineLRJ_gFexLRJ_deltaEt->SetLineColor(kRed);
    back_h_leading_offlineLRJ_gFexLRJ_deltaEt->SetLineColor(kBlue);
    back_h_leading_offlineLRJ_gFexLRJ_deltaEt->Draw("HIST");
    sig_h_leading_offlineLRJ_gFexLRJ_deltaEt->Draw("HIST SAME");
    
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "leading_offlineLRJ_gFexLRJ_deltaEt.pdf");

    sig_h_leading_offlineLRJ_jFexLRJ_deltaEt->Scale(1.0 / sig_h_leading_offlineLRJ_jFexLRJ_deltaEt->Integral());
    back_h_leading_offlineLRJ_jFexLRJ_deltaEt->Scale(1.0 / back_h_leading_offlineLRJ_jFexLRJ_deltaEt->Integral());
    sig_h_leading_offlineLRJ_jFexLRJ_deltaEt->SetLineColor(kRed);
    back_h_leading_offlineLRJ_jFexLRJ_deltaEt->SetLineColor(kBlue);
    back_h_leading_offlineLRJ_jFexLRJ_deltaEt->Draw("HIST");
    sig_h_leading_offlineLRJ_jFexLRJ_deltaEt->Draw("HIST SAME");
    
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "leading_offlineLRJ_jFexLRJ_deltaEt.pdf");

    sig_h_leading_LRJ_offlineLRJ_deltaEt->Scale(1.0 / sig_h_leading_LRJ_offlineLRJ_deltaEt->Integral());
    back_h_leading_LRJ_offlineLRJ_deltaEt->Scale(1.0 / back_h_leading_LRJ_offlineLRJ_deltaEt->Integral());
    sig_h_leading_LRJ_offlineLRJ_deltaEt->SetLineColor(kRed);
    back_h_leading_LRJ_offlineLRJ_deltaEt->SetLineColor(kBlue);
    back_h_leading_LRJ_offlineLRJ_deltaEt->Draw("HIST");
    sig_h_leading_LRJ_offlineLRJ_deltaEt->Draw("HIST SAME");
    
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "leading_LRJ_offlineLRJ_deltaEt.pdf");
    
    // Resolution plots
    sig_h_leading_LRJ_gFexLRJ_Et_resolution->Scale(1.0 / sig_h_leading_LRJ_gFexLRJ_Et_resolution->Integral());
    back_h_leading_LRJ_gFexLRJ_Et_resolution->Scale(1.0 / back_h_leading_LRJ_gFexLRJ_Et_resolution->Integral());
    sig_h_leading_LRJ_gFexLRJ_Et_resolution->SetLineColor(kRed);
    back_h_leading_LRJ_gFexLRJ_Et_resolution->SetLineColor(kBlue);
    sig_h_leading_LRJ_gFexLRJ_Et_resolution->Draw("HIST");
    back_h_leading_LRJ_gFexLRJ_Et_resolution->Draw("HIST SAME");
    
    
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "leading_LRJ_gFexLRJ_Et_resolution.pdf");

    sig_h_leading_offlineLRJ_gFexLRJ_Et_resolution->Scale(1.0 / sig_h_leading_offlineLRJ_gFexLRJ_Et_resolution->Integral());
    back_h_leading_offlineLRJ_gFexLRJ_Et_resolution->Scale(1.0 / back_h_leading_offlineLRJ_gFexLRJ_Et_resolution->Integral());
    sig_h_leading_offlineLRJ_gFexLRJ_Et_resolution->SetLineColor(kRed);
    back_h_leading_offlineLRJ_gFexLRJ_Et_resolution->SetLineColor(kBlue);
    sig_h_leading_offlineLRJ_gFexLRJ_Et_resolution->Draw("HIST");
    back_h_leading_offlineLRJ_gFexLRJ_Et_resolution->Draw("HIST SAME");
    
    
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "leading_offlineLRJ_gFexLRJ_Et_resolution.pdf");

    sig_h_leading_offlineLRJ_jFexLRJ_Et_resolution->Scale(1.0 / sig_h_leading_offlineLRJ_jFexLRJ_Et_resolution->Integral());
    back_h_leading_offlineLRJ_jFexLRJ_Et_resolution->Scale(1.0 / back_h_leading_offlineLRJ_jFexLRJ_Et_resolution->Integral());
    sig_h_leading_offlineLRJ_jFexLRJ_Et_resolution->SetLineColor(kRed);
    back_h_leading_offlineLRJ_jFexLRJ_Et_resolution->SetLineColor(kBlue);
    sig_h_leading_offlineLRJ_jFexLRJ_Et_resolution->Draw("HIST");
    back_h_leading_offlineLRJ_jFexLRJ_Et_resolution->Draw("HIST SAME");
    
    
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "leading_offlineLRJ_jFexLRJ_Et_resolution.pdf");

    sig_h_leading_LRJ_offlineLRJ_Et_resolution->Scale(1.0 / sig_h_leading_LRJ_offlineLRJ_Et_resolution->Integral());
    back_h_leading_LRJ_offlineLRJ_Et_resolution->Scale(1.0 / back_h_leading_LRJ_offlineLRJ_Et_resolution->Integral());
    sig_h_leading_LRJ_offlineLRJ_Et_resolution->SetLineColor(kRed);
    back_h_leading_LRJ_offlineLRJ_Et_resolution->SetLineColor(kBlue);
    sig_h_leading_LRJ_offlineLRJ_Et_resolution->Draw("HIST");
    back_h_leading_LRJ_offlineLRJ_Et_resolution->Draw("HIST SAME");
    
    
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "leading_LRJ_offlineLRJ_Et_resolution.pdf");



    // === Overlay: gFEX (dashed) vs JetTagger (solid), same colors ===
    TCanvas c_overlay("c_overlay", "DeltaEt Overlay", 800, 650);
    c_overlay.SetTicks(1,1);

    // Give the big titles some breathing room (leave your global sizes as-is)
    c_overlay.SetLeftMargin(0.20);    // was 0.16
    c_overlay.SetBottomMargin(0.20);  // was 0.16
    c_overlay.SetRightMargin(0.08);   // a hair more room for legend
    c_overlay.SetTopMargin(0.06);

    c_overlay.cd();

    // 1) Normalize (guard against zero integrals)
    auto safe_norm = [](TH1* h) {
        if (!h) return;
        const double I = h->Integral();
        if (I > 0) h->Scale(1.0 / I);
    };
    safe_norm(sig_h_leading_offlineLRJ_gFexLRJ_deltaEt);
    safe_norm(back_h_leading_offlineLRJ_gFexLRJ_deltaEt);
    safe_norm(sig_h_leading_LRJ_offlineLRJ_deltaEt);
    safe_norm(back_h_leading_LRJ_offlineLRJ_deltaEt);

    // 2) Styling: colors fixed, styles differ by source
    // gFEX = dashed
    sig_h_leading_offlineLRJ_gFexLRJ_deltaEt->SetLineColor(kRed);
    sig_h_leading_offlineLRJ_gFexLRJ_deltaEt->SetLineStyle(kDashed);
    sig_h_leading_offlineLRJ_gFexLRJ_deltaEt->SetLineWidth(2);

    back_h_leading_offlineLRJ_gFexLRJ_deltaEt->SetLineColor(kBlue);
    back_h_leading_offlineLRJ_gFexLRJ_deltaEt->SetLineStyle(kDashed);
    back_h_leading_offlineLRJ_gFexLRJ_deltaEt->SetLineWidth(2);

    // JetTagger = solid
    sig_h_leading_LRJ_offlineLRJ_deltaEt->SetLineColor(kRed);
    sig_h_leading_LRJ_offlineLRJ_deltaEt->SetLineStyle(kSolid);
    sig_h_leading_LRJ_offlineLRJ_deltaEt->SetLineWidth(2);

    back_h_leading_LRJ_offlineLRJ_deltaEt->SetLineColor(kBlue);
    back_h_leading_LRJ_offlineLRJ_deltaEt->SetLineStyle(kSolid);
    back_h_leading_LRJ_offlineLRJ_deltaEt->SetLineWidth(2);

    // 3) Axis/frame: use the gFEX background as a frame clone
    TH1F* frame = (TH1F*)back_h_leading_offlineLRJ_gFexLRJ_deltaEt->Clone("frame_deltaEt");
    frame->Reset("ICES");
    frame->SetTitle(";#Delta E_{T} (Offline - JetTagger, gFEX) [GeV];% of Leading LRJs / 10 GeV");

    // Compute a common max
    double ymax_deltaEt = 0.0;
    auto updmax = [&](TH1* h){ if(h) ymax_deltaEt = std::max(ymax_deltaEt, h->GetMaximum()); };
    updmax(sig_h_leading_offlineLRJ_gFexLRJ_deltaEt);
    updmax(back_h_leading_offlineLRJ_gFexLRJ_deltaEt);
    updmax(sig_h_leading_LRJ_offlineLRJ_deltaEt);
    updmax(back_h_leading_LRJ_offlineLRJ_deltaEt);
    if (ymax_deltaEt <= 0) ymax_deltaEt = 1.0;

    frame->SetMaximum(1.1 * ymax_deltaEt);
    frame->SetMinimum(0.0);
    frame->GetXaxis()->SetLabelSize(0.045);
    frame->GetXaxis()->SetTitleSize(0.055);
    frame->GetYaxis()->SetLabelSize(0.045);
    frame->GetYaxis()->SetTitleSize(0.055);
    frame->Draw("AXIS");   // draw just axes so "HIST" fills them

    // 4) Draw all four histos
    back_h_leading_offlineLRJ_gFexLRJ_deltaEt->Draw("HIST SAME");
    sig_h_leading_offlineLRJ_gFexLRJ_deltaEt->Draw("HIST SAME");
    back_h_leading_LRJ_offlineLRJ_deltaEt->Draw("HIST SAME");
    sig_h_leading_LRJ_offlineLRJ_deltaEt->Draw("HIST SAME");

    // 5) Legend: gFEX (dashed) vs JetTagger (solid)
    TLegend* leg_overlay = new TLegend(0.56, 0.62, 0.86, 0.87);
    leg_overlay->SetBorderSize(0);
    leg_overlay->SetFillStyle(0);
    leg_overlay->SetTextSize(0.032);
    leg_overlay->AddEntry(sig_h_leading_offlineLRJ_gFexLRJ_deltaEt,  "Signal (gFEX)",      "l");
    leg_overlay->AddEntry(back_h_leading_offlineLRJ_gFexLRJ_deltaEt, "Background (gFEX)",  "l");
    leg_overlay->AddEntry(sig_h_leading_LRJ_offlineLRJ_deltaEt,      "Signal (JetTagger)", "l");
    leg_overlay->AddEntry(back_h_leading_LRJ_offlineLRJ_deltaEt,     "Background (JetTagger)", "l");
    leg_overlay->Draw();

    c_overlay.Modified(); c_overlay.Update();
    c_overlay.SaveAs(modifiedOutputFileDir + "leading_deltaEt_overlay_gFEX_vs_JetTagger.pdf");


    // === Overlay: jFEX (dashed) vs JetTagger (solid), same colors ===
    TCanvas c_overlay_jFEX("c_overlay_jFEX", "DeltaEt Overlay", 800, 650);
    c_overlay_jFEX.SetTicks(1,1);

    // Give the big titles some breathing room (leave your global sizes as-is)
    c_overlay_jFEX.SetLeftMargin(0.20);    // was 0.16
    c_overlay_jFEX.SetBottomMargin(0.20);  // was 0.16
    c_overlay_jFEX.SetRightMargin(0.08);   // a hair more room for legend
    c_overlay_jFEX.SetTopMargin(0.06);

    c_overlay_jFEX.cd();

    // 1) Normalize (guard against zero integrals)
    safe_norm(sig_h_leading_offlineLRJ_jFexLRJ_deltaEt);
    safe_norm(back_h_leading_offlineLRJ_jFexLRJ_deltaEt);
    safe_norm(sig_h_leading_LRJ_offlineLRJ_deltaEt);
    safe_norm(back_h_leading_LRJ_offlineLRJ_deltaEt);

    // 2) Styling: colors fixed, styles differ by source
    // jFEX = dashed
    sig_h_leading_offlineLRJ_jFexLRJ_deltaEt->SetLineColor(kRed);
    sig_h_leading_offlineLRJ_jFexLRJ_deltaEt->SetLineStyle(kDashed);
    sig_h_leading_offlineLRJ_jFexLRJ_deltaEt->SetLineWidth(2);

    back_h_leading_offlineLRJ_jFexLRJ_deltaEt->SetLineColor(kBlue);
    back_h_leading_offlineLRJ_jFexLRJ_deltaEt->SetLineStyle(kDashed);
    back_h_leading_offlineLRJ_jFexLRJ_deltaEt->SetLineWidth(2);

    // JetTagger = solid
    sig_h_leading_LRJ_offlineLRJ_deltaEt->SetLineColor(kRed);
    sig_h_leading_LRJ_offlineLRJ_deltaEt->SetLineStyle(kSolid);
    sig_h_leading_LRJ_offlineLRJ_deltaEt->SetLineWidth(2);

    back_h_leading_LRJ_offlineLRJ_deltaEt->SetLineColor(kBlue);
    back_h_leading_LRJ_offlineLRJ_deltaEt->SetLineStyle(kSolid);
    back_h_leading_LRJ_offlineLRJ_deltaEt->SetLineWidth(2);

    // 3) Axis/frame: use the jFEX background as a frame clone
    TH1F* frame_jFEX = (TH1F*)back_h_leading_offlineLRJ_jFexLRJ_deltaEt->Clone("frame_deltaEt");
    frame_jFEX->Reset("ICES");
    frame_jFEX->SetTitle(";#Delta E_{T} (Offline - JetTagger, jFEX) [GeV];% of Leading LRJs / 10 GeV");

    // Compute a common max
    double ymax_jFEX = 0.0;
    auto updmax_jFEX = [&](TH1* h){ if(h) ymax_jFEX = std::max(ymax_jFEX, h->GetMaximum()); };
    updmax_jFEX(sig_h_leading_offlineLRJ_jFexLRJ_deltaEt);
    updmax_jFEX(back_h_leading_offlineLRJ_jFexLRJ_deltaEt);
    updmax_jFEX(sig_h_leading_LRJ_offlineLRJ_deltaEt);
    updmax_jFEX(back_h_leading_LRJ_offlineLRJ_deltaEt);
    if (ymax_jFEX <= 0) ymax_jFEX = 1.0;

    frame_jFEX->SetMaximum(1.1 * ymax_jFEX);
    frame_jFEX->SetMinimum(0.0);
    frame_jFEX->GetXaxis()->SetLabelSize(0.045);
    frame_jFEX->GetXaxis()->SetTitleSize(0.055);
    frame_jFEX->GetYaxis()->SetLabelSize(0.045);
    frame_jFEX->GetYaxis()->SetTitleSize(0.055);
    frame_jFEX->Draw("AXIS");   // draw just axes so "HIST" fills them

    // 4) Draw all four histos
    back_h_leading_offlineLRJ_jFexLRJ_deltaEt->Draw("HIST SAME");
    sig_h_leading_offlineLRJ_jFexLRJ_deltaEt->Draw("HIST SAME");
    back_h_leading_LRJ_offlineLRJ_deltaEt->Draw("HIST SAME");
    sig_h_leading_LRJ_offlineLRJ_deltaEt->Draw("HIST SAME");

    // 5) Legend: jFEX (dashed) vs JetTagger (solid)
    TLegend* leg_overlay_jFEX = new TLegend(0.56, 0.62, 0.86, 0.87);
    leg_overlay_jFEX->SetBorderSize(0);
    leg_overlay_jFEX->SetFillStyle(0);
    leg_overlay_jFEX->SetTextSize(0.032);
    leg_overlay_jFEX->AddEntry(sig_h_leading_offlineLRJ_jFexLRJ_deltaEt,  "Signal (jFEX)",      "l");
    leg_overlay_jFEX->AddEntry(back_h_leading_offlineLRJ_jFexLRJ_deltaEt, "Background (jFEX)",  "l");
    leg_overlay_jFEX->AddEntry(sig_h_leading_LRJ_offlineLRJ_deltaEt,      "Signal (JetTagger)", "l");
    leg_overlay_jFEX->AddEntry(back_h_leading_LRJ_offlineLRJ_deltaEt,     "Background (JetTagger)", "l");
    leg_overlay_jFEX->Draw();

    c_overlay_jFEX.Modified(); c_overlay_jFEX.Update();
    c_overlay_jFEX.SaveAs(modifiedOutputFileDir + "leading_deltaEt_overlay_jFEX_vs_JetTagger.pdf");




    c.cd();

    sig_h_leading_LRJ_gFexLRJ_deltaR->Scale(1.0 / sig_h_leading_LRJ_gFexLRJ_deltaR->Integral());
    back_h_leading_LRJ_gFexLRJ_deltaR->Scale(1.0 / back_h_leading_LRJ_gFexLRJ_deltaR->Integral());
    sig_h_leading_LRJ_gFexLRJ_deltaR->SetLineColor(kRed);
    back_h_leading_LRJ_gFexLRJ_deltaR->SetLineColor(kBlue);
    sig_h_leading_LRJ_gFexLRJ_deltaR->Draw("HIST");
    back_h_leading_LRJ_gFexLRJ_deltaR->Draw("HIST SAME");
    
    
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "leading_LRJ_gFexLRJ_deltaR.pdf");

    sig_h_leading_LRJ_offlineLRJ_deltaR->Scale(1.0 / sig_h_leading_LRJ_offlineLRJ_deltaR->Integral());
    back_h_leading_LRJ_offlineLRJ_deltaR->Scale(1.0 / back_h_leading_LRJ_offlineLRJ_deltaR->Integral());
    sig_h_leading_LRJ_offlineLRJ_deltaR->SetLineColor(kRed);
    back_h_leading_LRJ_offlineLRJ_deltaR->SetLineColor(kBlue);
    sig_h_leading_LRJ_offlineLRJ_deltaR->Draw("HIST");
    back_h_leading_LRJ_offlineLRJ_deltaR->Draw("HIST SAME");
    
    
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "leading_LRJ_offlineLRJ_deltaR.pdf");

    sig_h_first_LRJ_jFexSRJ_deltaR->Scale(1.0 / sig_h_first_LRJ_jFexSRJ_deltaR->Integral());
    back_h_first_LRJ_jFexSRJ_deltaR->Scale(1.0 / back_h_first_LRJ_jFexSRJ_deltaR->Integral());
    sig_h_first_LRJ_jFexSRJ_deltaR->SetLineColor(kRed);
    back_h_first_LRJ_jFexSRJ_deltaR->SetLineColor(kBlue);
    sig_h_first_LRJ_jFexSRJ_deltaR->Draw("HIST");
    back_h_first_LRJ_jFexSRJ_deltaR->Draw("HIST SAME");
    
    
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "first_LRJ_jFexSRJ_deltaR.pdf");

    sig_h_second_LRJ_jFexSRJ_deltaR->Scale(1.0 / sig_h_second_LRJ_jFexSRJ_deltaR->Integral());
    back_h_second_LRJ_jFexSRJ_deltaR->Scale(1.0 / back_h_second_LRJ_jFexSRJ_deltaR->Integral());
    sig_h_second_LRJ_jFexSRJ_deltaR->SetLineColor(kRed);
    back_h_second_LRJ_jFexSRJ_deltaR->SetLineColor(kBlue);
    sig_h_second_LRJ_jFexSRJ_deltaR->Draw("HIST");
    back_h_second_LRJ_jFexSRJ_deltaR->Draw("HIST SAME");
    
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "second_LRJ_jFexSRJ_deltaR.pdf");

    sig_h_lead_sublead_LRJ_deltaR->Scale(1.0 / sig_h_lead_sublead_LRJ_deltaR->Integral());
    back_h_lead_sublead_LRJ_deltaR->Scale(1.0 / back_h_lead_sublead_LRJ_deltaR->Integral());
    sig_h_lead_sublead_LRJ_deltaR->SetLineColor(kRed);
    back_h_lead_sublead_LRJ_deltaR->SetLineColor(kBlue);
    back_h_lead_sublead_LRJ_deltaR->Draw("HIST");
    sig_h_lead_sublead_LRJ_deltaR->Draw("HIST SAME");
    
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "lead_sublead_LRJ_deltaR.pdf");

    TString overlayedJZSliceDir = "overlayJZSliceHistograms/" + algorithmConfigurations[fileIt] + "/";

    gSystem->mkdir(overlayedJZSliceDir); 

    back_h_leading_LRJ_Et_arr[0]->Draw("HIST");
    c.SaveAs(overlayedJZSliceDir + "JZ0_jettagger_leading_LRJ_Et.pdf");

    back_h_leading_LRJ_Et_arr[4]->Draw("HIST");
    c.SaveAs(overlayedJZSliceDir + "JZ4_jettagger_leading_LRJ_Et.pdf");

    back_h_leading_LRJ_Et_arr[9]->Draw("HIST");
    c.SaveAs(overlayedJZSliceDir + "JZ9_jettagger_leading_LRJ_Et.pdf");

    OverlayAndSave(back_h_leading_LRJ_Et_arr,  nJZSlices_, "c_leadLRJ", overlayedJZSliceDir + "overlay_leading_LRJ_Et_filled.pdf", 1001);
    OverlayAndSave(back_h_subleading_LRJ_Et_arr, nJZSlices_, "c_subleadLRJ", overlayedJZSliceDir + "overlay_subleading_LRJ_Et_filled.pdf", 1001);

    OverlayAndSave(back_h_gFEX_leading_LRJ_Et_arr, nJZSlices_, "c_gFEX_leadLRJ", overlayedJZSliceDir + "overlay_gFEX_leading_LRJ_Et_filled.pdf", 1001);
    OverlayAndSave(back_h_gFEX_subleading_LRJ_Et_arr, nJZSlices_, "c_gFEX_subLRJ", overlayedJZSliceDir + "overlay_gFEX_subleading_LRJ_Et_filled.pdf", 1001);

    OverlayAndSave(back_h_jFEX_leading_LRJ_Et_arr, nJZSlices_, "c_jFEX_leadLRJ",   overlayedJZSliceDir + "overlay_jFEX_leading_LRJ_Et_filled.pdf", 1001);
    OverlayAndSave(back_h_jFEX_subleading_LRJ_Et_arr, nJZSlices_, "c_jFEX_subLRJ", overlayedJZSliceDir + "overlay_jFEX_subleading_LRJ_Et_filled.pdf", 1001);

    OverlayAndSave(back_h_gFEX_leading_SRJ_Et_arr, nJZSlices_, "c_gFEX_leadSRJ", overlayedJZSliceDir + "overlay_gFEX_leading_SRJ_Et_filled.pdf", 1001);
    OverlayAndSave(back_h_gFEX_subleading_SRJ_Et_arr, nJZSlices_, "c_gFEX_subSRJ", overlayedJZSliceDir + "overlay_gFEX_subleading_SRJ_Et_filled.pdf", 1001);

    OverlayAndSave(back_h_jFEX_leading_SRJ_Et_arr, nJZSlices_, "c_jFEX_leadSRJ",   overlayedJZSliceDir + "overlay_jFEX_leading_SRJ_Et_filled.pdf", 1001);
    OverlayAndSave(back_h_jFEX_subleading_SRJ_Et_arr, nJZSlices_, "c_jFEX_subSRJ", overlayedJZSliceDir + "overlay_jFEX_subleading_SRJ_Et_filled.pdf", 1001);

    OverlayAndSave(back_h_leading_offlineLRJ_Et_arr, nJZSlices_, "c_off_leadLRJ", overlayedJZSliceDir + "overlay_offline_leading_LRJ_Et_filled.pdf", 1001);
    OverlayAndSave(back_h_subleading_offlineLRJ_Et_arr,nJZSlices_, "c_off_subLRJ", overlayedJZSliceDir + "overlay_offline_subleading_LRJ_Et_filled.pdf", 1001);

    OverlayAndSave(back_h_leading_truthSRJs_Et_arr, nJZSlices_, "c_truth_leadSRJ", overlayedJZSliceDir + "overlay_truth_leading_SRJs_Et_filled.pdf", 1001);
    OverlayAndSave(back_h_subleading_truthSRJs_Et_arr, nJZSlices_, "c_truth_subSRJ", overlayedJZSliceDir + "overlay_truth_subleading_SRJs_Et_filled.pdf", 1001);

    OverlayAndSave(back_h_leading_conejets_cellstowers_pT_arr, nJZSlices_, "c_leadConeCellsTowers", overlayedJZSliceDir + "overlay_lead_conejet_cellstowers_pT_filled.pdf", 1001);
    OverlayAndSave(back_h_subleading_conejets_cellstowers_pT_arr, nJZSlices_, "c_subleadConeCellsTowers", overlayedJZSliceDir + "overlay_sublead_conejet_cellstowers_pT_filled.pdf", 1001);

    OverlayAndSave(back_h_leading_WTA_conejets_cellstowers_pT_arr, nJZSlices_, "c_WTA_leadConeCellsTowers", overlayedJZSliceDir + "overlay_wta_lead_conejet_cellstowers_pT_filled.pdf", 1001);
    OverlayAndSave(back_h_subleading_WTA_conejets_cellstowers_pT_arr, nJZSlices_, "c_WTA_subleadConeCellsTowers", overlayedJZSliceDir + "overlay_wta_sublead_conejet_cellstowers_pT_filled.pdf", 1001);

    OverlayAndSave(back_h_leading_conejets_basicclusters_pT_arr, nJZSlices_, "c_leadConeBasicClusters", overlayedJZSliceDir + "overlay_lead_conejet_basicclusters_pT_filled.pdf", 1001);
    OverlayAndSave(back_h_subleading_conejets_cellstowers_pT_arr, nJZSlices_, "c_subleadConeBasicClusters", overlayedJZSliceDir + "overlay_sublead_conejet_basicclusters_pT_filled.pdf", 1001);

    OverlayAndSave(back_h_leading_WTA_conejets_basicclusters_pT_arr, nJZSlices_, "c_WTA_leadConeBasicClusters", overlayedJZSliceDir + "overlay_wta_lead_conejet_basicclusters_pT_filled.pdf", 1001);
    OverlayAndSave(back_h_subleading_WTA_conejets_basicclusters_pT_arr, nJZSlices_, "c_WTA_subleadConeBasicClusters", overlayedJZSliceDir + "overlay_wta_sublead_conejet_basicclusters_pT_filled.pdf", 1001);

    OverlayAndSave(back_h_leading_LRJ_Et_arr,  nJZSlices_, "c_leadLRJ_open", overlayedJZSliceDir + "overlay_leading_LRJ_Et_open.pdf", 0);
    OverlayAndSave(back_h_subleading_LRJ_Et_arr, nJZSlices_, "c_subleadLRJ_open", overlayedJZSliceDir + "overlay_subleading_LRJ_Et_open.pdf", 0);

    OverlayAndSave(back_h_gFEX_leading_LRJ_Et_arr, nJZSlices_, "c_gFEX_leadLRJ_open", overlayedJZSliceDir + "overlay_gFEX_leading_LRJ_Et_open.pdf", 0);
    OverlayAndSave(back_h_gFEX_subleading_LRJ_Et_arr, nJZSlices_, "c_gFEX_subLRJ_open", overlayedJZSliceDir + "overlay_gFEX_subleading_LRJ_Et_open.pdf", 0);

    OverlayAndSave(back_h_jFEX_leading_LRJ_Et_arr, nJZSlices_, "c_jFEX_leadLRJ_open",   overlayedJZSliceDir + "overlay_jFEX_leading_LRJ_Et_open.pdf", 0);
    OverlayAndSave(back_h_jFEX_subleading_LRJ_Et_arr, nJZSlices_, "c_jFEX_subLRJ_open", overlayedJZSliceDir + "overlay_jFEX_subleading_LRJ_Et_open.pdf", 0);

    OverlayAndSave(back_h_gFEX_leading_SRJ_Et_arr, nJZSlices_, "c_gFEX_leadSRJ_open", overlayedJZSliceDir + "overlay_gFEX_leading_SRJ_Et_open.pdf", 0);
    OverlayAndSave(back_h_gFEX_subleading_SRJ_Et_arr, nJZSlices_, "c_gFEX_subSRJ_open", overlayedJZSliceDir + "overlay_gFEX_subleading_SRJ_Et_open.pdf", 0);

    OverlayAndSave(back_h_jFEX_leading_SRJ_Et_arr, nJZSlices_, "c_jFEX_leadSRJ_open",   overlayedJZSliceDir + "overlay_jFEX_leading_SRJ_Et_open.pdf", 0);
    OverlayAndSave(back_h_jFEX_subleading_SRJ_Et_arr, nJZSlices_, "c_jFEX_subSRJ_open", overlayedJZSliceDir + "overlay_jFEX_subleading_SRJ_Et_open.pdf", 0);

    OverlayAndSave(back_h_leading_offlineLRJ_Et_arr, nJZSlices_, "c_off_leadLRJ_open", overlayedJZSliceDir + "overlay_offline_leading_LRJ_Et_open.pdf", 0);
    OverlayAndSave(back_h_subleading_offlineLRJ_Et_arr,nJZSlices_, "c_off_subLRJ_open", overlayedJZSliceDir + "overlay_offline_subleading_LRJ_Et_open.pdf", 0);

    OverlayAndSave(back_h_leading_truthSRJs_Et_arr, nJZSlices_, "c_truth_leadSRJ_open", overlayedJZSliceDir + "overlay_truth_leading_SRJs_Et_open.pdf", 0);
    OverlayAndSave(back_h_subleading_truthSRJs_Et_arr, nJZSlices_, "c_truth_subSRJ_open", overlayedJZSliceDir + "overlay_truth_subleading_SRJs_Et_open.pdf", 0);

    OverlayAndSave(back_h_leading_conejets_cellstowers_pT_arr, nJZSlices_, "c_leadConeCellsTowers_open", overlayedJZSliceDir + "overlay_lead_conejet_cellstowers_pT_open.pdf", 0);
    OverlayAndSave(back_h_subleading_conejets_cellstowers_pT_arr, nJZSlices_, "c_subleadConeCellsTowers_open", overlayedJZSliceDir + "overlay_sublead_conejet_cellstowers_pT_open.pdf", 0);

    OverlayAndSave(back_h_leading_WTA_conejets_cellstowers_pT_arr, nJZSlices_, "c_WTA_leadConeCellsTowers_open", overlayedJZSliceDir + "overlay_wta_lead_conejet_cellstowers_pT_open.pdf", 0);
    OverlayAndSave(back_h_subleading_WTA_conejets_cellstowers_pT_arr, nJZSlices_, "c_WTA_subleadConeCellsTowers_open", overlayedJZSliceDir + "overlay_wta_sublead_conejet_cellstowers_pT_open.pdf", 0);

    OverlayAndSave(back_h_leading_conejets_basicclusters_pT_arr, nJZSlices_, "c_leadConeBasicClusters_open", overlayedJZSliceDir + "overlay_lead_conejet_basicclusters_pT_open.pdf", 0);
    OverlayAndSave(back_h_subleading_conejets_cellstowers_pT_arr, nJZSlices_, "c_subleadConeBasicClusters_open", overlayedJZSliceDir + "overlay_sublead_conejet_basicclusters_pT_open.pdf", 0);

    OverlayAndSave(back_h_leading_WTA_conejets_basicclusters_pT_arr, nJZSlices_, "c_WTA_leadConeBasicClusters_open", overlayedJZSliceDir + "overlay_wta_lead_conejet_basicclusters_pT_open.pdf", 0);
    OverlayAndSave(back_h_subleading_WTA_conejets_basicclusters_pT_arr, nJZSlices_, "c_WTA_subleadConeBasicClusters_open", overlayedJZSliceDir + "overlay_wta_sublead_conejet_basicclusters_pT_open.pdf", 0);

    OverlayAndSaveStack(back_h_leading_LRJ_Et_arr,  nJZSlices_, "c_leadLRJ_stackedfilled", overlayedJZSliceDir + "overlay_leading_LRJ_Et_stack_filled.pdf", 1001);
    OverlayAndSaveStack(back_h_subleading_LRJ_Et_arr, nJZSlices_, "c_subleadLRJ_stackedfilled", overlayedJZSliceDir + "overlay_subleading_LRJ_Et_stack_filled.pdf", 1001);

    OverlayAndSaveStack(back_h_gFEX_leading_LRJ_Et_arr, nJZSlices_, "c_gFEX_leadLRJ_stackedfilled", overlayedJZSliceDir + "overlay_gFEX_leading_LRJ_Et_stack_filled.pdf", 1001);
    OverlayAndSaveStack(back_h_gFEX_subleading_LRJ_Et_arr, nJZSlices_, "c_gFEX_subLRJ_stackedfilled", overlayedJZSliceDir + "overlay_gFEX_subleading_LRJ_Et_stack_filled.pdf", 1001);

    OverlayAndSaveStack(back_h_jFEX_leading_LRJ_Et_arr, nJZSlices_, "c_jFEX_leadLRJ_stackedfilled",   overlayedJZSliceDir + "overlay_jFEX_leading_LRJ_Et_stack_filled.pdf", 1001);
    OverlayAndSaveStack(back_h_jFEX_subleading_LRJ_Et_arr, nJZSlices_, "c_jFEX_subLRJ_stackedfilled", overlayedJZSliceDir + "overlay_jFEX_subleading_LRJ_Et_stack_filled.pdf", 1001);

    OverlayAndSaveStack(back_h_gFEX_leading_SRJ_Et_arr, nJZSlices_, "c_gFEX_leadSRJ_stackedfilled", overlayedJZSliceDir + "overlay_gFEX_leading_SRJ_Et_stack_filled.pdf", 1001);
    OverlayAndSaveStack(back_h_gFEX_subleading_SRJ_Et_arr, nJZSlices_, "c_gFEX_subSRJ_stackedfilled", overlayedJZSliceDir + "overlay_gFEX_subleading_SRJ_Et_stack_filled.pdf", 1001);

    OverlayAndSaveStack(back_h_jFEX_leading_SRJ_Et_arr, nJZSlices_, "c_jFEX_leadSRJ_stackedfilled",   overlayedJZSliceDir + "overlay_jFEX_leading_SRJ_Et_stack_filled.pdf", 1001);
    OverlayAndSaveStack(back_h_jFEX_subleading_SRJ_Et_arr, nJZSlices_, "c_jFEX_subSRJ_stackedfilled", overlayedJZSliceDir + "overlay_jFEX_subleading_SRJ_Et_stack_filled.pdf", 1001);

    OverlayAndSaveStack(back_h_leading_offlineLRJ_Et_arr, nJZSlices_, "c_off_leadLRJ_stackedfilled", overlayedJZSliceDir + "overlay_offline_leading_LRJ_Et_stack_filled.pdf", 1001);
    OverlayAndSaveStack(back_h_subleading_offlineLRJ_Et_arr,nJZSlices_, "c_off_subLRJ_stackedfilled", overlayedJZSliceDir + "overlay_offline_subleading_LRJ_Et_stack_filled.pdf", 1001);

    OverlayAndSaveStack(back_h_leading_truthSRJs_Et_arr, nJZSlices_, "c_truth_leadSRJ_stackedfilled", overlayedJZSliceDir + "overlay_truth_leading_SRJs_Et_stack_filled.pdf", 1001);
    OverlayAndSaveStack(back_h_subleading_truthSRJs_Et_arr, nJZSlices_, "c_truth_subSRJ_stackedfilled", overlayedJZSliceDir + "overlay_truth_subleading_SRJs_Et_stack_filled.pdf", 1001);

    OverlayAndSaveStack(back_h_leading_conejets_cellstowers_pT_arr, nJZSlices_, "c_leadConeCellsTowers_stackedfilled", overlayedJZSliceDir + "overlay_lead_conejet_cellstowers_pT_stack_filled.pdf", 1001);
    OverlayAndSaveStack(back_h_subleading_conejets_cellstowers_pT_arr, nJZSlices_, "c_subleadConeCellsTowers_stackedfilled", overlayedJZSliceDir + "overlay_sublead_conejet_cellstowers_pT_stack_filled.pdf", 1001);

    OverlayAndSaveStack(back_h_leading_WTA_conejets_cellstowers_pT_arr, nJZSlices_, "c_WTA_leadConeCellsTowers_stackedfilled", overlayedJZSliceDir + "overlay_wta_lead_conejet_cellstowers_pT_stack_filled.pdf", 1001);
    OverlayAndSaveStack(back_h_subleading_WTA_conejets_cellstowers_pT_arr, nJZSlices_, "c_WTA_subleadConeCellsTowers_stackedfilled", overlayedJZSliceDir + "overlay_wta_sublead_conejet_cellstowers_pT_stack_filled.pdf", 1001);

    OverlayAndSaveStack(back_h_leading_conejets_basicclusters_pT_arr, nJZSlices_, "c_leadConeBasicClusters_stackedfilled", overlayedJZSliceDir + "overlay_lead_conejet_basicclusters_pT_stack_filled.pdf", 1001);
    OverlayAndSaveStack(back_h_subleading_conejets_cellstowers_pT_arr, nJZSlices_, "c_subleadConeBasicClusters_stackedfilled", overlayedJZSliceDir + "overlay_sublead_conejet_basicclusters_pT_stack_filled.pdf", 1001);

    OverlayAndSaveStack(back_h_leading_WTA_conejets_basicclusters_pT_arr, nJZSlices_, "c_WTA_leadConeBasicClusters_stackedfilled", overlayedJZSliceDir + "overlay_wta_lead_conejet_basicclusters_pT_stack_filled.pdf", 1001);
    OverlayAndSaveStack(back_h_subleading_WTA_conejets_basicclusters_pT_arr, nJZSlices_, "c_WTA_subleadConeBasicClusters_stackedfilled", overlayedJZSliceDir + "overlay_wta_sublead_conejet_basicclusters_pT_stack_filled.pdf", 1001);

    OverlayAndSaveStack(back_h_leading_LRJ_Et_arr,  nJZSlices_, "c_leadLRJ_stackedopen", overlayedJZSliceDir + "overlay_leading_LRJ_Et_stack_open.pdf", 0);
    OverlayAndSaveStack(back_h_subleading_LRJ_Et_arr, nJZSlices_, "c_subleadLRJ_stackedopen", overlayedJZSliceDir + "overlay_subleading_LRJ_Et_stack_open.pdf", 0);

    OverlayAndSaveStack(back_h_gFEX_leading_LRJ_Et_arr, nJZSlices_, "c_gFEX_leadLRJ_stackedopen", overlayedJZSliceDir + "overlay_gFEX_leading_LRJ_Et_stack_open.pdf", 0);
    OverlayAndSaveStack(back_h_gFEX_subleading_LRJ_Et_arr, nJZSlices_, "c_gFEX_subLRJ_stackedopen", overlayedJZSliceDir + "overlay_gFEX_subleading_LRJ_Et_stack_open.pdf", 0);

    OverlayAndSaveStack(back_h_jFEX_leading_LRJ_Et_arr, nJZSlices_, "c_jFEX_leadLRJ_stackedopen",   overlayedJZSliceDir + "overlay_jFEX_leading_LRJ_Et_stack_open.pdf", 0);
    OverlayAndSaveStack(back_h_jFEX_subleading_LRJ_Et_arr, nJZSlices_, "c_jFEX_subLRJ_stackedopen", overlayedJZSliceDir + "overlay_jFEX_subleading_LRJ_Et_stack_open.pdf", 0);

    OverlayAndSaveStack(back_h_gFEX_leading_SRJ_Et_arr, nJZSlices_, "c_gFEX_leadSRJ_stackedopen", overlayedJZSliceDir + "overlay_gFEX_leading_SRJ_Et_stack_open.pdf", 0);
    OverlayAndSaveStack(back_h_gFEX_subleading_SRJ_Et_arr, nJZSlices_, "c_gFEX_subSRJ_stackedopen", overlayedJZSliceDir + "overlay_gFEX_subleading_SRJ_Et_stack_open.pdf", 0);

    OverlayAndSaveStack(back_h_jFEX_leading_SRJ_Et_arr, nJZSlices_, "c_jFEX_leadSRJ_stackedopen",   overlayedJZSliceDir + "overlay_jFEX_leading_SRJ_Et_stack_open.pdf", 0);
    OverlayAndSaveStack(back_h_jFEX_subleading_SRJ_Et_arr, nJZSlices_, "c_jFEX_subSRJ_stackedopen", overlayedJZSliceDir + "overlay_jFEX_subleading_SRJ_Et_stack_open.pdf", 0);

    OverlayAndSaveStack(back_h_leading_offlineLRJ_Et_arr, nJZSlices_, "c_off_leadLRJ_stackedopen", overlayedJZSliceDir + "overlay_offline_leading_LRJ_Et_stack_open.pdf", 0);
    OverlayAndSaveStack(back_h_subleading_offlineLRJ_Et_arr,nJZSlices_, "c_off_subLRJ_stackedopen", overlayedJZSliceDir + "overlay_offline_subleading_LRJ_Et_stack_open.pdf", 0);

    OverlayAndSaveStack(back_h_leading_truthSRJs_Et_arr, nJZSlices_, "c_truth_leadSRJ_stackedopen", overlayedJZSliceDir + "overlay_truth_leading_SRJs_Et_stack_open.pdf", 0);
    OverlayAndSaveStack(back_h_subleading_truthSRJs_Et_arr, nJZSlices_, "c_truth_subSRJ_stackedopen", overlayedJZSliceDir + "overlay_truth_subleading_SRJs_Et_stack_open.pdf", 0);

    OverlayAndSaveStack(back_h_leading_conejets_cellstowers_pT_arr, nJZSlices_, "c_leadConeCellsTowers_stackedopen", overlayedJZSliceDir + "overlay_lead_conejet_cellstowers_pT_stack_open.pdf", 0);
    OverlayAndSaveStack(back_h_subleading_conejets_cellstowers_pT_arr, nJZSlices_, "c_subleadConeCellsTowers_stackedopen", overlayedJZSliceDir + "overlay_sublead_conejet_cellstowers_pT_stack_open.pdf", 0);

    OverlayAndSaveStack(back_h_leading_WTA_conejets_cellstowers_pT_arr, nJZSlices_, "c_WTA_leadConeCellsTowers_stackedopen", overlayedJZSliceDir + "overlay_wta_lead_conejet_cellstowers_pT_stack_open.pdf", 0);
    OverlayAndSaveStack(back_h_subleading_WTA_conejets_cellstowers_pT_arr, nJZSlices_, "c_WTA_subleadConeCellsTowers_stackedopen", overlayedJZSliceDir + "overlay_wta_sublead_conejet_cellstowers_pT_stack_open.pdf", 0);

    OverlayAndSaveStack(back_h_leading_conejets_basicclusters_pT_arr, nJZSlices_, "c_leadConeBasicClusters_stackedopen", overlayedJZSliceDir + "overlay_lead_conejet_basicclusters_pT_stack_open.pdf", 0);
    OverlayAndSaveStack(back_h_subleading_conejets_cellstowers_pT_arr, nJZSlices_, "c_subleadConeBasicClusters_stackedopen", overlayedJZSliceDir + "overlay_sublead_conejet_basicclusters_pT_stack_open.pdf", 0);

    OverlayAndSaveStack(back_h_leading_WTA_conejets_basicclusters_pT_arr, nJZSlices_, "c_WTA_leadConeBasicClusters_stackedopen", overlayedJZSliceDir + "overlay_wta_lead_conejet_basicclusters_pT_stack_open.pdf", 0);
    OverlayAndSaveStack(back_h_subleading_WTA_conejets_basicclusters_pT_arr, nJZSlices_, "c_WTA_subleadConeBasicClusters_stackedopen", overlayedJZSliceDir + "overlay_wta_sublead_conejet_basicclusters_pT_stack_open.pdf", 0);

    TCanvas cLog;
    cLog.SetLogy();
    cLog.cd();
    back_h_leading_LRJ_Et->Draw("HIST");
    cLog.SaveAs(modifiedOutputFileDir + "back_leading_LRJ_Et_events.pdf");

    back_h_gFEX_leading_LRJ_Et->Draw("HIST");
    cLog.SaveAs(modifiedOutputFileDir + "back_h_gFEX_leading_LRJ_Et_events.pdf");

    back_h_jFEX_leading_LRJ_Et->Draw("HIST");
    cLog.SaveAs(modifiedOutputFileDir + "back_h_jFEX_leading_LRJ_Et_events.pdf");

    back_h_leading_offlineLRJ_Et->Draw("HIST");
    cLog.SaveAs(modifiedOutputFileDir + "back_leading_offline_LRJ_Et_events.pdf");

    sig_h_leading_LRJ_Et->Scale(1.0 / sig_h_leading_LRJ_Et->Integral());
    back_h_leading_LRJ_Et->Scale(1.0 / back_h_leading_LRJ_Et->Integral());
    sig_h_leading_LRJ_Et->SetLineColor(kRed);
    back_h_leading_LRJ_Et->SetLineColor(kBlue);
    back_h_leading_LRJ_Et->Draw("HIST");
    sig_h_leading_LRJ_Et->Draw("HIST SAME");
    
    leg->Draw();
    cLog.SaveAs(modifiedOutputFileDir + "leading_LRJ_Et.pdf");

    sig_h_gFEX_leading_LRJ_Et->Scale(1.0 / sig_h_gFEX_leading_LRJ_Et->Integral());
    back_h_gFEX_leading_LRJ_Et->Scale(1.0 / back_h_gFEX_leading_LRJ_Et->Integral());
    sig_h_gFEX_leading_LRJ_Et->SetLineColor(kRed);
    back_h_gFEX_leading_LRJ_Et->SetLineColor(kBlue);
    back_h_gFEX_leading_LRJ_Et->Draw("HIST");
    sig_h_gFEX_leading_LRJ_Et->Draw("HIST SAME");
    
    leg->Draw();
    cLog.SaveAs(modifiedOutputFileDir + "leading_gFEX_LRJ_Et.pdf");

    sig_h_jFEX_leading_LRJ_Et->Scale(1.0 / sig_h_jFEX_leading_LRJ_Et->Integral());
    back_h_jFEX_leading_LRJ_Et->Scale(1.0 / back_h_jFEX_leading_LRJ_Et->Integral());
    sig_h_jFEX_leading_LRJ_Et->SetLineColor(kRed);
    back_h_jFEX_leading_LRJ_Et->SetLineColor(kBlue);
    back_h_jFEX_leading_LRJ_Et->Draw("HIST");
    sig_h_jFEX_leading_LRJ_Et->Draw("HIST SAME");
    
    leg->Draw();
    cLog.SaveAs(modifiedOutputFileDir + "leading_jFEX_LRJ_Et.pdf");

    //std::cout << "Subleading signal mean: " << sig_h_subleading_LRJ_Et->GetMean() << " and subleading background mean: " << back_h_subleading_LRJ_Et->GetMean() << "\n";
    sig_h_subleading_LRJ_Et->Scale(1.0 / sig_h_subleading_LRJ_Et->Integral());
    back_h_subleading_LRJ_Et->Scale(1.0 / back_h_subleading_LRJ_Et->Integral());
    sig_h_subleading_LRJ_Et->SetLineColor(kRed);
    back_h_subleading_LRJ_Et->SetLineColor(kBlue);
    back_h_subleading_LRJ_Et->Draw("HIST");
    sig_h_subleading_LRJ_Et->Draw("HIST SAME");
    
    leg->Draw();
    cLog.SaveAs(modifiedOutputFileDir + "subleading_LRJ_Et.pdf");

    sig_h_gFEX_subleading_LRJ_Et->Scale(1.0 / sig_h_gFEX_subleading_LRJ_Et->Integral());
    back_h_gFEX_subleading_LRJ_Et->Scale(1.0 / back_h_gFEX_subleading_LRJ_Et->Integral());
    sig_h_gFEX_subleading_LRJ_Et->SetLineColor(kRed);
    back_h_gFEX_subleading_LRJ_Et->SetLineColor(kBlue);
    back_h_gFEX_subleading_LRJ_Et->Draw("HIST");
    sig_h_gFEX_subleading_LRJ_Et->Draw("HIST SAME");
    
    leg->Draw();
    cLog.SaveAs(modifiedOutputFileDir + "subleading_gFEX_LRJ_Et.pdf");

    sig_h_jFEX_subleading_LRJ_Et->Scale(1.0 / sig_h_jFEX_subleading_LRJ_Et->Integral());
    back_h_jFEX_subleading_LRJ_Et->Scale(1.0 / back_h_jFEX_subleading_LRJ_Et->Integral());
    sig_h_jFEX_subleading_LRJ_Et->SetLineColor(kRed);
    back_h_jFEX_subleading_LRJ_Et->SetLineColor(kBlue);
    back_h_jFEX_subleading_LRJ_Et->Draw("HIST");
    sig_h_jFEX_subleading_LRJ_Et->Draw("HIST SAME");
    
    leg->Draw();
    cLog.SaveAs(modifiedOutputFileDir + "subleading_jFEX_LRJ_Et.pdf");


    sig_h_LRJ_E->Scale(1.0 / sig_h_LRJ_E->Integral());
    back_h_LRJ_E->Scale(1.0 / back_h_LRJ_E->Integral());
    sig_h_LRJ_E->SetLineColor(kRed);
    back_h_LRJ_E->SetLineColor(kBlue);
    sig_h_LRJ_E->Draw("HIST");
    back_h_LRJ_E->Draw("HIST SAME");
    
    leg->Draw();
    cLog.SaveAs(modifiedOutputFileDir + "LRJ_Energy.pdf");

    sig_h_leading_offlineLRJ_Et->Scale(1.0 / sig_h_leading_offlineLRJ_Et->Integral());
    back_h_leading_offlineLRJ_Et->Scale(1.0 / back_h_leading_offlineLRJ_Et->Integral());
    sig_h_leading_offlineLRJ_Et->SetLineColor(kRed);
    back_h_leading_offlineLRJ_Et->SetLineColor(kBlue);
    
    back_h_leading_offlineLRJ_Et->Draw("HIST");
    sig_h_leading_offlineLRJ_Et->Draw("HIST SAME");
    
    leg->Draw();

    cLog.SaveAs(modifiedOutputFileDir + "leading_offline_LRJ_Et.pdf");

    sig_h_subleading_offlineLRJ_Et->Scale(1.0 / sig_h_subleading_offlineLRJ_Et->Integral());
    back_h_subleading_offlineLRJ_Et->Scale(1.0 / back_h_subleading_offlineLRJ_Et->Integral());
    sig_h_subleading_offlineLRJ_Et->SetLineColor(kRed);
    back_h_subleading_offlineLRJ_Et->SetLineColor(kBlue);
    
    back_h_subleading_offlineLRJ_Et->Draw("HIST");
    sig_h_subleading_offlineLRJ_Et->Draw("HIST SAME");
    
    leg->Draw();

    cLog.SaveAs(modifiedOutputFileDir + "subleading_offline_LRJ_Et.pdf");

    c.cd();

    sigDiamvsEt->Draw("COLZ");
    c.SaveAs(modifiedOutputFileDir + "EtvsDiamSignal.pdf");

    leadingHiggsVsSubleadingHiggspT->Draw("COLZ");
    leadingHiggsVsSubleadingHiggspT->Scale(1.0 / leadingHiggsVsSubleadingHiggspT->Integral());
    c.SaveAs(modifiedOutputFileDir + "leadingHiggsVsSubleadingHiggspT.pdf");

    leadingbVsSubleadingbpT_LeadingHiggs->Draw("COLZ");
    leadingbVsSubleadingbpT_LeadingHiggs->Scale(1.0 / leadingbVsSubleadingbpT_LeadingHiggs->Integral());
    c.SaveAs(modifiedOutputFileDir + "leadingbVsSubleadingbpT_LeadingHiggs.pdf");

    leadingbVsSubleadingbpT_SubleadingHiggs->Draw("COLZ");
    leadingbVsSubleadingbpT_SubleadingHiggs->Scale(1.0 / leadingbVsSubleadingbpT_SubleadingHiggs->Integral());
    c.SaveAs(modifiedOutputFileDir + "leadingbVsSubleadingbpT_SubleadingHiggs.pdf");

    backDiamvsEt->Draw("COLZ");
    c.SaveAs(modifiedOutputFileDir + "EtvsDiamBack.pdf");

    sigJetTaggerLeadingLRJEtvsPsi_R->Draw("COLZ");
    sigJetTaggerLeadingLRJEtvsPsi_R->Scale(1.0 / sigJetTaggerLeadingLRJEtvsPsi_R->Integral());
    c.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvsPsi_R.pdf");

    sigJetTaggerSubleadingLRJEtvsPsi_R->Draw("COLZ");
    sigJetTaggerSubleadingLRJEtvsPsi_R->Scale(1.0 / sigJetTaggerSubleadingLRJEtvsPsi_R->Integral());
    c.SaveAs(modifiedOutputFileDir + "sigJetTaggerSubleadingLRJEtvsPsi_R.pdf");

    sigJetTaggerLeadingLRJEtvsPsi_R_squared->Draw("COLZ");
    sigJetTaggerLeadingLRJEtvsPsi_R_squared->Scale(1.0 / sigJetTaggerLeadingLRJEtvsPsi_R_squared->Integral());
    c.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvsPsi_R_squared.pdf");

    sigJetTaggerSubleadingLRJEtvsPsi_R_squared->Draw("COLZ");
    sigJetTaggerSubleadingLRJEtvsPsi_R_squared->Scale(1.0 / sigJetTaggerSubleadingLRJEtvsPsi_R_squared->Integral());
    c.SaveAs(modifiedOutputFileDir + "sigJetTaggerSubleadingLRJEtvsPsi_R_squared.pdf");

    TCanvas cLogZ;
    cLogZ.SetLogz();

    cLogZ.cd();
    
    backJetTaggerLeadingLRJEtvsPsi_R_squared->Draw("COLZ");
    backJetTaggerLeadingLRJEtvsPsi_R_squared->Scale(1.0 / backJetTaggerLeadingLRJEtvsPsi_R_squared->Integral());
    backJetTaggerLeadingLRJEtvsPsi_R_squared->SetMinimum(1e-14);
    cLogZ.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvsPsi_R_squared.pdf");
    
    backJetTaggerSubleadingLRJEtvsPsi_R_squared->Draw("COLZ");
    backJetTaggerSubleadingLRJEtvsPsi_R_squared->Scale(1.0 / backJetTaggerSubleadingLRJEtvsPsi_R_squared->Integral());
    backJetTaggerSubleadingLRJEtvsPsi_R_squared->SetMinimum(1e-14);
    cLogZ.SaveAs(modifiedOutputFileDir + "backJetTaggerSubleadingLRJEtvsPsi_R_squared.pdf");

    c.cd();
    
    char rhoText_Sig_Psi_R[128];
    sprintf(rhoText_Sig_Psi_R, "Pearson #rho = %.3f", sigJetTaggerLeadingLRJPsi_RvsSubleadingPsi_R->GetCorrelationFactor());
    //std::cout << "rhoText_Sig_Psi_R: " << rhoText_Sig_Psi_R << "\n";
    
    sigJetTaggerLeadingLRJPsi_RvsSubleadingPsi_R->Draw("COLZ");
    sigJetTaggerLeadingLRJPsi_RvsSubleadingPsi_R->Scale(1.0 / sigJetTaggerLeadingLRJPsi_RvsSubleadingPsi_R->Integral());
    mySmallText(0.15, 0.05, kBlack, rhoText_Sig_Psi_R);
    c.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJPsi_RvsSubleadingPsi_R.pdf");

    cLogZ.cd();

    
    backJetTaggerLeadingLRJEtvsPsi_12->Draw("COLZ");
    backJetTaggerLeadingLRJEtvsPsi_12->Scale(1.0 / backJetTaggerLeadingLRJEtvsPsi_12->Integral());
    backJetTaggerLeadingLRJEtvsPsi_12->SetMinimum(1e-14);
    cLogZ.SaveAs(modifiedOutputFileDir + "backOfflineLeadingLRJEtvsPsi_R_12.pdf");

    
    backJetTaggerSubleadingLRJEtvsPsi_R2_12->Draw("COLZ");
    backJetTaggerSubleadingLRJEtvsPsi_R2_12->Scale(1.0 / backJetTaggerSubleadingLRJEtvsPsi_R2_12->Integral());
    backJetTaggerSubleadingLRJEtvsPsi_R2_12->SetMinimum(1e-14);
    cLogZ.SaveAs(modifiedOutputFileDir + "backJetTaggerSubleadingLRJEtvsPsi_R2_12.pdf");

    backJetTaggerLeadingLRJEtvsPsi_R2_12->Draw("COLZ");
    backJetTaggerLeadingLRJEtvsPsi_R2_12->Scale(1.0 / backJetTaggerLeadingLRJEtvsPsi_R2_12->Integral());
    backJetTaggerLeadingLRJEtvsPsi_R2_12->SetMinimum(1e-14);
    cLogZ.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvsPsi_R2_12.pdf");

    
    backJetTaggerSubleadingLRJEtvsPsi_12->Draw("COLZ");
    backJetTaggerSubleadingLRJEtvsPsi_12->Scale(1.0 / backJetTaggerSubleadingLRJEtvsPsi_12->Integral());
    backJetTaggerSubleadingLRJEtvsPsi_12->SetMinimum(1e-14);
    cLogZ.SaveAs(modifiedOutputFileDir + "backOfflineSubleadingLRJEtvsPsi_R_12.pdf");

    char rhoText_Back_Psi_R[128];
    sprintf(rhoText_Back_Psi_R, "Pearson #rho = %.3f", backJetTaggerLeadingLRJPsi_RvsSubleadingPsi_R->GetCorrelationFactor());
    
    
    backJetTaggerLeadingLRJPsi_RvsSubleadingPsi_R->Draw("COLZ");
    backJetTaggerLeadingLRJPsi_RvsSubleadingPsi_R->Scale(1.0 / backJetTaggerLeadingLRJPsi_RvsSubleadingPsi_R->Integral());
    backJetTaggerLeadingLRJPsi_RvsSubleadingPsi_R->SetMinimum(1e-14);
    mySmallText(0.15, 0.05, kBlack, rhoText_Back_Psi_R);
    
    
    cLogZ.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJPsi_RvsSubleadingPsi_R.pdf");

    
    backJetTaggerLeadingLRJEtvsPsi_R->Draw("COLZ");
    backJetTaggerLeadingLRJEtvsPsi_R->Scale(1.0 / backJetTaggerLeadingLRJEtvsPsi_R->Integral());
    backJetTaggerLeadingLRJEtvsPsi_R->SetMinimum(1e-14);
    cLogZ.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvsPsi_R.pdf");

    sigOfflineLeadingLRJMassvsPsi_R->Draw("COLZ");
    sigOfflineLeadingLRJMassvsPsi_R->Scale(1.0 / sigOfflineLeadingLRJMassvsPsi_R->Integral());
    cLogZ.SaveAs(modifiedOutputFileDir + "sigOfflineLeadingLRJMassvsPsi_R.pdf");

    
    backOfflineLeadingLRJMassvsPsi_R->Draw("COLZ");
    backOfflineLeadingLRJMassvsPsi_R->Scale(1.0 / backOfflineLeadingLRJMassvsPsi_R->Integral());
    backOfflineLeadingLRJMassvsPsi_R->SetMinimum(1e-10);
    cLogZ.SaveAs(modifiedOutputFileDir + "backOfflineLeadingLRJMassvsPsi_R.pdf");

    
    backJetTaggerSubleadingLRJEtvsPsi_R->Draw("COLZ");
    backJetTaggerSubleadingLRJEtvsPsi_R->Scale(1.0 / backJetTaggerSubleadingLRJEtvsPsi_R->Integral());
    backJetTaggerSubleadingLRJEtvsPsi_R->SetMinimum(1e-14);
    cLogZ.SaveAs(modifiedOutputFileDir + "backJetTaggerSubleadingLRJEtvsPsi_R.pdf");

    c.cd();

    // Computed with deltaR^2 metric
    sigJetTaggerLeadingLRJEtvsPsi_R2->Draw("COLZ");
    sigJetTaggerLeadingLRJEtvsPsi_R2->Scale(1.0 / sigJetTaggerLeadingLRJEtvsPsi_R2->Integral());
    c.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvsPsi_R2.pdf");

    sigJetTaggerSubleadingLRJEtvsPsi_R2->Draw("COLZ");
    sigJetTaggerSubleadingLRJEtvsPsi_R2->Scale(1.0 / sigJetTaggerSubleadingLRJEtvsPsi_R2->Integral());
    c.SaveAs(modifiedOutputFileDir + "sigJetTaggerSubleadingLRJEtvsPsi_R2.pdf");

    sigJetTaggerLeadingLRJEtvsPsi_R2_squared->Draw("COLZ");
    sigJetTaggerLeadingLRJEtvsPsi_R2_squared->Scale(1.0 / sigJetTaggerLeadingLRJEtvsPsi_R2_squared->Integral());
    c.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvsPsi_R2_squared.pdf");
    
    cLogZ.cd();
    sigJetTaggerLeadingLRJEtvsPsi_12->Draw("COLZ");
    sigJetTaggerLeadingLRJEtvsPsi_12->Scale(1.0 / sigJetTaggerLeadingLRJEtvsPsi_12->Integral());
    cLogZ.SaveAs(modifiedOutputFileDir + "sigOfflineLeadingLRJEtvsPsi_R_12.pdf");
    
    sigJetTaggerSubleadingLRJEtvsPsi_12->Draw("COLZ");
    sigJetTaggerSubleadingLRJEtvsPsi_12->Scale(1.0 / sigJetTaggerSubleadingLRJEtvsPsi_12->Integral());
    cLogZ.SaveAs(modifiedOutputFileDir + "sigOfflineSubleadingLRJEtvsPsi_R_12.pdf");

    sigJetTaggerLeadingLRJEtvsPsi_R2_12->Draw("COLZ");
    sigJetTaggerLeadingLRJEtvsPsi_R2_12->Scale(1.0 / sigJetTaggerLeadingLRJEtvsPsi_R2_12->Integral());
    cLogZ.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvsPsi_R2_12.pdf");
    
    sigJetTaggerSubleadingLRJEtvsPsi_R2_12->Draw("COLZ");
    sigJetTaggerSubleadingLRJEtvsPsi_R2_12->Scale(1.0 / sigJetTaggerSubleadingLRJEtvsPsi_12->Integral());
    cLogZ.SaveAs(modifiedOutputFileDir + "sigJetTaggerSubleadingLRJEtvsPsi_R2_12.pdf");

    sigJetTaggerSubleadingLRJEtvsPsi_R2_squared->Draw("COLZ");
    sigJetTaggerSubleadingLRJEtvsPsi_R2_squared->Scale(1.0 / sigJetTaggerSubleadingLRJEtvsPsi_R2_squared->Integral());
    cLogZ.SaveAs(modifiedOutputFileDir + "sigJetTaggerSubleadingLRJEtvsPsi_R2_squared.pdf");

    backJetTaggerLeadingLRJEtvsPsi_R2_squared->Draw("COLZ");
    backJetTaggerLeadingLRJEtvsPsi_R2_squared->Scale(1.0 / backJetTaggerLeadingLRJEtvsPsi_R2_squared->Integral());
    backOfflineLeadingLRJMassvsEt->SetMinimum(1e-14);
    cLogZ.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvsPsi_R2_squared.pdf");

    c.cd();
    
    backJetTaggerSubleadingLRJEtvsPsi_R2_squared->Draw("COLZ");
    backJetTaggerSubleadingLRJEtvsPsi_R2_squared->Scale(1.0 / backJetTaggerSubleadingLRJEtvsPsi_R2_squared->Integral());
    c.SaveAs(modifiedOutputFileDir + "backJetTaggerSubleadingLRJEtvsPsi_R2_squared.pdf");

    sigJetTaggerLeadingLRJPsi_R2vsSubleadingPsi_R2->Scale(1.0 / sigJetTaggerLeadingLRJPsi_R2vsSubleadingPsi_R2->Integral());
    sigJetTaggerLeadingLRJPsi_R2vsSubleadingPsi_R2->Draw("COLZ");
    c.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJPsi_R2vsSubleadingPsi_R2.pdf");

    backJetTaggerLeadingLRJPsi_R2vsSubleadingPsi_R2->Draw("COLZ");
    backJetTaggerLeadingLRJPsi_R2vsSubleadingPsi_R2->Scale(1.0 / backJetTaggerLeadingLRJPsi_R2vsSubleadingPsi_R2->Integral());
    c.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJPsi_R2vsSubleadingPsi_R2.pdf");
    cLogZ.cd();

    backJetTaggerLeadingLRJEtvsPsi_R2->Draw("COLZ");
    backJetTaggerLeadingLRJEtvsPsi_R2->Scale(1.0 / backJetTaggerLeadingLRJEtvsPsi_R2->Integral());
    cLogZ.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvsPsi_R2.pdf");

    backJetTaggerSubleadingLRJEtvsPsi_R2->Draw("COLZ");
    backJetTaggerSubleadingLRJEtvsPsi_R2->Scale(1.0 / backJetTaggerSubleadingLRJEtvsPsi_R2->Integral());
    cLogZ.SaveAs(modifiedOutputFileDir + "backJetTaggerSubleadingLRJEtvsPsi_R2.pdf");

    sigOfflineLeadingLRJMassvsEt->Scale(1.0 / sigOfflineLeadingLRJMassvsEt->Integral());
    sigOfflineLeadingLRJMassvsEt->Draw("COLZ");
    cLogZ.SaveAs(modifiedOutputFileDir + "sigOfflineLeadingLRJMassvsEt.pdf");

    sigOfflineSubleadingLRJMassvsEt->Scale(1.0 / sigOfflineSubleadingLRJMassvsEt->Integral());
    sigOfflineSubleadingLRJMassvsEt->Draw("COLZ");
    cLogZ.SaveAs(modifiedOutputFileDir + "sigOfflineSubleadingLRJMassvsEt.pdf");

    char rhoText_Sig_Mass[128];
    sprintf(rhoText_Sig_Mass, "Pearson #rho = %.3f", sigOfflineSubleadingLRJMassvsLeadingLRJMass->GetCorrelationFactor());
    //std::cout << "rhoText_Sig_Mass: " << rhoText_Sig_Mass << "\n";
    
    sigOfflineSubleadingLRJMassvsLeadingLRJMass->Scale(1.0 / sigOfflineSubleadingLRJMassvsLeadingLRJMass->Integral());
    sigOfflineSubleadingLRJMassvsLeadingLRJMass->Draw("COLZ");
    mySmallText(0.15, 0.05, kBlack, rhoText_Sig_Mass);
    cLogZ.SaveAs(modifiedOutputFileDir + "sigOfflineSubleadingLRJMassvsLeadingLRJMass.pdf");

    
    backOfflineLeadingLRJMassvsEt->Draw("COLZ");
    
    backOfflineLeadingLRJMassvsEt->Scale(1.0 / backOfflineLeadingLRJMassvsEt->Integral());
    backOfflineLeadingLRJMassvsEt->SetMinimum(1e-14);
    cLogZ.SaveAs(modifiedOutputFileDir + "backOfflineLeadingLRJMassvsEt.pdf");

    char rhoText_Back_Mass[128];
    sprintf(rhoText_Back_Mass, "Pearson #rho = %.3f", backOfflineSubleadingLRJMassvsLeadingLRJMass->GetCorrelationFactor());
    
    backOfflineSubleadingLRJMassvsLeadingLRJMass->SetMinimum(1e-6);
    backOfflineSubleadingLRJMassvsLeadingLRJMass->Draw("COLZ");
    mySmallText(0.15, 0.05, kBlack, rhoText_Back_Mass);
    //backOfflineSubleadingLRJMassvsLeadingLRJMass->Scale(1.0 / backOfflineSubleadingLRJMassvsLeadingLRJMass->Integral());
    cLogZ.SaveAs(modifiedOutputFileDir + "backOfflineSubleadingLRJMassvsLeadingLRJMass.pdf");

    
    backOfflineSubleadingLRJMassvsEt->Draw("COLZ");
    backOfflineSubleadingLRJMassvsEt->Scale(1.0 / backOfflineSubleadingLRJMassvsEt->Integral());
    backOfflineSubleadingLRJMassvsEt->SetMinimum(1e-14);
    cLogZ.SaveAs(modifiedOutputFileDir + "backOfflineSubleadingLRJMassvsEt.pdf");

    c.cd();
    sigOfflineLeadingLRJMassvsSubjetMult->Draw("COLZ");
    c.SaveAs(modifiedOutputFileDir + "sigOfflineLeadingLRJMassvsSubjetMult.pdf");

    backOfflineLeadingLRJMassvsSubjetMult->Draw("COLZ");
    c.SaveAs(modifiedOutputFileDir + "backOfflineLeadingLRJMassvsSubjetMult.pdf");

    cLogZ.cd();
    sigOfflineLeadingLRJEtvsSubjetMult->Draw("COLZ");
    sigOfflineLeadingLRJEtvsSubjetMult->Scale(1.0 / sigOfflineLeadingLRJEtvsSubjetMult->Integral());
    cLogZ.SaveAs(modifiedOutputFileDir + "sigOfflineLeadingLRJEtvsSubjetMult.pdf");

    backJetTaggerLeadingLRJEtvsSubleadingLRJEt->Draw("COLZ");
    backJetTaggerLeadingLRJEtvsSubleadingLRJEt->Scale(1.0 / backJetTaggerLeadingLRJEtvsSubleadingLRJEt->Integral());
    backOfflineLeadingLRJEtvsSubjetMult->SetMinimum(1e-14);
    cLogZ.SaveAs(modifiedOutputFileDir + "backJetTaggerLeadingLRJEtvsSubleadingLRJEt.pdf");

    sigJetTaggerLeadingLRJEtvsSubleadingLRJEt->Draw("COLZ");
    sigJetTaggerLeadingLRJEtvsSubleadingLRJEt->Scale(1.0 / sigJetTaggerLeadingLRJEtvsSubleadingLRJEt->Integral());
    cLogZ.SaveAs(modifiedOutputFileDir + "sigJetTaggerLeadingLRJEtvsSubleadingLRJEt.pdf");
    

    

    backOfflineLeadingLRJEtvsSubjetMult->Draw("COLZ");
    backOfflineLeadingLRJEtvsSubjetMult->Scale(1.0 / backOfflineLeadingLRJEtvsSubjetMult->Integral());
    backOfflineLeadingLRJEtvsSubjetMult->SetMinimum(1e-14);
    cLogZ.SaveAs(modifiedOutputFileDir + "backOfflineLeadingLRJEtvsSubjetMult.pdf");

    TCanvas cLogYConeJets;
    cLogYConeJets.SetLogy();
    cLogYConeJets.cd();


    sig_h_leading_WTA_conecellstowers_pT->Scale(1.0 / sig_h_leading_WTA_conecellstowers_pT->Integral());
    back_h_leading_WTA_conecellstowers_pT->Scale(1.0 / back_h_leading_WTA_conecellstowers_pT->Integral());
    sig_h_leading_WTA_conecellstowers_pT->SetLineColor(kRed);
    back_h_leading_WTA_conecellstowers_pT->SetLineColor(kBlue);
    back_h_leading_WTA_conecellstowers_pT->Draw("HIST");
    sig_h_leading_WTA_conecellstowers_pT->Draw("HIST SAME");
    leg->Draw();
    cLogYConeJets.SaveAs(modifiedOutputFileDir + "leading_WTA_conecellstowers_pT.pdf");

    sig_h_subleading_WTA_conecellstowers_pT->Scale(1.0 / sig_h_subleading_WTA_conecellstowers_pT->Integral());
    back_h_subleading_WTA_conecellstowers_pT->Scale(1.0 / back_h_subleading_WTA_conecellstowers_pT->Integral());
    sig_h_subleading_WTA_conecellstowers_pT->SetLineColor(kRed);
    back_h_subleading_WTA_conecellstowers_pT->SetLineColor(kBlue);
    back_h_subleading_WTA_conecellstowers_pT->Draw("HIST");
    sig_h_subleading_WTA_conecellstowers_pT->Draw("HIST SAME");
    leg->Draw();
    cLogYConeJets.SaveAs(modifiedOutputFileDir + "subleading_WTA_conecellstowers_pT.pdf");

    sig_h_leading_WTA_conebasicclusters_pT->Scale(1.0 / sig_h_leading_WTA_conebasicclusters_pT->Integral());
    back_h_leading_WTA_conebasicclusters_pT->Scale(1.0 / back_h_leading_WTA_conebasicclusters_pT->Integral());
    sig_h_leading_WTA_conebasicclusters_pT->SetLineColor(kRed);
    back_h_leading_WTA_conebasicclusters_pT->SetLineColor(kBlue);
    back_h_leading_WTA_conebasicclusters_pT->Draw("HIST");
    sig_h_leading_WTA_conebasicclusters_pT->Draw("HIST SAME");
    leg->Draw();
    cLogYConeJets.SaveAs(modifiedOutputFileDir + "leading_WTA_conebasicclusters_pT.pdf");

    sig_h_subleading_WTA_conebasicclusters_pT->Scale(1.0 / sig_h_subleading_WTA_conebasicclusters_pT->Integral());
    back_h_subleading_WTA_conebasicclusters_pT->Scale(1.0 / back_h_subleading_WTA_conebasicclusters_pT->Integral());
    sig_h_subleading_WTA_conebasicclusters_pT->SetLineColor(kRed);
    back_h_subleading_WTA_conebasicclusters_pT->SetLineColor(kBlue);
    back_h_subleading_WTA_conebasicclusters_pT->Draw("HIST");
    sig_h_subleading_WTA_conebasicclusters_pT->Draw("HIST SAME");
    leg->Draw();
    cLogYConeJets.SaveAs(modifiedOutputFileDir + "subleading_WTA_conebasicclusters_pT.pdf");

    sig_h_WTA_conecellstowers_multiplicity->Scale(1.0 / sig_h_WTA_conecellstowers_multiplicity->Integral());
    back_h_WTA_conecellstowers_multiplicity->Scale(1.0 / back_h_WTA_conecellstowers_multiplicity->Integral());
    sig_h_WTA_conecellstowers_multiplicity->SetLineColor(kRed);
    back_h_WTA_conecellstowers_multiplicity->SetLineColor(kBlue);
    back_h_WTA_conecellstowers_multiplicity->Draw("HIST");
    sig_h_WTA_conecellstowers_multiplicity->Draw("HIST SAME");
    leg->Draw();
    cLogYConeJets.SaveAs(modifiedOutputFileDir + "WTA_conecellstowers_multiplicity.pdf");

    sig_h_WTA_conebasicclusters_multiplicity->Scale(1.0 / sig_h_WTA_conebasicclusters_multiplicity->Integral());
    back_h_WTA_conebasicclusters_multiplicity->Scale(1.0 / back_h_WTA_conebasicclusters_multiplicity->Integral());
    sig_h_WTA_conebasicclusters_multiplicity->SetLineColor(kRed);
    back_h_WTA_conebasicclusters_multiplicity->SetLineColor(kBlue);
    back_h_WTA_conebasicclusters_multiplicity->Draw("HIST");
    sig_h_WTA_conebasicclusters_multiplicity->Draw("HIST SAME");
    leg->Draw();
    cLogYConeJets.SaveAs(modifiedOutputFileDir + "WTA_conebasicclusters_multiplicity.pdf");

    c.cd();
    sigOfflineLeadingLRJMass->Scale(1.0 / sigOfflineLeadingLRJMass->Integral());
    backOfflineLeadingLRJMass->Scale(1.0 / backOfflineLeadingLRJMass->Integral());
    sigOfflineLeadingLRJMass->SetLineColor(kRed);
    backOfflineLeadingLRJMass->SetLineColor(kBlue);
    backOfflineLeadingLRJMass->Draw("HIST");
    sigOfflineLeadingLRJMass->Draw("HIST SAME");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "leadingOfflineLRJMass.pdf");

    sigOfflineSubleadingLRJMass->Scale(1.0 / sigOfflineSubleadingLRJMass->Integral());
    backOfflineSubleadingLRJMass->Scale(1.0 / backOfflineSubleadingLRJMass->Integral());
    sigOfflineSubleadingLRJMass->SetLineColor(kRed);
    backOfflineSubleadingLRJMass->SetLineColor(kBlue);
    backOfflineSubleadingLRJMass->Draw("HIST");
    sigOfflineSubleadingLRJMass->Draw("HIST SAME");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "subleadingOfflineLRJMass.pdf");

    sigDeltaRLeadingSubleadingTruthJets->Scale(1.0 / sigDeltaRLeadingSubleadingTruthJets->Integral());
    backDeltaRLeadingSubleadingTruthJets->Scale(1.0 / backDeltaRLeadingSubleadingTruthJets->Integral());
    sigDeltaRLeadingSubleadingTruthJets->SetLineColor(kRed);
    backDeltaRLeadingSubleadingTruthJets->SetLineColor(kBlue);
    backDeltaRLeadingSubleadingTruthJets->Draw("HIST");
    sigDeltaRLeadingSubleadingTruthJets->Draw("HIST SAME");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "deltaRLeadingSubleadingTruthJets.pdf");
    


    sig_h_LRJ_substruct->Scale(1.0 / sig_h_LRJ_substruct->Integral());
    back_h_LRJ_substruct->Scale(1.0 / back_h_LRJ_substruct->Integral());
    sig_h_LRJ_substruct->SetLineColor(kRed);
    back_h_LRJ_substruct->SetLineColor(kBlue);
    
    
    sig_h_LRJ_substruct->Draw("HIST");
    back_h_LRJ_substruct->Draw("HIST SAME");
    leg_Psi_R->Draw();
    c.SaveAs(modifiedOutputFileDir + "LRJ_Psi_R.pdf");

    sig_h_LRJ_eta->SetLineColor(kRed);
    back_h_LRJ_eta->SetLineColor(kBlue);
    sig_h_LRJ_eta->Draw();
    back_h_LRJ_eta->Draw("SAME");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "LRJ_eta.pdf");

    sig_h_LRJ_phi->SetLineColor(kRed);
    back_h_LRJ_phi->SetLineColor(kBlue);
    sig_h_LRJ_phi->Draw();
    back_h_LRJ_phi->Draw("SAME");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "LRJ_phi.pdf");

    // Build overlaid efficiency histograms (background first)
    auto be100 = (TH1F*)h_back_num100->Clone(Form("back_eff_offlineLRJ_Et_100_%d", fileIt));
    be100->SetDirectory(nullptr);
    be100->SetTitle("Emulated Trigger Efficiency (Background);Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)");
    be100->Divide(h_back_num100, h_back_denom100 , 1.0, 1.0, "B"); // binomial errors
    be100->SetAxisRange(0.0, 1.1, "Y");
    back_eff_100.push_back(be100);

    auto be200 = (TH1F*)h_back_num200->Clone(Form("back_eff_offlineLRJ_Et_200_%d", fileIt));
    be200->SetDirectory(nullptr);
    be200->SetTitle("Emulated Trigger Efficiency (Background);Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)");
    be200->Divide(h_back_num200, h_back_denom200, 1.0, 1.0, "B");
    be200->SetAxisRange(0.0, 1.1, "Y");
    back_eff_200.push_back(be200);

    auto be300 = (TH1F*)h_back_num300->Clone(Form("back_eff_offlineLRJ_Et_300_%d", fileIt));
    be300->SetDirectory(nullptr);
    be300->SetTitle("Emulated Trigger Efficiency (Background);Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)");
    be300->Divide(h_back_num300, h_back_denom300, 1.0, 1.0, "B");
    be300->SetAxisRange(0.0, 1.1, "Y");
    back_eff_300.push_back(be300);

    // Signal
    auto se100 = (TH1F*)h_sig_num100->Clone(Form("sig_eff_offlineLRJ_Et_100_%d", fileIt));
    se100->SetDirectory(nullptr);
    se100->SetTitle("Emulated Trigger Efficiency (Signal);Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)");
    se100->Divide(h_sig_num100, h_sig_denom100, 1.0, 1.0, "B");
    se100->SetAxisRange(0.0, 1.1, "Y");
    sig_eff_100.push_back(se100);

    auto se250 = (TH1F*)h_sig_num250->Clone(Form("sig_eff_offlineLRJ_Et_250_%d", fileIt));
    se250->SetDirectory(nullptr);
    se250->SetTitle("Emulated Trigger Efficiency (Signal);Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)");
    se250->Divide(h_sig_num250, h_sig_denom250, 1.0, 1.0, "B");
    se250->SetAxisRange(0.0, 1.1, "Y");
    sig_eff_250.push_back(se250);

    auto se400 = (TH1F*)h_sig_num400->Clone(Form("sig_eff_offlineLRJ_Et_400_%d", fileIt));
    se400->SetDirectory(nullptr);
    se400->SetTitle("Emulated Trigger Efficiency (Signal);Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)");
    se400->Divide(h_sig_num400, h_sig_denom400, 1.0, 1.0, "B");
    se400->SetAxisRange(0.0, 1.1, "Y");
    sig_eff_400.push_back(se400);


    // Draw signal JetTagger efficiency curves by dividing numerator, denominator TH1Fs

    TH1F* sig_eff_offlineLRJ10kHz = (TH1F*)sig_h_offlineLRJ_Et_num10kHz->Clone();
    sig_eff_offlineLRJ10kHz->SetName("eff_LRJ10kHz");
    sig_eff_offlineLRJ10kHz->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ10kHz->Divide(sig_h_offlineLRJ_Et_num10kHz, sig_h_offlineLRJ_Et_denom10kHz, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ10kHz->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ10kHz->Draw();
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ10kHz.pdf");

    sig_eff_offlineLRJ10kHz_vec.push_back(sig_eff_offlineLRJ10kHz);

    TH1F* sig_eff_offlineLRJ10kHz_HiggsMassWindow = (TH1F*)sig_h_offlineLRJ_Et_num10kHz_HiggsMassWindow->Clone();
    sig_eff_offlineLRJ10kHz_HiggsMassWindow->SetName("eff_LRJ10kHz");
    sig_eff_offlineLRJ10kHz_HiggsMassWindow->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ10kHz_HiggsMassWindow->Divide(sig_h_offlineLRJ_Et_num10kHz_HiggsMassWindow, sig_h_offlineLRJ_Et_denom10kHz_HiggsMassWindow, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ10kHz_HiggsMassWindow->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ10kHz_HiggsMassWindow->Draw();
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ10kHz_HiggsMassWindow.pdf");

    sig_eff_offlineLRJ10kHz_HiggsMassWindow_vec.push_back(sig_eff_offlineLRJ10kHz_HiggsMassWindow);

    TH1F* sig_eff_offlineLRJ10kHz_1Subjet = (TH1F*)sig_h_offlineLRJ_Et_num10kHz_1Subjet->Clone();
    sig_eff_offlineLRJ10kHz_1Subjet->SetName("eff_LRJ10kHz");
    sig_eff_offlineLRJ10kHz_1Subjet->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ10kHz_1Subjet->Divide(sig_h_offlineLRJ_Et_num10kHz_1Subjet, sig_h_offlineLRJ_Et_denom10kHz_1Subjet, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ10kHz_1Subjet->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ10kHz_1Subjet->Draw();
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ10kHz_1Subjet.pdf");

    sig_eff_offlineLRJ10kHz_1Subjet_vec.push_back(sig_eff_offlineLRJ10kHz_1Subjet);


    TH1F* sig_eff_offlineLRJ10kHz_GrEq2Subjets = (TH1F*)sig_h_offlineLRJ_Et_num10kHz_GrEq2Subjets->Clone();
    sig_eff_offlineLRJ10kHz_GrEq2Subjets->SetName("eff_LRJ10kHz");
    sig_eff_offlineLRJ10kHz_GrEq2Subjets->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ10kHz_GrEq2Subjets->Divide(sig_h_offlineLRJ_Et_num10kHz_GrEq2Subjets, sig_h_offlineLRJ_Et_denom10kHz_GrEq2Subjets, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ10kHz_GrEq2Subjets->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ10kHz_GrEq2Subjets->Draw();
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ10kHz_GrEq2Subjets.pdf");

    sig_eff_offlineLRJ10kHz_GrEq2Subjets_vec.push_back(sig_eff_offlineLRJ10kHz_GrEq2Subjets);

    TH1F* sig_eff_offline_gFEX_LRJ10kHz = (TH1F*)sig_h_offlineLRJ_Et_num10kHz_gFexLRJ->Clone();
    sig_eff_offline_gFEX_LRJ10kHz->SetName("eff_gFEX_LRJ_10kHz");
    sig_eff_offline_gFEX_LRJ10kHz->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offline_gFEX_LRJ10kHz->Divide(sig_h_offlineLRJ_Et_num10kHz_gFexLRJ, sig_h_offlineLRJ_Et_denom10kHz_gFexLRJ, 1.0, 1.0, "B");
    
    sig_eff_offline_gFEX_LRJ10kHz->SetAxisRange(0, 1.1, "Y");

    sig_eff_offline_gFEX_LRJ10kHz->Draw();
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offline_gFEX_LRJ10kHz.pdf");

    TH1F* sig_eff_offline_gFEX_LRJ10kHz_HiggsMassWindow = (TH1F*)sig_h_offlineLRJ_Et_num10kHz_gFexLRJ_HiggsMassWindow->Clone();
    sig_eff_offline_gFEX_LRJ10kHz_HiggsMassWindow->SetName("eff_gFEX_LRJ_10kHz");
    sig_eff_offline_gFEX_LRJ10kHz_HiggsMassWindow->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offline_gFEX_LRJ10kHz_HiggsMassWindow->Divide(sig_h_offlineLRJ_Et_num10kHz_gFexLRJ_HiggsMassWindow, sig_h_offlineLRJ_Et_denom10kHz_gFexLRJ_HiggsMassWindow, 1.0, 1.0, "B");
    
    sig_eff_offline_gFEX_LRJ10kHz_HiggsMassWindow->SetAxisRange(0, 1.1, "Y");

    sig_eff_offline_gFEX_LRJ10kHz_HiggsMassWindow->Draw();
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offline_gFEX_LRJ10kHz_HiggsMassWindow.pdf");

    TH1F* sig_eff_offline_gFEX_LRJ10kHz_1Subjet = (TH1F*)sig_h_offlineLRJ_Et_num10kHz_gFexLRJ_1Subjet->Clone();
    sig_eff_offline_gFEX_LRJ10kHz_1Subjet->SetName("eff_gFEX_LRJ_10kHz");
    sig_eff_offline_gFEX_LRJ10kHz->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offline_gFEX_LRJ10kHz_1Subjet->Divide(sig_h_offlineLRJ_Et_num10kHz_gFexLRJ_1Subjet, sig_h_offlineLRJ_Et_denom10kHz_gFexLRJ_1Subjet, 1.0, 1.0, "B");
    
    sig_eff_offline_gFEX_LRJ10kHz_1Subjet->SetAxisRange(0, 1.1, "Y");

    sig_eff_offline_gFEX_LRJ10kHz_1Subjet->Draw();
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offline_gFEX_LRJ10kHz_1Subjet.pdf");

    TH1F* sig_eff_offline_gFEX_LRJ10kHz_GrEq2Subjets = (TH1F*)sig_h_offlineLRJ_Et_num10kHz_gFexLRJ_GrEq2Subjets->Clone();
    sig_eff_offline_gFEX_LRJ10kHz_GrEq2Subjets->SetName("eff_gFEX_LRJ_10kHz");
    sig_eff_offline_gFEX_LRJ10kHz_GrEq2Subjets->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offline_gFEX_LRJ10kHz_GrEq2Subjets->Divide(sig_h_offlineLRJ_Et_num10kHz_gFexLRJ_GrEq2Subjets, sig_h_offlineLRJ_Et_denom10kHz_gFexLRJ_GrEq2Subjets, 1.0, 1.0, "B");
    
    sig_eff_offline_gFEX_LRJ10kHz_GrEq2Subjets->SetAxisRange(0, 1.1, "Y");

    sig_eff_offline_gFEX_LRJ10kHz_GrEq2Subjets->Draw();
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offline_gFEX_LRJ10kHz_GrEq2Subjets.pdf");

    TH1F* sig_eff_offlineLRJ10kHz_Subleading = (TH1F*)sig_h_offlineLRJ_Et_num10kHz_Subleading->Clone();
    sig_eff_offlineLRJ10kHz_Subleading->SetName("eff_LRJ10kHz");
    sig_eff_offlineLRJ10kHz_Subleading->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ10kHz_Subleading->Divide(sig_h_offlineLRJ_Et_num10kHz_Subleading, sig_h_offlineLRJ_Et_denom10kHz_Subleading, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ10kHz_Subleading->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ10kHz_Subleading->Draw();
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ10kHz_Subleading.pdf");

    sig_eff_offlineLRJ10kHz_Subleading_vec.push_back(sig_eff_offlineLRJ10kHz_Subleading);

    TH1F* sig_eff_offlineLRJ10kHz_HiggsMassWindow_Subleading = (TH1F*)sig_h_offlineLRJ_Et_num10kHz_HiggsMassWindow_Subleading->Clone();
    sig_eff_offlineLRJ10kHz_HiggsMassWindow_Subleading->SetName("eff_LRJ10kHz");
    sig_eff_offlineLRJ10kHz_HiggsMassWindow_Subleading->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ10kHz_HiggsMassWindow_Subleading->Divide(sig_h_offlineLRJ_Et_num10kHz_HiggsMassWindow_Subleading, sig_h_offlineLRJ_Et_denom10kHz_HiggsMassWindow_Subleading, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ10kHz_HiggsMassWindow_Subleading->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ10kHz_HiggsMassWindow_Subleading->Draw();
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ10kHz_HiggsMassWindow_Subleading.pdf");

    sig_eff_offlineLRJ10kHz_HiggsMassWindow_Subleading_vec.push_back(sig_eff_offlineLRJ10kHz_HiggsMassWindow_Subleading);

    TH1F* sig_eff_offlineLRJ10kHz_1Subjet_Subleading = (TH1F*)sig_h_offlineLRJ_Et_num10kHz_1Subjet_Subleading->Clone();
    sig_eff_offlineLRJ10kHz_1Subjet_Subleading->SetName("eff_LRJ10kHz");
    sig_eff_offlineLRJ10kHz_1Subjet_Subleading->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ10kHz_1Subjet_Subleading->Divide(sig_h_offlineLRJ_Et_num10kHz_1Subjet_Subleading, sig_h_offlineLRJ_Et_denom10kHz_1Subjet_Subleading, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ10kHz_1Subjet_Subleading->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ10kHz_1Subjet_Subleading->Draw();
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ10kHz_1Subjet_Subleading.pdf");

    sig_eff_offlineLRJ10kHz_1Subjet_Subleading_vec.push_back(sig_eff_offlineLRJ10kHz_1Subjet_Subleading);


    TH1F* sig_eff_offlineLRJ10kHz_GrEq2Subjets_Subleading = (TH1F*)sig_h_offlineLRJ_Et_num10kHz_GrEq2Subjets_Subleading->Clone();
    sig_eff_offlineLRJ10kHz_GrEq2Subjets_Subleading->SetName("eff_LRJ10kHz");
    sig_eff_offlineLRJ10kHz_GrEq2Subjets_Subleading->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ10kHz_GrEq2Subjets_Subleading->Divide(sig_h_offlineLRJ_Et_num10kHz_GrEq2Subjets_Subleading, sig_h_offlineLRJ_Et_denom10kHz_GrEq2Subjets_Subleading, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ10kHz_GrEq2Subjets_Subleading->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ10kHz_GrEq2Subjets_Subleading->Draw();
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ10kHz_GrEq2Subjets_Subleading.pdf");

    sig_eff_offlineLRJ10kHz_GrEq2Subjets_Subleading_vec.push_back(sig_eff_offlineLRJ10kHz_GrEq2Subjets_Subleading);

    TH1F* sig_eff_offline_gFEX_LRJ10kHz_Subleading = (TH1F*)sig_h_offlineLRJ_Et_num10kHz_gFexLRJ_Subleading->Clone();
    sig_eff_offline_gFEX_LRJ10kHz_Subleading->SetName("eff_gFEX_LRJ_10kHz");
    sig_eff_offline_gFEX_LRJ10kHz_Subleading->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offline_gFEX_LRJ10kHz_Subleading->Divide(sig_h_offlineLRJ_Et_num10kHz_gFexLRJ_Subleading, sig_h_offlineLRJ_Et_denom10kHz_gFexLRJ_Subleading, 1.0, 1.0, "B");
    
    sig_eff_offline_gFEX_LRJ10kHz_Subleading->SetAxisRange(0, 1.1, "Y");

    sig_eff_offline_gFEX_LRJ10kHz_Subleading->Draw();
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offline_gFEX_LRJ10kHz_Subleading.pdf");

    TH1F* sig_eff_offline_gFEX_LRJ10kHz_HiggsMassWindow_Subleading = (TH1F*)sig_h_offlineLRJ_Et_num10kHz_gFexLRJ_HiggsMassWindow_Subleading->Clone();
    sig_eff_offline_gFEX_LRJ10kHz_HiggsMassWindow_Subleading->SetName("eff_gFEX_LRJ_10kHz");
    sig_eff_offline_gFEX_LRJ10kHz_HiggsMassWindow_Subleading->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offline_gFEX_LRJ10kHz_HiggsMassWindow_Subleading->Divide(sig_h_offlineLRJ_Et_num10kHz_gFexLRJ_HiggsMassWindow_Subleading, sig_h_offlineLRJ_Et_denom10kHz_gFexLRJ_HiggsMassWindow_Subleading, 1.0, 1.0, "B");
    
    sig_eff_offline_gFEX_LRJ10kHz_HiggsMassWindow_Subleading->SetAxisRange(0, 1.1, "Y");

    sig_eff_offline_gFEX_LRJ10kHz_HiggsMassWindow_Subleading->Draw();
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offline_gFEX_LRJ10kHz_HiggsMassWindow.pdf");

    TH1F* sig_eff_offline_gFEX_LRJ10kHz_1Subjet_Subleading = (TH1F*)sig_h_offlineLRJ_Et_num10kHz_gFexLRJ_1Subjet_Subleading->Clone();
    sig_eff_offline_gFEX_LRJ10kHz_1Subjet_Subleading->SetName("eff_gFEX_LRJ_10kHz");
    sig_eff_offline_gFEX_LRJ10kHz_Subleading->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offline_gFEX_LRJ10kHz_1Subjet_Subleading->Divide(sig_h_offlineLRJ_Et_num10kHz_gFexLRJ_1Subjet_Subleading, sig_h_offlineLRJ_Et_denom10kHz_gFexLRJ_1Subjet_Subleading, 1.0, 1.0, "B");
    
    sig_eff_offline_gFEX_LRJ10kHz_1Subjet_Subleading->SetAxisRange(0, 1.1, "Y");

    sig_eff_offline_gFEX_LRJ10kHz_1Subjet_Subleading->Draw();
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offline_gFEX_LRJ10kHz_1Subjet_Subleading.pdf");

    TH1F* sig_eff_offline_gFEX_LRJ10kHz_GrEq2Subjets_Subleading = (TH1F*)sig_h_offlineLRJ_Et_num10kHz_gFexLRJ_GrEq2Subjets_Subleading->Clone();
    sig_eff_offline_gFEX_LRJ10kHz_GrEq2Subjets_Subleading->SetName("eff_gFEX_LRJ_10kHz");
    sig_eff_offline_gFEX_LRJ10kHz_GrEq2Subjets_Subleading->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offline_gFEX_LRJ10kHz_GrEq2Subjets_Subleading->Divide(sig_h_offlineLRJ_Et_num10kHz_gFexLRJ_GrEq2Subjets_Subleading, sig_h_offlineLRJ_Et_denom10kHz_gFexLRJ_GrEq2Subjets_Subleading, 1.0, 1.0, "B");
    
    sig_eff_offline_gFEX_LRJ10kHz_GrEq2Subjets_Subleading->SetAxisRange(0, 1.1, "Y");

    sig_eff_offline_gFEX_LRJ10kHz_GrEq2Subjets_Subleading->Draw();
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offline_gFEX_LRJ10kHz_GrEq2Subjets_Subleading.pdf");

    TH1F* sig_eff_offline_jFEX_LRJ10kHz = (TH1F*)sig_h_offlineLRJ_Et_num10kHz_jFexLRJ->Clone();
    sig_eff_offline_jFEX_LRJ10kHz->SetName("eff_jFEX_LRJ_10kHz");
    sig_eff_offline_jFEX_LRJ10kHz->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offline_jFEX_LRJ10kHz->Divide(sig_h_offlineLRJ_Et_num10kHz_jFexLRJ, sig_h_offlineLRJ_Et_denom10kHz_jFexLRJ, 1.0, 1.0, "B");
    
    sig_eff_offline_jFEX_LRJ10kHz->SetAxisRange(0, 1.1, "Y");

    sig_eff_offline_jFEX_LRJ10kHz->Draw();
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offline_jFEX_LRJ10kHz.pdf");

    TH1F* sig_eff_offlineLRJ50 = (TH1F*)sig_h_offlineLRJ_Et_num50->Clone();
    sig_eff_offlineLRJ50->SetName("eff_LRJ50");
    sig_eff_offlineLRJ50->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ50->Divide(sig_h_offlineLRJ_Et_num50, sig_h_offlineLRJ_Et_denom50, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ50->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ50->Draw();
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ50.pdf");

    TH1F* sig_eff_offlineLRJ50_mass100to150 = (TH1F*)sig_h_offlineLRJ_Et_num50_mass100to150->Clone();
    sig_eff_offlineLRJ50_mass100to150->SetName("eff_LRJ50_mass100to150");
    sig_eff_offlineLRJ50_mass100to150->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ50_mass100to150->Divide(sig_h_offlineLRJ_Et_num50_mass100to150, sig_h_offlineLRJ_Et_denom50_mass100to150, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ50_mass100to150->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ50_mass100to150->Draw();
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ50_mass100to150.pdf");

    TH1F* sig_eff_b_Et50 = (TH1F*)sig_h_Avg_b_Et_num50->Clone();
    sig_eff_b_Et50->SetName("eff_b50");
    sig_eff_b_Et50->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_b_Et50->Divide(sig_h_Avg_b_Et_num50, sig_h_Avg_b_Et_denom50, 1.0, 1.0, "B");
    
    sig_eff_b_Et50->SetAxisRange(0, 1.1, "Y");

    sig_eff_b_Et50->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_b_Et50.pdf");

    TH1F* sig_eff_offlineLRJ100 = (TH1F*)sig_h_offlineLRJ_Et_num100->Clone();
    sig_eff_offlineLRJ100->SetName("eff_LRJ100");
    sig_eff_offlineLRJ100->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ100->Divide(sig_h_offlineLRJ_Et_num100, sig_h_offlineLRJ_Et_denom100, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ100->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ100->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ100.pdf");

    TH1F* sig_eff_offlineLRJ100_mass100to150 = (TH1F*)sig_h_offlineLRJ_Et_num100_mass100to150->Clone();
    sig_eff_offlineLRJ100_mass100to150->SetName("eff_LRJ100_mass100to150");
    sig_eff_offlineLRJ100_mass100to150->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ100_mass100to150->Divide(sig_h_offlineLRJ_Et_num100_mass100to150, sig_h_offlineLRJ_Et_denom100_mass100to150, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ100_mass100to150->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ100_mass100to150->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ100_mass100to150.pdf");

    TH1F* sig_eff_b_Et100 = (TH1F*)sig_h_Avg_b_Et_num100->Clone();
    sig_eff_b_Et100->SetName("eff_b100");
    sig_eff_b_Et100->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_b_Et100->Divide(sig_h_Avg_b_Et_num100, sig_h_Avg_b_Et_denom100, 1.0, 1.0, "B");
    
    sig_eff_b_Et100->SetAxisRange(0, 1.1, "Y");

    sig_eff_b_Et100->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_b_Et100.pdf");

    TH1F* sig_eff_offlineLRJ150 = (TH1F*)sig_h_offlineLRJ_Et_num150->Clone();
    sig_eff_offlineLRJ150->SetName("eff_LRJ150");
    sig_eff_offlineLRJ150->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ150->Divide(sig_h_offlineLRJ_Et_num150, sig_h_offlineLRJ_Et_denom150, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ150->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ150->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ150.pdf");

    TH1F* sig_eff_offlineLRJ150_mass100to150 = (TH1F*)sig_h_offlineLRJ_Et_num150_mass100to150->Clone();
    sig_eff_offlineLRJ150_mass100to150->SetName("eff_LRJ150_mass100to150");
    sig_eff_offlineLRJ150_mass100to150->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ150_mass100to150->Divide(sig_h_offlineLRJ_Et_num150_mass100to150, sig_h_offlineLRJ_Et_denom150_mass100to150, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ150_mass100to150->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ150_mass100to150->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ150_mass100to150.pdf");

    TH1F* sig_eff_b_Et150 = (TH1F*)sig_h_Avg_b_Et_num150->Clone();
    sig_eff_b_Et150->SetName("eff_b150");
    sig_eff_b_Et150->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_b_Et150->Divide(sig_h_Avg_b_Et_num150, sig_h_Avg_b_Et_denom150, 1.0, 1.0, "B");
    
    sig_eff_b_Et150->SetAxisRange(0, 1.1, "Y");

    sig_eff_b_Et150->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_b_Et150.pdf");

    TH1F* sig_eff_offlineLRJ200 = (TH1F*)sig_h_offlineLRJ_Et_num200->Clone();
    sig_eff_offlineLRJ200->SetName("eff_LRJ200");
    sig_eff_offlineLRJ200->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ200->Divide(sig_h_offlineLRJ_Et_num200, sig_h_offlineLRJ_Et_denom200, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ200->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ200->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ200.pdf");

    TH1F* sig_eff_offlineLRJ200_mass100to150 = (TH1F*)sig_h_offlineLRJ_Et_num200_mass100to150->Clone();
    sig_eff_offlineLRJ200_mass100to150->SetName("eff_LRJ200_mass100to150");
    sig_eff_offlineLRJ200_mass100to150->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ200_mass100to150->Divide(sig_h_offlineLRJ_Et_num200_mass100to150, sig_h_offlineLRJ_Et_denom200_mass100to150, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ200_mass100to150->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ200_mass100to150->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ200_mass100to150.pdf");

    TH1F* sig_eff_b_Et200 = (TH1F*)sig_h_Avg_b_Et_num200->Clone();
    sig_eff_b_Et200->SetName("eff_b200");
    sig_eff_b_Et200->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_b_Et200->Divide(sig_h_Avg_b_Et_num200, sig_h_Avg_b_Et_denom200, 1.0, 1.0, "B");
    
    sig_eff_b_Et200->SetAxisRange(0, 1.1, "Y");

    sig_eff_b_Et200->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_b_Et200.pdf");

    TH1F* sig_eff_offlineLRJ250 = (TH1F*)sig_h_offlineLRJ_Et_num250->Clone();
    sig_eff_offlineLRJ250->SetName("eff_LRJ250");
    sig_eff_offlineLRJ250->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ250->Divide(sig_h_offlineLRJ_Et_num250, sig_h_offlineLRJ_Et_denom250, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ250->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ250->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ250.pdf");

    TH1F* sig_eff_offlineLRJ250_mass100to150 = (TH1F*)sig_h_offlineLRJ_Et_num250_mass100to150->Clone();
    sig_eff_offlineLRJ250_mass100to150->SetName("eff_LRJ250_mass100to150");
    sig_eff_offlineLRJ250_mass100to150->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ250_mass100to150->Divide(sig_h_offlineLRJ_Et_num250_mass100to150, sig_h_offlineLRJ_Et_denom250_mass100to150, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ250_mass100to150->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ250_mass100to150->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ250_mass100to150.pdf");

    TH1F* sig_eff_b_Et250 = (TH1F*)sig_h_Avg_b_Et_num250->Clone();
    sig_eff_b_Et250->SetName("eff_b250");
    sig_eff_b_Et250->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_b_Et250->Divide(sig_h_Avg_b_Et_num250, sig_h_Avg_b_Et_denom250, 1.0, 1.0, "B");
    
    sig_eff_b_Et250->SetAxisRange(0, 1.1, "Y");

    sig_eff_b_Et250->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_b_Et250.pdf");

    TH1F* sig_eff_offlineLRJ300 = (TH1F*)sig_h_offlineLRJ_Et_num300->Clone();
    sig_eff_offlineLRJ300->SetName("eff_LRJ300");
    sig_eff_offlineLRJ300->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ300->Divide(sig_h_offlineLRJ_Et_num300, sig_h_offlineLRJ_Et_denom300, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ300->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ300->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ300.pdf");

    TH1F* sig_eff_offlineLRJ300_mass100to150 = (TH1F*)sig_h_offlineLRJ_Et_num300_mass100to150->Clone();
    sig_eff_offlineLRJ300_mass100to150->SetName("eff_LRJ300_mass100to150");
    sig_eff_offlineLRJ300_mass100to150->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ300_mass100to150->Divide(sig_h_offlineLRJ_Et_num300_mass100to150, sig_h_offlineLRJ_Et_denom300_mass100to150, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ300_mass100to150->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ300_mass100to150->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ300_mass100to150.pdf");

    TH1F* sig_eff_b_Et300 = (TH1F*)sig_h_Avg_b_Et_num300->Clone();
    sig_eff_b_Et300->SetName("eff_b300");
    sig_eff_b_Et300->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_b_Et300->Divide(sig_h_Avg_b_Et_num300, sig_h_Avg_b_Et_denom300, 1.0, 1.0, "B");
    
    sig_eff_b_Et300->SetAxisRange(0, 1.1, "Y");

    sig_eff_b_Et300->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_b_Et300.pdf");

    TH1F* sig_eff_offlineLRJ350 = (TH1F*)sig_h_offlineLRJ_Et_num350->Clone();
    sig_eff_offlineLRJ350->SetName("eff_LRJ350");
    sig_eff_offlineLRJ350->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ350->Divide(sig_h_offlineLRJ_Et_num350, sig_h_offlineLRJ_Et_denom350, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ350->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ350->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ350.pdf");

    TH1F* sig_eff_offlineLRJ350_mass100to150 = (TH1F*)sig_h_offlineLRJ_Et_num350_mass100to150->Clone();
    sig_eff_offlineLRJ350_mass100to150->SetName("eff_LRJ350_mass100to150");
    sig_eff_offlineLRJ350_mass100to150->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ350_mass100to150->Divide(sig_h_offlineLRJ_Et_num350_mass100to150, sig_h_offlineLRJ_Et_denom350_mass100to150, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ350_mass100to150->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ350_mass100to150->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ350_mass100to150.pdf");

    TH1F* sig_eff_b_Et350 = (TH1F*)sig_h_Avg_b_Et_num350->Clone();
    sig_eff_b_Et350->SetName("eff_b350");
    sig_eff_b_Et350->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_b_Et350->Divide(sig_h_Avg_b_Et_num350, sig_h_Avg_b_Et_denom350, 1.0, 1.0, "B");
    
    sig_eff_b_Et350->SetAxisRange(0, 1.1, "Y");

    sig_eff_b_Et350->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_b_Et350.pdf");

    TH1F* sig_eff_offlineLRJ400 = (TH1F*)sig_h_offlineLRJ_Et_num400->Clone();
    sig_eff_offlineLRJ400->SetName("eff_LRJ400");
    sig_eff_offlineLRJ400->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ400->Divide(sig_h_offlineLRJ_Et_num400, sig_h_offlineLRJ_Et_denom400, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ400->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ400->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ400.pdf");

    TH1F* sig_eff_offlineLRJ400_mass100to150 = (TH1F*)sig_h_offlineLRJ_Et_num400_mass100to150->Clone();
    sig_eff_offlineLRJ400_mass100to150->SetName("eff_LRJ400_mass100to150");
    sig_eff_offlineLRJ400_mass100to150->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ400_mass100to150->Divide(sig_h_offlineLRJ_Et_num400_mass100to150, sig_h_offlineLRJ_Et_denom400_mass100to150, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ400_mass100to150->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ400_mass100to150->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ400_mass100to150.pdf");

    TH1F* sig_eff_b_Et400 = (TH1F*)sig_h_Avg_b_Et_num400->Clone();
    sig_eff_b_Et400->SetName("eff_b400");
    sig_eff_b_Et400->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_b_Et400->Divide(sig_h_Avg_b_Et_num400, sig_h_Avg_b_Et_denom400, 1.0, 1.0, "B");
    
    sig_eff_b_Et400->SetAxisRange(0, 1.1, "Y");

    sig_eff_b_Et400->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_b_Et400.pdf");

    TH1F* sig_eff_offlineLRJ450 = (TH1F*)sig_h_offlineLRJ_Et_num450->Clone();
    sig_eff_offlineLRJ450->SetName("eff_LRJ450");
    sig_eff_offlineLRJ450->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ450->Divide(sig_h_offlineLRJ_Et_num450, sig_h_offlineLRJ_Et_denom450, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ450->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ450->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ450.pdf");

    TH1F* sig_eff_offlineLRJ450_mass100to150 = (TH1F*)sig_h_offlineLRJ_Et_num450_mass100to150->Clone();
    sig_eff_offlineLRJ450_mass100to150->SetName("eff_LRJ450_mass100to150");
    sig_eff_offlineLRJ450_mass100to150->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ450_mass100to150->Divide(sig_h_offlineLRJ_Et_num450_mass100to150, sig_h_offlineLRJ_Et_denom450_mass100to150, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ450_mass100to150->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ450_mass100to150->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ450_mass100to150.pdf");

    TH1F* sig_eff_b_Et450 = (TH1F*)sig_h_Avg_b_Et_num450->Clone();
    sig_eff_b_Et450->SetName("eff_b450");
    sig_eff_b_Et450->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_b_Et450->Divide(sig_h_Avg_b_Et_num450, sig_h_Avg_b_Et_denom450, 1.0, 1.0, "B");
    
    sig_eff_b_Et450->SetAxisRange(0, 1.1, "Y");

    sig_eff_b_Et450->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_b_Et450.pdf");

    TH1F* sig_eff_offlineLRJ500 = (TH1F*)sig_h_offlineLRJ_Et_num500->Clone();
    sig_eff_offlineLRJ500->SetName("eff_LRJ500");
    sig_eff_offlineLRJ500->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ500->Divide(sig_h_offlineLRJ_Et_num500, sig_h_offlineLRJ_Et_denom500, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ500->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ500->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ500.pdf");

    TH1F* sig_eff_offlineLRJ500_mass100to150 = (TH1F*)sig_h_offlineLRJ_Et_num500_mass100to150->Clone();
    sig_eff_offlineLRJ500_mass100to150->SetName("eff_LRJ500_mass100to150");
    sig_eff_offlineLRJ500_mass100to150->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ500_mass100to150->Divide(sig_h_offlineLRJ_Et_num500_mass100to150, sig_h_offlineLRJ_Et_denom500_mass100to150, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ500_mass100to150->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ500_mass100to150->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ500_mass100to150.pdf");

    TH1F* sig_eff_b_Et500 = (TH1F*)sig_h_Avg_b_Et_num500->Clone();
    sig_eff_b_Et500->SetName("eff_b500");
    sig_eff_b_Et500->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_b_Et500->Divide(sig_h_Avg_b_Et_num500, sig_h_Avg_b_Et_denom500, 1.0, 1.0, "B");
    
    sig_eff_b_Et500->SetAxisRange(0, 1.1, "Y");

    sig_eff_b_Et500->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_b_Et500.pdf");

    // Draw signal gFEX efficiency curves - first 1 jet

    TH1F* sig_eff_offlineLRJ50_gFexLRJ = (TH1F*)sig_h_offlineLRJ_Et_num50_gFexLRJ->Clone();
    sig_eff_offlineLRJ50_gFexLRJ->SetName("eff_LRJ50");
    sig_eff_offlineLRJ50_gFexLRJ->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ50_gFexLRJ->Divide(sig_h_offlineLRJ_Et_num50_gFexLRJ, sig_h_offlineLRJ_Et_denom50_gFexLRJ, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ50_gFexLRJ->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ50_gFexLRJ->Draw();
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ50_gFexLRJ.pdf");

    TH1F* sig_eff_offlineLRJ100_gFexLRJ = (TH1F*)sig_h_offlineLRJ_Et_num100_gFexLRJ->Clone();
    sig_eff_offlineLRJ100_gFexLRJ->SetName("eff_LRJ100");
    sig_eff_offlineLRJ100_gFexLRJ->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ100_gFexLRJ->Divide(sig_h_offlineLRJ_Et_num100_gFexLRJ, sig_h_offlineLRJ_Et_denom100_gFexLRJ, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ100_gFexLRJ->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ100_gFexLRJ->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ100_gFexLRJ.pdf");

    TH1F* sig_eff_offlineLRJ150_gFexLRJ = (TH1F*)sig_h_offlineLRJ_Et_num150_gFexLRJ->Clone();
    sig_eff_offlineLRJ150_gFexLRJ->SetName("eff_LRJ150");
    sig_eff_offlineLRJ150_gFexLRJ->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ150_gFexLRJ->Divide(sig_h_offlineLRJ_Et_num150_gFexLRJ, sig_h_offlineLRJ_Et_denom150_gFexLRJ, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ150_gFexLRJ->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ150_gFexLRJ->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ150_gFexLRJ.pdf");

    TH1F* sig_eff_offlineLRJ200_gFexLRJ = (TH1F*)sig_h_offlineLRJ_Et_num200_gFexLRJ->Clone();
    sig_eff_offlineLRJ200_gFexLRJ->SetName("eff_LRJ200_gFexLRJ");
    sig_eff_offlineLRJ200_gFexLRJ->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ200_gFexLRJ->Divide(sig_h_offlineLRJ_Et_num200_gFexLRJ, sig_h_offlineLRJ_Et_denom200_gFexLRJ, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ200_gFexLRJ->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ200_gFexLRJ->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ200_gFexLRJ.pdf");

    TH1F* sig_eff_offlineLRJ250_gFexLRJ = (TH1F*)sig_h_offlineLRJ_Et_num250_gFexLRJ->Clone();
    sig_eff_offlineLRJ250_gFexLRJ->SetName("eff_LRJ250_gFexLRJ");
    sig_eff_offlineLRJ250_gFexLRJ->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ250_gFexLRJ->Divide(sig_h_offlineLRJ_Et_num250_gFexLRJ, sig_h_offlineLRJ_Et_denom250_gFexLRJ, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ250_gFexLRJ->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ250_gFexLRJ->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ250_gFexLRJ.pdf");


    TH1F* sig_eff_offlineLRJ300_gFexLRJ = (TH1F*)sig_h_offlineLRJ_Et_num300_gFexLRJ->Clone();
    sig_eff_offlineLRJ300_gFexLRJ->SetName("eff_LRJ300");
    sig_eff_offlineLRJ300_gFexLRJ->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ300_gFexLRJ->Divide(sig_h_offlineLRJ_Et_num300_gFexLRJ, sig_h_offlineLRJ_Et_denom300_gFexLRJ, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ300_gFexLRJ->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ300_gFexLRJ->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ300_gFexLRJ.pdf");


    TH1F* sig_eff_offlineLRJ350_gFexLRJ = (TH1F*)sig_h_offlineLRJ_Et_num350_gFexLRJ->Clone();
    sig_eff_offlineLRJ350_gFexLRJ->SetName("eff_LRJ350");
    sig_eff_offlineLRJ350_gFexLRJ->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ350_gFexLRJ->Divide(sig_h_offlineLRJ_Et_num350_gFexLRJ, sig_h_offlineLRJ_Et_denom350_gFexLRJ, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ350_gFexLRJ->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ350_gFexLRJ->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ350_gFexLRJ.pdf");


    TH1F* sig_eff_offlineLRJ400_gFexLRJ = (TH1F*)sig_h_offlineLRJ_Et_num400_gFexLRJ->Clone();
    sig_eff_offlineLRJ400_gFexLRJ->SetName("eff_LRJ400");
    sig_eff_offlineLRJ400_gFexLRJ->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ400_gFexLRJ->Divide(sig_h_offlineLRJ_Et_num400_gFexLRJ, sig_h_offlineLRJ_Et_denom400_gFexLRJ, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ400_gFexLRJ->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ400_gFexLRJ->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ400_gFexLRJ.pdf");


    TH1F* sig_eff_offlineLRJ450_gFexLRJ = (TH1F*)sig_h_offlineLRJ_Et_num450_gFexLRJ->Clone();
    sig_eff_offlineLRJ450_gFexLRJ->SetName("eff_LRJ450");
    sig_eff_offlineLRJ450_gFexLRJ->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ450_gFexLRJ->Divide(sig_h_offlineLRJ_Et_num450_gFexLRJ, sig_h_offlineLRJ_Et_denom450_gFexLRJ, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ450_gFexLRJ->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ450_gFexLRJ->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ450_gFexLRJ.pdf");


    TH1F* sig_eff_offlineLRJ500_gFexLRJ = (TH1F*)sig_h_offlineLRJ_Et_num500_gFexLRJ->Clone();
    sig_eff_offlineLRJ500_gFexLRJ->SetName("eff_LRJ500");
    sig_eff_offlineLRJ500_gFexLRJ->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ500_gFexLRJ->Divide(sig_h_offlineLRJ_Et_num500_gFexLRJ, sig_h_offlineLRJ_Et_denom500_gFexLRJ, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ500_gFexLRJ->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ500_gFexLRJ->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ500_gFexLRJ.pdf");

    // Next jFEX (1 jet) signal

    TH1F* sig_eff_offlineLRJ50_jFexLRJ = (TH1F*)sig_h_offlineLRJ_Et_num50_jFexLRJ->Clone();
    sig_eff_offlineLRJ50_jFexLRJ->SetName("eff_LRJ50");
    sig_eff_offlineLRJ50_jFexLRJ->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ50_jFexLRJ->Divide(sig_h_offlineLRJ_Et_num50_jFexLRJ, sig_h_offlineLRJ_Et_denom50_jFexLRJ, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ50_jFexLRJ->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ50_jFexLRJ->Draw();
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ50_jFexLRJ.pdf");

    TH1F* sig_eff_offlineLRJ100_jFexLRJ = (TH1F*)sig_h_offlineLRJ_Et_num100_jFexLRJ->Clone();
    sig_eff_offlineLRJ100_jFexLRJ->SetName("eff_LRJ100");
    sig_eff_offlineLRJ100_jFexLRJ->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ100_jFexLRJ->Divide(sig_h_offlineLRJ_Et_num100_jFexLRJ, sig_h_offlineLRJ_Et_denom100_jFexLRJ, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ100_jFexLRJ->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ100_jFexLRJ->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ100_jFexLRJ.pdf");

    TH1F* sig_eff_offlineLRJ150_jFexLRJ = (TH1F*)sig_h_offlineLRJ_Et_num150_jFexLRJ->Clone();
    sig_eff_offlineLRJ150_jFexLRJ->SetName("eff_LRJ150");
    sig_eff_offlineLRJ150_jFexLRJ->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ150_jFexLRJ->Divide(sig_h_offlineLRJ_Et_num150_jFexLRJ, sig_h_offlineLRJ_Et_denom150_jFexLRJ, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ150_jFexLRJ->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ150_jFexLRJ->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ150_jFexLRJ.pdf");

    TH1F* sig_eff_offlineLRJ200_jFexLRJ = (TH1F*)sig_h_offlineLRJ_Et_num200_jFexLRJ->Clone();
    sig_eff_offlineLRJ200_jFexLRJ->SetName("eff_LRJ200_jFexLRJ");
    sig_eff_offlineLRJ200_jFexLRJ->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ200_jFexLRJ->Divide(sig_h_offlineLRJ_Et_num200_jFexLRJ, sig_h_offlineLRJ_Et_denom200_jFexLRJ, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ200_jFexLRJ->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ200_jFexLRJ->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ200_jFexLRJ.pdf");

    TH1F* sig_eff_offlineLRJ250_jFexLRJ = (TH1F*)sig_h_offlineLRJ_Et_num250_jFexLRJ->Clone();
    sig_eff_offlineLRJ250_jFexLRJ->SetName("eff_LRJ250_jFexLRJ");
    sig_eff_offlineLRJ250_jFexLRJ->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ250_jFexLRJ->Divide(sig_h_offlineLRJ_Et_num250_jFexLRJ, sig_h_offlineLRJ_Et_denom250_jFexLRJ, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ250_jFexLRJ->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ250_jFexLRJ->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ250_jFexLRJ.pdf");


    TH1F* sig_eff_offlineLRJ300_jFexLRJ = (TH1F*)sig_h_offlineLRJ_Et_num300_jFexLRJ->Clone();
    sig_eff_offlineLRJ300_jFexLRJ->SetName("eff_LRJ300");
    sig_eff_offlineLRJ300_jFexLRJ->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ300_jFexLRJ->Divide(sig_h_offlineLRJ_Et_num300_jFexLRJ, sig_h_offlineLRJ_Et_denom300_jFexLRJ, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ300_jFexLRJ->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ300_jFexLRJ->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ300_jFexLRJ.pdf");


    TH1F* sig_eff_offlineLRJ350_jFexLRJ = (TH1F*)sig_h_offlineLRJ_Et_num350_jFexLRJ->Clone();
    sig_eff_offlineLRJ350_jFexLRJ->SetName("eff_LRJ350");
    sig_eff_offlineLRJ350_jFexLRJ->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ350_jFexLRJ->Divide(sig_h_offlineLRJ_Et_num350_jFexLRJ, sig_h_offlineLRJ_Et_denom350_jFexLRJ, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ350_jFexLRJ->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ350_jFexLRJ->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ350_jFexLRJ.pdf");


    TH1F* sig_eff_offlineLRJ400_jFexLRJ = (TH1F*)sig_h_offlineLRJ_Et_num400_jFexLRJ->Clone();
    sig_eff_offlineLRJ400_jFexLRJ->SetName("eff_LRJ400");
    sig_eff_offlineLRJ400_jFexLRJ->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ400_jFexLRJ->Divide(sig_h_offlineLRJ_Et_num400_jFexLRJ, sig_h_offlineLRJ_Et_denom400_jFexLRJ, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ400_jFexLRJ->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ400_jFexLRJ->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ400_jFexLRJ.pdf");


    TH1F* sig_eff_offlineLRJ450_jFexLRJ = (TH1F*)sig_h_offlineLRJ_Et_num450_jFexLRJ->Clone();
    sig_eff_offlineLRJ450_jFexLRJ->SetName("eff_LRJ450");
    sig_eff_offlineLRJ450_jFexLRJ->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ450_jFexLRJ->Divide(sig_h_offlineLRJ_Et_num450_jFexLRJ, sig_h_offlineLRJ_Et_denom450_jFexLRJ, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ450_jFexLRJ->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ450_jFexLRJ->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ450_jFexLRJ.pdf");


    TH1F* sig_eff_offlineLRJ500_jFexLRJ = (TH1F*)sig_h_offlineLRJ_Et_num500_jFexLRJ->Clone();
    sig_eff_offlineLRJ500_jFexLRJ->SetName("eff_LRJ500");
    sig_eff_offlineLRJ500_jFexLRJ->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ500_jFexLRJ->Divide(sig_h_offlineLRJ_Et_num500_jFexLRJ, sig_h_offlineLRJ_Et_denom500_jFexLRJ, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ500_jFexLRJ->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ500_jFexLRJ->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ500_jFexLRJ.pdf");

    // Next dijet

    TH1F* sig_eff_offlineLRJ50_gFexLRJ_Dijet = (TH1F*)sig_h_offlineLRJ_Et_num50_gFexLRJ_Dijet->Clone();
    sig_eff_offlineLRJ50_gFexLRJ_Dijet->SetName("eff_LRJ50");
    sig_eff_offlineLRJ50_gFexLRJ_Dijet->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ50_gFexLRJ_Dijet->Divide(sig_h_offlineLRJ_Et_num50_gFexLRJ_Dijet, sig_h_offlineLRJ_Et_denom50_gFexLRJ_Dijet, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ50_gFexLRJ_Dijet->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ50_gFexLRJ_Dijet->Draw();
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ50_gFexLRJ_Dijet.pdf");

    TH1F* sig_eff_offlineLRJ100_gFexLRJ_Dijet = (TH1F*)sig_h_offlineLRJ_Et_num100_gFexLRJ_Dijet->Clone();
    sig_eff_offlineLRJ100_gFexLRJ_Dijet->SetName("eff_LRJ100");
    sig_eff_offlineLRJ100_gFexLRJ_Dijet->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ100_gFexLRJ_Dijet->Divide(sig_h_offlineLRJ_Et_num100_gFexLRJ_Dijet, sig_h_offlineLRJ_Et_denom100_gFexLRJ_Dijet, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ100_gFexLRJ_Dijet->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ100_gFexLRJ_Dijet->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ100_gFexLRJ_Dijet.pdf");

    TH1F* sig_eff_offlineLRJ150_gFexLRJ_Dijet = (TH1F*)sig_h_offlineLRJ_Et_num150_gFexLRJ_Dijet->Clone();
    sig_eff_offlineLRJ150_gFexLRJ_Dijet->SetName("eff_LRJ150");
    sig_eff_offlineLRJ150_gFexLRJ_Dijet->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ150_gFexLRJ_Dijet->Divide(sig_h_offlineLRJ_Et_num150_gFexLRJ_Dijet, sig_h_offlineLRJ_Et_denom150_gFexLRJ_Dijet, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ150_gFexLRJ_Dijet->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ150_gFexLRJ_Dijet->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ150_gFexLRJ_Dijet.pdf");

    TH1F* sig_eff_offlineLRJ200_gFexLRJ_Dijet = (TH1F*)sig_h_offlineLRJ_Et_num200_gFexLRJ_Dijet->Clone();
    sig_eff_offlineLRJ200_gFexLRJ_Dijet->SetName("eff_LRJ200_gFexLRJ_Dijet");
    sig_eff_offlineLRJ200_gFexLRJ_Dijet->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ200_gFexLRJ_Dijet->Divide(sig_h_offlineLRJ_Et_num200_gFexLRJ_Dijet, sig_h_offlineLRJ_Et_denom200_gFexLRJ_Dijet, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ200_gFexLRJ_Dijet->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ200_gFexLRJ_Dijet->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ200_gFexLRJ_Dijet.pdf");

    TH1F* sig_eff_offlineLRJ250_gFexLRJ_Dijet = (TH1F*)sig_h_offlineLRJ_Et_num250_gFexLRJ_Dijet->Clone();
    sig_eff_offlineLRJ250_gFexLRJ_Dijet->SetName("eff_LRJ250_gFexLRJ_Dijet");
    sig_eff_offlineLRJ250_gFexLRJ_Dijet->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ250_gFexLRJ_Dijet->Divide(sig_h_offlineLRJ_Et_num250_gFexLRJ_Dijet, sig_h_offlineLRJ_Et_denom250_gFexLRJ_Dijet, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ250_gFexLRJ_Dijet->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ250_gFexLRJ_Dijet->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ250_gFexLRJ_Dijet.pdf");


    TH1F* sig_eff_offlineLRJ300_gFexLRJ_Dijet = (TH1F*)sig_h_offlineLRJ_Et_num300_gFexLRJ_Dijet->Clone();
    sig_eff_offlineLRJ300_gFexLRJ_Dijet->SetName("eff_LRJ300");
    sig_eff_offlineLRJ300_gFexLRJ_Dijet->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ300_gFexLRJ_Dijet->Divide(sig_h_offlineLRJ_Et_num300_gFexLRJ_Dijet, sig_h_offlineLRJ_Et_denom300_gFexLRJ_Dijet, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ300_gFexLRJ_Dijet->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ300_gFexLRJ_Dijet->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ300_gFexLRJ_Dijet.pdf");


    TH1F* sig_eff_offlineLRJ350_gFexLRJ_Dijet = (TH1F*)sig_h_offlineLRJ_Et_num350_gFexLRJ_Dijet->Clone();
    sig_eff_offlineLRJ350_gFexLRJ_Dijet->SetName("eff_LRJ350");
    sig_eff_offlineLRJ350_gFexLRJ_Dijet->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ350_gFexLRJ_Dijet->Divide(sig_h_offlineLRJ_Et_num350_gFexLRJ_Dijet, sig_h_offlineLRJ_Et_denom350_gFexLRJ_Dijet, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ350_gFexLRJ_Dijet->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ350_gFexLRJ_Dijet->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ350_gFexLRJ_Dijet.pdf");


    TH1F* sig_eff_offlineLRJ400_gFexLRJ_Dijet = (TH1F*)sig_h_offlineLRJ_Et_num400_gFexLRJ_Dijet->Clone();
    sig_eff_offlineLRJ400_gFexLRJ_Dijet->SetName("eff_LRJ400");
    sig_eff_offlineLRJ400_gFexLRJ_Dijet->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ400_gFexLRJ_Dijet->Divide(sig_h_offlineLRJ_Et_num400_gFexLRJ_Dijet, sig_h_offlineLRJ_Et_denom400_gFexLRJ_Dijet, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ400_gFexLRJ_Dijet->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ400_gFexLRJ_Dijet->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ400_gFexLRJ_Dijet.pdf");


    TH1F* sig_eff_offlineLRJ450_gFexLRJ_Dijet = (TH1F*)sig_h_offlineLRJ_Et_num450_gFexLRJ_Dijet->Clone();
    sig_eff_offlineLRJ450_gFexLRJ_Dijet->SetName("eff_LRJ450");
    sig_eff_offlineLRJ450_gFexLRJ_Dijet->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ450_gFexLRJ_Dijet->Divide(sig_h_offlineLRJ_Et_num450_gFexLRJ_Dijet, sig_h_offlineLRJ_Et_denom450_gFexLRJ_Dijet, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ450_gFexLRJ_Dijet->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ450_gFexLRJ_Dijet->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ450_gFexLRJ_Dijet.pdf");


    TH1F* sig_eff_offlineLRJ500_gFexLRJ_Dijet = (TH1F*)sig_h_offlineLRJ_Et_num500_gFexLRJ_Dijet->Clone();
    sig_eff_offlineLRJ500_gFexLRJ_Dijet->SetName("eff_LRJ500");
    sig_eff_offlineLRJ500_gFexLRJ_Dijet->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ500_gFexLRJ_Dijet->Divide(sig_h_offlineLRJ_Et_num500_gFexLRJ_Dijet, sig_h_offlineLRJ_Et_denom500_gFexLRJ_Dijet, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ500_gFexLRJ_Dijet->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ500_gFexLRJ_Dijet->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ500_gFexLRJ_Dijet.pdf");



    // Draw background gFex trigger efficiencies (and create histograms with actual efficiency curves from numerators, denominators)
    TH1F* back_eff_offlineLRJ50_gFexLRJ = (TH1F*)back_h_offlineLRJ_Et_num50_gFexLRJ->Clone();
    back_eff_offlineLRJ50_gFexLRJ->SetName("eff_LRJ50");
    back_eff_offlineLRJ50_gFexLRJ->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Background)");
    back_eff_offlineLRJ50_gFexLRJ->Divide(back_h_offlineLRJ_Et_num50_gFexLRJ, back_h_offlineLRJ_Et_denom50_gFexLRJ, 1.0, 1.0, "B");
    
    back_eff_offlineLRJ50_gFexLRJ->SetAxisRange(0, 1.1, "Y");

    back_eff_offlineLRJ50_gFexLRJ->Draw();
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "back_eff_offlineLRJ50_gFexLRJ.pdf");

    TH1F* back_eff_offlineLRJ100_gFexLRJ = (TH1F*)back_h_offlineLRJ_Et_num100_gFexLRJ->Clone();
    back_eff_offlineLRJ100_gFexLRJ->SetName("eff_LRJ100");
    back_eff_offlineLRJ100_gFexLRJ->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Background)");
    back_eff_offlineLRJ100_gFexLRJ->Divide(back_h_offlineLRJ_Et_num100_gFexLRJ, back_h_offlineLRJ_Et_denom100_gFexLRJ, 1.0, 1.0, "B");
    
    back_eff_offlineLRJ100_gFexLRJ->SetAxisRange(0, 1.1, "Y");

    back_eff_offlineLRJ100_gFexLRJ->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "back_eff_offlineLRJ100_gFexLRJ.pdf");

    TH1F* back_eff_offlineLRJ150_gFexLRJ = (TH1F*)back_h_offlineLRJ_Et_num150_gFexLRJ->Clone();
    back_eff_offlineLRJ150_gFexLRJ->SetName("eff_LRJ150");
    back_eff_offlineLRJ150_gFexLRJ->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Background)");
    back_eff_offlineLRJ150_gFexLRJ->Divide(back_h_offlineLRJ_Et_num150_gFexLRJ, back_h_offlineLRJ_Et_denom150_gFexLRJ, 1.0, 1.0, "B");
    
    back_eff_offlineLRJ150_gFexLRJ->SetAxisRange(0, 1.1, "Y");

    back_eff_offlineLRJ150_gFexLRJ->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "back_eff_offlineLRJ150_gFexLRJ.pdf");

    TH1F* back_eff_offlineLRJ200_gFexLRJ = (TH1F*)back_h_offlineLRJ_Et_num200_gFexLRJ->Clone();
    back_eff_offlineLRJ200_gFexLRJ->SetName("eff_LRJ200_gFexLRJ");
    back_eff_offlineLRJ200_gFexLRJ->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Background)");
    back_eff_offlineLRJ200_gFexLRJ->Divide(back_h_offlineLRJ_Et_num200_gFexLRJ, back_h_offlineLRJ_Et_denom200_gFexLRJ, 1.0, 1.0, "B");
    
    back_eff_offlineLRJ200_gFexLRJ->SetAxisRange(0, 1.1, "Y");

    back_eff_offlineLRJ200_gFexLRJ->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "back_eff_offlineLRJ200_gFexLRJ.pdf");

    TH1F* back_eff_offlineLRJ250_gFexLRJ = (TH1F*)back_h_offlineLRJ_Et_num250_gFexLRJ->Clone();
    back_eff_offlineLRJ250_gFexLRJ->SetName("eff_LRJ250_gFexLRJ");
    back_eff_offlineLRJ250_gFexLRJ->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Background)");
    back_eff_offlineLRJ250_gFexLRJ->Divide(back_h_offlineLRJ_Et_num250_gFexLRJ, back_h_offlineLRJ_Et_denom250_gFexLRJ, 1.0, 1.0, "B");
    
    back_eff_offlineLRJ250_gFexLRJ->SetAxisRange(0, 1.1, "Y");

    back_eff_offlineLRJ250_gFexLRJ->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "back_eff_offlineLRJ250_gFexLRJ.pdf");


    TH1F* back_eff_offlineLRJ300_gFexLRJ = (TH1F*)back_h_offlineLRJ_Et_num300_gFexLRJ->Clone();
    back_eff_offlineLRJ300_gFexLRJ->SetName("eff_LRJ300");
    back_eff_offlineLRJ300_gFexLRJ->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Background)");
    back_eff_offlineLRJ300_gFexLRJ->Divide(back_h_offlineLRJ_Et_num300_gFexLRJ, back_h_offlineLRJ_Et_denom300_gFexLRJ, 1.0, 1.0, "B");
    
    back_eff_offlineLRJ300_gFexLRJ->SetAxisRange(0, 1.1, "Y");

    back_eff_offlineLRJ300_gFexLRJ->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "back_eff_offlineLRJ300_gFexLRJ.pdf");


    TH1F* back_eff_offlineLRJ350_gFexLRJ = (TH1F*)back_h_offlineLRJ_Et_num350_gFexLRJ->Clone();
    back_eff_offlineLRJ350_gFexLRJ->SetName("eff_LRJ350");
    back_eff_offlineLRJ350_gFexLRJ->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Background)");
    back_eff_offlineLRJ350_gFexLRJ->Divide(back_h_offlineLRJ_Et_num350_gFexLRJ, back_h_offlineLRJ_Et_denom350_gFexLRJ, 1.0, 1.0, "B");
    
    back_eff_offlineLRJ350_gFexLRJ->SetAxisRange(0, 1.1, "Y");

    back_eff_offlineLRJ350_gFexLRJ->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "back_eff_offlineLRJ350_gFexLRJ.pdf");


    TH1F* back_eff_offlineLRJ400_gFexLRJ = (TH1F*)back_h_offlineLRJ_Et_num400_gFexLRJ->Clone();
    back_eff_offlineLRJ400_gFexLRJ->SetName("eff_LRJ400");
    back_eff_offlineLRJ400_gFexLRJ->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Background)");
    back_eff_offlineLRJ400_gFexLRJ->Divide(back_h_offlineLRJ_Et_num400_gFexLRJ, back_h_offlineLRJ_Et_denom400_gFexLRJ, 1.0, 1.0, "B");
    
    back_eff_offlineLRJ400_gFexLRJ->SetAxisRange(0, 1.1, "Y");

    back_eff_offlineLRJ400_gFexLRJ->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "back_eff_offlineLRJ400_gFexLRJ.pdf");


    TH1F* back_eff_offlineLRJ450_gFexLRJ = (TH1F*)back_h_offlineLRJ_Et_num450_gFexLRJ->Clone();
    back_eff_offlineLRJ450_gFexLRJ->SetName("eff_LRJ450");
    back_eff_offlineLRJ450_gFexLRJ->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Background)");
    back_eff_offlineLRJ450_gFexLRJ->Divide(back_h_offlineLRJ_Et_num450_gFexLRJ, back_h_offlineLRJ_Et_denom450_gFexLRJ, 1.0, 1.0, "B");
    
    back_eff_offlineLRJ450_gFexLRJ->SetAxisRange(0, 1.1, "Y");

    back_eff_offlineLRJ450_gFexLRJ->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "back_eff_offlineLRJ450_gFexLRJ.pdf");


    // Draw background jFex trigger efficiencies (and create histograms with actual efficiency curves from numerators, denominators)
    TH1F* back_eff_offlineLRJ50_jFexLRJ = (TH1F*)back_h_offlineLRJ_Et_num50_jFexLRJ->Clone();
    back_eff_offlineLRJ50_jFexLRJ->SetName("eff_LRJ50");
    back_eff_offlineLRJ50_jFexLRJ->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Background)");
    back_eff_offlineLRJ50_jFexLRJ->Divide(back_h_offlineLRJ_Et_num50_jFexLRJ, back_h_offlineLRJ_Et_denom50_jFexLRJ, 1.0, 1.0, "B");
    
    back_eff_offlineLRJ50_jFexLRJ->SetAxisRange(0, 1.1, "Y");

    back_eff_offlineLRJ50_jFexLRJ->Draw();
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "back_eff_offlineLRJ50_jFexLRJ.pdf");

    TH1F* back_eff_offlineLRJ100_jFexLRJ = (TH1F*)back_h_offlineLRJ_Et_num100_jFexLRJ->Clone();
    back_eff_offlineLRJ100_jFexLRJ->SetName("eff_LRJ100");
    back_eff_offlineLRJ100_jFexLRJ->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Background)");
    back_eff_offlineLRJ100_jFexLRJ->Divide(back_h_offlineLRJ_Et_num100_jFexLRJ, back_h_offlineLRJ_Et_denom100_jFexLRJ, 1.0, 1.0, "B");
    
    back_eff_offlineLRJ100_jFexLRJ->SetAxisRange(0, 1.1, "Y");

    back_eff_offlineLRJ100_jFexLRJ->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "back_eff_offlineLRJ100_jFexLRJ.pdf");

    TH1F* back_eff_offlineLRJ150_jFexLRJ = (TH1F*)back_h_offlineLRJ_Et_num150_jFexLRJ->Clone();
    back_eff_offlineLRJ150_jFexLRJ->SetName("eff_LRJ150");
    back_eff_offlineLRJ150_jFexLRJ->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Background)");
    back_eff_offlineLRJ150_jFexLRJ->Divide(back_h_offlineLRJ_Et_num150_jFexLRJ, back_h_offlineLRJ_Et_denom150_jFexLRJ, 1.0, 1.0, "B");
    
    back_eff_offlineLRJ150_jFexLRJ->SetAxisRange(0, 1.1, "Y");

    back_eff_offlineLRJ150_jFexLRJ->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "back_eff_offlineLRJ150_jFexLRJ.pdf");

    TH1F* back_eff_offlineLRJ200_jFexLRJ = (TH1F*)back_h_offlineLRJ_Et_num200_jFexLRJ->Clone();
    back_eff_offlineLRJ200_jFexLRJ->SetName("eff_LRJ200_jFexLRJ");
    back_eff_offlineLRJ200_jFexLRJ->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Background)");
    back_eff_offlineLRJ200_jFexLRJ->Divide(back_h_offlineLRJ_Et_num200_jFexLRJ, back_h_offlineLRJ_Et_denom200_jFexLRJ, 1.0, 1.0, "B");
    
    back_eff_offlineLRJ200_jFexLRJ->SetAxisRange(0, 1.1, "Y");

    back_eff_offlineLRJ200_jFexLRJ->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "back_eff_offlineLRJ200_jFexLRJ.pdf");

    TH1F* back_eff_offlineLRJ250_jFexLRJ = (TH1F*)back_h_offlineLRJ_Et_num250_jFexLRJ->Clone();
    back_eff_offlineLRJ250_jFexLRJ->SetName("eff_LRJ250_jFexLRJ");
    back_eff_offlineLRJ250_jFexLRJ->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Background)");
    back_eff_offlineLRJ250_jFexLRJ->Divide(back_h_offlineLRJ_Et_num250_jFexLRJ, back_h_offlineLRJ_Et_denom250_jFexLRJ, 1.0, 1.0, "B");
    
    back_eff_offlineLRJ250_jFexLRJ->SetAxisRange(0, 1.1, "Y");

    back_eff_offlineLRJ250_jFexLRJ->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "back_eff_offlineLRJ250_jFexLRJ.pdf");


    TH1F* back_eff_offlineLRJ300_jFexLRJ = (TH1F*)back_h_offlineLRJ_Et_num300_jFexLRJ->Clone();
    back_eff_offlineLRJ300_jFexLRJ->SetName("eff_LRJ300");
    back_eff_offlineLRJ300_jFexLRJ->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Background)");
    back_eff_offlineLRJ300_jFexLRJ->Divide(back_h_offlineLRJ_Et_num300_jFexLRJ, back_h_offlineLRJ_Et_denom300_jFexLRJ, 1.0, 1.0, "B");
    
    back_eff_offlineLRJ300_jFexLRJ->SetAxisRange(0, 1.1, "Y");

    back_eff_offlineLRJ300_jFexLRJ->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "back_eff_offlineLRJ300_jFexLRJ.pdf");


    TH1F* back_eff_offlineLRJ350_jFexLRJ = (TH1F*)back_h_offlineLRJ_Et_num350_jFexLRJ->Clone();
    back_eff_offlineLRJ350_jFexLRJ->SetName("eff_LRJ350");
    back_eff_offlineLRJ350_jFexLRJ->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Background)");
    back_eff_offlineLRJ350_jFexLRJ->Divide(back_h_offlineLRJ_Et_num350_jFexLRJ, back_h_offlineLRJ_Et_denom350_jFexLRJ, 1.0, 1.0, "B");
    
    back_eff_offlineLRJ350_jFexLRJ->SetAxisRange(0, 1.1, "Y");

    back_eff_offlineLRJ350_jFexLRJ->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "back_eff_offlineLRJ350_jFexLRJ.pdf");


    TH1F* back_eff_offlineLRJ400_jFexLRJ = (TH1F*)back_h_offlineLRJ_Et_num400_jFexLRJ->Clone();
    back_eff_offlineLRJ400_jFexLRJ->SetName("eff_LRJ400");
    back_eff_offlineLRJ400_jFexLRJ->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Background)");
    back_eff_offlineLRJ400_jFexLRJ->Divide(back_h_offlineLRJ_Et_num400_jFexLRJ, back_h_offlineLRJ_Et_denom400_jFexLRJ, 1.0, 1.0, "B");
    
    back_eff_offlineLRJ400_jFexLRJ->SetAxisRange(0, 1.1, "Y");

    back_eff_offlineLRJ400_jFexLRJ->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "back_eff_offlineLRJ400_jFexLRJ.pdf");


    TH1F* back_eff_offlineLRJ450_jFexLRJ = (TH1F*)back_h_offlineLRJ_Et_num450_jFexLRJ->Clone();
    back_eff_offlineLRJ450_jFexLRJ->SetName("eff_LRJ450");
    back_eff_offlineLRJ450_jFexLRJ->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Background)");
    back_eff_offlineLRJ450_jFexLRJ->Divide(back_h_offlineLRJ_Et_num450_jFexLRJ, back_h_offlineLRJ_Et_denom450_jFexLRJ, 1.0, 1.0, "B");
    
    back_eff_offlineLRJ450_jFexLRJ->SetAxisRange(0, 1.1, "Y");

    back_eff_offlineLRJ450_jFexLRJ->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "back_eff_offlineLRJ450_jFexLRJ.pdf");

    // Draw background jet tagger efficiency curves

    TH1F* back_eff_offlineLRJ50 = (TH1F*)back_h_offlineLRJ_Et_num50->Clone();
    back_eff_offlineLRJ50->SetName("eff_LRJ50");
    back_eff_offlineLRJ50->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Background)");
    back_eff_offlineLRJ50->Divide(back_h_offlineLRJ_Et_num50, back_h_offlineLRJ_Et_denom50, 1.0, 1.0, "B");
    
    back_eff_offlineLRJ50->SetAxisRange(0, 1.1, "Y");

    back_eff_offlineLRJ50->Draw();
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "back_eff_offlineLRJ50.pdf");

    TH1F* back_eff_offlineLRJ100 = (TH1F*)back_h_offlineLRJ_Et_num100->Clone();
    back_eff_offlineLRJ100->SetName("eff_LRJ100");
    back_eff_offlineLRJ100->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Background)");
    back_eff_offlineLRJ100->Divide(back_h_offlineLRJ_Et_num100, back_h_offlineLRJ_Et_denom100, 1.0, 1.0, "B");
    
    back_eff_offlineLRJ100->SetAxisRange(0, 1.1, "Y");

    back_eff_offlineLRJ100->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "back_eff_offlineLRJ100.pdf");

    TH1F* back_eff_offlineLRJ150 = (TH1F*)back_h_offlineLRJ_Et_num150->Clone();
    back_eff_offlineLRJ150->SetName("eff_LRJ150");
    back_eff_offlineLRJ150->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Background)");
    back_eff_offlineLRJ150->Divide(back_h_offlineLRJ_Et_num150, back_h_offlineLRJ_Et_denom150, 1.0, 1.0, "B");
    
    back_eff_offlineLRJ150->SetAxisRange(0, 1.1, "Y");

    back_eff_offlineLRJ150->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "back_eff_offlineLRJ150.pdf");

    TH1F* back_eff_offlineLRJ200 = (TH1F*)back_h_offlineLRJ_Et_num200->Clone();
    back_eff_offlineLRJ200->SetName("eff_LRJ200");
    back_eff_offlineLRJ200->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Background)");
    back_eff_offlineLRJ200->Divide(back_h_offlineLRJ_Et_num200, back_h_offlineLRJ_Et_denom200, 1.0, 1.0, "B");
    
    back_eff_offlineLRJ200->SetAxisRange(0, 1.1, "Y");

    back_eff_offlineLRJ200->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "back_eff_offlineLRJ200.pdf");

    TH1F* back_eff_offlineLRJ250 = (TH1F*)back_h_offlineLRJ_Et_num250->Clone();
    back_eff_offlineLRJ250->SetName("eff_LRJ250");
    back_eff_offlineLRJ250->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Background)");
    back_eff_offlineLRJ250->Divide(back_h_offlineLRJ_Et_num250, back_h_offlineLRJ_Et_denom250, 1.0, 1.0, "B");
    
    back_eff_offlineLRJ250->SetAxisRange(0, 1.1, "Y");

    back_eff_offlineLRJ250->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "back_eff_offlineLRJ250.pdf");

    TH1F* back_eff_offlineLRJ300 = (TH1F*)back_h_offlineLRJ_Et_num300->Clone();
    back_eff_offlineLRJ300->SetName("eff_LRJ300");
    back_eff_offlineLRJ300->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Background)");
    back_eff_offlineLRJ300->Divide(back_h_offlineLRJ_Et_num300, back_h_offlineLRJ_Et_denom300, 1.0, 1.0, "B");
    
    back_eff_offlineLRJ300->SetAxisRange(0, 1.1, "Y");

    back_eff_offlineLRJ300->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "back_eff_offlineLRJ300.pdf");

    TH1F* back_eff_offlineLRJ350 = (TH1F*)back_h_offlineLRJ_Et_num350->Clone();
    back_eff_offlineLRJ350->SetName("eff_LRJ350");
    back_eff_offlineLRJ350->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Background)");
    back_eff_offlineLRJ350->Divide(back_h_offlineLRJ_Et_num350, back_h_offlineLRJ_Et_denom350, 1.0, 1.0, "B");
    
    back_eff_offlineLRJ350->SetAxisRange(0, 1.1, "Y");

    back_eff_offlineLRJ350->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "back_eff_offlineLRJ350.pdf");

    TH1F* back_eff_offlineLRJ400 = (TH1F*)back_h_offlineLRJ_Et_num400->Clone();
    back_eff_offlineLRJ400->SetName("eff_LRJ400");
    back_eff_offlineLRJ400->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Background)");
    back_eff_offlineLRJ400->Divide(back_h_offlineLRJ_Et_num400, back_h_offlineLRJ_Et_denom400, 1.0, 1.0, "B");
    
    back_eff_offlineLRJ400->SetAxisRange(0, 1.1, "Y");

    back_eff_offlineLRJ400->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "back_eff_offlineLRJ400.pdf");

    TH1F* back_eff_offlineLRJ450 = (TH1F*)back_h_offlineLRJ_Et_num450->Clone();
    back_eff_offlineLRJ450->SetName("eff_LRJ450");
    back_eff_offlineLRJ450->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Background)");
    back_eff_offlineLRJ450->Divide(back_h_offlineLRJ_Et_num450, back_h_offlineLRJ_Et_denom450, 1.0, 1.0, "B");
    
    back_eff_offlineLRJ450->SetAxisRange(0, 1.1, "Y");

    back_eff_offlineLRJ450->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "back_eff_offlineLRJ450.pdf");

    // Dijet trigger efficiencies (no further event selections)

    TH1F* sig_eff_offlineLRJ50_Dijet = (TH1F*)sig_h_offlineLRJ_Et_num50_Dijet->Clone();
    sig_eff_offlineLRJ50_Dijet->SetName("eff_LRJ50_Dijet");
    sig_eff_offlineLRJ50_Dijet->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ50_Dijet->Divide(sig_h_offlineLRJ_Et_num50_Dijet, sig_h_offlineLRJ_Et_denom50_Dijet, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ50_Dijet->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ50_Dijet->Draw();
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ50_Dijet.pdf");

    TH1F* sig_eff_offlineLRJ100_Dijet = (TH1F*)sig_h_offlineLRJ_Et_num100_Dijet->Clone();
    sig_eff_offlineLRJ100_Dijet->SetName("eff_LRJ100_Dijet");
    sig_eff_offlineLRJ100_Dijet->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ100_Dijet->Divide(sig_h_offlineLRJ_Et_num100_Dijet, sig_h_offlineLRJ_Et_denom100_Dijet, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ100_Dijet->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ100_Dijet->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ100_Dijet.pdf");

    TH1F* sig_eff_offlineLRJ150_Dijet = (TH1F*)sig_h_offlineLRJ_Et_num150_Dijet->Clone();
    sig_eff_offlineLRJ150_Dijet->SetName("eff_LRJ150_Dijet");
    sig_eff_offlineLRJ150_Dijet->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ150_Dijet->Divide(sig_h_offlineLRJ_Et_num150_Dijet, sig_h_offlineLRJ_Et_denom150_Dijet, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ150_Dijet->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ150_Dijet->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ150_Dijet.pdf");

    TH1F* sig_eff_offlineLRJ200_Dijet = (TH1F*)sig_h_offlineLRJ_Et_num200_Dijet->Clone();
    sig_eff_offlineLRJ200_Dijet->SetName("eff_LRJ200_Dijet");
    sig_eff_offlineLRJ200_Dijet->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ200_Dijet->Divide(sig_h_offlineLRJ_Et_num200_Dijet, sig_h_offlineLRJ_Et_denom200_Dijet, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ200_Dijet->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ200_Dijet->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ200_Dijet.pdf");

    TH1F* sig_eff_offlineLRJ250_Dijet = (TH1F*)sig_h_offlineLRJ_Et_num250_Dijet->Clone();
    sig_eff_offlineLRJ250_Dijet->SetName("eff_LRJ250_Dijet");
    sig_eff_offlineLRJ250_Dijet->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ250_Dijet->Divide(sig_h_offlineLRJ_Et_num250_Dijet, sig_h_offlineLRJ_Et_denom250_Dijet, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ250_Dijet->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ250_Dijet->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ250_Dijet.pdf");

    TH1F* sig_eff_offlineLRJ300_Dijet = (TH1F*)sig_h_offlineLRJ_Et_num300_Dijet->Clone();
    sig_eff_offlineLRJ300_Dijet->SetName("eff_LRJ300_Dijet");
    sig_eff_offlineLRJ300_Dijet->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ300_Dijet->Divide(sig_h_offlineLRJ_Et_num300_Dijet, sig_h_offlineLRJ_Et_denom300_Dijet, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ300_Dijet->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ300_Dijet->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ300_Dijet.pdf");

    TH1F* sig_eff_offlineLRJ350_Dijet = (TH1F*)sig_h_offlineLRJ_Et_num350_Dijet->Clone();
    sig_eff_offlineLRJ350_Dijet->SetName("eff_LRJ350_Dijet");
    sig_eff_offlineLRJ350_Dijet->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ350_Dijet->Divide(sig_h_offlineLRJ_Et_num350_Dijet, sig_h_offlineLRJ_Et_denom350_Dijet, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ350_Dijet->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ350_Dijet->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ350_Dijet.pdf");

    TH1F* sig_eff_offlineLRJ400_Dijet = (TH1F*)sig_h_offlineLRJ_Et_num400_Dijet->Clone();
    sig_eff_offlineLRJ400_Dijet->SetName("eff_LRJ400_Dijet");
    sig_eff_offlineLRJ400_Dijet->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ400_Dijet->Divide(sig_h_offlineLRJ_Et_num400_Dijet, sig_h_offlineLRJ_Et_denom400_Dijet, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ400_Dijet->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ400_Dijet->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ400_Dijet.pdf");

    TH1F* sig_eff_offlineLRJ450_Dijet = (TH1F*)sig_h_offlineLRJ_Et_num450_Dijet->Clone();
    sig_eff_offlineLRJ450_Dijet->SetName("eff_LRJ450_Dijet");
    sig_eff_offlineLRJ450_Dijet->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ450_Dijet->Divide(sig_h_offlineLRJ_Et_num450_Dijet, sig_h_offlineLRJ_Et_denom450_Dijet, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ450_Dijet->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ450_Dijet->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ450_Dijet.pdf");

    TH1F* sig_eff_offlineLRJ500_Dijet = (TH1F*)sig_h_offlineLRJ_Et_num500_Dijet->Clone();
    sig_eff_offlineLRJ500_Dijet->SetName("eff_LRJ500_Dijet");
    sig_eff_offlineLRJ500_Dijet->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ500_Dijet->Divide(sig_h_offlineLRJ_Et_num500_Dijet, sig_h_offlineLRJ_Et_denom500_Dijet, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ500_Dijet->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ500_Dijet->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ500_Dijet.pdf");

    // Subjet requirement efficiencies (1 subjet)

    TH1F* sig_eff_offlineLRJ50_1Subjet = (TH1F*)sig_h_offlineLRJ_Et_num50_1Subjet->Clone();
    sig_eff_offlineLRJ50_1Subjet->SetName("eff_LRJ50_1Subjet");
    sig_eff_offlineLRJ50_1Subjet->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ50_1Subjet->Divide(sig_h_offlineLRJ_Et_num50_1Subjet, sig_h_offlineLRJ_Et_denom50_1Subjet, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ50_1Subjet->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ50_1Subjet->Draw();
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ50_1Subjet.pdf");

    TH1F* sig_eff_offlineLRJ100_1Subjet = (TH1F*)sig_h_offlineLRJ_Et_num100_1Subjet->Clone();
    sig_eff_offlineLRJ100_1Subjet->SetName("eff_LRJ100_1Subjet");
    sig_eff_offlineLRJ100_1Subjet->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ100_1Subjet->Divide(sig_h_offlineLRJ_Et_num100_1Subjet, sig_h_offlineLRJ_Et_denom100_1Subjet, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ100_1Subjet->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ100_1Subjet->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ100_1Subjet.pdf");

    TH1F* sig_eff_offlineLRJ150_1Subjet = (TH1F*)sig_h_offlineLRJ_Et_num150_1Subjet->Clone();
    sig_eff_offlineLRJ150_1Subjet->SetName("eff_LRJ150_1Subjet");
    sig_eff_offlineLRJ150_1Subjet->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ150_1Subjet->Divide(sig_h_offlineLRJ_Et_num150_1Subjet, sig_h_offlineLRJ_Et_denom150_1Subjet, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ150_1Subjet->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ150_1Subjet->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ150_1Subjet.pdf");

    TH1F* sig_eff_offlineLRJ200_1Subjet = (TH1F*)sig_h_offlineLRJ_Et_num200_1Subjet->Clone();
    sig_eff_offlineLRJ200_1Subjet->SetName("eff_LRJ200_1Subjet");
    sig_eff_offlineLRJ200_1Subjet->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ200_1Subjet->Divide(sig_h_offlineLRJ_Et_num200_1Subjet, sig_h_offlineLRJ_Et_denom200_1Subjet, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ200_1Subjet->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ200_1Subjet->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ200_1Subjet.pdf");

    TH1F* sig_eff_offlineLRJ250_1Subjet = (TH1F*)sig_h_offlineLRJ_Et_num250_1Subjet->Clone();
    sig_eff_offlineLRJ250_1Subjet->SetName("eff_LRJ250_1Subjet");
    sig_eff_offlineLRJ250_1Subjet->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ250_1Subjet->Divide(sig_h_offlineLRJ_Et_num250_1Subjet, sig_h_offlineLRJ_Et_denom250_1Subjet, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ250_1Subjet->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ250_1Subjet->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ250_1Subjet.pdf");

    TH1F* sig_eff_offlineLRJ300_1Subjet = (TH1F*)sig_h_offlineLRJ_Et_num300_1Subjet->Clone();
    sig_eff_offlineLRJ300_1Subjet->SetName("eff_LRJ300_1Subjet");
    sig_eff_offlineLRJ300_1Subjet->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ300_1Subjet->Divide(sig_h_offlineLRJ_Et_num300_1Subjet, sig_h_offlineLRJ_Et_denom300_1Subjet, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ300_1Subjet->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ300_1Subjet->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ300_1Subjet.pdf");

    TH1F* sig_eff_offlineLRJ350_1Subjet = (TH1F*)sig_h_offlineLRJ_Et_num350_1Subjet->Clone();
    sig_eff_offlineLRJ350_1Subjet->SetName("eff_LRJ350_1Subjet");
    sig_eff_offlineLRJ350_1Subjet->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ350_1Subjet->Divide(sig_h_offlineLRJ_Et_num350_1Subjet, sig_h_offlineLRJ_Et_denom350_1Subjet, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ350_1Subjet->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ350_1Subjet->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ350_1Subjet.pdf");

    TH1F* sig_eff_offlineLRJ400_1Subjet = (TH1F*)sig_h_offlineLRJ_Et_num400_1Subjet->Clone();
    sig_eff_offlineLRJ400_1Subjet->SetName("eff_LRJ400_1Subjet");
    sig_eff_offlineLRJ400_1Subjet->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ400_1Subjet->Divide(sig_h_offlineLRJ_Et_num400_1Subjet, sig_h_offlineLRJ_Et_denom400_1Subjet, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ400_1Subjet->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ400_1Subjet->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ400_1Subjet.pdf");

    TH1F* sig_eff_offlineLRJ450_1Subjet = (TH1F*)sig_h_offlineLRJ_Et_num450_1Subjet->Clone();
    sig_eff_offlineLRJ450_1Subjet->SetName("eff_LRJ450_1Subjet");
    sig_eff_offlineLRJ450_1Subjet->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ450_1Subjet->Divide(sig_h_offlineLRJ_Et_num450_1Subjet, sig_h_offlineLRJ_Et_denom450_1Subjet, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ450_1Subjet->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ450_1Subjet->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ450_1Subjet.pdf");

    TH1F* sig_eff_offlineLRJ500_1Subjet = (TH1F*)sig_h_offlineLRJ_Et_num500_1Subjet->Clone();
    sig_eff_offlineLRJ500_1Subjet->SetName("eff_LRJ500_1Subjet");
    sig_eff_offlineLRJ500_1Subjet->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ500_1Subjet->Divide(sig_h_offlineLRJ_Et_num500_1Subjet, sig_h_offlineLRJ_Et_denom500_1Subjet, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ500_1Subjet->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ500_1Subjet->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ500_1Subjet.pdf");

    // Background subjet = 1 efficiencies
    TH1F* back_eff_offlineLRJ100_1Subjet = (TH1F*)back_h_offlineLRJ_Et_num100_1Subjet->Clone();
    back_eff_offlineLRJ100_1Subjet->SetName("eff_LRJ100_1Subjet");
    back_eff_offlineLRJ100_1Subjet->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Background)");
    back_eff_offlineLRJ100_1Subjet->Divide(back_h_offlineLRJ_Et_num100_1Subjet, back_h_offlineLRJ_Et_denom100_1Subjet, 1.0, 1.0, "B");
    
    back_eff_offlineLRJ100_1Subjet->SetAxisRange(0, 1.1, "Y");

    back_eff_offlineLRJ100_1Subjet->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "back_eff_offlineLRJ100_1Subjet.pdf");

    TH1F* back_eff_offlineLRJ200_1Subjet = (TH1F*)back_h_offlineLRJ_Et_num200_1Subjet->Clone();
    back_eff_offlineLRJ200_1Subjet->SetName("eff_LRJ200_1Subjet");
    back_eff_offlineLRJ200_1Subjet->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Background)");
    back_eff_offlineLRJ200_1Subjet->Divide(back_h_offlineLRJ_Et_num200_1Subjet, back_h_offlineLRJ_Et_denom200_1Subjet, 1.0, 1.0, "B");
    
    back_eff_offlineLRJ200_1Subjet->SetAxisRange(0, 1.1, "Y");

    back_eff_offlineLRJ200_1Subjet->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "back_eff_offlineLRJ200_1Subjet.pdf");

    TH1F* back_eff_offlineLRJ300_1Subjet = (TH1F*)back_h_offlineLRJ_Et_num300_1Subjet->Clone();
    back_eff_offlineLRJ300_1Subjet->SetName("eff_LRJ300_1Subjet");
    back_eff_offlineLRJ300_1Subjet->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Background)");
    back_eff_offlineLRJ300_1Subjet->Divide(back_h_offlineLRJ_Et_num300_1Subjet, back_h_offlineLRJ_Et_denom300_1Subjet, 1.0, 1.0, "B");
    
    back_eff_offlineLRJ300_1Subjet->SetAxisRange(0, 1.1, "Y");

    back_eff_offlineLRJ300_1Subjet->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "back_eff_offlineLRJ300_1Subjet.pdf");

    // Subjet requirement efficiencies (greater than or equal to 2 subjets)

    TH1F* sig_eff_offlineLRJ50_GrEq2Subjets = (TH1F*)sig_h_offlineLRJ_Et_num50_GrEq2Subjets->Clone();
    sig_eff_offlineLRJ50_GrEq2Subjets->SetName("eff_LRJ50_GrEq2Subjets");
    sig_eff_offlineLRJ50_GrEq2Subjets->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ50_GrEq2Subjets->Divide(sig_h_offlineLRJ_Et_num50_GrEq2Subjets, sig_h_offlineLRJ_Et_denom50_GrEq2Subjets, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ50_GrEq2Subjets->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ50_GrEq2Subjets->Draw();
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ50_GrEq2Subjets.pdf");

    TH1F* sig_eff_offlineLRJ100_GrEq2Subjets = (TH1F*)sig_h_offlineLRJ_Et_num100_GrEq2Subjets->Clone();
    sig_eff_offlineLRJ100_GrEq2Subjets->SetName("eff_LRJ100_GrEq2Subjets");
    sig_eff_offlineLRJ100_GrEq2Subjets->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ100_GrEq2Subjets->Divide(sig_h_offlineLRJ_Et_num100_GrEq2Subjets, sig_h_offlineLRJ_Et_denom100_GrEq2Subjets, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ100_GrEq2Subjets->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ100_GrEq2Subjets->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ100_GrEq2Subjets.pdf");

    TH1F* sig_eff_offlineLRJ150_GrEq2Subjets = (TH1F*)sig_h_offlineLRJ_Et_num150_GrEq2Subjets->Clone();
    sig_eff_offlineLRJ150_GrEq2Subjets->SetName("eff_LRJ150_GrEq2Subjets");
    sig_eff_offlineLRJ150_GrEq2Subjets->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ150_GrEq2Subjets->Divide(sig_h_offlineLRJ_Et_num150_GrEq2Subjets, sig_h_offlineLRJ_Et_denom150_GrEq2Subjets, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ150_GrEq2Subjets->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ150_GrEq2Subjets->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ150_GrEq2Subjets.pdf");

    TH1F* sig_eff_offlineLRJ200_GrEq2Subjets = (TH1F*)sig_h_offlineLRJ_Et_num200_GrEq2Subjets->Clone();
    sig_eff_offlineLRJ200_GrEq2Subjets->SetName("eff_LRJ200_GrEq2Subjets");
    sig_eff_offlineLRJ200_GrEq2Subjets->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ200_GrEq2Subjets->Divide(sig_h_offlineLRJ_Et_num200_GrEq2Subjets, sig_h_offlineLRJ_Et_denom200_GrEq2Subjets, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ200_GrEq2Subjets->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ200_GrEq2Subjets->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ200_GrEq2Subjets.pdf");

    TH1F* sig_eff_offlineLRJ250_GrEq2Subjets = (TH1F*)sig_h_offlineLRJ_Et_num250_GrEq2Subjets->Clone();
    sig_eff_offlineLRJ250_GrEq2Subjets->SetName("eff_LRJ250_GrEq2Subjets");
    sig_eff_offlineLRJ250_GrEq2Subjets->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ250_GrEq2Subjets->Divide(sig_h_offlineLRJ_Et_num250_GrEq2Subjets, sig_h_offlineLRJ_Et_denom250_GrEq2Subjets, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ250_GrEq2Subjets->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ250_GrEq2Subjets->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ250_GrEq2Subjets.pdf");

    TH1F* sig_eff_offlineLRJ300_GrEq2Subjets = (TH1F*)sig_h_offlineLRJ_Et_num300_GrEq2Subjets->Clone();
    sig_eff_offlineLRJ300_GrEq2Subjets->SetName("eff_LRJ300_GrEq2Subjets");
    sig_eff_offlineLRJ300_GrEq2Subjets->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ300_GrEq2Subjets->Divide(sig_h_offlineLRJ_Et_num300_GrEq2Subjets, sig_h_offlineLRJ_Et_denom300_GrEq2Subjets, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ300_GrEq2Subjets->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ300_GrEq2Subjets->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ300_GrEq2Subjets.pdf");

    TH1F* sig_eff_offlineLRJ350_GrEq2Subjets = (TH1F*)sig_h_offlineLRJ_Et_num350_GrEq2Subjets->Clone();
    sig_eff_offlineLRJ350_GrEq2Subjets->SetName("eff_LRJ350_GrEq2Subjets");
    sig_eff_offlineLRJ350_GrEq2Subjets->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ350_GrEq2Subjets->Divide(sig_h_offlineLRJ_Et_num350_GrEq2Subjets, sig_h_offlineLRJ_Et_denom350_GrEq2Subjets, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ350_GrEq2Subjets->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ350_GrEq2Subjets->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ350_GrEq2Subjets.pdf");

    TH1F* sig_eff_offlineLRJ400_GrEq2Subjets = (TH1F*)sig_h_offlineLRJ_Et_num400_GrEq2Subjets->Clone();
    sig_eff_offlineLRJ400_GrEq2Subjets->SetName("eff_LRJ400_GrEq2Subjets");
    sig_eff_offlineLRJ400_GrEq2Subjets->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ400_GrEq2Subjets->Divide(sig_h_offlineLRJ_Et_num400_GrEq2Subjets, sig_h_offlineLRJ_Et_denom400_GrEq2Subjets, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ400_GrEq2Subjets->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ400_GrEq2Subjets->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ400_GrEq2Subjets.pdf");

    TH1F* sig_eff_offlineLRJ450_GrEq2Subjets = (TH1F*)sig_h_offlineLRJ_Et_num450_GrEq2Subjets->Clone();
    sig_eff_offlineLRJ450_GrEq2Subjets->SetName("eff_LRJ450_GrEq2Subjets");
    sig_eff_offlineLRJ450_GrEq2Subjets->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ450_GrEq2Subjets->Divide(sig_h_offlineLRJ_Et_num450_GrEq2Subjets, sig_h_offlineLRJ_Et_denom450_GrEq2Subjets, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ450_GrEq2Subjets->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ450_GrEq2Subjets->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ450_GrEq2Subjets.pdf");

    TH1F* sig_eff_offlineLRJ500_GrEq2Subjets = (TH1F*)sig_h_offlineLRJ_Et_num500_GrEq2Subjets->Clone();
    sig_eff_offlineLRJ500_GrEq2Subjets->SetName("eff_LRJ500_GrEq2Subjets");
    sig_eff_offlineLRJ500_GrEq2Subjets->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Signal)");
    sig_eff_offlineLRJ500_GrEq2Subjets->Divide(sig_h_offlineLRJ_Et_num500_GrEq2Subjets, sig_h_offlineLRJ_Et_denom500_GrEq2Subjets, 1.0, 1.0, "B");
    
    sig_eff_offlineLRJ500_GrEq2Subjets->SetAxisRange(0, 1.1, "Y");

    sig_eff_offlineLRJ500_GrEq2Subjets->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "sig_eff_offlineLRJ500_GrEq2Subjets.pdf");

    // background greater than or equal to 2 Subjet Efficiencies
    TH1F* back_eff_offlineLRJ100_GrEq2Subjets = (TH1F*)back_h_offlineLRJ_Et_num100_GrEq2Subjets->Clone();
    back_eff_offlineLRJ100_GrEq2Subjets->SetName("back_eff_LRJ100_GrEq2Subjets");
    back_eff_offlineLRJ100_GrEq2Subjets->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Background)");
    back_eff_offlineLRJ100_GrEq2Subjets->Divide(back_h_offlineLRJ_Et_num100_GrEq2Subjets, back_h_offlineLRJ_Et_denom100_GrEq2Subjets, 1.0, 1.0, "B");
    
    back_eff_offlineLRJ100_GrEq2Subjets->SetAxisRange(0, 1.1, "Y");

    back_eff_offlineLRJ100_GrEq2Subjets->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "back_eff_offlineLRJ100_GrEq2Subjets.pdf");


    TH1F* back_eff_offlineLRJ200_GrEq2Subjets = (TH1F*)back_h_offlineLRJ_Et_num200_GrEq2Subjets->Clone();
    back_eff_offlineLRJ200_GrEq2Subjets->SetName("back_eff_LRJ200_GrEq2Subjets");
    back_eff_offlineLRJ200_GrEq2Subjets->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Background)");
    back_eff_offlineLRJ200_GrEq2Subjets->Divide(back_h_offlineLRJ_Et_num200_GrEq2Subjets, back_h_offlineLRJ_Et_denom200_GrEq2Subjets, 1.0, 1.0, "B");
    
    back_eff_offlineLRJ200_GrEq2Subjets->SetAxisRange(0, 1.1, "Y");

    back_eff_offlineLRJ200_GrEq2Subjets->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "back_eff_offlineLRJ200_GrEq2Subjets.pdf");


    TH1F* back_eff_offlineLRJ300_GrEq2Subjets = (TH1F*)back_h_offlineLRJ_Et_num300_GrEq2Subjets->Clone();
    back_eff_offlineLRJ300_GrEq2Subjets->SetName("back_eff_LRJ300_GrEq2Subjets");
    back_eff_offlineLRJ300_GrEq2Subjets->GetYaxis()->SetTitle("Emulated Trigger Efficiency (Background)");
    back_eff_offlineLRJ300_GrEq2Subjets->Divide(back_h_offlineLRJ_Et_num300_GrEq2Subjets, back_h_offlineLRJ_Et_denom300_GrEq2Subjets, 1.0, 1.0, "B");
    
    back_eff_offlineLRJ300_GrEq2Subjets->SetAxisRange(0, 1.1, "Y");

    back_eff_offlineLRJ300_GrEq2Subjets->Draw("P");
    leg->Draw();
    c.SaveAs(modifiedOutputFileDir + "back_eff_offlineLRJ300_GrEq2Subjets.pdf");

    // ===========================================================
    // Compute Likelihood Ratio (Signal / Background) TH2F plots
    // ===========================================================

    // Small protection value for empty bins
    const double epsilon = 1e-12;

    // --- Leading jets ---
    TH2F* LR_Leading = (TH2F*)sigJetTaggerLeadingLRJEtvsPsi_12->Clone("LR_Leading");
    LR_Leading->SetTitle("Likelihood Ratio (Signal/Background) - Leading");
    for (int i = 1; i <= LR_Leading->GetNbinsX(); ++i) {
        for (int j = 1; j <= LR_Leading->GetNbinsY(); ++j) {
            double s = sigJetTaggerLeadingLRJEtvsPsi_12->GetBinContent(i,j);
            double b = backJetTaggerLeadingLRJEtvsPsi_12->GetBinContent(i,j);
            double ratio = (b > 0) ? s / (b + epsilon) : 0.0;
            LR_Leading->SetBinContent(i, j, ratio);
        }
    }

    // Optionally take log10 of LR for dynamic range clarity
    TH2F* logLR_Leading = (TH2F*)LR_Leading->Clone("logLR_Leading");
    logLR_Leading->SetTitle("log10(Likelihood Ratio) - Leading");
    for (int i = 1; i <= logLR_Leading->GetNbinsX(); ++i) {
        for (int j = 1; j <= logLR_Leading->GetNbinsY(); ++j) {
            double val = LR_Leading->GetBinContent(i,j);
            logLR_Leading->SetBinContent(i,j, (val > 0) ? std::log10(val) : -10); // clip low bins
        }
    }

    // --- Subleading jets ---
    TH2F* LR_Subleading = (TH2F*)sigJetTaggerSubleadingLRJEtvsPsi_12->Clone("LR_Subleading");
    LR_Subleading->SetTitle("Likelihood Ratio (Signal/Background) - Subleading");
    for (int i = 1; i <= LR_Subleading->GetNbinsX(); ++i) {
        for (int j = 1; j <= LR_Subleading->GetNbinsY(); ++j) {
            double s = sigJetTaggerSubleadingLRJEtvsPsi_12->GetBinContent(i,j);
            double b = backJetTaggerSubleadingLRJEtvsPsi_12->GetBinContent(i,j);
            double ratio = (b > 0) ? s / (b + epsilon) : 0.0;
            LR_Subleading->SetBinContent(i, j, ratio);
        }
    }

    // Optional log10 version for visibility
    TH2F* logLR_Subleading = (TH2F*)LR_Subleading->Clone("logLR_Subleading");
    logLR_Subleading->SetTitle("log10(Likelihood Ratio) - Subleading");
    for (int i = 1; i <= logLR_Subleading->GetNbinsX(); ++i) {
        for (int j = 1; j <= logLR_Subleading->GetNbinsY(); ++j) {
            double val = LR_Subleading->GetBinContent(i,j);
            logLR_Subleading->SetBinContent(i,j, (val > 0) ? std::log10(val) : -10);
        }
    }

    // ===========================================================
    // Draw and save
    // ===========================================================
    TCanvas cLR("cLR", "Likelihood Ratios", 800, 700);
    cLR.SetLogz(); // log scale color map for clarity

    logLR_Leading->Draw("COLZ");
    logLR_Leading->GetXaxis()->SetTitle("JetTagger Leading LRJ E_{T} [GeV]");
    logLR_Leading->GetYaxis()->SetTitle("#psi_{R,Leading}/#psi_{R,Subleading}");
    cLR.SaveAs(modifiedOutputFileDir + "Psi_12_LikelihoodRatio_Leading.pdf");

    logLR_Subleading->Draw("COLZ");
    logLR_Subleading->GetXaxis()->SetTitle("JetTagger Subleading LRJ E_{T} [GeV]");
    logLR_Subleading->GetYaxis()->SetTitle("#psi_{R,Leading}/#psi_{R,Subleading}");
    cLR.SaveAs(modifiedOutputFileDir + "Psi_12_LikelihoodRatio_Subleading.pdf");

    //Psi_1 * Psi_2
    // --- Leading jets ---
    TH2F* LRSquared_Leading = (TH2F*)sigJetTaggerLeadingLRJEtvsPsi_R_squared->Clone("LRSquared_Leading");
    LRSquared_Leading->SetTitle("Likelihood Ratio (Signal/Background) - Leading");
    for (int i = 1; i <= LRSquared_Leading->GetNbinsX(); ++i) {
        for (int j = 1; j <= LRSquared_Leading->GetNbinsY(); ++j) {
            double s = sigJetTaggerLeadingLRJEtvsPsi_R_squared->GetBinContent(i,j);
            double b = backJetTaggerLeadingLRJEtvsPsi_R_squared->GetBinContent(i,j);
            double ratio = (b > 0) ? s / (b + epsilon) : 0.0;
            LRSquared_Leading->SetBinContent(i, j, ratio);
        }
    }

    // Optionally take log10 of LR for dynamic range clarity
    TH2F* logLRSquared_Leading = (TH2F*)LRSquared_Leading->Clone("logLRSquared_Leading");
    logLRSquared_Leading->SetTitle("log10(Likelihood Ratio) - Leading");
    for (int i = 1; i <= logLRSquared_Leading->GetNbinsX(); ++i) {
        for (int j = 1; j <= logLRSquared_Leading->GetNbinsY(); ++j) {
            double val = LRSquared_Leading->GetBinContent(i,j);
            logLRSquared_Leading->SetBinContent(i,j, (val > 0) ? std::log10(val) : -10); // clip low bins
        }
    }

    // --- Subleading jets ---
    TH2F* LRSquared_Subleading = (TH2F*)sigJetTaggerSubleadingLRJEtvsPsi_R_squared->Clone("LRSquared_Subleading");
    LRSquared_Subleading->SetTitle("Likelihood Ratio (Signal/Background) - Subleading");
    for (int i = 1; i <= LR_Subleading->GetNbinsX(); ++i) {
        for (int j = 1; j <= LR_Subleading->GetNbinsY(); ++j) {
            double s = sigJetTaggerSubleadingLRJEtvsPsi_R_squared->GetBinContent(i,j);
            double b = backJetTaggerSubleadingLRJEtvsPsi_R_squared->GetBinContent(i,j);
            double ratio = (b > 0) ? s / (b + epsilon) : 0.0;
            LRSquared_Subleading->SetBinContent(i, j, ratio);
        }
    }

    // Optional log10 version for visibility
    TH2F* logLRSquared_Subleading = (TH2F*)LRSquared_Subleading->Clone("logLRSquared_Subleading");
    logLRSquared_Subleading->SetTitle("log10(Likelihood Ratio) - Subleading");
    for (int i = 1; i <= logLRSquared_Subleading->GetNbinsX(); ++i) {
    for (int j = 1; j <= logLRSquared_Subleading->GetNbinsY(); ++j) {
        double val = LRSquared_Subleading->GetBinContent(i,j);
        logLRSquared_Subleading->SetBinContent(i,j, (val > 0) ? std::log10(val) : -10);
    }
    }

    // ===========================================================
    // Draw and save
    // ===========================================================
    TCanvas cLRSquared("cLSquared", "Likelihood Ratios", 800, 700);
    cLRSquared.SetLogz(); // log scale color map for clarity

    logLRSquared_Leading->Draw("COLZ");
    logLRSquared_Leading->GetXaxis()->SetTitle("JetTagger Leading LRJ E_{T} [GeV]");
    logLRSquared_Leading->GetYaxis()->SetTitle("#psi_{R,Leading} #times #psi_{R,Subleading}");
    cLRSquared.SaveAs(modifiedOutputFileDir + "Psi_R_Squared_LikelihoodRatio_Leading.pdf");

    logLRSquared_Subleading->Draw("COLZ");
    logLRSquared_Subleading->GetXaxis()->SetTitle("JetTagger Subleading LRJ E_{T} [GeV]");
    logLRSquared_Subleading->GetYaxis()->SetTitle("#psi_{R,Leading} #times #psi_{R,Subleading}");
    cLRSquared.SaveAs(modifiedOutputFileDir + "Psi_R_Squared_LikelihoodRatio_Subleading.pdf");

    //  Psi ratio computed with R^2 metric 
    // --- Leading jets ---
    TH2F* LR2_Leading = (TH2F*)sigJetTaggerLeadingLRJEtvsPsi_R2_12->Clone("LR2_Leading");
    LR2_Leading->SetTitle("Likelihood Ratio (Signal/Background) - Leading");
    for (int i = 1; i <= LR_Leading->GetNbinsX(); ++i) {
    for (int j = 1; j <= LR_Leading->GetNbinsY(); ++j) {
        double s = sigJetTaggerLeadingLRJEtvsPsi_R2_12->GetBinContent(i,j);
        double b = backJetTaggerLeadingLRJEtvsPsi_R2_12->GetBinContent(i,j);
        double ratio = (b > 0) ? s / (b + epsilon) : 0.0;
        LR2_Leading->SetBinContent(i, j, ratio);
    }
    }

    // Optionally take log10 of LR for dynamic range clarity
    TH2F* logLR2_Leading = (TH2F*)LR2_Leading->Clone("logLR2_Leading");
    logLR2_Leading->SetTitle("log10(Likelihood Ratio) - Leading");
    for (int i = 1; i <= logLR2_Leading->GetNbinsX(); ++i) {
    for (int j = 1; j <= logLR2_Leading->GetNbinsY(); ++j) {
        double val = LR2_Leading->GetBinContent(i,j);
        logLR2_Leading->SetBinContent(i,j, (val > 0) ? std::log10(val) : -10); // clip low bins
    }
    }

    // --- Subleading jets ---
    TH2F* LR2_Subleading = (TH2F*)sigJetTaggerSubleadingLRJEtvsPsi_R2_12->Clone("LR2_Subleading");
    LR2_Subleading->SetTitle("Likelihood Ratio (Signal/Background) - Subleading");
    for (int i = 1; i <= LR_Subleading->GetNbinsX(); ++i) {
    for (int j = 1; j <= LR_Subleading->GetNbinsY(); ++j) {
        double s = sigJetTaggerSubleadingLRJEtvsPsi_R2_12->GetBinContent(i,j);
        double b = backJetTaggerSubleadingLRJEtvsPsi_R2_12->GetBinContent(i,j);
        double ratio = (b > 0) ? s / (b + epsilon) : 0.0;
        LR2_Subleading->SetBinContent(i, j, ratio);
    }
    }

    // Optional log10 version for visibility
    TH2F* logLR2_Subleading = (TH2F*)LR2_Subleading->Clone("logLR2_Subleading");
    logLR2_Subleading->SetTitle("log10(Likelihood Ratio) - Subleading");
    for (int i = 1; i <= logLR2_Subleading->GetNbinsX(); ++i) {
    for (int j = 1; j <= logLR2_Subleading->GetNbinsY(); ++j) {
        double val = LR2_Subleading->GetBinContent(i,j);
        logLR2_Subleading->SetBinContent(i,j, (val > 0) ? std::log10(val) : -10);
    }
    }

    // ===========================================================
    // Draw and save
    // ===========================================================

    TCanvas cLR2("cLR2", "Likelihood Ratios", 800, 700);
    cLR2.SetLogz(); // log scale color map for clarity

    logLR2_Leading->Draw("COLZ");
    logLR2_Leading->GetXaxis()->SetTitle("JetTagger Leading LRJ E_{T} [GeV]");
    logLR2_Leading->GetYaxis()->SetTitle("#psi_{R^{2},Leading}/#psi_{R^{2},Subleading}");
    cLR2.SaveAs(modifiedOutputFileDir + "Psi_R2_12_LikelihoodRatio_Leading.pdf");

    logLR_Subleading->Draw("COLZ");
    logLR2_Subleading->GetXaxis()->SetTitle("JetTagger Subleading LRJ E_{T} [GeV]");
    logLR2_Subleading->GetYaxis()->SetTitle("#psi_{R^{2},Leading}/#psi_{R^{2},Subleading}");
    cLR2.SaveAs(modifiedOutputFileDir + "Psi_R2_12_LikelihoodRatio_Subleading.pdf");

    // N Subjets of Leading Offline LRJ vs. Leading Offline LRJ E_T likelihood ratio
    // --- Leading jets ---
    TH2F* LR_Leading_Subjets = (TH2F*)sigOfflineLeadingLRJEtvsSubjetMult->Clone("LR_Leading_Subjets");
    LR_Leading_Subjets->SetTitle("Likelihood Ratio (Signal/Background) - Leading");
    for (int i = 1; i <= LR_Leading_Subjets->GetNbinsX(); ++i) {
    for (int j = 1; j <= LR_Leading_Subjets->GetNbinsY(); ++j) {
        double s = sigOfflineLeadingLRJEtvsSubjetMult->GetBinContent(i,j);
        double b = backOfflineLeadingLRJEtvsSubjetMult->GetBinContent(i,j);
        double ratio = (b > 0) ? s / (b + epsilon) : 0.0;
        LR_Leading_Subjets->SetBinContent(i, j, ratio);
    }
    }

    // Optionally take log10 of LR for dynamic range clarity
    TH2F* logLR_Leading_Subjets = (TH2F*)LR_Leading_Subjets->Clone("logLR_Leading_Subjets");
    logLR_Leading_Subjets->SetTitle("log10(Likelihood Ratio) - Leading");
    for (int i = 1; i <= logLR_Leading_Subjets->GetNbinsX(); ++i) {
    for (int j = 1; j <= logLR_Leading_Subjets->GetNbinsY(); ++j) {
        double val = LR_Leading_Subjets->GetBinContent(i,j);
        logLR_Leading_Subjets->SetBinContent(i,j, (val > 0) ? std::log10(val) : -10); // clip low bins
    }
    }

    // --- Subleading jets ---
    /*TH2F* LR_Subleading = (TH2F*)sigJetTaggerSubleadingLRJEtvsPsi_12->Clone("LR_Subleading");
    LR_Subleading->SetTitle("Likelihood Ratio (Signal/Background) - Subleading");
    for (int i = 1; i <= LR_Subleading->GetNbinsX(); ++i) {
    for (int j = 1; j <= LR_Subleading->GetNbinsY(); ++j) {
        double s = sigJetTaggerSubleadingLRJEtvsPsi_12->GetBinContent(i,j);
        double b = backJetTaggerSubleadingLRJEtvsPsi_12->GetBinContent(i,j);
        double ratio = (b > 0) ? s / (b + epsilon) : 0.0;
        LR_Subleading->SetBinContent(i, j, ratio);
    }
    }

    // Optional log10 version for visibility
    TH2F* logLR_Subleading = (TH2F*)LR_Subleading->Clone("logLR_Subleading");
    logLR_Subleading->SetTitle("log10(Likelihood Ratio) - Subleading");
    for (int i = 1; i <= logLR_Subleading->GetNbinsX(); ++i) {
    for (int j = 1; j <= logLR_Subleading->GetNbinsY(); ++j) {
        double val = LR_Subleading->GetBinContent(i,j);
        logLR_Subleading->SetBinContent(i,j, (val > 0) ? std::log10(val) : -10);
    }
    }*/

    // ===========================================================
    // Draw and save
    // ===========================================================
    TCanvas cLR_Subjets("cLR_Subjets", "Likelihood Ratios", 800, 700);
    cLR_Subjets.SetLogz(); // log scale color map for clarity

    logLR_Leading_Subjets->Draw("COLZ");
    logLR_Leading_Subjets->GetXaxis()->SetTitle("Leading Offline LRJ E_{T} [GeV]");
    logLR_Leading_Subjets->GetYaxis()->SetTitle("N_{Subjets} (Offline Leading LRJ)");
    cLR_Subjets.SaveAs(modifiedOutputFileDir + "NSubjets_Likelihood_Ratio.pdf");

    /*logLR_Subleading->Draw("COLZ");
    logLR_Subleading->GetXaxis()->SetTitle("JetTagger Subleading LRJ E_{T} [GeV]");
    logLR_Subleading->GetYaxis()->SetTitle("#psi_{R,Leading}/#psi_{R,Subleading}");
    cLR.SaveAs(modifiedOutputFileDir + "Psi_12_LikelihoodRatio_Subleading.pdf");*/

    c.cd();
    /*if(displayEv0Sig_){
        sigTopo422Highest128SeedPositionsEv0->GetZaxis()->SetTitle("E_{T} [GeV]");
        sigTopo422Highest128SeedPositionsEv0->Draw("COLZ");

        TEllipse *sigCircle0_Ev0 = new TEllipse(jFexSeedPositionsSigEv0[0].first, jFexSeedPositionsSigEv0[0].second, 1.0, 1.0); // R in both x and y
        sigCircle0_Ev0->SetLineColor(kRed);
        sigCircle0_Ev0->SetLineWidth(2);
        sigCircle0_Ev0->SetFillStyle(0); // no fill
        sigCircle0_Ev0->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        sigCircle0_Ev0->Draw("same");    // overlay on the existing plot

        TEllipse *sigCircle1_Ev0 = new TEllipse(jFexSeedPositionsSigEv0[1].first, jFexSeedPositionsSigEv0[1].second, 1.0, 1.0); // R in both x and y
        sigCircle1_Ev0->SetLineColor(kRed);
        sigCircle1_Ev0->SetLineWidth(2);
        sigCircle1_Ev0->SetFillStyle(0); // no fill
        sigCircle1_Ev0->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        sigCircle1_Ev0->Draw("same");    // overlay on the existing plot

        TEllipse *sigCircle2_Ev0 = new TEllipse(jFexAdditionalSRJPositionsSigEv0[0].first, jFexAdditionalSRJPositionsSigEv0[0].second, 1.0, 1.0); // R in both x and y
        sigCircle2_Ev0->SetLineColor(kAzure+2);
        sigCircle2_Ev0->SetLineWidth(2);
        sigCircle2_Ev0->SetFillStyle(0); // no fill
        sigCircle2_Ev0->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        sigCircle2_Ev0->Draw("same");    // overlay on the existing plot

        TEllipse *sigCircle3_Ev0 = new TEllipse(jFexAdditionalSRJPositionsSigEv0[1].first, jFexAdditionalSRJPositionsSigEv0[1].second, 1.0, 1.0); // R in both x and y
        sigCircle3_Ev0->SetLineColor(kAzure+2);
        sigCircle3_Ev0->SetLineWidth(2);
        sigCircle3_Ev0->SetFillStyle(0); // no fill
        sigCircle3_Ev0->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        sigCircle3_Ev0->Draw("same");    // overlay on the existing plot

        TEllipse *sigCircle4_Ev0 = new TEllipse(jFexAdditionalSRJPositionsSigEv0[2].first, jFexAdditionalSRJPositionsSigEv0[2].second, 1.0, 1.0); // R in both x and y
        sigCircle4_Ev0->SetLineColor(kAzure+2);
        sigCircle4_Ev0->SetLineWidth(2);
        sigCircle4_Ev0->SetFillStyle(0); // no fill
        sigCircle4_Ev0->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        sigCircle4_Ev0->Draw("same");    // overlay on the existing plot

        TEllipse *sigCircle5_Ev0 = new TEllipse(jFexAdditionalSRJPositionsSigEv0[3].first, jFexAdditionalSRJPositionsSigEv0[3].second, 1.0, 1.0); // R in both x and y
        sigCircle5_Ev0->SetLineColor(kAzure+2);
        sigCircle5_Ev0->SetLineWidth(2);
        sigCircle5_Ev0->SetFillStyle(0); // no fill
        sigCircle5_Ev0->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        sigCircle5_Ev0->Draw("same");    // overlay on the existing plot

        TEllipse *sigCircle6_Ev0 = new TEllipse(newSeedPositionsSigEv0[0].first, newSeedPositionsSigEv0[0].second, 1.0, 1.0); // R in both x and y
        sigCircle6_Ev0->SetLineColor(kGreen+2);
        sigCircle6_Ev0->SetLineWidth(2);
        sigCircle6_Ev0->SetFillStyle(0); // no fill
        sigCircle6_Ev0->SetLineStyle(1);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        sigCircle6_Ev0->Draw("same");    // overlay on the existing plot

        TEllipse *sigCircle7_Ev0 = new TEllipse(newSeedPositionsSigEv0[1].first, newSeedPositionsSigEv0[1].second, 1.0, 1.0); // R in both x and y
        sigCircle7_Ev0->SetLineColor(kGreen+2);
        sigCircle7_Ev0->SetLineWidth(2);
        sigCircle7_Ev0->SetFillStyle(0); // no fill
        sigCircle7_Ev0->SetLineStyle(1);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        sigCircle7_Ev0->Draw("same");    // overlay on the existing plot

        // Build the label text (1st LRJ)
        TString sigLabel1Ev0 = Form("#eta=%.2f, #phi=%.2f, E_{T}=%.1f GeV, #psi_{R}=%.2f", newSeedPositionsSigEv0[0].first, newSeedPositionsSigEv0[0].second, sigLRJEtEv0[0], sigLRJPsi_REv0[0]);

        // Option 1: Use TLatex directly
        TLatex sigLat1Ev0;
        sigLat1Ev0.SetTextSize(0.025);     // Adjust size
        sigLat1Ev0.SetTextColor(kBlack); // Match sigCircle color
        sigLat1Ev0.DrawLatex(newSeedPositionsSigEv0[0].first, newSeedPositionsSigEv0[0].second + 0.6, sigLabel1Ev0); // Slightly above the sigCircle

        // Build the label text (2nd LRJ)
        TString sigLabel2Ev0 = Form("#eta=%.2f, #phi=%.2f, E_{T}=%.1f GeV, #psi_{R}=%.2f", newSeedPositionsSigEv0[1].first, newSeedPositionsSigEv0[1].second, sigLRJEtEv0[1], sigLRJPsi_REv0[1]);

        // Option 1: Use TLatex directly
        TLatex sigLat2Ev0;
        sigLat2Ev0.SetTextSize(0.025);     // Adjust size
        sigLat2Ev0.SetTextColor(kBlack); // Match sigCircle color
        sigLat2Ev0.DrawLatex(newSeedPositionsSigEv0[1].first, newSeedPositionsSigEv0[1].second + 0.6, sigLabel2Ev0); // Slightly above the sigCircle\

        c.SaveAs(modifiedOutputFileDir + "sigTopo422_highest128Et_EtaPhi_Ev0.pdf");   
    }
    
    
    
    
    if(displayEv1Sig_){
        sigTopo422Highest128SeedPositionsEv1->GetZaxis()->SetTitle("E_{T} [GeV]");
        sigTopo422Highest128SeedPositionsEv1->Draw("COLZ");

        TEllipse *sigCircle0_Ev1 = new TEllipse(jFexSeedPositionsSigEv1[0].first, jFexSeedPositionsSigEv1[0].second, 1.0, 1.0); // R in both x and y
        sigCircle0_Ev1->SetLineColor(kRed);
        sigCircle0_Ev1->SetLineWidth(2);
        sigCircle0_Ev1->SetFillStyle(0); // no fill
        sigCircle0_Ev1->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        sigCircle0_Ev1->Draw("same");    // overlay on the existing plot

        TEllipse *sigCircle1_Ev1 = new TEllipse(jFexSeedPositionsSigEv1[1].first, jFexSeedPositionsSigEv1[1].second, 1.0, 1.0); // R in both x and y
        sigCircle1_Ev1->SetLineColor(kRed);
        sigCircle1_Ev1->SetLineWidth(2);
        sigCircle1_Ev1->SetFillStyle(0); // no fill
        sigCircle1_Ev1->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        sigCircle1_Ev1->Draw("same");    // overlay on the existing plot

        TEllipse *sigCircle2_Ev1 = new TEllipse(jFexAdditionalSRJPositionsSigEv1[0].first, jFexAdditionalSRJPositionsSigEv1[0].second, 1.0, 1.0); // R in both x and y
        sigCircle2_Ev1->SetLineColor(kAzure+2);
        sigCircle2_Ev1->SetLineWidth(2);
        sigCircle2_Ev1->SetFillStyle(0); // no fill
        sigCircle2_Ev1->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        sigCircle2_Ev1->Draw("same");    // overlay on the existing plot

        TEllipse *sigCircle3_Ev1 = new TEllipse(jFexAdditionalSRJPositionsSigEv1[1].first, jFexAdditionalSRJPositionsSigEv1[1].second, 1.0, 1.0); // R in both x and y
        sigCircle3_Ev1->SetLineColor(kAzure+2);
        sigCircle3_Ev1->SetLineWidth(2);
        sigCircle3_Ev1->SetFillStyle(0); // no fill
        sigCircle3_Ev1->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        sigCircle3_Ev1->Draw("same");    // overlay on the existing plot

        TEllipse *sigCircle4_Ev1 = new TEllipse(jFexAdditionalSRJPositionsSigEv1[2].first, jFexAdditionalSRJPositionsSigEv1[2].second, 1.0, 1.0); // R in both x and y
        sigCircle4_Ev1->SetLineColor(kAzure+2);
        sigCircle4_Ev1->SetLineWidth(2);
        sigCircle4_Ev1->SetFillStyle(0); // no fill
        sigCircle4_Ev1->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        sigCircle4_Ev1->Draw("same");    // overlay on the existing plot

        TEllipse *sigCircle5_Ev1 = new TEllipse(jFexAdditionalSRJPositionsSigEv1[3].first, jFexAdditionalSRJPositionsSigEv1[3].second, 1.0, 1.0); // R in both x and y
        sigCircle5_Ev1->SetLineColor(kAzure+2);
        sigCircle5_Ev1->SetLineWidth(2);
        sigCircle5_Ev1->SetFillStyle(0); // no fill
        sigCircle5_Ev1->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        sigCircle5_Ev1->Draw("same");    // overlay on the existing plot

        TEllipse *sigCircle6_Ev1 = new TEllipse(newSeedPositionsSigEv1[0].first, newSeedPositionsSigEv1[0].second, 1.0, 1.0); // R in both x and y
        sigCircle6_Ev1->SetLineColor(kGreen+2);
        sigCircle6_Ev1->SetLineWidth(2);
        sigCircle6_Ev1->SetFillStyle(0); // no fill
        sigCircle6_Ev1->SetLineStyle(1);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        sigCircle6_Ev1->Draw("same");    // overlay on the existing plot

        TEllipse *sigCircle7_Ev1 = new TEllipse(newSeedPositionsSigEv1[1].first, newSeedPositionsSigEv1[1].second, 1.0, 1.0); // R in both x and y
        sigCircle7_Ev1->SetLineColor(kGreen+2);
        sigCircle7_Ev1->SetLineWidth(2);
        sigCircle7_Ev1->SetFillStyle(0); // no fill
        sigCircle7_Ev1->SetLineStyle(1);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        sigCircle7_Ev1->Draw("same");    // overlay on the existing plot

        // Build the label text (1st LRJ)
        TString sigLabel1Ev1 = Form("#eta=%.2f, #phi=%.2f, E_{T}=%.1f GeV, #psi_{R}=%.2f", newSeedPositionsSigEv1[0].first, newSeedPositionsSigEv1[0].second, sigLRJEtEv1[0], sigLRJPsi_REv1[0]);

        // Option 1: Use TLatex directly
        TLatex sigLat1Ev1;
        sigLat1Ev1.SetTextSize(0.025);     // Adjust size
        sigLat1Ev1.SetTextColor(kBlack); // Match sigCircle color
        sigLat1Ev1.DrawLatex(newSeedPositionsSigEv1[0].first, newSeedPositionsSigEv1[0].second + 0.6, sigLabel1Ev1); // Slightly above the sigCircle

        // Build the label text (2nd LRJ)
        TString sigLabel2Ev1 = Form("#eta=%.2f, #phi=%.2f, E_{T}=%.1f GeV, #psi_{R}=%.2f", newSeedPositionsSigEv1[1].first, newSeedPositionsSigEv1[1].second, sigLRJEtEv1[1], sigLRJPsi_REv2[1]);

        // Option 1: Use TLatex directly
        TLatex sigLat2Ev1;
        sigLat2Ev1.SetTextSize(0.025);     // Adjust size
        sigLat2Ev1.SetTextColor(kBlack); // Match sigCircle color
        sigLat2Ev1.DrawLatex(newSeedPositionsSigEv1[1].first, newSeedPositionsSigEv1[1].second + 0.6, sigLabel2Ev1); // Slightly above the sigCircle\

        c.SaveAs(modifiedOutputFileDir + "sigTopo422_highest128Et_EtaPhi_Ev1.pdf");   
    }
    
    
    if(displayEv2Sig_){
        sigTopo422Highest128SeedPositionsEv2->GetZaxis()->SetTitle("E_{T} [GeV]");
        sigTopo422Highest128SeedPositionsEv2->Draw("COLZ");


        TEllipse *sigCircle0_Ev2 = new TEllipse(jFexSeedPositionsSigEv2[0].first, jFexSeedPositionsSigEv2[0].second, 1.0, 1.0); // R in both x and y
        sigCircle0_Ev2->SetLineColor(kRed);
        sigCircle0_Ev2->SetLineWidth(2);
        sigCircle0_Ev2->SetFillStyle(0); // no fill
        sigCircle0_Ev2->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        sigCircle0_Ev2->Draw("same");    // overlay on the existing plot

        TEllipse *sigCircle1_Ev2 = new TEllipse(jFexSeedPositionsSigEv2[1].first, jFexSeedPositionsSigEv2[1].second, 1.0, 1.0); // R in both x and y
        sigCircle1_Ev2->SetLineColor(kRed);
        sigCircle1_Ev2->SetLineWidth(2);
        sigCircle1_Ev2->SetFillStyle(0); // no fill
        sigCircle1_Ev2->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        sigCircle1_Ev2->Draw("same");    // overlay on the existing plot

        TEllipse *sigCircle2_Ev2 = new TEllipse(jFexAdditionalSRJPositionsSigEv2[0].first, jFexAdditionalSRJPositionsSigEv2[0].second, 1.0, 1.0); // R in both x and y
        sigCircle2_Ev2->SetLineColor(kAzure+2);
        sigCircle2_Ev2->SetLineWidth(2);
        sigCircle2_Ev2->SetFillStyle(0); // no fill
        sigCircle2_Ev2->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        sigCircle2_Ev2->Draw("same");    // overlay on the existing plot

        TEllipse *sigCircle3_Ev2 = new TEllipse(jFexAdditionalSRJPositionsSigEv2[1].first, jFexAdditionalSRJPositionsSigEv2[1].second, 1.0, 1.0); // R in both x and y
        sigCircle3_Ev2->SetLineColor(kAzure+2);
        sigCircle3_Ev2->SetLineWidth(2);
        sigCircle3_Ev2->SetFillStyle(0); // no fill
        sigCircle3_Ev2->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        sigCircle3_Ev2->Draw("same");    // overlay on the existing plot

        TEllipse *sigCircle4_Ev2 = new TEllipse(jFexAdditionalSRJPositionsSigEv2[2].first, jFexAdditionalSRJPositionsSigEv2[2].second, 1.0, 1.0); // R in both x and y
        sigCircle4_Ev2->SetLineColor(kAzure+2);
        sigCircle4_Ev2->SetLineWidth(2);
        sigCircle4_Ev2->SetFillStyle(0); // no fill
        sigCircle4_Ev2->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        sigCircle4_Ev2->Draw("same");    // overlay on the existing plot

        TEllipse *sigCircle5_Ev2 = new TEllipse(jFexAdditionalSRJPositionsSigEv2[3].first, jFexAdditionalSRJPositionsSigEv2[3].second, 1.0, 1.0); // R in both x and y
        sigCircle5_Ev2->SetLineColor(kAzure+2);
        sigCircle5_Ev2->SetLineWidth(2);
        sigCircle5_Ev2->SetFillStyle(0); // no fill
        sigCircle5_Ev2->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        sigCircle5_Ev2->Draw("same");    // overlay on the existing plot

        TEllipse *sigCircle6_Ev2 = new TEllipse(newSeedPositionsSigEv2[0].first, newSeedPositionsSigEv2[0].second, 1.0, 1.0); // R in both x and y
        sigCircle6_Ev2->SetLineColor(kGreen+2);
        sigCircle6_Ev2->SetLineWidth(2);
        sigCircle6_Ev2->SetFillStyle(0); // no fill
        sigCircle6_Ev2->SetLineStyle(1);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        sigCircle6_Ev2->Draw("same");    // overlay on the existing plot

        TEllipse *sigCircle7_Ev2 = new TEllipse(newSeedPositionsSigEv2[1].first, newSeedPositionsSigEv2[1].second, 1.0, 1.0); // R in both x and y
        sigCircle7_Ev2->SetLineColor(kGreen+2);
        sigCircle7_Ev2->SetLineWidth(2);
        sigCircle7_Ev2->SetFillStyle(0); // no fill
        sigCircle7_Ev2->SetLineStyle(1);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        sigCircle7_Ev2->Draw("same");    // overlay on the existing plot

        // Build the label text (1st LRJ)
        TString sigLabel1Ev2 = Form("#eta=%.2f, #phi=%.2f, E_{T}=%.1f GeV, #psi_{R}=%.2f", newSeedPositionsSigEv2[0].first, newSeedPositionsSigEv2[0].second, sigLRJEtEv2[0], sigLRJPsi_REv2[0]);

        // Option 1: Use TLatex directly
        TLatex sigLat1Ev2;
        sigLat1Ev2.SetTextSize(0.025);     // Adjust size
        sigLat1Ev2.SetTextColor(kBlack); // Match sigCircle color
        sigLat1Ev2.DrawLatex(newSeedPositionsSigEv2[0].first, newSeedPositionsSigEv2[0].second + 0.6, sigLabel1Ev2); // Slightly above the sigCircle

        // Build the label text (2nd LRJ)
        TString sigLabel2Ev2 = Form("#eta=%.2f, #phi=%.2f, E_{T}=%.1f GeV, #psi_{R}=%.2f", newSeedPositionsSigEv2[1].first, newSeedPositionsSigEv2[1].second, sigLRJEtEv2[1], sigLRJPsi_REv2[1]);

        // Option 1: Use TLatex directly
        TLatex sigLat2Ev2;
        sigLat2Ev2.SetTextSize(0.025);     // Adjust size
        sigLat2Ev2.SetTextColor(kBlack); // Match sigCircle color
        sigLat2Ev2.DrawLatex(newSeedPositionsSigEv2[1].first, newSeedPositionsSigEv2[1].second + 0.6, sigLabel2Ev2); // Slightly above the sigCircle\

        c.SaveAs(modifiedOutputFileDir + "sigTopo422_highest128Et_EtaPhi_Ev2.pdf");   
    }
    if(displayEv3Sig_){
        sigTopo422Highest128SeedPositionsEv3->GetZaxis()->SetTitle("E_{T} [GeV]");
        sigTopo422Highest128SeedPositionsEv3->Draw("COLZ");


        TEllipse *sigCircle0_Ev3 = new TEllipse(jFexSeedPositionsSigEv3[0].first, jFexSeedPositionsSigEv3[0].second, 1.0, 1.0); // R in both x and y
        sigCircle0_Ev3->SetLineColor(kRed);
        sigCircle0_Ev3->SetLineWidth(2);
        sigCircle0_Ev3->SetFillStyle(0); // no fill
        sigCircle0_Ev3->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        sigCircle0_Ev3->Draw("same");    // overlay on the existing plot

        TEllipse *sigCircle1_Ev3 = new TEllipse(jFexSeedPositionsSigEv3[1].first, jFexSeedPositionsSigEv3[1].second, 1.0, 1.0); // R in both x and y
        sigCircle1_Ev3->SetLineColor(kRed);
        sigCircle1_Ev3->SetLineWidth(2);
        sigCircle1_Ev3->SetFillStyle(0); // no fill
        sigCircle1_Ev3->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        sigCircle1_Ev3->Draw("same");    // overlay on the existing plot

        TEllipse *sigCircle2_Ev3 = new TEllipse(jFexAdditionalSRJPositionsSigEv3[0].first, jFexAdditionalSRJPositionsSigEv3[0].second, 1.0, 1.0); // R in both x and y
        sigCircle2_Ev3->SetLineColor(kAzure+2);
        sigCircle2_Ev3->SetLineWidth(2);
        sigCircle2_Ev3->SetFillStyle(0); // no fill
        sigCircle2_Ev3->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        sigCircle2_Ev3->Draw("same");    // overlay on the existing plot

        TEllipse *sigCircle3_Ev3 = new TEllipse(jFexAdditionalSRJPositionsSigEv3[1].first, jFexAdditionalSRJPositionsSigEv3[1].second, 1.0, 1.0); // R in both x and y
        sigCircle3_Ev3->SetLineColor(kAzure+2);
        sigCircle3_Ev3->SetLineWidth(2);
        sigCircle3_Ev3->SetFillStyle(0); // no fill
        sigCircle3_Ev3->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        sigCircle3_Ev3->Draw("same");    // overlay on the existing plot

        TEllipse *sigCircle4_Ev3 = new TEllipse(jFexAdditionalSRJPositionsSigEv3[2].first, jFexAdditionalSRJPositionsSigEv3[2].second, 1.0, 1.0); // R in both x and y
        sigCircle4_Ev3->SetLineColor(kAzure+2);
        sigCircle4_Ev3->SetLineWidth(2);
        sigCircle4_Ev3->SetFillStyle(0); // no fill
        sigCircle4_Ev3->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        sigCircle4_Ev3->Draw("same");    // overlay on the existing plot

        TEllipse *sigCircle5_Ev3 = new TEllipse(jFexAdditionalSRJPositionsSigEv3[3].first, jFexAdditionalSRJPositionsSigEv3[3].second, 1.0, 1.0); // R in both x and y
        sigCircle5_Ev3->SetLineColor(kAzure+2);
        sigCircle5_Ev3->SetLineWidth(2);
        sigCircle5_Ev3->SetFillStyle(0); // no fill
        sigCircle5_Ev3->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        sigCircle5_Ev3->Draw("same");    // overlay on the existing plot

        TEllipse *sigCircle6_Ev3 = new TEllipse(newSeedPositionsSigEv3[0].first, newSeedPositionsSigEv3[0].second, 1.0, 1.0); // R in both x and y
        sigCircle6_Ev3->SetLineColor(kGreen+2);
        sigCircle6_Ev3->SetLineWidth(2);
        sigCircle6_Ev3->SetFillStyle(0); // no fill
        sigCircle6_Ev3->SetLineStyle(1);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        sigCircle6_Ev3->Draw("same");    // overlay on the existing plot

        TEllipse *sigCircle7_Ev3 = new TEllipse(newSeedPositionsSigEv3[1].first, newSeedPositionsSigEv3[1].second, 1.0, 1.0); // R in both x and y
        sigCircle7_Ev3->SetLineColor(kGreen+2);
        sigCircle7_Ev3->SetLineWidth(2);
        sigCircle7_Ev3->SetFillStyle(0); // no fill
        sigCircle7_Ev3->SetLineStyle(1);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        sigCircle7_Ev3->Draw("same");    // overlay on the existing plot

        // Build the label text (1st LRJ)
        TString sigLabel1Ev3 = Form("#eta=%.2f, #phi=%.2f, E_{T}=%.1f GeV, #psi_{R}=%.2f", newSeedPositionsSigEv3[0].first, newSeedPositionsSigEv3[0].second, sigLRJEtEv3[0], sigLRJPsi_REv3[0]);

        // Option 1: Use TLatex directly
        TLatex sigLat1Ev3;
        sigLat1Ev3.SetTextSize(0.025);     // Adjust size
        sigLat1Ev3.SetTextColor(kBlack); // Match sigCircle color
        sigLat1Ev3.DrawLatex(newSeedPositionsSigEv3[0].first, newSeedPositionsSigEv3[0].second + 0.6, sigLabel1Ev3); // Slightly above the sigCircle

        // Build the label text (2nd LRJ)
        TString sigLabel2Ev3 = Form("#eta=%.2f, #phi=%.2f, E_{T}=%.1f GeV, #psi_{R}=%.2f", newSeedPositionsSigEv3[1].first, newSeedPositionsSigEv3[1].second, sigLRJEtEv3[1], sigLRJPsi_REv3[1]);

        // Option 1: Use TLatex directly
        TLatex sigLat2Ev3;
        sigLat2Ev3.SetTextSize(0.025);     // Adjust size
        sigLat2Ev3.SetTextColor(kBlack); // Match sigCircle color
        sigLat2Ev3.DrawLatex(newSeedPositionsSigEv3[1].first, newSeedPositionsSigEv3[1].second + 0.6, sigLabel2Ev3); // Slightly above the sigCircle

        c.SaveAs(modifiedOutputFileDir + "sigTopo422_highest128Et_EtaPhi_Ev3.pdf");   
    }
    
    
    if(displayEv4Sig_){
        sigTopo422Highest128SeedPositionsEv4->GetZaxis()->SetTitle("E_{T} [GeV]");
        sigTopo422Highest128SeedPositionsEv4->Draw("COLZ");


        TEllipse *sigCircle0_Ev4 = new TEllipse(jFexSeedPositionsSigEv4[0].first, jFexSeedPositionsSigEv4[0].second, 1.0, 1.0); // R in both x and y
        sigCircle0_Ev4->SetLineColor(kRed);
        sigCircle0_Ev4->SetLineWidth(2);
        sigCircle0_Ev4->SetFillStyle(0); // no fill
        sigCircle0_Ev4->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        sigCircle0_Ev4->Draw("same");    // overlay on the existing plot

        TEllipse *sigCircle1_Ev4 = new TEllipse(jFexSeedPositionsSigEv4[1].first, jFexSeedPositionsSigEv4[1].second, 1.0, 1.0); // R in both x and y
        sigCircle1_Ev4->SetLineColor(kRed);
        sigCircle1_Ev4->SetLineWidth(2);
        sigCircle1_Ev4->SetFillStyle(0); // no fill
        sigCircle1_Ev4->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        sigCircle1_Ev4->Draw("same");    // overlay on the existing plot

        TEllipse *sigCircle2_Ev4 = new TEllipse(jFexAdditionalSRJPositionsSigEv4[0].first, jFexAdditionalSRJPositionsSigEv4[0].second, 1.0, 1.0); // R in both x and y
        sigCircle2_Ev4->SetLineColor(kAzure+2);
        sigCircle2_Ev4->SetLineWidth(2);
        sigCircle2_Ev4->SetFillStyle(0); // no fill
        sigCircle2_Ev4->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        sigCircle2_Ev4->Draw("same");    // overlay on the existing plot

        TEllipse *sigCircle3_Ev4 = new TEllipse(jFexAdditionalSRJPositionsSigEv4[1].first, jFexAdditionalSRJPositionsSigEv4[1].second, 1.0, 1.0); // R in both x and y
        sigCircle3_Ev4->SetLineColor(kAzure+2);
        sigCircle3_Ev4->SetLineWidth(2);
        sigCircle3_Ev4->SetFillStyle(0); // no fill
        sigCircle3_Ev4->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        sigCircle3_Ev4->Draw("same");    // overlay on the existing plot

        TEllipse *sigCircle4_Ev4 = new TEllipse(jFexAdditionalSRJPositionsSigEv4[2].first, jFexAdditionalSRJPositionsSigEv4[2].second, 1.0, 1.0); // R in both x and y
        sigCircle4_Ev4->SetLineColor(kAzure+2);
        sigCircle4_Ev4->SetLineWidth(2);
        sigCircle4_Ev4->SetFillStyle(0); // no fill
        sigCircle4_Ev4->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        sigCircle4_Ev4->Draw("same");    // overlay on the existing plot

        TEllipse *sigCircle5_Ev4 = new TEllipse(jFexAdditionalSRJPositionsSigEv4[3].first, jFexAdditionalSRJPositionsSigEv4[3].second, 1.0, 1.0); // R in both x and y
        sigCircle5_Ev4->SetLineColor(kAzure+2);
        sigCircle5_Ev4->SetLineWidth(2);
        sigCircle5_Ev4->SetFillStyle(0); // no fill
        sigCircle5_Ev4->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        sigCircle5_Ev4->Draw("same");    // overlay on the existing plot

        TEllipse *sigCircle6_Ev4 = new TEllipse(newSeedPositionsSigEv4[0].first, newSeedPositionsSigEv4[0].second, 1.0, 1.0); // R in both x and y
        sigCircle6_Ev4->SetLineColor(kGreen+2);
        sigCircle6_Ev4->SetLineWidth(2);
        sigCircle6_Ev4->SetFillStyle(0); // no fill
        sigCircle6_Ev4->SetLineStyle(1);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        sigCircle6_Ev4->Draw("same");    // overlay on the existing plot

        TEllipse *sigCircle7_Ev4 = new TEllipse(newSeedPositionsSigEv4[1].first, newSeedPositionsSigEv4[1].second, 1.0, 1.0); // R in both x and y
        sigCircle7_Ev4->SetLineColor(kGreen+2);
        sigCircle7_Ev4->SetLineWidth(2);
        sigCircle7_Ev4->SetFillStyle(0); // no fill
        sigCircle7_Ev4->SetLineStyle(1);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        sigCircle7_Ev4->Draw("same");    // overlay on the existing plot

        // Build the label text (1st LRJ)
        TString sigLabel1Ev4 = Form("#eta=%.2f, #phi=%.2f, E_{T}=%.1f GeV, #psi_{R}=%.2f", newSeedPositionsSigEv4[0].first, newSeedPositionsSigEv4[0].second, sigLRJEtEv4[0], sigLRJPsi_REv4[0]);

        // Option 1: Use TLatex directly
        TLatex sigLat1Ev4;
        sigLat1Ev4.SetTextSize(0.025);     // Adjust size
        sigLat1Ev4.SetTextColor(kBlack); // Match sigCircle color
        sigLat1Ev4.DrawLatex(newSeedPositionsSigEv4[0].first, newSeedPositionsSigEv4[0].second + 0.6, sigLabel1Ev4); // Slightly above the sigCircle

        // Build the label text (2nd LRJ)
        TString sigLabel2Ev4 = Form("#eta=%.2f, #phi=%.2f, E_{T}=%.1f GeV, #psi_{R}=%.2f", newSeedPositionsSigEv4[1].first, newSeedPositionsSigEv4[1].second, sigLRJEtEv4[1], sigLRJPsi_REv4[1]);

        // Option 1: Use TLatex directly
        TLatex sigLat2Ev4;
        sigLat2Ev4.SetTextSize(0.025);     // Adjust size
        sigLat2Ev4.SetTextColor(kBlack); // Match sigCircle color
        sigLat2Ev4.DrawLatex(newSeedPositionsSigEv4[1].first, newSeedPositionsSigEv4[1].second + 0.6, sigLabel2Ev4); // Slightly above the sigCircle

        c.SaveAs(modifiedOutputFileDir + "sigTopo422_highest128Et_EtaPhi_Ev4.pdf");   
    }*/
    
    
    // Guard: fetch ET values if available
    auto getET = [](const std::vector<double>& v, size_t i)->double {
        return (i < v.size() ? v[i] : 0.0);
    };

    /*TCanvas cEventDisplays;
    cEventDisplays.cd();

    if (displayEv0Sig_) {
        
        // ---------------- MAIN EVENT DISPLAY (NO LEGEND HERE) ----------------
        // (No right-margin fiddling so the plot doesn't warp.)
        sigTopo422Highest128SeedPositionsEv0->GetZaxis()->SetTitle("E_{T} [GeV]");
        sigTopo422Highest128SeedPositionsEv0->Draw("COLZ");

        // gFEX LRJs
        TEllipse *sigCircle0_Ev0_gFEX_Offline_JetTagger =
            new TEllipse(gFexLRJPositionSigEv0[0].first, gFexLRJPositionSigEv0[0].second, 0.9, 0.9);
        sigCircle0_Ev0_gFEX_Offline_JetTagger->SetLineColor(colors[2]);
        sigCircle0_Ev0_gFEX_Offline_JetTagger->SetLineWidth(2);
        sigCircle0_Ev0_gFEX_Offline_JetTagger->SetFillStyle(0);
        sigCircle0_Ev0_gFEX_Offline_JetTagger->SetLineStyle(1);  // leading = solid
        sigCircle0_Ev0_gFEX_Offline_JetTagger->Draw("same");

        TEllipse *sigCircle1_Ev0_gFEX_Offline_JetTagger =
            new TEllipse(gFexLRJPositionSigEv0[1].first, gFexLRJPositionSigEv0[1].second, 0.9, 0.9);
        sigCircle1_Ev0_gFEX_Offline_JetTagger->SetLineColor(colors[2]);
        sigCircle1_Ev0_gFEX_Offline_JetTagger->SetLineWidth(2);
        sigCircle1_Ev0_gFEX_Offline_JetTagger->SetFillStyle(0);
        sigCircle1_Ev0_gFEX_Offline_JetTagger->SetLineStyle(2);  // subleading = dashed
        sigCircle1_Ev0_gFEX_Offline_JetTagger->Draw("same");

        // JetTagger LRJs
        TEllipse *sigCircle2_Ev0_gFEX_Offline_JetTagger =
            new TEllipse(newSeedPositionsSigEv0[0].first, newSeedPositionsSigEv0[0].second, 1.0, 1.0);
        sigCircle2_Ev0_gFEX_Offline_JetTagger->SetLineColor(colors[3]);
        sigCircle2_Ev0_gFEX_Offline_JetTagger->SetLineWidth(2);
        sigCircle2_Ev0_gFEX_Offline_JetTagger->SetFillStyle(0);
        sigCircle2_Ev0_gFEX_Offline_JetTagger->SetLineStyle(1);  // leading = solid
        sigCircle2_Ev0_gFEX_Offline_JetTagger->Draw("same");

        TEllipse *sigCircle3_Ev0_gFEX_Offline_JetTagger =
            new TEllipse(newSeedPositionsSigEv0[1].first, newSeedPositionsSigEv0[1].second, 1.0, 1.0);
        sigCircle3_Ev0_gFEX_Offline_JetTagger->SetLineColor(colors[3]);
        sigCircle3_Ev0_gFEX_Offline_JetTagger->SetLineWidth(2);
        sigCircle3_Ev0_gFEX_Offline_JetTagger->SetFillStyle(0);
        sigCircle3_Ev0_gFEX_Offline_JetTagger->SetLineStyle(2);  // subleading = dashed
        sigCircle3_Ev0_gFEX_Offline_JetTagger->Draw("same");

        // Offline LRJs
        TEllipse *sigCircle4_Ev0_gFEX_Offline_JetTagger =
            new TEllipse(offlineLRJPositionSigEv0[0].first, offlineLRJPositionSigEv0[0].second, 1.0, 1.0);
        sigCircle4_Ev0_gFEX_Offline_JetTagger->SetLineColor(colors[4]);
        sigCircle4_Ev0_gFEX_Offline_JetTagger->SetLineWidth(2);
        sigCircle4_Ev0_gFEX_Offline_JetTagger->SetFillStyle(0);
        sigCircle4_Ev0_gFEX_Offline_JetTagger->SetLineStyle(1);  // leading = solid
        sigCircle4_Ev0_gFEX_Offline_JetTagger->Draw("same");

        TEllipse *sigCircle5_Ev0_gFEX_Offline_JetTagger =
            new TEllipse(offlineLRJPositionSigEv0[1].first, offlineLRJPositionSigEv0[1].second, 1.0, 1.0);
        sigCircle5_Ev0_gFEX_Offline_JetTagger->SetLineColor(colors[4]);
        sigCircle5_Ev0_gFEX_Offline_JetTagger->SetLineWidth(2);
        sigCircle5_Ev0_gFEX_Offline_JetTagger->SetFillStyle(0);
        sigCircle5_Ev0_gFEX_Offline_JetTagger->SetLineStyle(2);  // subleading = dashed
        sigCircle5_Ev0_gFEX_Offline_JetTagger->Draw("same");

        // Save the event display (no legend)
        
        cEventDisplays.SaveAs(modifiedOutputFileDir + "sigTopo422_highest128Et_EtaPhi_Ev0_gFEX_Offline_JetTagger.pdf");

        // ---------------- LEGEND-ONLY PDF ON A SEPARATE CANVAS ----------------
        const double gfexET_lead_Ev0 = getET(siggFexLRJEtEv0,    0);
        const double gfexET_sub_Ev0  = getET(siggFexLRJEtEv0,    1);
        const double jetET_lead_Ev0  = getET(sigLRJEtEv0,        0);
        const double jetET_sub_Ev0   = getET(sigLRJEtEv0,        1);
        const double offET_lead_Ev0  = getET(sigOfflineLRJEtEv0, 0);
        const double offET_sub_Ev0   = getET(sigOfflineLRJEtEv0, 1);

        TString lab_gfex_lead_Ev0 = Form("gFEX Leading  (E_{T}=%.1f GeV)",        gfexET_lead_Ev0);
        TString lab_gfex_sub_Ev0  = Form("gFEX Subleading (E_{T}=%.1f GeV)",      gfexET_sub_Ev0);
        TString lab_jet_lead_Ev0  = Form("JetTagger Leading  (E_{T}=%.1f GeV)",   jetET_lead_Ev0);
        TString lab_jet_sub_Ev0   = Form("JetTagger Subleading (E_{T}=%.1f GeV)", jetET_sub_Ev0);
        TString lab_off_lead_Ev0  = Form("Offline Leading  (E_{T}=%.1f GeV)",     offET_lead_Ev0);
        TString lab_off_sub_Ev0   = Form("Offline Subleading (E_{T}=%.1f GeV)",   offET_sub_Ev0);

        TCanvas cLeg_Ev0("cLeg_Ev0", "Legend Ev0", 600, 700);
        cLeg_Ev0.cd();
        cLeg_Ev0.SetBorderMode(0);
        cLeg_Ev0.SetFrameBorderMode(0);

        // Proxy lines with exact colors/styles to match circles
        TLine* gfex_lead_proxy = new TLine(0,0,1,0);  gfex_lead_proxy->SetLineColor(colors[2]); gfex_lead_proxy->SetLineStyle(1); gfex_lead_proxy->SetLineWidth(2);
        TLine* gfex_sub_proxy  = new TLine(0,0,1,0);  gfex_sub_proxy ->SetLineColor(colors[2]); gfex_sub_proxy ->SetLineStyle(2); gfex_sub_proxy ->SetLineWidth(2);

        TLine* jet_lead_proxy  = new TLine(0,0,1,0);  jet_lead_proxy ->SetLineColor(colors[3]); jet_lead_proxy ->SetLineStyle(1); jet_lead_proxy ->SetLineWidth(2);
        TLine* jet_sub_proxy   = new TLine(0,0,1,0);  jet_sub_proxy  ->SetLineColor(colors[3]); jet_sub_proxy  ->SetLineStyle(2); jet_sub_proxy  ->SetLineWidth(2);

        TLine* off_lead_proxy  = new TLine(0,0,1,0);  off_lead_proxy ->SetLineColor(colors[4]); off_lead_proxy ->SetLineStyle(1); off_lead_proxy ->SetLineWidth(2);
        TLine* off_sub_proxy   = new TLine(0,0,1,0);  off_sub_proxy  ->SetLineColor(colors[4]); off_sub_proxy  ->SetLineStyle(2); off_sub_proxy  ->SetLineWidth(2);

        TLegend* leg_only_Ev0 = new TLegend(0.08, 0.10, 0.92, 0.90);
        leg_only_Ev0->SetBorderSize(0);
        leg_only_Ev0->SetFillStyle(0);
        leg_only_Ev0->SetTextSize(0.04);
        leg_only_Ev0->SetHeader("LRJ positions", "C");

        leg_only_Ev0->AddEntry(gfex_lead_proxy, lab_gfex_lead_Ev0, "l");
        leg_only_Ev0->AddEntry(gfex_sub_proxy,  lab_gfex_sub_Ev0,  "l");
        leg_only_Ev0->AddEntry(jet_lead_proxy,  lab_jet_lead_Ev0,  "l");
        leg_only_Ev0->AddEntry(jet_sub_proxy,   lab_jet_sub_Ev0,   "l");
        leg_only_Ev0->AddEntry(off_lead_proxy,  lab_off_lead_Ev0,  "l");
        leg_only_Ev0->AddEntry(off_sub_proxy,   lab_off_sub_Ev0,   "l");

        leg_only_Ev0->Draw();

        cLeg_Ev0.Modified(); cLeg_Ev0.Update();
        cLeg_Ev0.SaveAs(modifiedOutputFileDir + "sigTopo422_highest128Et_EtaPhi_Ev0_gFEX_Offline_JetTagger_LEGEND.pdf");
    }

    if (displayEv1Sig_) {
        cEventDisplays.cd();
        
        // ---------------- MAIN EVENT DISPLAY (NO LEGEND HERE) ----------------
        // (No right-margin fiddling so the plot doesn't warp.)
        sigTopo422Highest128SeedPositionsEv1->GetZaxis()->SetTitle("E_{T} [GeV]");
        sigTopo422Highest128SeedPositionsEv1->Draw("COLZ");

        // gFEX LRJs
        TEllipse *sigCircle0_Ev1_gFEX_Offline_JetTagger =
            new TEllipse(gFexLRJPositionSigEv1[0].first, gFexLRJPositionSigEv1[0].second, 0.9, 0.9);
        sigCircle0_Ev1_gFEX_Offline_JetTagger->SetLineColor(colors[2]);
        sigCircle0_Ev1_gFEX_Offline_JetTagger->SetLineWidth(2);
        sigCircle0_Ev1_gFEX_Offline_JetTagger->SetFillStyle(0);
        sigCircle0_Ev1_gFEX_Offline_JetTagger->SetLineStyle(1);  // leading = solid
        sigCircle0_Ev1_gFEX_Offline_JetTagger->Draw("same");

        TEllipse *sigCircle1_Ev1_gFEX_Offline_JetTagger =
            new TEllipse(gFexLRJPositionSigEv1[1].first, gFexLRJPositionSigEv1[1].second, 0.9, 0.9);
        sigCircle1_Ev1_gFEX_Offline_JetTagger->SetLineColor(colors[2]);
        sigCircle1_Ev1_gFEX_Offline_JetTagger->SetLineWidth(2);
        sigCircle1_Ev1_gFEX_Offline_JetTagger->SetFillStyle(0);
        sigCircle1_Ev1_gFEX_Offline_JetTagger->SetLineStyle(2);  // subleading = dashed
        sigCircle1_Ev1_gFEX_Offline_JetTagger->Draw("same");

        // JetTagger LRJs
        TEllipse *sigCircle2_Ev1_gFEX_Offline_JetTagger =
            new TEllipse(newSeedPositionsSigEv1[0].first, newSeedPositionsSigEv1[0].second, 1.0, 1.0);
        sigCircle2_Ev1_gFEX_Offline_JetTagger->SetLineColor(colors[3]);
        sigCircle2_Ev1_gFEX_Offline_JetTagger->SetLineWidth(2);
        sigCircle2_Ev1_gFEX_Offline_JetTagger->SetFillStyle(0);
        sigCircle2_Ev1_gFEX_Offline_JetTagger->SetLineStyle(1);  // leading = solid
        sigCircle2_Ev1_gFEX_Offline_JetTagger->Draw("same");

        TEllipse *sigCircle3_Ev1_gFEX_Offline_JetTagger =
            new TEllipse(newSeedPositionsSigEv1[1].first, newSeedPositionsSigEv1[1].second, 1.0, 1.0);
        sigCircle3_Ev1_gFEX_Offline_JetTagger->SetLineColor(colors[3]);
        sigCircle3_Ev1_gFEX_Offline_JetTagger->SetLineWidth(2);
        sigCircle3_Ev1_gFEX_Offline_JetTagger->SetFillStyle(0);
        sigCircle3_Ev1_gFEX_Offline_JetTagger->SetLineStyle(2);  // subleading = dashed
        sigCircle3_Ev1_gFEX_Offline_JetTagger->Draw("same");

        // Offline LRJs
        TEllipse *sigCircle4_Ev1_gFEX_Offline_JetTagger =
            new TEllipse(offlineLRJPositionSigEv1[0].first, offlineLRJPositionSigEv1[0].second, 1.0, 1.0);
        sigCircle4_Ev1_gFEX_Offline_JetTagger->SetLineColor(colors[4]);
        sigCircle4_Ev1_gFEX_Offline_JetTagger->SetLineWidth(2);
        sigCircle4_Ev1_gFEX_Offline_JetTagger->SetFillStyle(0);
        sigCircle4_Ev1_gFEX_Offline_JetTagger->SetLineStyle(1);  // leading = solid
        sigCircle4_Ev1_gFEX_Offline_JetTagger->Draw("same");

        TEllipse *sigCircle5_Ev1_gFEX_Offline_JetTagger =
            new TEllipse(offlineLRJPositionSigEv1[1].first, offlineLRJPositionSigEv1[1].second, 1.0, 1.0);
        sigCircle5_Ev1_gFEX_Offline_JetTagger->SetLineColor(colors[4]);
        sigCircle5_Ev1_gFEX_Offline_JetTagger->SetLineWidth(2);
        sigCircle5_Ev1_gFEX_Offline_JetTagger->SetFillStyle(0);
        sigCircle5_Ev1_gFEX_Offline_JetTagger->SetLineStyle(2);  // subleading = dashed
        sigCircle5_Ev1_gFEX_Offline_JetTagger->Draw("same");

        // Save the event display (no legend)
        
        cEventDisplays.SaveAs(modifiedOutputFileDir + "sigTopo422_highest128Et_EtaPhi_Ev1_gFEX_Offline_JetTagger.pdf");

        // ---------------- LEGEND-ONLY PDF ON A SEPARATE CANVAS ----------------
        const double gfexET_lead_Ev1 = getET(siggFexLRJEtEv1,    0);
        const double gfexET_sub_Ev1  = getET(siggFexLRJEtEv1,    1);
        const double jetET_lead_Ev1  = getET(sigLRJEtEv1,        0);
        const double jetET_sub_Ev1   = getET(sigLRJEtEv1,        1);
        const double offET_lead_Ev1  = getET(sigOfflineLRJEtEv1, 0);
        const double offET_sub_Ev1   = getET(sigOfflineLRJEtEv1, 1);

        TString lab_gfex_lead_Ev1 = Form("gFEX Leading  (E_{T}=%.1f GeV)",        gfexET_lead_Ev1);
        TString lab_gfex_sub_Ev1  = Form("gFEX Subleading (E_{T}=%.1f GeV)",      gfexET_sub_Ev1);
        TString lab_jet_lead_Ev1  = Form("JetTagger Leading  (E_{T}=%.1f GeV)",   jetET_lead_Ev1);
        TString lab_jet_sub_Ev1   = Form("JetTagger Subleading (E_{T}=%.1f GeV)", jetET_sub_Ev1);
        TString lab_off_lead_Ev1  = Form("Offline Leading  (E_{T}=%.1f GeV)",     offET_lead_Ev1);
        TString lab_off_sub_Ev1   = Form("Offline Subleading (E_{T}=%.1f GeV)",   offET_sub_Ev1);

        TCanvas cLeg_Ev1("cLeg_Ev1", "Legend Ev1", 600, 700);
        cLeg_Ev1.cd();
        cLeg_Ev1.SetBorderMode(0);
        cLeg_Ev1.SetFrameBorderMode(0);

        // Proxy lines with exact colors/styles to match circles
        TLine* gfex_lead_proxy = new TLine(0,0,1,0);  gfex_lead_proxy->SetLineColor(colors[2]); gfex_lead_proxy->SetLineStyle(1); gfex_lead_proxy->SetLineWidth(2);
        TLine* gfex_sub_proxy  = new TLine(0,0,1,0);  gfex_sub_proxy ->SetLineColor(colors[2]); gfex_sub_proxy ->SetLineStyle(2); gfex_sub_proxy ->SetLineWidth(2);

        TLine* jet_lead_proxy  = new TLine(0,0,1,0);  jet_lead_proxy ->SetLineColor(colors[3]); jet_lead_proxy ->SetLineStyle(1); jet_lead_proxy ->SetLineWidth(2);
        TLine* jet_sub_proxy   = new TLine(0,0,1,0);  jet_sub_proxy  ->SetLineColor(colors[3]); jet_sub_proxy  ->SetLineStyle(2); jet_sub_proxy  ->SetLineWidth(2);

        TLine* off_lead_proxy  = new TLine(0,0,1,0);  off_lead_proxy ->SetLineColor(colors[4]); off_lead_proxy ->SetLineStyle(1); off_lead_proxy ->SetLineWidth(2);
        TLine* off_sub_proxy   = new TLine(0,0,1,0);  off_sub_proxy  ->SetLineColor(colors[4]); off_sub_proxy  ->SetLineStyle(2); off_sub_proxy  ->SetLineWidth(2);

        TLegend* leg_only_Ev1 = new TLegend(0.08, 0.10, 0.92, 0.90);
        leg_only_Ev1->SetBorderSize(0);
        leg_only_Ev1->SetFillStyle(0);
        leg_only_Ev1->SetTextSize(0.04);
        leg_only_Ev1->SetHeader("LRJ positions", "C");

        leg_only_Ev1->AddEntry(gfex_lead_proxy, lab_gfex_lead_Ev1, "l");
        leg_only_Ev1->AddEntry(gfex_sub_proxy,  lab_gfex_sub_Ev1,  "l");
        leg_only_Ev1->AddEntry(jet_lead_proxy,  lab_jet_lead_Ev1,  "l");
        leg_only_Ev1->AddEntry(jet_sub_proxy,   lab_jet_sub_Ev1,   "l");
        leg_only_Ev1->AddEntry(off_lead_proxy,  lab_off_lead_Ev1,  "l");
        leg_only_Ev1->AddEntry(off_sub_proxy,   lab_off_sub_Ev1,   "l");

        leg_only_Ev1->Draw();

        cLeg_Ev1.Modified(); cLeg_Ev1.Update();
        cLeg_Ev1.SaveAs(modifiedOutputFileDir + "sigTopo422_highest128Et_EtaPhi_Ev1_gFEX_Offline_JetTagger_LEGEND.pdf");
    }

    if (displayEv2Sig_) {
        cEventDisplays.cd();
        
        // ---------------- MAIN EVENT DISPLAY (NO LEGEND HERE) ----------------
        // (No right-margin fiddling so the plot doesn't warp.)
        sigTopo422Highest128SeedPositionsEv2->GetZaxis()->SetTitle("E_{T} [GeV]");
        sigTopo422Highest128SeedPositionsEv2->Draw("COLZ");

        // gFEX LRJs
        TEllipse *sigCircle0_Ev2_gFEX_Offline_JetTagger =
            new TEllipse(gFexLRJPositionSigEv2[0].first, gFexLRJPositionSigEv2[0].second, 0.9, 0.9);
        sigCircle0_Ev2_gFEX_Offline_JetTagger->SetLineColor(colors[2]);
        sigCircle0_Ev2_gFEX_Offline_JetTagger->SetLineWidth(2);
        sigCircle0_Ev2_gFEX_Offline_JetTagger->SetFillStyle(0);
        sigCircle0_Ev2_gFEX_Offline_JetTagger->SetLineStyle(1);  // leading = solid
        sigCircle0_Ev2_gFEX_Offline_JetTagger->Draw("same");

        TEllipse *sigCircle1_Ev2_gFEX_Offline_JetTagger =
            new TEllipse(gFexLRJPositionSigEv2[1].first, gFexLRJPositionSigEv2[1].second, 0.9, 0.9);
        sigCircle1_Ev2_gFEX_Offline_JetTagger->SetLineColor(colors[2]);
        sigCircle1_Ev2_gFEX_Offline_JetTagger->SetLineWidth(2);
        sigCircle1_Ev2_gFEX_Offline_JetTagger->SetFillStyle(0);
        sigCircle1_Ev2_gFEX_Offline_JetTagger->SetLineStyle(2);  // subleading = dashed
        sigCircle1_Ev2_gFEX_Offline_JetTagger->Draw("same");

        // JetTagger LRJs
        TEllipse *sigCircle2_Ev2_gFEX_Offline_JetTagger =
            new TEllipse(newSeedPositionsSigEv2[0].first, newSeedPositionsSigEv2[0].second, 1.0, 1.0);
        sigCircle2_Ev2_gFEX_Offline_JetTagger->SetLineColor(colors[3]);
        sigCircle2_Ev2_gFEX_Offline_JetTagger->SetLineWidth(2);
        sigCircle2_Ev2_gFEX_Offline_JetTagger->SetFillStyle(0);
        sigCircle2_Ev2_gFEX_Offline_JetTagger->SetLineStyle(1);  // leading = solid
        sigCircle2_Ev2_gFEX_Offline_JetTagger->Draw("same");

        TEllipse *sigCircle3_Ev2_gFEX_Offline_JetTagger =
            new TEllipse(newSeedPositionsSigEv2[1].first, newSeedPositionsSigEv2[1].second, 1.0, 1.0);
        sigCircle3_Ev2_gFEX_Offline_JetTagger->SetLineColor(colors[3]);
        sigCircle3_Ev2_gFEX_Offline_JetTagger->SetLineWidth(2);
        sigCircle3_Ev2_gFEX_Offline_JetTagger->SetFillStyle(0);
        sigCircle3_Ev2_gFEX_Offline_JetTagger->SetLineStyle(2);  // subleading = dashed
        sigCircle3_Ev2_gFEX_Offline_JetTagger->Draw("same");

        // Offline LRJs
        TEllipse *sigCircle4_Ev2_gFEX_Offline_JetTagger =
            new TEllipse(offlineLRJPositionSigEv2[0].first, offlineLRJPositionSigEv2[0].second, 1.0, 1.0);
        sigCircle4_Ev2_gFEX_Offline_JetTagger->SetLineColor(colors[4]);
        sigCircle4_Ev2_gFEX_Offline_JetTagger->SetLineWidth(2);
        sigCircle4_Ev2_gFEX_Offline_JetTagger->SetFillStyle(0);
        sigCircle4_Ev2_gFEX_Offline_JetTagger->SetLineStyle(1);  // leading = solid
        sigCircle4_Ev2_gFEX_Offline_JetTagger->Draw("same");

        TEllipse *sigCircle5_Ev2_gFEX_Offline_JetTagger =
            new TEllipse(offlineLRJPositionSigEv2[1].first, offlineLRJPositionSigEv2[1].second, 1.0, 1.0);
        sigCircle5_Ev2_gFEX_Offline_JetTagger->SetLineColor(colors[4]);
        sigCircle5_Ev2_gFEX_Offline_JetTagger->SetLineWidth(2);
        sigCircle5_Ev2_gFEX_Offline_JetTagger->SetFillStyle(0);
        sigCircle5_Ev2_gFEX_Offline_JetTagger->SetLineStyle(2);  // subleading = dashed
        sigCircle5_Ev2_gFEX_Offline_JetTagger->Draw("same");

        // Save the event display (no legend)
        
        cEventDisplays.SaveAs(modifiedOutputFileDir + "sigTopo422_highest128Et_EtaPhi_Ev2_gFEX_Offline_JetTagger.pdf");

        // ---------------- LEGEND-ONLY PDF ON A SEPARATE CANVAS ----------------
        const double gfexET_lead_Ev2 = getET(siggFexLRJEtEv2,    0);
        const double gfexET_sub_Ev2  = getET(siggFexLRJEtEv2,    1);
        const double jetET_lead_Ev2  = getET(sigLRJEtEv2,        0);
        const double jetET_sub_Ev2   = getET(sigLRJEtEv2,        1);
        const double offET_lead_Ev2  = getET(sigOfflineLRJEtEv2, 0);
        const double offET_sub_Ev2   = getET(sigOfflineLRJEtEv2, 1);

        TString lab_gfex_lead_Ev2 = Form("gFEX Leading  (E_{T}=%.1f GeV)",        gfexET_lead_Ev2);
        TString lab_gfex_sub_Ev2  = Form("gFEX Subleading (E_{T}=%.1f GeV)",      gfexET_sub_Ev2);
        TString lab_jet_lead_Ev2  = Form("JetTagger Leading  (E_{T}=%.1f GeV)",   jetET_lead_Ev2);
        TString lab_jet_sub_Ev2   = Form("JetTagger Subleading (E_{T}=%.1f GeV)", jetET_sub_Ev2);
        TString lab_off_lead_Ev2  = Form("Offline Leading  (E_{T}=%.1f GeV)",     offET_lead_Ev2);
        TString lab_off_sub_Ev2   = Form("Offline Subleading (E_{T}=%.1f GeV)",   offET_sub_Ev2);

        TCanvas cLeg_Ev2("cLeg_Ev2", "Legend Ev2", 600, 700);
        cLeg_Ev2.cd();
        cLeg_Ev2.SetBorderMode(0);
        cLeg_Ev2.SetFrameBorderMode(0);

        // Proxy lines with exact colors/styles to match circles
        TLine* gfex_lead_proxy = new TLine(0,0,1,0);  gfex_lead_proxy->SetLineColor(colors[2]); gfex_lead_proxy->SetLineStyle(1); gfex_lead_proxy->SetLineWidth(2);
        TLine* gfex_sub_proxy  = new TLine(0,0,1,0);  gfex_sub_proxy ->SetLineColor(colors[2]); gfex_sub_proxy ->SetLineStyle(2); gfex_sub_proxy ->SetLineWidth(2);

        TLine* jet_lead_proxy  = new TLine(0,0,1,0);  jet_lead_proxy ->SetLineColor(colors[3]); jet_lead_proxy ->SetLineStyle(1); jet_lead_proxy ->SetLineWidth(2);
        TLine* jet_sub_proxy   = new TLine(0,0,1,0);  jet_sub_proxy  ->SetLineColor(colors[3]); jet_sub_proxy  ->SetLineStyle(2); jet_sub_proxy  ->SetLineWidth(2);

        TLine* off_lead_proxy  = new TLine(0,0,1,0);  off_lead_proxy ->SetLineColor(colors[4]); off_lead_proxy ->SetLineStyle(1); off_lead_proxy ->SetLineWidth(2);
        TLine* off_sub_proxy   = new TLine(0,0,1,0);  off_sub_proxy  ->SetLineColor(colors[4]); off_sub_proxy  ->SetLineStyle(2); off_sub_proxy  ->SetLineWidth(2);

        TLegend* leg_only_Ev2 = new TLegend(0.08, 0.10, 0.92, 0.90);
        leg_only_Ev2->SetBorderSize(0);
        leg_only_Ev2->SetFillStyle(0);
        leg_only_Ev2->SetTextSize(0.04);
        leg_only_Ev2->SetHeader("LRJ positions", "C");

        leg_only_Ev2->AddEntry(gfex_lead_proxy, lab_gfex_lead_Ev2, "l");
        leg_only_Ev2->AddEntry(gfex_sub_proxy,  lab_gfex_sub_Ev2,  "l");
        leg_only_Ev2->AddEntry(jet_lead_proxy,  lab_jet_lead_Ev2,  "l");
        leg_only_Ev2->AddEntry(jet_sub_proxy,   lab_jet_sub_Ev2,   "l");
        leg_only_Ev2->AddEntry(off_lead_proxy,  lab_off_lead_Ev2,  "l");
        leg_only_Ev2->AddEntry(off_sub_proxy,   lab_off_sub_Ev2,   "l");

        leg_only_Ev2->Draw();

        cLeg_Ev2.Modified(); cLeg_Ev2.Update();
        cLeg_Ev2.SaveAs(modifiedOutputFileDir + "sigTopo422_highest128Et_EtaPhi_Ev2_gFEX_Offline_JetTagger_LEGEND.pdf");
    }

    if (displayEv3Sig_) {
        cEventDisplays.cd();
        
        // ---------------- MAIN EVENT DISPLAY (NO LEGEND HERE) ----------------
        // (No right-margin fiddling so the plot doesn't warp.)
        sigTopo422Highest128SeedPositionsEv3->GetZaxis()->SetTitle("E_{T} [GeV]");
        sigTopo422Highest128SeedPositionsEv3->Draw("COLZ");

        // gFEX LRJs
        TEllipse *sigCircle0_Ev3_gFEX_Offline_JetTagger =
            new TEllipse(gFexLRJPositionSigEv3[0].first, gFexLRJPositionSigEv3[0].second, 0.9, 0.9);
        sigCircle0_Ev3_gFEX_Offline_JetTagger->SetLineColor(colors[2]);
        sigCircle0_Ev3_gFEX_Offline_JetTagger->SetLineWidth(2);
        sigCircle0_Ev3_gFEX_Offline_JetTagger->SetFillStyle(0);
        sigCircle0_Ev3_gFEX_Offline_JetTagger->SetLineStyle(1);  // leading = solid
        sigCircle0_Ev3_gFEX_Offline_JetTagger->Draw("same");

        TEllipse *sigCircle1_Ev3_gFEX_Offline_JetTagger =
            new TEllipse(gFexLRJPositionSigEv3[1].first, gFexLRJPositionSigEv3[1].second, 0.9, 0.9);
        sigCircle1_Ev3_gFEX_Offline_JetTagger->SetLineColor(colors[2]);
        sigCircle1_Ev3_gFEX_Offline_JetTagger->SetLineWidth(2);
        sigCircle1_Ev3_gFEX_Offline_JetTagger->SetFillStyle(0);
        sigCircle1_Ev3_gFEX_Offline_JetTagger->SetLineStyle(2);  // subleading = dashed
        sigCircle1_Ev3_gFEX_Offline_JetTagger->Draw("same");

        // JetTagger LRJs
        TEllipse *sigCircle2_Ev3_gFEX_Offline_JetTagger =
            new TEllipse(newSeedPositionsSigEv3[0].first, newSeedPositionsSigEv3[0].second, 1.0, 1.0);
        sigCircle2_Ev3_gFEX_Offline_JetTagger->SetLineColor(colors[3]);
        sigCircle2_Ev3_gFEX_Offline_JetTagger->SetLineWidth(2);
        sigCircle2_Ev3_gFEX_Offline_JetTagger->SetFillStyle(0);
        sigCircle2_Ev3_gFEX_Offline_JetTagger->SetLineStyle(1);  // leading = solid
        sigCircle2_Ev3_gFEX_Offline_JetTagger->Draw("same");

        TEllipse *sigCircle3_Ev3_gFEX_Offline_JetTagger =
            new TEllipse(newSeedPositionsSigEv3[1].first, newSeedPositionsSigEv3[1].second, 1.0, 1.0);
        sigCircle3_Ev3_gFEX_Offline_JetTagger->SetLineColor(colors[3]);
        sigCircle3_Ev3_gFEX_Offline_JetTagger->SetLineWidth(2);
        sigCircle3_Ev3_gFEX_Offline_JetTagger->SetFillStyle(0);
        sigCircle3_Ev3_gFEX_Offline_JetTagger->SetLineStyle(2);  // subleading = dashed
        sigCircle3_Ev3_gFEX_Offline_JetTagger->Draw("same");

        // Offline LRJs
        TEllipse *sigCircle4_Ev3_gFEX_Offline_JetTagger =
            new TEllipse(offlineLRJPositionSigEv3[0].first, offlineLRJPositionSigEv3[0].second, 1.0, 1.0);
        sigCircle4_Ev3_gFEX_Offline_JetTagger->SetLineColor(colors[4]);
        sigCircle4_Ev3_gFEX_Offline_JetTagger->SetLineWidth(2);
        sigCircle4_Ev3_gFEX_Offline_JetTagger->SetFillStyle(0);
        sigCircle4_Ev3_gFEX_Offline_JetTagger->SetLineStyle(1);  // leading = solid
        sigCircle4_Ev3_gFEX_Offline_JetTagger->Draw("same");

        TEllipse *sigCircle5_Ev3_gFEX_Offline_JetTagger =
            new TEllipse(offlineLRJPositionSigEv3[1].first, offlineLRJPositionSigEv3[1].second, 1.0, 1.0);
        sigCircle5_Ev3_gFEX_Offline_JetTagger->SetLineColor(colors[4]);
        sigCircle5_Ev3_gFEX_Offline_JetTagger->SetLineWidth(2);
        sigCircle5_Ev3_gFEX_Offline_JetTagger->SetFillStyle(0);
        sigCircle5_Ev3_gFEX_Offline_JetTagger->SetLineStyle(2);  // subleading = dashed
        sigCircle5_Ev3_gFEX_Offline_JetTagger->Draw("same");

        // Save the event display (no legend)
        
        cEventDisplays.SaveAs(modifiedOutputFileDir + "sigTopo422_highest128Et_EtaPhi_Ev3_gFEX_Offline_JetTagger.pdf");

        // ---------------- LEGEND-ONLY PDF ON A SEPARATE CANVAS ----------------
        const double gfexET_lead_Ev3 = getET(siggFexLRJEtEv3,    0);
        const double gfexET_sub_Ev3  = getET(siggFexLRJEtEv3,    1);
        const double jetET_lead_Ev3  = getET(sigLRJEtEv3,        0);
        const double jetET_sub_Ev3   = getET(sigLRJEtEv3,        1);
        const double offET_lead_Ev3  = getET(sigOfflineLRJEtEv3, 0);
        const double offET_sub_Ev3   = getET(sigOfflineLRJEtEv3, 1);

        TString lab_gfex_lead_Ev3 = Form("gFEX Leading  (E_{T}=%.1f GeV)",        gfexET_lead_Ev3);
        TString lab_gfex_sub_Ev3  = Form("gFEX Subleading (E_{T}=%.1f GeV)",      gfexET_sub_Ev3);
        TString lab_jet_lead_Ev3  = Form("JetTagger Leading  (E_{T}=%.1f GeV)",   jetET_lead_Ev3);
        TString lab_jet_sub_Ev3   = Form("JetTagger Subleading (E_{T}=%.1f GeV)", jetET_sub_Ev3);
        TString lab_off_lead_Ev3  = Form("Offline Leading  (E_{T}=%.1f GeV)",     offET_lead_Ev3);
        TString lab_off_sub_Ev3   = Form("Offline Subleading (E_{T}=%.1f GeV)",   offET_sub_Ev3);

        TCanvas cLeg_Ev3("cLeg_Ev3", "Legend Ev3", 600, 700);
        cLeg_Ev3.cd();
        cLeg_Ev3.SetBorderMode(0);
        cLeg_Ev3.SetFrameBorderMode(0);

        // Proxy lines with exact colors/styles to match circles
        TLine* gfex_lead_proxy = new TLine(0,0,1,0);  gfex_lead_proxy->SetLineColor(colors[2]); gfex_lead_proxy->SetLineStyle(1); gfex_lead_proxy->SetLineWidth(2);
        TLine* gfex_sub_proxy  = new TLine(0,0,1,0);  gfex_sub_proxy ->SetLineColor(colors[2]); gfex_sub_proxy ->SetLineStyle(2); gfex_sub_proxy ->SetLineWidth(2);

        TLine* jet_lead_proxy  = new TLine(0,0,1,0);  jet_lead_proxy ->SetLineColor(colors[3]); jet_lead_proxy ->SetLineStyle(1); jet_lead_proxy ->SetLineWidth(2);
        TLine* jet_sub_proxy   = new TLine(0,0,1,0);  jet_sub_proxy  ->SetLineColor(colors[3]); jet_sub_proxy  ->SetLineStyle(2); jet_sub_proxy  ->SetLineWidth(2);

        TLine* off_lead_proxy  = new TLine(0,0,1,0);  off_lead_proxy ->SetLineColor(colors[4]); off_lead_proxy ->SetLineStyle(1); off_lead_proxy ->SetLineWidth(2);
        TLine* off_sub_proxy   = new TLine(0,0,1,0);  off_sub_proxy  ->SetLineColor(colors[4]); off_sub_proxy  ->SetLineStyle(2); off_sub_proxy  ->SetLineWidth(2);

        TLegend* leg_only_Ev3 = new TLegend(0.08, 0.10, 0.92, 0.90);
        leg_only_Ev3->SetBorderSize(0);
        leg_only_Ev3->SetFillStyle(0);
        leg_only_Ev3->SetTextSize(0.04);
        leg_only_Ev3->SetHeader("LRJ positions", "C");

        leg_only_Ev3->AddEntry(gfex_lead_proxy, lab_gfex_lead_Ev3, "l");
        leg_only_Ev3->AddEntry(gfex_sub_proxy,  lab_gfex_sub_Ev3,  "l");
        leg_only_Ev3->AddEntry(jet_lead_proxy,  lab_jet_lead_Ev3,  "l");
        leg_only_Ev3->AddEntry(jet_sub_proxy,   lab_jet_sub_Ev3,   "l");
        leg_only_Ev3->AddEntry(off_lead_proxy,  lab_off_lead_Ev3,  "l");
        leg_only_Ev3->AddEntry(off_sub_proxy,   lab_off_sub_Ev3,   "l");

        leg_only_Ev3->Draw();

        cLeg_Ev3.Modified(); cLeg_Ev3.Update();
        cLeg_Ev3.SaveAs(modifiedOutputFileDir + "sigTopo422_highest128Et_EtaPhi_Ev3_gFEX_Offline_JetTagger_LEGEND.pdf");
    }

    if (displayEv4Sig_) {
        cEventDisplays.cd();
        
        // ---------------- MAIN EVENT DISPLAY (NO LEGEND HERE) ----------------
        // (No right-margin fiddling so the plot doesn't warp.)
        sigTopo422Highest128SeedPositionsEv4->GetZaxis()->SetTitle("E_{T} [GeV]");
        sigTopo422Highest128SeedPositionsEv4->Draw("COLZ");

        // gFEX LRJs
        TEllipse *sigCircle0_Ev4_gFEX_Offline_JetTagger =
            new TEllipse(gFexLRJPositionSigEv4[0].first, gFexLRJPositionSigEv4[0].second, 0.9, 0.9);
        sigCircle0_Ev4_gFEX_Offline_JetTagger->SetLineColor(colors[2]);
        sigCircle0_Ev4_gFEX_Offline_JetTagger->SetLineWidth(2);
        sigCircle0_Ev4_gFEX_Offline_JetTagger->SetFillStyle(0);
        sigCircle0_Ev4_gFEX_Offline_JetTagger->SetLineStyle(1);  // leading = solid
        sigCircle0_Ev4_gFEX_Offline_JetTagger->Draw("same");

        TEllipse *sigCircle1_Ev4_gFEX_Offline_JetTagger =
            new TEllipse(gFexLRJPositionSigEv4[1].first, gFexLRJPositionSigEv4[1].second, 0.9, 0.9);
        sigCircle1_Ev4_gFEX_Offline_JetTagger->SetLineColor(colors[2]);
        sigCircle1_Ev4_gFEX_Offline_JetTagger->SetLineWidth(2);
        sigCircle1_Ev4_gFEX_Offline_JetTagger->SetFillStyle(0);
        sigCircle1_Ev4_gFEX_Offline_JetTagger->SetLineStyle(2);  // subleading = dashed
        sigCircle1_Ev4_gFEX_Offline_JetTagger->Draw("same");

        // JetTagger LRJs
        TEllipse *sigCircle2_Ev4_gFEX_Offline_JetTagger =
            new TEllipse(newSeedPositionsSigEv4[0].first, newSeedPositionsSigEv4[0].second, 1.0, 1.0);
        sigCircle2_Ev4_gFEX_Offline_JetTagger->SetLineColor(colors[3]);
        sigCircle2_Ev4_gFEX_Offline_JetTagger->SetLineWidth(2);
        sigCircle2_Ev4_gFEX_Offline_JetTagger->SetFillStyle(0);
        sigCircle2_Ev4_gFEX_Offline_JetTagger->SetLineStyle(1);  // leading = solid
        sigCircle2_Ev4_gFEX_Offline_JetTagger->Draw("same");

        TEllipse *sigCircle3_Ev4_gFEX_Offline_JetTagger =
            new TEllipse(newSeedPositionsSigEv4[1].first, newSeedPositionsSigEv4[1].second, 1.0, 1.0);
        sigCircle3_Ev4_gFEX_Offline_JetTagger->SetLineColor(colors[3]);
        sigCircle3_Ev4_gFEX_Offline_JetTagger->SetLineWidth(2);
        sigCircle3_Ev4_gFEX_Offline_JetTagger->SetFillStyle(0);
        sigCircle3_Ev4_gFEX_Offline_JetTagger->SetLineStyle(2);  // subleading = dashed
        sigCircle3_Ev4_gFEX_Offline_JetTagger->Draw("same");

        // Offline LRJs
        TEllipse *sigCircle4_Ev4_gFEX_Offline_JetTagger =
            new TEllipse(offlineLRJPositionSigEv4[0].first, offlineLRJPositionSigEv4[0].second, 1.0, 1.0);
        sigCircle4_Ev4_gFEX_Offline_JetTagger->SetLineColor(colors[4]);
        sigCircle4_Ev4_gFEX_Offline_JetTagger->SetLineWidth(2);
        sigCircle4_Ev4_gFEX_Offline_JetTagger->SetFillStyle(0);
        sigCircle4_Ev4_gFEX_Offline_JetTagger->SetLineStyle(1);  // leading = solid
        sigCircle4_Ev4_gFEX_Offline_JetTagger->Draw("same");

        TEllipse *sigCircle5_Ev4_gFEX_Offline_JetTagger =
            new TEllipse(offlineLRJPositionSigEv4[1].first, offlineLRJPositionSigEv4[1].second, 1.0, 1.0);
        sigCircle5_Ev4_gFEX_Offline_JetTagger->SetLineColor(colors[4]);
        sigCircle5_Ev4_gFEX_Offline_JetTagger->SetLineWidth(2);
        sigCircle5_Ev4_gFEX_Offline_JetTagger->SetFillStyle(0);
        sigCircle5_Ev4_gFEX_Offline_JetTagger->SetLineStyle(2);  // subleading = dashed
        sigCircle5_Ev4_gFEX_Offline_JetTagger->Draw("same");

        // Save the event display (no legend)
        
        cEventDisplays.SaveAs(modifiedOutputFileDir + "sigTopo422_highest128Et_EtaPhi_Ev4_gFEX_Offline_JetTagger.pdf");

        // ---------------- LEGEND-ONLY PDF ON A SEPARATE CANVAS ----------------
        const double gfexET_lead_Ev4 = getET(siggFexLRJEtEv4,    0);
        const double gfexET_sub_Ev4  = getET(siggFexLRJEtEv4,    1);
        const double jetET_lead_Ev4  = getET(sigLRJEtEv4,        0);
        const double jetET_sub_Ev4   = getET(sigLRJEtEv4,        1);
        const double offET_lead_Ev4  = getET(sigOfflineLRJEtEv4, 0);
        const double offET_sub_Ev4   = getET(sigOfflineLRJEtEv4, 1);

        TString lab_gfex_lead_Ev4 = Form("gFEX Leading  (E_{T}=%.1f GeV)",        gfexET_lead_Ev4);
        TString lab_gfex_sub_Ev4  = Form("gFEX Subleading (E_{T}=%.1f GeV)",      gfexET_sub_Ev4);
        TString lab_jet_lead_Ev4  = Form("JetTagger Leading  (E_{T}=%.1f GeV)",   jetET_lead_Ev4);
        TString lab_jet_sub_Ev4   = Form("JetTagger Subleading (E_{T}=%.1f GeV)", jetET_sub_Ev4);
        TString lab_off_lead_Ev4  = Form("Offline Leading  (E_{T}=%.1f GeV)",     offET_lead_Ev4);
        TString lab_off_sub_Ev4   = Form("Offline Subleading (E_{T}=%.1f GeV)",   offET_sub_Ev4);

        TCanvas cLeg_Ev4("cLeg_Ev4", "Legend Ev4", 600, 700);
        cLeg_Ev4.cd();
        cLeg_Ev4.SetBorderMode(0);
        cLeg_Ev4.SetFrameBorderMode(0);

        // Proxy lines with exact colors/styles to match circles
        TLine* gfex_lead_proxy = new TLine(0,0,1,0);  gfex_lead_proxy->SetLineColor(colors[2]); gfex_lead_proxy->SetLineStyle(1); gfex_lead_proxy->SetLineWidth(2);
        TLine* gfex_sub_proxy  = new TLine(0,0,1,0);  gfex_sub_proxy ->SetLineColor(colors[2]); gfex_sub_proxy ->SetLineStyle(2); gfex_sub_proxy ->SetLineWidth(2);

        TLine* jet_lead_proxy  = new TLine(0,0,1,0);  jet_lead_proxy ->SetLineColor(colors[3]); jet_lead_proxy ->SetLineStyle(1); jet_lead_proxy ->SetLineWidth(2);
        TLine* jet_sub_proxy   = new TLine(0,0,1,0);  jet_sub_proxy  ->SetLineColor(colors[3]); jet_sub_proxy  ->SetLineStyle(2); jet_sub_proxy  ->SetLineWidth(2);

        TLine* off_lead_proxy  = new TLine(0,0,1,0);  off_lead_proxy ->SetLineColor(colors[4]); off_lead_proxy ->SetLineStyle(1); off_lead_proxy ->SetLineWidth(2);
        TLine* off_sub_proxy   = new TLine(0,0,1,0);  off_sub_proxy  ->SetLineColor(colors[4]); off_sub_proxy  ->SetLineStyle(2); off_sub_proxy  ->SetLineWidth(2);

        TLegend* leg_only_Ev4 = new TLegend(0.08, 0.10, 0.92, 0.90);
        leg_only_Ev4->SetBorderSize(0);
        leg_only_Ev4->SetFillStyle(0);
        leg_only_Ev4->SetTextSize(0.04);
        leg_only_Ev4->SetHeader("LRJ positions", "C");

        leg_only_Ev4->AddEntry(gfex_lead_proxy, lab_gfex_lead_Ev4, "l");
        leg_only_Ev4->AddEntry(gfex_sub_proxy,  lab_gfex_sub_Ev4,  "l");
        leg_only_Ev4->AddEntry(jet_lead_proxy,  lab_jet_lead_Ev4,  "l");
        leg_only_Ev4->AddEntry(jet_sub_proxy,   lab_jet_sub_Ev4,   "l");
        leg_only_Ev4->AddEntry(off_lead_proxy,  lab_off_lead_Ev4,  "l");
        leg_only_Ev4->AddEntry(off_sub_proxy,   lab_off_sub_Ev4,   "l");

        leg_only_Ev4->Draw();

        cLeg_Ev4.Modified(); cLeg_Ev4.Update();
        cLeg_Ev4.SaveAs(modifiedOutputFileDir + "sigTopo422_highest128Et_EtaPhi_Ev4_gFEX_Offline_JetTagger_LEGEND.pdf");
    }*/

    jFexSeedPositionsSigEv0.clear();
    jFexAdditionalSRJPositionsSigEv0.clear();
    newSeedPositionsSigEv0.clear();
    sigLRJEtEv0.clear();
    sigLRJPsi_REv0.clear();
    gFexLRJPositionSigEv0.clear();
    offlineLRJPositionSigEv0.clear();
    siggFexLRJEtEv0.clear();
    sigOfflineLRJEtEv0.clear();
    jFexSeedPositionsSigEv1.clear();
    jFexAdditionalSRJPositionsSigEv1.clear();
    newSeedPositionsSigEv1.clear();
    sigLRJEtEv1.clear();
    sigLRJPsi_REv1.clear();
    gFexLRJPositionSigEv1.clear();
    offlineLRJPositionSigEv1.clear();
    siggFexLRJEtEv1.clear();
    sigOfflineLRJEtEv1.clear();
    jFexSeedPositionsSigEv2.clear();
    jFexAdditionalSRJPositionsSigEv2.clear();
    newSeedPositionsSigEv2.clear();
    sigLRJEtEv2.clear();
    sigLRJPsi_REv2.clear();
    gFexLRJPositionSigEv2.clear();
    offlineLRJPositionSigEv2.clear();
    siggFexLRJEtEv2.clear();
    sigOfflineLRJEtEv2.clear();
    jFexSeedPositionsSigEv3.clear();
    jFexAdditionalSRJPositionsSigEv3.clear();
    newSeedPositionsSigEv3.clear();
    sigLRJEtEv3.clear();
    sigLRJPsi_REv3.clear();
    gFexLRJPositionSigEv3.clear();
    offlineLRJPositionSigEv3.clear();
    siggFexLRJEtEv3.clear();
    sigOfflineLRJEtEv3.clear();
    jFexSeedPositionsSigEv4.clear();
    jFexAdditionalSRJPositionsSigEv4.clear();
    newSeedPositionsSigEv4.clear();
    sigLRJEtEv4.clear();
    sigLRJPsi_REv4.clear();
    gFexLRJPositionSigEv4.clear();
    offlineLRJPositionSigEv4.clear();
    siggFexLRJEtEv4.clear();
    sigOfflineLRJEtEv4.clear();
    

    // Draw background event displays //FIXME turn into a loop to reduce duplicate code
    c.cd();
    if(displayEv0Back_){
        backTopo422Highest128SeedPositionsEv0->GetZaxis()->SetTitle("E_{T} [GeV]");
        backTopo422Highest128SeedPositionsEv0->Draw("COLZ");


        TEllipse *backCircle0_Ev0 = new TEllipse(jFexSeedPositionsBackEv0[0].first, jFexSeedPositionsBackEv0[0].second, 1.0, 1.0); // R in both x and y
        backCircle0_Ev0->SetLineColor(kRed);
        backCircle0_Ev0->SetLineWidth(2);
        backCircle0_Ev0->SetFillStyle(0); // no fill
        backCircle0_Ev0->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        backCircle0_Ev0->Draw("same");    // overlay on the existing plot

        TEllipse *backCircle1_Ev0 = new TEllipse(jFexSeedPositionsBackEv0[1].first, jFexSeedPositionsBackEv0[1].second, 1.0, 1.0); // R in both x and y
        backCircle1_Ev0->SetLineColor(kRed);
        backCircle1_Ev0->SetLineWidth(2);
        backCircle1_Ev0->SetFillStyle(0); // no fill
        backCircle1_Ev0->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        backCircle1_Ev0->Draw("same");    // overlay on the existing plot

        TEllipse *backCircle2_Ev0 = new TEllipse(jFexAdditionalSRJPositionsBackEv0[0].first, jFexAdditionalSRJPositionsBackEv0[0].second, 1.0, 1.0); // R in both x and y
        backCircle2_Ev0->SetLineColor(kAzure+2);
        backCircle2_Ev0->SetLineWidth(2);
        backCircle2_Ev0->SetFillStyle(0); // no fill
        backCircle2_Ev0->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        backCircle2_Ev0->Draw("same");    // overlay on the existing plot

        TEllipse *backCircle3_Ev0 = new TEllipse(jFexAdditionalSRJPositionsBackEv0[1].first, jFexAdditionalSRJPositionsBackEv0[1].second, 1.0, 1.0); // R in both x and y
        backCircle3_Ev0->SetLineColor(kAzure+2);
        backCircle3_Ev0->SetLineWidth(2);
        backCircle3_Ev0->SetFillStyle(0); // no fill
        backCircle3_Ev0->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        backCircle3_Ev0->Draw("same");    // overlay on the existing plot

        TEllipse *backCircle4_Ev0 = new TEllipse(jFexAdditionalSRJPositionsBackEv0[2].first, jFexAdditionalSRJPositionsBackEv0[2].second, 1.0, 1.0); // R in both x and y
        backCircle4_Ev0->SetLineColor(kAzure+2);
        backCircle4_Ev0->SetLineWidth(2);
        backCircle4_Ev0->SetFillStyle(0); // no fill
        backCircle4_Ev0->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        backCircle4_Ev0->Draw("same");    // overlay on the existing plot

        TEllipse *backCircle5_Ev0 = new TEllipse(jFexAdditionalSRJPositionsBackEv0[3].first, jFexAdditionalSRJPositionsBackEv0[3].second, 1.0, 1.0); // R in both x and y
        backCircle5_Ev0->SetLineColor(kAzure+2);
        backCircle5_Ev0->SetLineWidth(2);
        backCircle5_Ev0->SetFillStyle(0); // no fill
        backCircle5_Ev0->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        backCircle5_Ev0->Draw("same");    // overlay on the existing plot

        TEllipse *backCircle6_Ev0 = new TEllipse(newSeedPositionsBackEv0[0].first, newSeedPositionsBackEv0[0].second, 1.0, 1.0); // R in both x and y
        backCircle6_Ev0->SetLineColor(kGreen+2);
        backCircle6_Ev0->SetLineWidth(2);
        backCircle6_Ev0->SetFillStyle(0); // no fill
        backCircle6_Ev0->SetLineStyle(1);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        backCircle6_Ev0->Draw("same");    // overlay on the existing plot

        TEllipse *backCircle7_Ev0 = new TEllipse(newSeedPositionsBackEv0[1].first, newSeedPositionsBackEv0[1].second, 1.0, 1.0); // R in both x and y
        backCircle7_Ev0->SetLineColor(kGreen+2);
        backCircle7_Ev0->SetLineWidth(2);
        backCircle7_Ev0->SetFillStyle(0); // no fill
        backCircle7_Ev0->SetLineStyle(1);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        backCircle7_Ev0->Draw("same");    // overlay on the existing plot

        // Build the label text (1st LRJ)
        TString backLabel1Ev0 = Form("#eta=%.2f, #phi=%.2f, E_{T}=%.1f GeV, #psi_{R}=%.2f", newSeedPositionsBackEv0[0].first, newSeedPositionsBackEv0[0].second, backLRJEtEv0[0], backLRJPsi_REv0[0]);

        // Option 1: Use TLatex directly
        TLatex backLat1Ev0;
        backLat1Ev0.SetTextSize(0.025);     // Adjust size
        backLat1Ev0.SetTextColor(kBlack); // Match backCircle color
        backLat1Ev0.DrawLatex(newSeedPositionsBackEv0[0].first, newSeedPositionsBackEv0[0].second + 0.6, backLabel1Ev0); // Slightly above the backCircle

        // Build the label text (2nd LRJ)
        TString backLabel2Ev0 = Form("#eta=%.2f, #phi=%.2f, E_{T}=%.1f GeV, #psi_{R}=%.2f", newSeedPositionsBackEv0[1].first, newSeedPositionsBackEv0[1].second, backLRJEtEv0[1], backLRJPsi_REv0[1]);

        // Option 1: Use TLatex directly
        TLatex backLat2Ev0;
        backLat2Ev0.SetTextSize(0.025);     // Adjust size
        backLat2Ev0.SetTextColor(kBlack); // Match backCircle color
        backLat2Ev0.DrawLatex(newSeedPositionsBackEv0[1].first, newSeedPositionsBackEv0[1].second + 0.6, backLabel2Ev0); // Slightly above the backCircle\

        c.SaveAs(modifiedOutputFileDir + "backTopo422_highest128Et_EtaPhi_Ev0.pdf");   

        jFexSeedPositionsBackEv0.clear();
        jFexAdditionalSRJPositionsBackEv0.clear();
        newSeedPositionsBackEv0.clear();
        backLRJEtEv0.clear();
        backLRJPsi_REv0.clear();
    }
    
    if(displayEv1Back_){
        backTopo422Highest128SeedPositionsEv1->GetZaxis()->SetTitle("E_{T} [GeV]");
        backTopo422Highest128SeedPositionsEv1->Draw("COLZ");


        TEllipse *backCircle0_Ev1 = new TEllipse(jFexSeedPositionsBackEv1[0].first, jFexSeedPositionsBackEv1[0].second, 1.0, 1.0); // R in both x and y
        backCircle0_Ev1->SetLineColor(kRed);
        backCircle0_Ev1->SetLineWidth(2);
        backCircle0_Ev1->SetFillStyle(0); // no fill
        backCircle0_Ev1->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        backCircle0_Ev1->Draw("same");    // overlay on the existing plot

        TEllipse *backCircle1_Ev1 = new TEllipse(jFexSeedPositionsBackEv1[1].first, jFexSeedPositionsBackEv1[1].second, 1.0, 1.0); // R in both x and y
        backCircle1_Ev1->SetLineColor(kRed);
        backCircle1_Ev1->SetLineWidth(2);
        backCircle1_Ev1->SetFillStyle(0); // no fill
        backCircle1_Ev1->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        backCircle1_Ev1->Draw("same");    // overlay on the existing plot

        TEllipse *backCircle2_Ev1 = new TEllipse(jFexAdditionalSRJPositionsBackEv1[0].first, jFexAdditionalSRJPositionsBackEv1[0].second, 1.0, 1.0); // R in both x and y
        backCircle2_Ev1->SetLineColor(kAzure+2);
        backCircle2_Ev1->SetLineWidth(2);
        backCircle2_Ev1->SetFillStyle(0); // no fill
        backCircle2_Ev1->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        backCircle2_Ev1->Draw("same");    // overlay on the existing plot

        TEllipse *backCircle3_Ev1 = new TEllipse(jFexAdditionalSRJPositionsBackEv1[1].first, jFexAdditionalSRJPositionsBackEv1[1].second, 1.0, 1.0); // R in both x and y
        backCircle3_Ev1->SetLineColor(kAzure+2);
        backCircle3_Ev1->SetLineWidth(2);
        backCircle3_Ev1->SetFillStyle(0); // no fill
        backCircle3_Ev1->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        backCircle3_Ev1->Draw("same");    // overlay on the existing plot

        TEllipse *backCircle4_Ev1 = new TEllipse(jFexAdditionalSRJPositionsBackEv1[2].first, jFexAdditionalSRJPositionsBackEv1[2].second, 1.0, 1.0); // R in both x and y
        backCircle4_Ev1->SetLineColor(kAzure+2);
        backCircle4_Ev1->SetLineWidth(2);
        backCircle4_Ev1->SetFillStyle(0); // no fill
        backCircle4_Ev1->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        backCircle4_Ev1->Draw("same");    // overlay on the existing plot

        TEllipse *backCircle5_Ev1 = new TEllipse(jFexAdditionalSRJPositionsBackEv1[3].first, jFexAdditionalSRJPositionsBackEv1[3].second, 1.0, 1.0); // R in both x and y
        backCircle5_Ev1->SetLineColor(kAzure+2);
        backCircle5_Ev1->SetLineWidth(2);
        backCircle5_Ev1->SetFillStyle(0); // no fill
        backCircle5_Ev1->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        backCircle5_Ev1->Draw("same");    // overlay on the existing plot

        TEllipse *backCircle6_Ev1 = new TEllipse(newSeedPositionsBackEv1[0].first, newSeedPositionsBackEv1[0].second, 1.0, 1.0); // R in both x and y
        backCircle6_Ev1->SetLineColor(kGreen+2);
        backCircle6_Ev1->SetLineWidth(2);
        backCircle6_Ev1->SetFillStyle(0); // no fill
        backCircle6_Ev1->SetLineStyle(1);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        backCircle6_Ev1->Draw("same");    // overlay on the existing plot

        TEllipse *backCircle7_Ev1 = new TEllipse(newSeedPositionsBackEv1[1].first, newSeedPositionsBackEv1[1].second, 1.0, 1.0); // R in both x and y
        backCircle7_Ev1->SetLineColor(kGreen+2);
        backCircle7_Ev1->SetLineWidth(2);
        backCircle7_Ev1->SetFillStyle(0); // no fill
        backCircle7_Ev1->SetLineStyle(1);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        backCircle7_Ev1->Draw("same");    // overlay on the existing plot

        // Build the label text (1st LRJ)
        TString backLabel1Ev1 = Form("#eta=%.2f, #phi=%.2f, E_{T}=%.1f GeV, #psi_{R}=%.2f", newSeedPositionsBackEv1[0].first, newSeedPositionsBackEv1[0].second, backLRJEtEv1[0], backLRJPsi_REv1[0]);

        // Option 1: Use TLatex directly
        TLatex backLat1Ev1;
        backLat1Ev1.SetTextSize(0.025);     // Adjust size
        backLat1Ev1.SetTextColor(kBlack); // Match backCircle color
        backLat1Ev1.DrawLatex(newSeedPositionsBackEv1[0].first, newSeedPositionsBackEv1[0].second + 0.6, backLabel1Ev1); // Slightly above the backCircle

        // Build the label text (2nd LRJ)
        TString backLabel2Ev1 = Form("#eta=%.2f, #phi=%.2f, E_{T}=%.1f GeV, #psi_{R}=%.2f", newSeedPositionsBackEv1[1].first, newSeedPositionsBackEv1[1].second, backLRJEtEv1[1], backLRJPsi_REv0[1]);

        // Option 1: Use TLatex directly
        TLatex backLat2Ev1;
        backLat2Ev1.SetTextSize(0.025);     // Adjust size
        backLat2Ev1.SetTextColor(kBlack); // Match backCircle color
        backLat2Ev1.DrawLatex(newSeedPositionsBackEv1[1].first, newSeedPositionsBackEv1[1].second + 0.6, backLabel2Ev1); // Slightly above the backCircle\

        c.SaveAs(modifiedOutputFileDir + "backTopo422_highest128Et_EtaPhi_Ev1.pdf");   
        
        
        jFexSeedPositionsBackEv1.clear();
        jFexAdditionalSRJPositionsBackEv1.clear();
        newSeedPositionsBackEv1.clear();
        backLRJEtEv1.clear();
        backLRJPsi_REv1.clear();
    }
    
    if(displayEv2Back_){
        backTopo422Highest128SeedPositionsEv2->GetZaxis()->SetTitle("E_{T} [GeV]");
        backTopo422Highest128SeedPositionsEv2->Draw("COLZ");


        TEllipse *backCircle0_Ev2 = new TEllipse(jFexSeedPositionsBackEv2[0].first, jFexSeedPositionsBackEv2[0].second, 1.0, 1.0); // R in both x and y
        backCircle0_Ev2->SetLineColor(kRed);
        backCircle0_Ev2->SetLineWidth(2);
        backCircle0_Ev2->SetFillStyle(0); // no fill
        backCircle0_Ev2->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        backCircle0_Ev2->Draw("same");    // overlay on the existing plot

        TEllipse *backCircle1_Ev2 = new TEllipse(jFexSeedPositionsBackEv2[1].first, jFexSeedPositionsBackEv2[1].second, 1.0, 1.0); // R in both x and y
        backCircle1_Ev2->SetLineColor(kRed);
        backCircle1_Ev2->SetLineWidth(2);
        backCircle1_Ev2->SetFillStyle(0); // no fill
        backCircle1_Ev2->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        backCircle1_Ev2->Draw("same");    // overlay on the existing plot

        TEllipse *backCircle2_Ev2 = new TEllipse(jFexAdditionalSRJPositionsBackEv2[0].first, jFexAdditionalSRJPositionsBackEv2[0].second, 1.0, 1.0); // R in both x and y
        backCircle2_Ev2->SetLineColor(kAzure+2);
        backCircle2_Ev2->SetLineWidth(2);
        backCircle2_Ev2->SetFillStyle(0); // no fill
        backCircle2_Ev2->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        backCircle2_Ev2->Draw("same");    // overlay on the existing plot

        TEllipse *backCircle3_Ev2 = new TEllipse(jFexAdditionalSRJPositionsBackEv2[1].first, jFexAdditionalSRJPositionsBackEv2[1].second, 1.0, 1.0); // R in both x and y
        backCircle3_Ev2->SetLineColor(kAzure+2);
        backCircle3_Ev2->SetLineWidth(2);
        backCircle3_Ev2->SetFillStyle(0); // no fill
        backCircle3_Ev2->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        backCircle3_Ev2->Draw("same");    // overlay on the existing plot

        TEllipse *backCircle4_Ev2 = new TEllipse(jFexAdditionalSRJPositionsBackEv2[2].first, jFexAdditionalSRJPositionsBackEv2[2].second, 1.0, 1.0); // R in both x and y
        backCircle4_Ev2->SetLineColor(kAzure+2);
        backCircle4_Ev2->SetLineWidth(2);
        backCircle4_Ev2->SetFillStyle(0); // no fill
        backCircle4_Ev2->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        backCircle4_Ev2->Draw("same");    // overlay on the existing plot

        TEllipse *backCircle5_Ev2 = new TEllipse(jFexAdditionalSRJPositionsBackEv2[3].first, jFexAdditionalSRJPositionsBackEv2[3].second, 1.0, 1.0); // R in both x and y
        backCircle5_Ev2->SetLineColor(kAzure+2);
        backCircle5_Ev2->SetLineWidth(2);
        backCircle5_Ev2->SetFillStyle(0); // no fill
        backCircle5_Ev2->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        backCircle5_Ev2->Draw("same");    // overlay on the existing plot

        TEllipse *backCircle6_Ev2 = new TEllipse(newSeedPositionsBackEv2[0].first, newSeedPositionsBackEv2[0].second, 1.0, 1.0); // R in both x and y
        backCircle6_Ev2->SetLineColor(kGreen+2);
        backCircle6_Ev2->SetLineWidth(2);
        backCircle6_Ev2->SetFillStyle(0); // no fill
        backCircle6_Ev2->SetLineStyle(1);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        backCircle6_Ev2->Draw("same");    // overlay on the existing plot

        TEllipse *backCircle7_Ev2 = new TEllipse(newSeedPositionsBackEv2[1].first, newSeedPositionsBackEv2[1].second, 1.0, 1.0); // R in both x and y
        backCircle7_Ev2->SetLineColor(kGreen+2);
        backCircle7_Ev2->SetLineWidth(2);
        backCircle7_Ev2->SetFillStyle(0); // no fill
        backCircle7_Ev2->SetLineStyle(1);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        backCircle7_Ev2->Draw("same");    // overlay on the existing plot

        // Build the label text (1st LRJ)
        TString backLabel1Ev2 = Form("#eta=%.2f, #phi=%.2f, E_{T}=%.1f GeV, #psi_{R}=%.2f", newSeedPositionsBackEv2[0].first, newSeedPositionsBackEv2[0].second, backLRJEtEv2[0], backLRJPsi_REv2[0]);

        // Option 1: Use TLatex directly
        TLatex backLat1Ev2;
        backLat1Ev2.SetTextSize(0.025);     // Adjust size
        backLat1Ev2.SetTextColor(kBlack); // Match backCircle color
        backLat1Ev2.DrawLatex(newSeedPositionsBackEv2[0].first, newSeedPositionsBackEv2[0].second + 0.6, backLabel1Ev2); // Slightly above the backCircle

        // Build the label text (2nd LRJ)
        TString backLabel2Ev2 = Form("#eta=%.2f, #phi=%.2f, E_{T}=%.1f GeV, #psi_{R}=%.2f", newSeedPositionsBackEv2[1].first, newSeedPositionsBackEv2[1].second, backLRJEtEv2[1], backLRJPsi_REv2[1]);

        // Option 1: Use TLatex directly
        TLatex backLat2Ev2;
        backLat2Ev2.SetTextSize(0.025);     // Adjust size
        backLat2Ev2.SetTextColor(kBlack); // Match backCircle color
        backLat2Ev2.DrawLatex(newSeedPositionsBackEv2[1].first, newSeedPositionsBackEv2[1].second + 0.6, backLabel2Ev2); // Slightly above the backCircle\

        c.SaveAs(modifiedOutputFileDir + "backTopo422_highest128Et_EtaPhi_Ev2.pdf");   
        
        
        jFexSeedPositionsBackEv2.clear();
        jFexAdditionalSRJPositionsBackEv2.clear();
        newSeedPositionsBackEv2.clear();
        backLRJEtEv2.clear();
        backLRJPsi_REv2.clear();
    }
    

    if(displayEv3Back_){
        backTopo422Highest128SeedPositionsEv3->GetZaxis()->SetTitle("E_{T} [GeV]");
        backTopo422Highest128SeedPositionsEv3->Draw("COLZ");


        TEllipse *backCircle0_Ev3 = new TEllipse(jFexSeedPositionsBackEv3[0].first, jFexSeedPositionsBackEv3[0].second, 1.0, 1.0); // R in both x and y
        backCircle0_Ev3->SetLineColor(kRed);
        backCircle0_Ev3->SetLineWidth(2);
        backCircle0_Ev3->SetFillStyle(0); // no fill
        backCircle0_Ev3->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        backCircle0_Ev3->Draw("same");    // overlay on the existing plot

        TEllipse *backCircle1_Ev3 = new TEllipse(jFexSeedPositionsBackEv3[1].first, jFexSeedPositionsBackEv3[1].second, 1.0, 1.0); // R in both x and y
        backCircle1_Ev3->SetLineColor(kRed);
        backCircle1_Ev3->SetLineWidth(2);
        backCircle1_Ev3->SetFillStyle(0); // no fill
        backCircle1_Ev3->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        backCircle1_Ev3->Draw("same");    // overlay on the existing plot

        TEllipse *backCircle2_Ev3 = new TEllipse(jFexAdditionalSRJPositionsBackEv3[0].first, jFexAdditionalSRJPositionsBackEv3[0].second, 1.0, 1.0); // R in both x and y
        backCircle2_Ev3->SetLineColor(kAzure+2);
        backCircle2_Ev3->SetLineWidth(2);
        backCircle2_Ev3->SetFillStyle(0); // no fill
        backCircle2_Ev3->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        backCircle2_Ev3->Draw("same");    // overlay on the existing plot

        TEllipse *backCircle3_Ev3 = new TEllipse(jFexAdditionalSRJPositionsBackEv3[1].first, jFexAdditionalSRJPositionsBackEv3[1].second, 1.0, 1.0); // R in both x and y
        backCircle3_Ev3->SetLineColor(kAzure+2);
        backCircle3_Ev3->SetLineWidth(2);
        backCircle3_Ev3->SetFillStyle(0); // no fill
        backCircle3_Ev3->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        backCircle3_Ev3->Draw("same");    // overlay on the existing plot

        TEllipse *backCircle4_Ev3 = new TEllipse(jFexAdditionalSRJPositionsBackEv3[2].first, jFexAdditionalSRJPositionsBackEv3[2].second, 1.0, 1.0); // R in both x and y
        backCircle4_Ev3->SetLineColor(kAzure+2);
        backCircle4_Ev3->SetLineWidth(2);
        backCircle4_Ev3->SetFillStyle(0); // no fill
        backCircle4_Ev3->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        backCircle4_Ev3->Draw("same");    // overlay on the existing plot

        TEllipse *backCircle5_Ev3 = new TEllipse(jFexAdditionalSRJPositionsBackEv3[3].first, jFexAdditionalSRJPositionsBackEv3[3].second, 1.0, 1.0); // R in both x and y
        backCircle5_Ev3->SetLineColor(kAzure+2);
        backCircle5_Ev3->SetLineWidth(2);
        backCircle5_Ev3->SetFillStyle(0); // no fill
        backCircle5_Ev3->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        backCircle5_Ev3->Draw("same");    // overlay on the existing plot

        TEllipse *backCircle6_Ev3 = new TEllipse(newSeedPositionsBackEv3[0].first, newSeedPositionsBackEv3[0].second, 1.0, 1.0); // R in both x and y
        backCircle6_Ev3->SetLineColor(kGreen+2);
        backCircle6_Ev3->SetLineWidth(2);
        backCircle6_Ev3->SetFillStyle(0); // no fill
        backCircle6_Ev3->SetLineStyle(1);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        backCircle6_Ev3->Draw("same");    // overlay on the existing plot

        TEllipse *backCircle7_Ev3 = new TEllipse(newSeedPositionsBackEv3[1].first, newSeedPositionsBackEv3[1].second, 1.0, 1.0); // R in both x and y
        backCircle7_Ev3->SetLineColor(kGreen+2);
        backCircle7_Ev3->SetLineWidth(2);
        backCircle7_Ev3->SetFillStyle(0); // no fill
        backCircle7_Ev3->SetLineStyle(1);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        backCircle7_Ev3->Draw("same");    // overlay on the existing plot

        // Build the label text (1st LRJ)
        TString backLabel1Ev3 = Form("#eta=%.2f, #phi=%.2f, E_{T}=%.1f GeV, #psi_{R}=%.2f", newSeedPositionsBackEv3[0].first, newSeedPositionsBackEv3[0].second, backLRJEtEv3[0], backLRJPsi_REv3[0]);

        // Option 1: Use TLatex directly
        TLatex backLat1Ev3;
        backLat1Ev3.SetTextSize(0.025);     // Adjust size
        backLat1Ev3.SetTextColor(kBlack); // Match backCircle color
        backLat1Ev3.DrawLatex(newSeedPositionsBackEv3[0].first, newSeedPositionsBackEv3[0].second + 0.6, backLabel1Ev3); // Slightly above the backCircle

        // Build the label text (2nd LRJ)
        TString backLabel2Ev3 = Form("#eta=%.2f, #phi=%.2f, E_{T}=%.1f GeV, #psi_{R}=%.2f", newSeedPositionsBackEv3[1].first, newSeedPositionsBackEv3[1].second, backLRJEtEv3[1], backLRJPsi_REv3[0]);

        // Option 1: Use TLatex directly
        TLatex backLat2Ev3;
        backLat2Ev3.SetTextSize(0.025);     // Adjust size
        backLat2Ev3.SetTextColor(kBlack); // Match backCircle color
        backLat2Ev3.DrawLatex(newSeedPositionsBackEv3[1].first, newSeedPositionsBackEv3[1].second + 0.6, backLabel2Ev3); // Slightly above the backCircle

        c.SaveAs(modifiedOutputFileDir + "backTopo422_highest128Et_EtaPhi_Ev3.pdf");   
        
        
        jFexSeedPositionsBackEv3.clear();
        jFexAdditionalSRJPositionsBackEv3.clear();
        newSeedPositionsBackEv3.clear();
        backLRJEtEv3.clear();
        backLRJPsi_REv3.clear();
    }

    

    if(displayEv4Back_){
        backTopo422Highest128SeedPositionsEv4->GetZaxis()->SetTitle("E_{T} [GeV]");
        backTopo422Highest128SeedPositionsEv4->Draw("COLZ");


        TEllipse *backCircle0_Ev4 = new TEllipse(jFexSeedPositionsBackEv4[0].first, jFexSeedPositionsBackEv4[0].second, 1.0, 1.0); // R in both x and y
        backCircle0_Ev4->SetLineColor(kRed);
        backCircle0_Ev4->SetLineWidth(2);
        backCircle0_Ev4->SetFillStyle(0); // no fill
        backCircle0_Ev4->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        backCircle0_Ev4->Draw("same");    // overlay on the existing plot

        TEllipse *backCircle1_Ev4 = new TEllipse(jFexSeedPositionsBackEv4[1].first, jFexSeedPositionsBackEv4[1].second, 1.0, 1.0); // R in both x and y
        backCircle1_Ev4->SetLineColor(kRed);
        backCircle1_Ev4->SetLineWidth(2);
        backCircle1_Ev4->SetFillStyle(0); // no fill
        backCircle1_Ev4->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        backCircle1_Ev4->Draw("same");    // overlay on the existing plot

        TEllipse *backCircle2_Ev4 = new TEllipse(jFexAdditionalSRJPositionsBackEv4[0].first, jFexAdditionalSRJPositionsBackEv4[0].second, 1.0, 1.0); // R in both x and y
        backCircle2_Ev4->SetLineColor(kAzure+2);
        backCircle2_Ev4->SetLineWidth(2);
        backCircle2_Ev4->SetFillStyle(0); // no fill
        backCircle2_Ev4->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        backCircle2_Ev4->Draw("same");    // overlay on the existing plot

        TEllipse *backCircle3_Ev4 = new TEllipse(jFexAdditionalSRJPositionsBackEv4[1].first, jFexAdditionalSRJPositionsBackEv4[1].second, 1.0, 1.0); // R in both x and y
        backCircle3_Ev4->SetLineColor(kAzure+2);
        backCircle3_Ev4->SetLineWidth(2);
        backCircle3_Ev4->SetFillStyle(0); // no fill
        backCircle3_Ev4->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        backCircle3_Ev4->Draw("same");    // overlay on the existing plot

        TEllipse *backCircle4_Ev4 = new TEllipse(jFexAdditionalSRJPositionsBackEv4[2].first, jFexAdditionalSRJPositionsBackEv4[2].second, 1.0, 1.0); // R in both x and y
        backCircle4_Ev4->SetLineColor(kAzure+2);
        backCircle4_Ev4->SetLineWidth(2);
        backCircle4_Ev4->SetFillStyle(0); // no fill
        backCircle4_Ev4->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        backCircle4_Ev4->Draw("same");    // overlay on the existing plot

        TEllipse *backCircle5_Ev4 = new TEllipse(jFexAdditionalSRJPositionsBackEv4[3].first, jFexAdditionalSRJPositionsBackEv4[3].second, 1.0, 1.0); // R in both x and y
        backCircle5_Ev4->SetLineColor(kAzure+2);
        backCircle5_Ev4->SetLineWidth(2);
        backCircle5_Ev4->SetFillStyle(0); // no fill
        backCircle5_Ev4->SetLineStyle(2);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        backCircle5_Ev4->Draw("same");    // overlay on the existing plot

        TEllipse *backCircle6_Ev4 = new TEllipse(newSeedPositionsBackEv4[0].first, newSeedPositionsBackEv4[0].second, 1.0, 1.0); // R in both x and y
        backCircle6_Ev4->SetLineColor(kGreen+2);
        backCircle6_Ev4->SetLineWidth(2);
        backCircle6_Ev4->SetFillStyle(0); // no fill
        backCircle6_Ev4->SetLineStyle(1);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        backCircle6_Ev4->Draw("same");    // overlay on the existing plot

        TEllipse *backCircle7_Ev4 = new TEllipse(newSeedPositionsBackEv4[1].first, newSeedPositionsBackEv4[1].second, 1.0, 1.0); // R in both x and y
        backCircle7_Ev4->SetLineColor(kGreen+2);
        backCircle7_Ev4->SetLineWidth(2);
        backCircle7_Ev4->SetFillStyle(0); // no fill
        backCircle7_Ev4->SetLineStyle(1);  // dashed (1=solid, 2=dashed, 3=dotted, etc.)
        backCircle7_Ev4->Draw("same");    // overlay on the existing plot

        // Build the label text (1st LRJ)
        TString backLabel1Ev4 = Form("#eta=%.2f, #phi=%.2f, E_{T}=%.1f GeV, #psi_{R}=%.2f", newSeedPositionsBackEv4[0].first, newSeedPositionsBackEv4[0].second, backLRJEtEv4[0], backLRJPsi_REv4[0]);

        // Option 1: Use TLatex directly
        TLatex backLat1Ev4;
        backLat1Ev4.SetTextSize(0.025);     // Adjust size
        backLat1Ev4.SetTextColor(kBlack); // Match backCircle color
        backLat1Ev4.DrawLatex(newSeedPositionsBackEv4[0].first, newSeedPositionsBackEv4[0].second + 0.6, backLabel1Ev4); // Slightly above the backCircle

        // Build the label text (2nd LRJ)
        TString backLabel2Ev4 = Form("#eta=%.2f, #phi=%.2f, E_{T}=%.1f GeV, #psi_{R}=%.2f", newSeedPositionsBackEv4[1].first, newSeedPositionsBackEv4[1].second, backLRJEtEv4[1], backLRJPsi_REv4[1]);

        // Option 1: Use TLatex directly
        TLatex backLat2Ev4;
        backLat2Ev4.SetTextSize(0.025);     // Adjust size
        backLat2Ev4.SetTextColor(kBlack); // Match backCircle color
        backLat2Ev4.DrawLatex(newSeedPositionsBackEv4[1].first, newSeedPositionsBackEv4[1].second + 0.6, backLabel2Ev4); // Slightly above the backCircle

        c.SaveAs(modifiedOutputFileDir + "backTopo422_highest128Et_EtaPhi_Ev4.pdf");   
        
        jFexSeedPositionsBackEv4.clear();
        jFexAdditionalSRJPositionsBackEv4.clear();
        newSeedPositionsBackEv4.clear();
        backLRJEtEv4.clear();
        backLRJPsi_REv4.clear();
    }

    cSigEffLRJ.cd();

    // eff. vs. offline leading lrj Et overlay
    sig_eff_offlineLRJ50->SetLineColor(colors[0]);
    sig_eff_offlineLRJ50->SetMarkerColor(colors[0]);
    sigLegEffLRJ->AddEntry(sig_eff_offlineLRJ50, "Lead. LRJ E_{T} > 50 GeV", "l");
    sig_eff_offlineLRJ100->SetLineColor(colors[1]);
    sig_eff_offlineLRJ100->SetMarkerColor(colors[1]);
    sigLegEffLRJ->AddEntry(sig_eff_offlineLRJ100, "Lead. LRJ E_{T} > 100 GeV", "l");
    sig_eff_offlineLRJ150->SetLineColor(colors[2]);
    sig_eff_offlineLRJ150->SetMarkerColor(colors[2]);
    sigLegEffLRJ->AddEntry(sig_eff_offlineLRJ150, "Lead. LRJ E_{T} > 150 GeV", "l");
    sig_eff_offlineLRJ200->SetLineColor(colors[3]);
    sig_eff_offlineLRJ200->SetMarkerColor(colors[3]);
    sigLegEffLRJ->AddEntry(sig_eff_offlineLRJ200, "Lead. LRJ E_{T} > 200 GeV", "l");
    sig_eff_offlineLRJ250->SetLineColor(colors[4]);
    sig_eff_offlineLRJ250->SetMarkerColor(colors[4]);
    sigLegEffLRJ->AddEntry(sig_eff_offlineLRJ250, "Lead. LRJ E_{T} > 250 GeV", "l");
    sig_eff_offlineLRJ300->SetLineColor(colors[5]);
    sig_eff_offlineLRJ300->SetMarkerColor(colors[5]);
    sigLegEffLRJ->AddEntry(sig_eff_offlineLRJ300, "Lead. LRJ E_{T} > 300 GeV", "l");
    sig_eff_offlineLRJ350->SetLineColor(colors[6]);
    sig_eff_offlineLRJ350->SetMarkerColor(colors[6]);
    sigLegEffLRJ->AddEntry(sig_eff_offlineLRJ350, "Lead. LRJ E_{T} > 350 GeV", "l");
    sig_eff_offlineLRJ400->SetLineColor(colors[7]);
    sig_eff_offlineLRJ400->SetMarkerColor(colors[7]);
    sigLegEffLRJ->AddEntry(sig_eff_offlineLRJ400, "Lead. LRJ E_{T} > 400 GeV", "l");
    sig_eff_offlineLRJ450->SetLineColor(colors[8]);
    sig_eff_offlineLRJ450->SetMarkerColor(colors[8]);
    sigLegEffLRJ->AddEntry(sig_eff_offlineLRJ450, "Lead. LRJ E_{T} > 450 GeV", "l");
    sig_eff_offlineLRJ500->SetLineColor(colors[9]);
    sig_eff_offlineLRJ500->SetMarkerColor(colors[9]);
    sigLegEffLRJ->AddEntry(sig_eff_offlineLRJ500, "Lead. LRJ E_{T} > 500 GeV", "l");
    sig_eff_offlineLRJ50->Draw("P");
    sig_eff_offlineLRJ100->Draw("P SAME");
    sig_eff_offlineLRJ150->Draw("P SAME");
    sig_eff_offlineLRJ200->Draw("P SAME");
    sig_eff_offlineLRJ250->Draw("P SAME");
    sig_eff_offlineLRJ300->Draw("P SAME");
    sig_eff_offlineLRJ350->Draw("P SAME");
    sig_eff_offlineLRJ400->Draw("P SAME");
    sig_eff_offlineLRJ450->Draw("P SAME");
    sig_eff_offlineLRJ500->Draw("P SAME");
    sigLegEffLRJ->Draw();
    cSigEffLRJ.SaveAs(modifiedOutputFileDir + "sig_overlayed_eff_LRJ.pdf");


    cSigEffLRJ_Dijet.cd();

    // eff. vs. offline leading lrj Et overlay
    sig_eff_offlineLRJ50_Dijet->SetLineColor(colors[0]);
    sig_eff_offlineLRJ50_Dijet->SetMarkerColor(colors[0]);
    sigLegEffLRJ_Dijet->AddEntry(sig_eff_offlineLRJ50_Dijet, "Sublead. LRJ E_{T} > 50 GeV", "l");
    sig_eff_offlineLRJ100_Dijet->SetLineColor(colors[1]);
    sig_eff_offlineLRJ100_Dijet->SetMarkerColor(colors[1]);
    sigLegEffLRJ_Dijet->AddEntry(sig_eff_offlineLRJ100_Dijet, "Sublead. LRJ E_{T} > 100 GeV", "l");
    sig_eff_offlineLRJ150_Dijet->SetLineColor(colors[2]);
    sig_eff_offlineLRJ150_Dijet->SetMarkerColor(colors[2]);
    sigLegEffLRJ_Dijet->AddEntry(sig_eff_offlineLRJ150_Dijet, "Sublead. LRJ E_{T} > 150 GeV", "l");
    sig_eff_offlineLRJ200_Dijet->SetLineColor(colors[3]);
    sig_eff_offlineLRJ200_Dijet->SetMarkerColor(colors[3]);
    sigLegEffLRJ_Dijet->AddEntry(sig_eff_offlineLRJ200_Dijet, "Sublead. LRJ E_{T} > 200 GeV", "l");
    sig_eff_offlineLRJ250_Dijet->SetLineColor(colors[4]);
    sig_eff_offlineLRJ250_Dijet->SetMarkerColor(colors[4]);
    sigLegEffLRJ_Dijet->AddEntry(sig_eff_offlineLRJ250_Dijet, "Sublead. LRJ E_{T} > 250 GeV", "l");
    sig_eff_offlineLRJ300_Dijet->SetLineColor(colors[5]);
    sig_eff_offlineLRJ300_Dijet->SetMarkerColor(colors[5]);
    sigLegEffLRJ_Dijet->AddEntry(sig_eff_offlineLRJ300_Dijet, "Sublead. LRJ E_{T} > 300 GeV", "l");
    sig_eff_offlineLRJ350_Dijet->SetLineColor(colors[6]);
    sig_eff_offlineLRJ350_Dijet->SetMarkerColor(colors[6]);
    sigLegEffLRJ_Dijet->AddEntry(sig_eff_offlineLRJ350_Dijet, "Sublead. LRJ E_{T} > 350 GeV", "l");
    sig_eff_offlineLRJ400_Dijet->SetLineColor(colors[7]);
    sig_eff_offlineLRJ400_Dijet->SetMarkerColor(colors[7]);
    sigLegEffLRJ_Dijet->AddEntry(sig_eff_offlineLRJ400_Dijet, "Sublead. LRJ E_{T} > 400 GeV", "l");
    sig_eff_offlineLRJ450_Dijet->SetLineColor(colors[8]);
    sig_eff_offlineLRJ450_Dijet->SetMarkerColor(colors[8]);
    sigLegEffLRJ_Dijet->AddEntry(sig_eff_offlineLRJ450_Dijet, "Sublead. LRJ E_{T} > 450 GeV", "l");
    sig_eff_offlineLRJ500_Dijet->SetLineColor(colors[9]);
    sig_eff_offlineLRJ500_Dijet->SetMarkerColor(colors[9]);
    sigLegEffLRJ_Dijet->AddEntry(sig_eff_offlineLRJ500_Dijet, "Sublead. LRJ E_{T} > 500 GeV", "l");
    sig_eff_offlineLRJ50_Dijet->Draw("P");
    sig_eff_offlineLRJ100_Dijet->Draw("P SAME");
    sig_eff_offlineLRJ150_Dijet->Draw("P SAME");
    sig_eff_offlineLRJ200_Dijet->Draw("P SAME");
    sig_eff_offlineLRJ250_Dijet->Draw("P SAME");
    sig_eff_offlineLRJ300_Dijet->Draw("P SAME");
    sig_eff_offlineLRJ350_Dijet->Draw("P SAME");
    sig_eff_offlineLRJ400_Dijet->Draw("P SAME");
    sig_eff_offlineLRJ450_Dijet->Draw("P SAME");
    sig_eff_offlineLRJ500_Dijet->Draw("P SAME");
    sigLegEffLRJ_Dijet->Draw();
    cSigEffLRJ_Dijet.SaveAs(modifiedOutputFileDir + "sig_overlayed_eff_LRJ_Dijet.pdf");


    cSigEffLRJ_1Subjet.cd();

    // eff. vs. offline leading lrj Et overlay
    sig_eff_offlineLRJ50_1Subjet->SetLineColor(colors[0]);
    sig_eff_offlineLRJ50_1Subjet->SetMarkerColor(colors[0]);
    sigLegEffLRJ_1Subjet->AddEntry(sig_eff_offlineLRJ50_1Subjet, "Lead. LRJ E_{T} > 50 GeV [1 Subjet]", "l");
    sig_eff_offlineLRJ100_1Subjet->SetLineColor(colors[1]);
    sig_eff_offlineLRJ100_1Subjet->SetMarkerColor(colors[1]);
    sigLegEffLRJ_1Subjet->AddEntry(sig_eff_offlineLRJ100_1Subjet, "Lead. LRJ E_{T} > 100 GeV [1 Subjet]", "l");
    sig_eff_offlineLRJ150_1Subjet->SetLineColor(colors[2]);
    sig_eff_offlineLRJ150_1Subjet->SetMarkerColor(colors[2]);
    sigLegEffLRJ_1Subjet->AddEntry(sig_eff_offlineLRJ150_1Subjet, "Lead. LRJ E_{T} > 150 GeV [1 Subjet]", "l");
    sig_eff_offlineLRJ200_1Subjet->SetLineColor(colors[3]);
    sig_eff_offlineLRJ200_1Subjet->SetMarkerColor(colors[3]);
    sigLegEffLRJ_1Subjet->AddEntry(sig_eff_offlineLRJ200_1Subjet, "Lead. LRJ E_{T} > 200 GeV [1 Subjet]", "l");
    sig_eff_offlineLRJ250_1Subjet->SetLineColor(colors[4]);
    sig_eff_offlineLRJ250_1Subjet->SetMarkerColor(colors[4]);
    sigLegEffLRJ_1Subjet->AddEntry(sig_eff_offlineLRJ250_1Subjet, "Lead. LRJ E_{T} > 250 GeV [1 Subjet]", "l");
    sig_eff_offlineLRJ300_1Subjet->SetLineColor(colors[5]);
    sig_eff_offlineLRJ300_1Subjet->SetMarkerColor(colors[5]);
    sigLegEffLRJ_1Subjet->AddEntry(sig_eff_offlineLRJ300_1Subjet, "Lead. LRJ E_{T} > 300 GeV [1 Subjet]", "l");
    sig_eff_offlineLRJ350_1Subjet->SetLineColor(colors[6]);
    sig_eff_offlineLRJ350_1Subjet->SetMarkerColor(colors[6]);
    sigLegEffLRJ_1Subjet->AddEntry(sig_eff_offlineLRJ350_1Subjet, "Lead. LRJ E_{T} > 350 GeV [1 Subjet]", "l");
    sig_eff_offlineLRJ400_1Subjet->SetLineColor(colors[7]);
    sig_eff_offlineLRJ400_1Subjet->SetMarkerColor(colors[7]);
    sigLegEffLRJ_1Subjet->AddEntry(sig_eff_offlineLRJ400_1Subjet, "Lead. LRJ E_{T} > 400 GeV [1 Subjet]", "l");
    sig_eff_offlineLRJ450_1Subjet->SetLineColor(colors[8]);
    sig_eff_offlineLRJ450_1Subjet->SetMarkerColor(colors[8]);
    sigLegEffLRJ_1Subjet->AddEntry(sig_eff_offlineLRJ450_1Subjet, "Lead. LRJ E_{T} > 450 GeV [1 Subjet]", "l");
    sig_eff_offlineLRJ500_1Subjet->SetLineColor(colors[9]);
    sig_eff_offlineLRJ500_1Subjet->SetMarkerColor(colors[9]);
    sigLegEffLRJ_1Subjet->AddEntry(sig_eff_offlineLRJ500_1Subjet, "Lead. LRJ E_{T} > 500 GeV [1 Subjet]", "l");
    sig_eff_offlineLRJ50_1Subjet->Draw("P");
    sig_eff_offlineLRJ100_1Subjet->Draw("P SAME");
    sig_eff_offlineLRJ150_1Subjet->Draw("P SAME");
    sig_eff_offlineLRJ200_1Subjet->Draw("P SAME");
    sig_eff_offlineLRJ250_1Subjet->Draw("P SAME");
    sig_eff_offlineLRJ300_1Subjet->Draw("P SAME");
    sig_eff_offlineLRJ350_1Subjet->Draw("P SAME");
    sig_eff_offlineLRJ400_1Subjet->Draw("P SAME");
    sig_eff_offlineLRJ450_1Subjet->Draw("P SAME");
    sig_eff_offlineLRJ500_1Subjet->Draw("P SAME");
    sigLegEffLRJ_1Subjet->Draw();
    cSigEffLRJ_1Subjet.SaveAs(modifiedOutputFileDir + "sig_overlayed_eff_LRJ_1Subjet.pdf");

    cBackEffLRJ_1Subjet.cd();

    // eff. vs. offline leading lrj Et overlay
    back_eff_offlineLRJ100_1Subjet->SetLineColor(colors[1]);
    back_eff_offlineLRJ100_1Subjet->SetMarkerColor(colors[1]);
    backLegEffLRJ_1Subjet->AddEntry(back_eff_offlineLRJ100_1Subjet, "Lead. LRJ E_{T} > 100 GeV [1 Subjet]", "l");
    back_eff_offlineLRJ200_1Subjet->SetLineColor(colors[3]);
    back_eff_offlineLRJ200_1Subjet->SetMarkerColor(colors[3]);
    backLegEffLRJ_1Subjet->AddEntry(back_eff_offlineLRJ200_1Subjet, "Lead. LRJ E_{T} > 200 GeV [1 Subjet]", "l");
    back_eff_offlineLRJ300_1Subjet->SetLineColor(colors[5]);
    back_eff_offlineLRJ300_1Subjet->SetMarkerColor(colors[5]);
    backLegEffLRJ_1Subjet->AddEntry(back_eff_offlineLRJ300_1Subjet, "Lead. LRJ E_{T} > 300 GeV [1 Subjet]", "l");
    back_eff_offlineLRJ100_1Subjet->Draw("P");
    back_eff_offlineLRJ200_1Subjet->Draw("P SAME");
    back_eff_offlineLRJ300_1Subjet->Draw("P SAME");
    backLegEffLRJ_1Subjet->Draw();
    cBackEffLRJ_1Subjet.SaveAs(modifiedOutputFileDir + "back_overlayed_eff_LRJ_1Subjet.pdf");


    cSigEffLRJ_GrEq2Subjets.cd();

    // eff. vs. offline leading lrj Et overlay
    sig_eff_offlineLRJ50_GrEq2Subjets->SetLineColor(colors[0]);
    sig_eff_offlineLRJ50_GrEq2Subjets->SetMarkerColor(colors[0]);
    sigLegEffLRJ_GrEq2Subjets->AddEntry(sig_eff_offlineLRJ50_GrEq2Subjets, "Lead. LRJ E_{T} > 50 GeV [#geq 2 Subjet]", "l");
    sig_eff_offlineLRJ100_GrEq2Subjets->SetLineColor(colors[1]);
    sig_eff_offlineLRJ100_GrEq2Subjets->SetMarkerColor(colors[1]);
    sigLegEffLRJ_GrEq2Subjets->AddEntry(sig_eff_offlineLRJ100_GrEq2Subjets, "Lead. LRJ E_{T} > 100 GeV [#geq 2 Subjet]", "l");
    sig_eff_offlineLRJ150_GrEq2Subjets->SetLineColor(colors[2]);
    sig_eff_offlineLRJ150_GrEq2Subjets->SetMarkerColor(colors[2]);
    sigLegEffLRJ_GrEq2Subjets->AddEntry(sig_eff_offlineLRJ150_GrEq2Subjets, "Lead. LRJ E_{T} > 150 GeV [#geq 2 Subjet]", "l");
    sig_eff_offlineLRJ200_GrEq2Subjets->SetLineColor(colors[3]);
    sig_eff_offlineLRJ200_GrEq2Subjets->SetMarkerColor(colors[3]);
    sigLegEffLRJ_GrEq2Subjets->AddEntry(sig_eff_offlineLRJ200_GrEq2Subjets, "Lead. LRJ E_{T} > 200 GeV [#geq 2 Subjet]", "l");
    sig_eff_offlineLRJ250_GrEq2Subjets->SetLineColor(colors[4]);
    sig_eff_offlineLRJ250_GrEq2Subjets->SetMarkerColor(colors[4]);
    sigLegEffLRJ_GrEq2Subjets->AddEntry(sig_eff_offlineLRJ250_GrEq2Subjets, "Lead. LRJ E_{T} > 250 GeV [#geq 2 Subjet]", "l");
    sig_eff_offlineLRJ300_GrEq2Subjets->SetLineColor(colors[5]);
    sig_eff_offlineLRJ300_GrEq2Subjets->SetMarkerColor(colors[5]);
    sigLegEffLRJ_GrEq2Subjets->AddEntry(sig_eff_offlineLRJ300_GrEq2Subjets, "Lead. LRJ E_{T} > 300 GeV [#geq 2 Subjet]", "l");
    sig_eff_offlineLRJ350_GrEq2Subjets->SetLineColor(colors[6]);
    sig_eff_offlineLRJ350_GrEq2Subjets->SetMarkerColor(colors[6]);
    sigLegEffLRJ_GrEq2Subjets->AddEntry(sig_eff_offlineLRJ350_GrEq2Subjets, "Lead. LRJ E_{T} > 350 GeV [#geq 2 Subjet]", "l");
    sig_eff_offlineLRJ400_GrEq2Subjets->SetLineColor(colors[7]);
    sig_eff_offlineLRJ400_GrEq2Subjets->SetMarkerColor(colors[7]);
    sigLegEffLRJ_GrEq2Subjets->AddEntry(sig_eff_offlineLRJ400_GrEq2Subjets, "Lead. LRJ E_{T} > 400 GeV [#geq 2 Subjet]", "l");
    sig_eff_offlineLRJ450_GrEq2Subjets->SetLineColor(colors[8]);
    sig_eff_offlineLRJ450_GrEq2Subjets->SetMarkerColor(colors[8]);
    sigLegEffLRJ_GrEq2Subjets->AddEntry(sig_eff_offlineLRJ450_GrEq2Subjets, "Lead. LRJ E_{T} > 450 GeV [#geq 2 Subjet]", "l");
    sig_eff_offlineLRJ500_GrEq2Subjets->SetLineColor(colors[9]);
    sig_eff_offlineLRJ500_GrEq2Subjets->SetMarkerColor(colors[9]);
    sigLegEffLRJ_GrEq2Subjets->AddEntry(sig_eff_offlineLRJ500_GrEq2Subjets, "Lead. LRJ E_{T} > 500 GeV [#geq 2 Subjets]", "l");
    sig_eff_offlineLRJ50_GrEq2Subjets->Draw("P");
    sig_eff_offlineLRJ100_GrEq2Subjets->Draw("P SAME");
    sig_eff_offlineLRJ150_GrEq2Subjets->Draw("P SAME");
    sig_eff_offlineLRJ200_GrEq2Subjets->Draw("P SAME");
    sig_eff_offlineLRJ250_GrEq2Subjets->Draw("P SAME");
    sig_eff_offlineLRJ300_GrEq2Subjets->Draw("P SAME");
    sig_eff_offlineLRJ350_GrEq2Subjets->Draw("P SAME");
    sig_eff_offlineLRJ400_GrEq2Subjets->Draw("P SAME");
    sig_eff_offlineLRJ450_GrEq2Subjets->Draw("P SAME");
    sig_eff_offlineLRJ500_GrEq2Subjets->Draw("P SAME");
    sigLegEffLRJ_GrEq2Subjets->Draw();
    cSigEffLRJ_GrEq2Subjets.SaveAs(modifiedOutputFileDir + "sig_overlayed_eff_LRJ_GrEq2Subjets.pdf");

    cBackEffLRJ_GrEq2Subjets.cd();

    // eff. vs. offline leading lrj Et overlay
    back_eff_offlineLRJ100_GrEq2Subjets->SetLineColor(colors[1]);
    back_eff_offlineLRJ100_GrEq2Subjets->SetMarkerColor(colors[1]);
    backLegEffLRJ_GrEq2Subjets->AddEntry(back_eff_offlineLRJ100_GrEq2Subjets, "Lead. LRJ E_{T} > 100 GeV [#geq 2 Subjet]", "l");
    back_eff_offlineLRJ200_GrEq2Subjets->SetLineColor(colors[3]);
    back_eff_offlineLRJ200_GrEq2Subjets->SetMarkerColor(colors[3]);
    backLegEffLRJ_GrEq2Subjets->AddEntry(back_eff_offlineLRJ200_GrEq2Subjets, "Lead. LRJ E_{T} > 200 GeV [#geq 2 Subjet]", "l");
    back_eff_offlineLRJ300_GrEq2Subjets->SetLineColor(colors[5]);
    back_eff_offlineLRJ300_GrEq2Subjets->SetMarkerColor(colors[5]);
    backLegEffLRJ_GrEq2Subjets->AddEntry(back_eff_offlineLRJ300_GrEq2Subjets, "Lead. LRJ E_{T} > 300 GeV [#geq 2 Subjet]", "l");
    back_eff_offlineLRJ100_GrEq2Subjets->Draw("P");
    back_eff_offlineLRJ200_GrEq2Subjets->Draw("P SAME");
    back_eff_offlineLRJ300_GrEq2Subjets->Draw("P SAME");
    backLegEffLRJ_GrEq2Subjets->Draw();
    cBackEffLRJ_GrEq2Subjets.SaveAs(modifiedOutputFileDir + "back_overlayed_eff_LRJ_GrEq2Subjets.pdf");


    cSigEffLRJ_Mass100to150.cd();

    // eff. vs. offline leading lrj Et overlay
    sig_eff_offlineLRJ50_mass100to150->SetLineColor(colors[0]);
    sig_eff_offlineLRJ50_mass100to150->SetMarkerColor(colors[0]);
    sigLegEffLRJ_mass100to150->AddEntry(sig_eff_offlineLRJ50_mass100to150, "Lead. LRJ E_{T} > 50 GeV", "l");
    sig_eff_offlineLRJ100_mass100to150->SetLineColor(colors[1]);
    sig_eff_offlineLRJ100_mass100to150->SetMarkerColor(colors[1]);
    sigLegEffLRJ_mass100to150->AddEntry(sig_eff_offlineLRJ100_mass100to150, "Lead. LRJ E_{T} > 100 GeV", "l");
    sig_eff_offlineLRJ150_mass100to150->SetLineColor(colors[2]);
    sig_eff_offlineLRJ150_mass100to150->SetMarkerColor(colors[2]);
    sigLegEffLRJ_mass100to150->AddEntry(sig_eff_offlineLRJ150_mass100to150, "Lead. LRJ E_{T} > 150 GeV", "l");
    sig_eff_offlineLRJ200_mass100to150->SetLineColor(colors[3]);
    sig_eff_offlineLRJ200_mass100to150->SetMarkerColor(colors[3]);
    sigLegEffLRJ_mass100to150->AddEntry(sig_eff_offlineLRJ200_mass100to150, "Lead. LRJ E_{T} > 200 GeV", "l");
    sig_eff_offlineLRJ250_mass100to150->SetLineColor(colors[4]);
    sig_eff_offlineLRJ250_mass100to150->SetMarkerColor(colors[4]);
    sigLegEffLRJ_mass100to150->AddEntry(sig_eff_offlineLRJ250_mass100to150, "Lead. LRJ E_{T} > 250 GeV", "l");
    sig_eff_offlineLRJ300_mass100to150->SetLineColor(colors[5]);
    sig_eff_offlineLRJ300_mass100to150->SetMarkerColor(colors[5]);
    sigLegEffLRJ_mass100to150->AddEntry(sig_eff_offlineLRJ300_mass100to150, "Lead. LRJ E_{T} > 300 GeV", "l");
    sig_eff_offlineLRJ350_mass100to150->SetLineColor(colors[6]);
    sig_eff_offlineLRJ350_mass100to150->SetMarkerColor(colors[6]);
    sigLegEffLRJ_mass100to150->AddEntry(sig_eff_offlineLRJ350_mass100to150, "Lead. LRJ E_{T} > 350 GeV", "l");
    sig_eff_offlineLRJ400_mass100to150->SetLineColor(colors[7]);
    sig_eff_offlineLRJ400_mass100to150->SetMarkerColor(colors[7]);
    sigLegEffLRJ_mass100to150->AddEntry(sig_eff_offlineLRJ400_mass100to150, "Lead. LRJ E_{T} > 400 GeV", "l");
    sig_eff_offlineLRJ450_mass100to150->SetLineColor(colors[8]);
    sig_eff_offlineLRJ450_mass100to150->SetMarkerColor(colors[8]);
    sigLegEffLRJ_mass100to150->AddEntry(sig_eff_offlineLRJ450_mass100to150, "Lead. LRJ E_{T} > 450 GeV", "l");
    sig_eff_offlineLRJ500_mass100to150->SetLineColor(colors[9]);
    sig_eff_offlineLRJ500_mass100to150->SetMarkerColor(colors[9]);
    sigLegEffLRJ_mass100to150->AddEntry(sig_eff_offlineLRJ500_mass100to150, "Lead. LRJ E_{T} > 500 GeV", "l");
    sig_eff_offlineLRJ50_mass100to150->Draw("P");
    sig_eff_offlineLRJ100_mass100to150->Draw("P SAME");
    sig_eff_offlineLRJ150_mass100to150->Draw("P SAME");
    sig_eff_offlineLRJ200_mass100to150->Draw("P SAME");
    sig_eff_offlineLRJ250_mass100to150->Draw("P SAME");
    sig_eff_offlineLRJ300_mass100to150->Draw("P SAME");
    sig_eff_offlineLRJ350_mass100to150->Draw("P SAME");
    sig_eff_offlineLRJ400_mass100to150->Draw("P SAME");
    sig_eff_offlineLRJ450_mass100to150->Draw("P SAME");
    sig_eff_offlineLRJ500_mass100to150->Draw("P SAME");
    sigLegEffLRJ_mass100to150->Draw();
    cSigEffLRJ_Mass100to150.SaveAs(modifiedOutputFileDir + "sig_overlayed_eff_LRJ_mass100to150.pdf");


    cBackEffLRJ.cd();

    back_eff_offlineLRJ50->SetLineColor(colors[0]);
    back_eff_offlineLRJ50->SetMarkerColor(colors[0]);
    backLegEffLRJ->AddEntry(back_eff_offlineLRJ50, "Lead. LRJ E_{T} > 50 GeV", "l");
    back_eff_offlineLRJ100->SetLineColor(colors[1]);
    back_eff_offlineLRJ100->SetMarkerColor(colors[1]);
    backLegEffLRJ->AddEntry(back_eff_offlineLRJ100, "Lead. LRJ E_{T} > 100 GeV", "l");
    back_eff_offlineLRJ150->SetLineColor(colors[2]);
    back_eff_offlineLRJ150->SetMarkerColor(colors[2]);
    backLegEffLRJ->AddEntry(back_eff_offlineLRJ150, "Lead. LRJ E_{T} > 150 GeV", "l");
    back_eff_offlineLRJ200->SetLineColor(colors[3]);
    back_eff_offlineLRJ200->SetMarkerColor(colors[3]);
    backLegEffLRJ->AddEntry(back_eff_offlineLRJ200, "Lead. LRJ E_{T} > 200 GeV", "l");
    back_eff_offlineLRJ250->SetLineColor(colors[4]);
    back_eff_offlineLRJ250->SetMarkerColor(colors[4]);
    backLegEffLRJ->AddEntry(back_eff_offlineLRJ250, "Lead. LRJ E_{T} > 250 GeV", "l");
    back_eff_offlineLRJ300->SetLineColor(colors[5]);
    back_eff_offlineLRJ300->SetMarkerColor(colors[5]);
    backLegEffLRJ->AddEntry(back_eff_offlineLRJ300, "Lead. LRJ E_{T} > 300 GeV", "l");
    back_eff_offlineLRJ350->SetLineColor(colors[6]);
    back_eff_offlineLRJ350->SetMarkerColor(colors[6]);
    backLegEffLRJ->AddEntry(back_eff_offlineLRJ350, "Lead. LRJ E_{T} > 350 GeV", "l");
    back_eff_offlineLRJ400->SetLineColor(colors[7]);
    back_eff_offlineLRJ400->SetMarkerColor(colors[7]);
    backLegEffLRJ->AddEntry(back_eff_offlineLRJ400, "Lead. LRJ E_{T} > 400 GeV", "l");
    back_eff_offlineLRJ450->SetLineColor(colors[8]);
    back_eff_offlineLRJ450->SetMarkerColor(colors[8]);
    backLegEffLRJ->AddEntry(back_eff_offlineLRJ450, "Lead. LRJ E_{T} > 450 GeV", "l");
    back_eff_offlineLRJ50->Draw("P");
    back_eff_offlineLRJ100->Draw("P SAME");
    back_eff_offlineLRJ150->Draw("P SAME");
    back_eff_offlineLRJ200->Draw("P SAME");
    back_eff_offlineLRJ250->Draw("P SAME");
    back_eff_offlineLRJ300->Draw("P SAME");
    back_eff_offlineLRJ350->Draw("P SAME");
    back_eff_offlineLRJ400->Draw("P SAME");
    back_eff_offlineLRJ450->Draw("P SAME");
    backLegEffLRJ->Draw();
    cBackEffLRJ.SaveAs(modifiedOutputFileDir + "back_overlayed_eff_LRJ.pdf");


    cSigEffLRJ_gFex_Dijet.cd();
    // eff. vs. offline leading lrj Et overlay
    sig_eff_offlineLRJ50_gFexLRJ_Dijet->SetLineColor(colors[0]);
    sig_eff_offlineLRJ50_gFexLRJ_Dijet->SetMarkerColor(colors[0]);
    sigLegEffLRJ_gFex_Dijet->AddEntry(sig_eff_offlineLRJ50_gFexLRJ_Dijet, "Sublead. LRJ E_{T} > 50 GeV", "p");
    sig_eff_offlineLRJ100_gFexLRJ_Dijet->SetLineColor(colors[1]);
    sig_eff_offlineLRJ100_gFexLRJ_Dijet->SetMarkerColor(colors[1]);
    sigLegEffLRJ_gFex_Dijet->AddEntry(sig_eff_offlineLRJ100_gFexLRJ_Dijet, "Sublead. LRJ E_{T} > 100 GeV", "p");
    sig_eff_offlineLRJ150_gFexLRJ_Dijet->SetLineColor(colors[2]);
    sig_eff_offlineLRJ150_gFexLRJ_Dijet->SetMarkerColor(colors[2]);
    sigLegEffLRJ_gFex_Dijet->AddEntry(sig_eff_offlineLRJ150_gFexLRJ_Dijet, "Sublead. LRJ E_{T} > 150 GeV", "p");
    sig_eff_offlineLRJ200_gFexLRJ_Dijet->SetLineColor(colors[3]);
    sig_eff_offlineLRJ200_gFexLRJ_Dijet->SetMarkerColor(colors[3]);
    sigLegEffLRJ_gFex_Dijet->AddEntry(sig_eff_offlineLRJ200_gFexLRJ_Dijet, "Sublead. LRJ E_{T} > 200 GeV", "p");
    sig_eff_offlineLRJ250_gFexLRJ_Dijet->SetLineColor(colors[4]);
    sig_eff_offlineLRJ250_gFexLRJ_Dijet->SetMarkerColor(colors[4]);
    sigLegEffLRJ_gFex_Dijet->AddEntry(sig_eff_offlineLRJ250_gFexLRJ_Dijet, "Sublead. LRJ E_{T} > 250 GeV", "p");
    sig_eff_offlineLRJ300_gFexLRJ_Dijet->SetLineColor(colors[5]);
    sig_eff_offlineLRJ300_gFexLRJ_Dijet->SetMarkerColor(colors[5]);
    sigLegEffLRJ_gFex_Dijet->AddEntry(sig_eff_offlineLRJ300_gFexLRJ_Dijet, "Sublead. LRJ E_{T} > 300 GeV", "p");
    sig_eff_offlineLRJ350_gFexLRJ_Dijet->SetLineColor(colors[6]);
    sig_eff_offlineLRJ350_gFexLRJ_Dijet->SetMarkerColor(colors[6]);
    sigLegEffLRJ_gFex_Dijet->AddEntry(sig_eff_offlineLRJ350_gFexLRJ_Dijet, "Sublead. LRJ E_{T} > 350 GeV", "p");
    sig_eff_offlineLRJ400_gFexLRJ_Dijet->SetLineColor(colors[7]);
    sig_eff_offlineLRJ400_gFexLRJ_Dijet->SetMarkerColor(colors[7]);
    sigLegEffLRJ_gFex_Dijet->AddEntry(sig_eff_offlineLRJ400_gFexLRJ_Dijet, "Sublead. LRJ E_{T} > 400 GeV", "p");
    sig_eff_offlineLRJ450_gFexLRJ_Dijet->SetLineColor(colors[8]);
    sig_eff_offlineLRJ450_gFexLRJ_Dijet->SetMarkerColor(colors[8]);
    sigLegEffLRJ_gFex_Dijet->AddEntry(sig_eff_offlineLRJ450_gFexLRJ_Dijet, "Sublead. LRJ E_{T} > 450 GeV", "p");
    sig_eff_offlineLRJ500_gFexLRJ_Dijet->SetLineColor(colors[9]);
    sig_eff_offlineLRJ500_gFexLRJ_Dijet->SetMarkerColor(colors[9]);
    sigLegEffLRJ_gFex_Dijet->AddEntry(sig_eff_offlineLRJ500_gFexLRJ_Dijet, "Sublead. LRJ E_{T} > 500 GeV", "p");
    sig_eff_offlineLRJ50_gFexLRJ_Dijet->Draw("P");
    sig_eff_offlineLRJ100_gFexLRJ_Dijet->Draw("P SAME");
    sig_eff_offlineLRJ150_gFexLRJ_Dijet->Draw("P SAME");
    sig_eff_offlineLRJ200_gFexLRJ_Dijet->Draw("P SAME");
    sig_eff_offlineLRJ250_gFexLRJ_Dijet->Draw("P SAME");
    sig_eff_offlineLRJ300_gFexLRJ_Dijet->Draw("P SAME");
    sig_eff_offlineLRJ350_gFexLRJ_Dijet->Draw("P SAME");
    sig_eff_offlineLRJ400_gFexLRJ_Dijet->Draw("P SAME");
    sig_eff_offlineLRJ450_gFexLRJ_Dijet->Draw("P SAME");
    sig_eff_offlineLRJ500_gFexLRJ_Dijet->Draw("P SAME");
    sigLegEffLRJ_gFex_Dijet->Draw();
    cSigEffLRJ_gFex_Dijet.SaveAs(modifiedOutputFileDir + "sig_overlayed_eff_LRJ_gFexLRJ_Dijet.pdf");


    cSigEffLRJ_gFex.cd();
    // eff. vs. offline leading lrj Et overlay
    sig_eff_offlineLRJ50_gFexLRJ->SetLineColor(colors[0]);
    sig_eff_offlineLRJ50_gFexLRJ->SetMarkerColor(colors[0]);
    sigLegEffLRJ_gFex->AddEntry(sig_eff_offlineLRJ50_gFexLRJ, "Lead. LRJ E_{T} > 50 GeV", "l");
    sig_eff_offlineLRJ100_gFexLRJ->SetLineColor(colors[1]);
    sig_eff_offlineLRJ100_gFexLRJ->SetMarkerColor(colors[1]);
    sigLegEffLRJ_gFex->AddEntry(sig_eff_offlineLRJ100_gFexLRJ, "Lead. LRJ E_{T} > 100 GeV", "l");
    sig_eff_offlineLRJ150_gFexLRJ->SetLineColor(colors[2]);
    sig_eff_offlineLRJ150_gFexLRJ->SetMarkerColor(colors[2]);
    sigLegEffLRJ_gFex->AddEntry(sig_eff_offlineLRJ150_gFexLRJ, "Lead. LRJ E_{T} > 150 GeV", "l");
    sig_eff_offlineLRJ200_gFexLRJ->SetLineColor(colors[3]);
    sig_eff_offlineLRJ200_gFexLRJ->SetMarkerColor(colors[3]);
    sigLegEffLRJ_gFex->AddEntry(sig_eff_offlineLRJ200_gFexLRJ, "Lead. LRJ E_{T} > 200 GeV", "l");
    sig_eff_offlineLRJ250_gFexLRJ->SetLineColor(colors[4]);
    sig_eff_offlineLRJ250_gFexLRJ->SetMarkerColor(colors[4]);
    sigLegEffLRJ_gFex->AddEntry(sig_eff_offlineLRJ250_gFexLRJ, "Lead. LRJ E_{T} > 250 GeV", "l");
    sig_eff_offlineLRJ300_gFexLRJ->SetLineColor(colors[5]);
    sig_eff_offlineLRJ300_gFexLRJ->SetMarkerColor(colors[5]);
    sigLegEffLRJ_gFex->AddEntry(sig_eff_offlineLRJ300_gFexLRJ, "Lead. LRJ E_{T} > 300 GeV", "l");
    sig_eff_offlineLRJ350_gFexLRJ->SetLineColor(colors[6]);
    sig_eff_offlineLRJ350_gFexLRJ->SetMarkerColor(colors[6]);
    sigLegEffLRJ_gFex->AddEntry(sig_eff_offlineLRJ350_gFexLRJ, "Lead. LRJ E_{T} > 350 GeV", "l");
    sig_eff_offlineLRJ400_gFexLRJ->SetLineColor(colors[7]);
    sig_eff_offlineLRJ400_gFexLRJ->SetMarkerColor(colors[7]);
    sigLegEffLRJ_gFex->AddEntry(sig_eff_offlineLRJ400_gFexLRJ, "Lead. LRJ E_{T} > 400 GeV", "l");
    sig_eff_offlineLRJ450_gFexLRJ->SetLineColor(colors[8]);
    sig_eff_offlineLRJ450_gFexLRJ->SetMarkerColor(colors[8]);
    sigLegEffLRJ_gFex->AddEntry(sig_eff_offlineLRJ450_gFexLRJ, "Lead. LRJ E_{T} > 450 GeV", "l");
    sig_eff_offlineLRJ500_gFexLRJ->SetLineColor(colors[9]);
    sig_eff_offlineLRJ500_gFexLRJ->SetMarkerColor(colors[9]);
    sigLegEffLRJ_gFex->AddEntry(sig_eff_offlineLRJ500_gFexLRJ, "Lead. LRJ E_{T} > 500 GeV", "l");
    sig_eff_offlineLRJ50_gFexLRJ->Draw("P");
    sig_eff_offlineLRJ100_gFexLRJ->Draw("P SAME");
    sig_eff_offlineLRJ150_gFexLRJ->Draw("P SAME");
    sig_eff_offlineLRJ200_gFexLRJ->Draw("P SAME");
    sig_eff_offlineLRJ250_gFexLRJ->Draw("P SAME");
    sig_eff_offlineLRJ300_gFexLRJ->Draw("P SAME");
    sig_eff_offlineLRJ350_gFexLRJ->Draw("P SAME");
    sig_eff_offlineLRJ400_gFexLRJ->Draw("P SAME");
    sig_eff_offlineLRJ450_gFexLRJ->Draw("P SAME");
    sig_eff_offlineLRJ500_gFexLRJ->Draw("P SAME");
    sigLegEffLRJ_gFex->Draw();
    cSigEffLRJ_gFex.SaveAs(modifiedOutputFileDir + "sig_overlayed_eff_LRJ_gFexLRJ.pdf");

    cSigEffLRJ_jFex.cd();
    // eff. vs. offline leading lrj Et overlay
    sig_eff_offlineLRJ50_jFexLRJ->SetLineColor(colors[0]);
    sig_eff_offlineLRJ50_jFexLRJ->SetMarkerColor(colors[0]);
    sigLegEffLRJ_jFex->AddEntry(sig_eff_offlineLRJ50_jFexLRJ, "Lead. LRJ E_{T} > 50 GeV", "l");
    sig_eff_offlineLRJ100_jFexLRJ->SetLineColor(colors[1]);
    sig_eff_offlineLRJ100_jFexLRJ->SetMarkerColor(colors[1]);
    sigLegEffLRJ_jFex->AddEntry(sig_eff_offlineLRJ100_jFexLRJ, "Lead. LRJ E_{T} > 100 GeV", "l");
    sig_eff_offlineLRJ150_jFexLRJ->SetLineColor(colors[2]);
    sig_eff_offlineLRJ150_jFexLRJ->SetMarkerColor(colors[2]);
    sigLegEffLRJ_jFex->AddEntry(sig_eff_offlineLRJ150_jFexLRJ, "Lead. LRJ E_{T} > 150 GeV", "l");
    sig_eff_offlineLRJ200_jFexLRJ->SetLineColor(colors[3]);
    sig_eff_offlineLRJ200_jFexLRJ->SetMarkerColor(colors[3]);
    sigLegEffLRJ_jFex->AddEntry(sig_eff_offlineLRJ200_jFexLRJ, "Lead. LRJ E_{T} > 200 GeV", "l");
    sig_eff_offlineLRJ250_jFexLRJ->SetLineColor(colors[4]);
    sig_eff_offlineLRJ250_jFexLRJ->SetMarkerColor(colors[4]);
    sigLegEffLRJ_jFex->AddEntry(sig_eff_offlineLRJ250_jFexLRJ, "Lead. LRJ E_{T} > 250 GeV", "l");
    sig_eff_offlineLRJ300_jFexLRJ->SetLineColor(colors[5]);
    sig_eff_offlineLRJ300_jFexLRJ->SetMarkerColor(colors[5]);
    sigLegEffLRJ_jFex->AddEntry(sig_eff_offlineLRJ300_jFexLRJ, "Lead. LRJ E_{T} > 300 GeV", "l");
    sig_eff_offlineLRJ350_jFexLRJ->SetLineColor(colors[6]);
    sig_eff_offlineLRJ350_jFexLRJ->SetMarkerColor(colors[6]);
    sigLegEffLRJ_jFex->AddEntry(sig_eff_offlineLRJ350_jFexLRJ, "Lead. LRJ E_{T} > 350 GeV", "l");
    sig_eff_offlineLRJ400_jFexLRJ->SetLineColor(colors[7]);
    sig_eff_offlineLRJ400_jFexLRJ->SetMarkerColor(colors[7]);
    sigLegEffLRJ_jFex->AddEntry(sig_eff_offlineLRJ400_jFexLRJ, "Lead. LRJ E_{T} > 400 GeV", "l");
    sig_eff_offlineLRJ450_jFexLRJ->SetLineColor(colors[8]);
    sig_eff_offlineLRJ450_jFexLRJ->SetMarkerColor(colors[8]);
    sigLegEffLRJ_jFex->AddEntry(sig_eff_offlineLRJ450_jFexLRJ, "Lead. LRJ E_{T} > 450 GeV", "l");
    sig_eff_offlineLRJ500_jFexLRJ->SetLineColor(colors[9]);
    sig_eff_offlineLRJ500_jFexLRJ->SetMarkerColor(colors[9]);
    sigLegEffLRJ_jFex->AddEntry(sig_eff_offlineLRJ500_jFexLRJ, "Lead. LRJ E_{T} > 500 GeV", "l");
    sig_eff_offlineLRJ50_jFexLRJ->Draw("P");
    sig_eff_offlineLRJ100_jFexLRJ->Draw("P SAME");
    sig_eff_offlineLRJ150_jFexLRJ->Draw("P SAME");
    sig_eff_offlineLRJ200_jFexLRJ->Draw("P SAME");
    sig_eff_offlineLRJ250_jFexLRJ->Draw("P SAME");
    sig_eff_offlineLRJ300_jFexLRJ->Draw("P SAME");
    sig_eff_offlineLRJ350_jFexLRJ->Draw("P SAME");
    sig_eff_offlineLRJ400_jFexLRJ->Draw("P SAME");
    sig_eff_offlineLRJ450_jFexLRJ->Draw("P SAME");
    sig_eff_offlineLRJ500_jFexLRJ->Draw("P SAME");
    sigLegEffLRJ_jFex->Draw();
    cSigEffLRJ_jFex.SaveAs(modifiedOutputFileDir + "sig_overlayed_eff_LRJ_jFexLRJ.pdf");


    cBackEffLRJ_gFex.cd();
    // eff. vs. offline leading lrj Et overlay
    back_eff_offlineLRJ50_gFexLRJ->SetLineColor(colors[0]);
    back_eff_offlineLRJ50_gFexLRJ->SetMarkerColor(colors[0]);
    backLegEffLRJ_gFex->AddEntry(back_eff_offlineLRJ50_gFexLRJ, "Lead. LRJ E_{T} > 50 GeV", "l");
    back_eff_offlineLRJ100_gFexLRJ->SetLineColor(colors[1]);
    back_eff_offlineLRJ100_gFexLRJ->SetMarkerColor(colors[1]);
    backLegEffLRJ_gFex->AddEntry(back_eff_offlineLRJ100_gFexLRJ, "Lead. LRJ E_{T} > 100 GeV", "l");
    back_eff_offlineLRJ150_gFexLRJ->SetLineColor(colors[2]);
    back_eff_offlineLRJ150_gFexLRJ->SetMarkerColor(colors[2]);
    backLegEffLRJ_gFex->AddEntry(back_eff_offlineLRJ150_gFexLRJ, "Lead. LRJ E_{T} > 150 GeV", "l");
    back_eff_offlineLRJ200_gFexLRJ->SetLineColor(colors[3]);
    back_eff_offlineLRJ200_gFexLRJ->SetMarkerColor(colors[3]);
    backLegEffLRJ_gFex->AddEntry(back_eff_offlineLRJ200_gFexLRJ, "Lead. LRJ E_{T} > 200 GeV", "l");
    back_eff_offlineLRJ250_gFexLRJ->SetLineColor(colors[4]);
    back_eff_offlineLRJ250_gFexLRJ->SetMarkerColor(colors[4]);
    backLegEffLRJ_gFex->AddEntry(back_eff_offlineLRJ250_gFexLRJ, "Lead. LRJ E_{T} > 250 GeV", "l");
    back_eff_offlineLRJ300_gFexLRJ->SetLineColor(colors[5]);
    back_eff_offlineLRJ300_gFexLRJ->SetMarkerColor(colors[5]);
    backLegEffLRJ_gFex->AddEntry(back_eff_offlineLRJ300_gFexLRJ, "Lead. LRJ E_{T} > 300 GeV", "l");
    back_eff_offlineLRJ350_gFexLRJ->SetLineColor(colors[6]);
    back_eff_offlineLRJ350_gFexLRJ->SetMarkerColor(colors[6]);
    backLegEffLRJ_gFex->AddEntry(back_eff_offlineLRJ350_gFexLRJ, "Lead. LRJ E_{T} > 350 GeV", "l");
    back_eff_offlineLRJ400_gFexLRJ->SetLineColor(colors[7]);
    back_eff_offlineLRJ400_gFexLRJ->SetMarkerColor(colors[7]);
    backLegEffLRJ_gFex->AddEntry(back_eff_offlineLRJ400_gFexLRJ, "Lead. LRJ E_{T} > 400 GeV", "l");
    back_eff_offlineLRJ450_gFexLRJ->SetLineColor(colors[8]);
    back_eff_offlineLRJ450_gFexLRJ->SetMarkerColor(colors[8]);
    backLegEffLRJ_gFex->AddEntry(back_eff_offlineLRJ450_gFexLRJ, "Lead. LRJ E_{T} > 450 GeV", "l");
    back_eff_offlineLRJ50_gFexLRJ->Draw("P");
    back_eff_offlineLRJ100_gFexLRJ->Draw("P SAME");
    back_eff_offlineLRJ150_gFexLRJ->Draw("P SAME");
    back_eff_offlineLRJ200_gFexLRJ->Draw("P SAME");
    back_eff_offlineLRJ250_gFexLRJ->Draw("P SAME");
    back_eff_offlineLRJ300_gFexLRJ->Draw("P SAME");
    back_eff_offlineLRJ350_gFexLRJ->Draw("P SAME");
    back_eff_offlineLRJ400_gFexLRJ->Draw("P SAME");
    back_eff_offlineLRJ450_gFexLRJ->Draw("P SAME");
    backLegEffLRJ_gFex->Draw();
    cBackEffLRJ_gFex.SaveAs(modifiedOutputFileDir + "back_overlayed_eff_LRJ_gFexLRJ.pdf");

    cBackEffLRJ_jFex.cd();
    // eff. vs. offline leading lrj Et overlay
    back_eff_offlineLRJ50_jFexLRJ->SetLineColor(colors[0]);
    back_eff_offlineLRJ50_jFexLRJ->SetMarkerColor(colors[0]);
    backLegEffLRJ_jFex->AddEntry(back_eff_offlineLRJ50_jFexLRJ, "Lead. LRJ E_{T} > 50 GeV", "l");
    back_eff_offlineLRJ100_jFexLRJ->SetLineColor(colors[1]);
    back_eff_offlineLRJ100_jFexLRJ->SetMarkerColor(colors[1]);
    backLegEffLRJ_jFex->AddEntry(back_eff_offlineLRJ100_jFexLRJ, "Lead. LRJ E_{T} > 100 GeV", "l");
    back_eff_offlineLRJ150_jFexLRJ->SetLineColor(colors[2]);
    back_eff_offlineLRJ150_jFexLRJ->SetMarkerColor(colors[2]);
    backLegEffLRJ_jFex->AddEntry(back_eff_offlineLRJ150_jFexLRJ, "Lead. LRJ E_{T} > 150 GeV", "l");
    back_eff_offlineLRJ200_jFexLRJ->SetLineColor(colors[3]);
    back_eff_offlineLRJ200_jFexLRJ->SetMarkerColor(colors[3]);
    backLegEffLRJ_jFex->AddEntry(back_eff_offlineLRJ200_jFexLRJ, "Lead. LRJ E_{T} > 200 GeV", "l");
    back_eff_offlineLRJ250_jFexLRJ->SetLineColor(colors[4]);
    back_eff_offlineLRJ250_jFexLRJ->SetMarkerColor(colors[4]);
    backLegEffLRJ_jFex->AddEntry(back_eff_offlineLRJ250_jFexLRJ, "Lead. LRJ E_{T} > 250 GeV", "l");
    back_eff_offlineLRJ300_jFexLRJ->SetLineColor(colors[5]);
    back_eff_offlineLRJ300_jFexLRJ->SetMarkerColor(colors[5]);
    backLegEffLRJ_jFex->AddEntry(back_eff_offlineLRJ300_jFexLRJ, "Lead. LRJ E_{T} > 300 GeV", "l");
    back_eff_offlineLRJ350_jFexLRJ->SetLineColor(colors[6]);
    back_eff_offlineLRJ350_jFexLRJ->SetMarkerColor(colors[6]);
    backLegEffLRJ_jFex->AddEntry(back_eff_offlineLRJ350_jFexLRJ, "Lead. LRJ E_{T} > 350 GeV", "l");
    back_eff_offlineLRJ400_jFexLRJ->SetLineColor(colors[7]);
    back_eff_offlineLRJ400_jFexLRJ->SetMarkerColor(colors[7]);
    backLegEffLRJ_jFex->AddEntry(back_eff_offlineLRJ400_jFexLRJ, "Lead. LRJ E_{T} > 400 GeV", "l");
    back_eff_offlineLRJ450_jFexLRJ->SetLineColor(colors[8]);
    back_eff_offlineLRJ450_jFexLRJ->SetMarkerColor(colors[8]);
    backLegEffLRJ_jFex->AddEntry(back_eff_offlineLRJ450_jFexLRJ, "Lead. LRJ E_{T} > 450 GeV", "l");
    back_eff_offlineLRJ50_jFexLRJ->Draw("P");
    back_eff_offlineLRJ100_jFexLRJ->Draw("P SAME");
    back_eff_offlineLRJ150_jFexLRJ->Draw("P SAME");
    back_eff_offlineLRJ200_jFexLRJ->Draw("P SAME");
    back_eff_offlineLRJ250_jFexLRJ->Draw("P SAME");
    back_eff_offlineLRJ300_jFexLRJ->Draw("P SAME");
    back_eff_offlineLRJ350_jFexLRJ->Draw("P SAME");
    back_eff_offlineLRJ400_jFexLRJ->Draw("P SAME");
    back_eff_offlineLRJ450_jFexLRJ->Draw("P SAME");
    backLegEffLRJ_jFex->Draw();
    cBackEffLRJ_jFex.SaveAs(modifiedOutputFileDir + "back_overlayed_eff_LRJ_jFexLRJ.pdf");

    cSigEffLRJ_gFex_LRJ_overlay.cd();

    // Choose the same colors you used before for 100/200/400
    const int col100 = colors[1]; // matches your 100 GeV color
    const int col150 = colors[2]; // matches your 150 GeV color
    const int col200 = colors[3]; // matches your 200 GeV color
    const int col250 = colors[4]; // matches your 250 GeV color
    const int col300 = colors[5]; // matches your 300 GeV color
    const int col400 = colors[7]; // matches your 400 GeV color
    const int col450 = colors[8]; // matches your 450 GeV color

    // Marker styles: full circle for offline, open circle for gFEX
    const int mFull = 20; // kFullCircle
    const int mOpen = 24; // kOpenCircle

    // ---- 100 GeV ----
    sig_eff_offlineLRJ100->SetLineColor(col100);
    sig_eff_offlineLRJ100->SetMarkerColor(col100);
    sig_eff_offlineLRJ100->SetMarkerStyle(mFull);
    sig_eff_offlineLRJ100->SetMarkerSize(1.1);

    sig_eff_offlineLRJ100_gFexLRJ->SetLineColor(col100);
    sig_eff_offlineLRJ100_gFexLRJ->SetMarkerColor(col100);
    sig_eff_offlineLRJ100_gFexLRJ->SetMarkerStyle(mOpen);
    sig_eff_offlineLRJ100_gFexLRJ->SetMarkerSize(1.1);

    // ---- 250 GeV ----
    sig_eff_offlineLRJ250->SetLineColor(col250);
    sig_eff_offlineLRJ250->SetMarkerColor(col250);
    sig_eff_offlineLRJ250->SetMarkerStyle(mFull);
    sig_eff_offlineLRJ250->SetMarkerSize(1.1);

    sig_eff_offlineLRJ250_gFexLRJ->SetLineColor(col250);
    sig_eff_offlineLRJ250_gFexLRJ->SetMarkerColor(col250);
    sig_eff_offlineLRJ250_gFexLRJ->SetMarkerStyle(mOpen);
    sig_eff_offlineLRJ250_gFexLRJ->SetMarkerSize(1.1);

    // ---- 400 GeV ----
    sig_eff_offlineLRJ400->SetLineColor(col400);
    sig_eff_offlineLRJ400->SetMarkerColor(col400);
    sig_eff_offlineLRJ400->SetMarkerStyle(mFull);
    sig_eff_offlineLRJ400->SetMarkerSize(1.1);

    sig_eff_offlineLRJ400_gFexLRJ->SetLineColor(col400);
    sig_eff_offlineLRJ400_gFexLRJ->SetMarkerColor(col400);
    sig_eff_offlineLRJ400_gFexLRJ->SetMarkerStyle(mOpen);
    sig_eff_offlineLRJ400_gFexLRJ->SetMarkerSize(1.1);

    // Draw: use one graph with "AP" to set axes; then overlay the rest
    // (If these are TGraph/TGraphAsymmErrors, "AP" is appropriate; otherwise "P" is fine.)
    sig_eff_offlineLRJ100->Draw("P");              // sets axes
    sig_eff_offlineLRJ100_gFexLRJ->Draw("P SAME");

    sig_eff_offlineLRJ250->Draw("P SAME");
    sig_eff_offlineLRJ250_gFexLRJ->Draw("P SAME");

    sig_eff_offlineLRJ400->Draw("P SAME");
    sig_eff_offlineLRJ400_gFexLRJ->Draw("P SAME");

    // Legend
    
    TLegend *sigLegEffLRJ_gFex_LRJ_overlay = new TLegend(0.615,0.2,0.99,0.525);
    sigLegEffLRJ_gFex_LRJ_overlay->SetTextSize(0.0275);

    // Group entries by threshold, showing offline (full) and gFEX (open) with same color
    sigLegEffLRJ_gFex_LRJ_overlay->AddEntry(sig_eff_offlineLRJ100,           "Lead. Jet E_{T} > 100 GeV (JetTagger)", "p");
    sigLegEffLRJ_gFex_LRJ_overlay->AddEntry(sig_eff_offlineLRJ100_gFexLRJ,   "Lead. Jet E_{T} > 100 GeV (gFEX LRJ)",    "p");

    sigLegEffLRJ_gFex_LRJ_overlay->AddEntry(sig_eff_offlineLRJ250,           "Lead. Jet E_{T} > 250 GeV (JetTagger)", "p");
    sigLegEffLRJ_gFex_LRJ_overlay->AddEntry(sig_eff_offlineLRJ250_gFexLRJ,   "Lead. Jet E_{T} > 250 GeV (gFEX LRJ)",    "p");

    sigLegEffLRJ_gFex_LRJ_overlay->AddEntry(sig_eff_offlineLRJ400,           "Lead. Jet E_{T} > 400 GeV (JetTagger)", "p");
    sigLegEffLRJ_gFex_LRJ_overlay->AddEntry(sig_eff_offlineLRJ400_gFexLRJ,   "Lead. Jet E_{T} > 400 GeV (gFEX LRJ)",    "p");

    sigLegEffLRJ_gFex_LRJ_overlay->Draw();

    // Save to a new file/canvas
    cSigEffLRJ_gFex_LRJ_overlay.SaveAs(modifiedOutputFileDir + "sig_overlayed_eff_LRJ_off_vs_gFEX_100_250_400.pdf");


    // JFEX
    cSigEffLRJ_jFex_LRJ_overlay.cd();
    // ---- 100 GeV ----
    sig_eff_offlineLRJ100->SetLineColor(col100);
    sig_eff_offlineLRJ100->SetMarkerColor(col100);
    sig_eff_offlineLRJ100->SetMarkerStyle(mFull);
    sig_eff_offlineLRJ100->SetMarkerSize(1.1);

    sig_eff_offlineLRJ100_jFexLRJ->SetLineColor(col100);
    sig_eff_offlineLRJ100_jFexLRJ->SetMarkerColor(col100);
    sig_eff_offlineLRJ100_jFexLRJ->SetMarkerStyle(mOpen);
    sig_eff_offlineLRJ100_jFexLRJ->SetMarkerSize(1.1);

    // ---- 250 GeV ----
    sig_eff_offlineLRJ250->SetLineColor(col250);
    sig_eff_offlineLRJ250->SetMarkerColor(col250);
    sig_eff_offlineLRJ250->SetMarkerStyle(mFull);
    sig_eff_offlineLRJ250->SetMarkerSize(1.1);

    sig_eff_offlineLRJ250_jFexLRJ->SetLineColor(col250);
    sig_eff_offlineLRJ250_jFexLRJ->SetMarkerColor(col250);
    sig_eff_offlineLRJ250_jFexLRJ->SetMarkerStyle(mOpen);
    sig_eff_offlineLRJ250_jFexLRJ->SetMarkerSize(1.1);

    // ---- 400 GeV ----
    sig_eff_offlineLRJ400->SetLineColor(col400);
    sig_eff_offlineLRJ400->SetMarkerColor(col400);
    sig_eff_offlineLRJ400->SetMarkerStyle(mFull);
    sig_eff_offlineLRJ400->SetMarkerSize(1.1);

    sig_eff_offlineLRJ400_jFexLRJ->SetLineColor(col400);
    sig_eff_offlineLRJ400_jFexLRJ->SetMarkerColor(col400);
    sig_eff_offlineLRJ400_jFexLRJ->SetMarkerStyle(mOpen);
    sig_eff_offlineLRJ400_jFexLRJ->SetMarkerSize(1.1);

    // Draw: use one graph with "AP" to set axes; then overlay the rest
    // (If these are TGraph/TGraphAsymmErrors, "AP" is appropriate; otherwise "P" is fine.)
    sig_eff_offlineLRJ100->Draw("P");              // sets axes
    sig_eff_offlineLRJ100_jFexLRJ->Draw("P SAME");

    sig_eff_offlineLRJ250->Draw("P SAME");
    sig_eff_offlineLRJ250_jFexLRJ->Draw("P SAME");

    sig_eff_offlineLRJ400->Draw("P SAME");
    sig_eff_offlineLRJ400_jFexLRJ->Draw("P SAME");

    // Legend
    
    TLegend *sigLegEffLRJ_jFex_LRJ_overlay = new TLegend(0.615,0.2,0.99,0.525);
    sigLegEffLRJ_jFex_LRJ_overlay->SetTextSize(0.0275);

    // Group entries by threshold, showing offline (full) and jFex (open) with same color
    sigLegEffLRJ_jFex_LRJ_overlay->AddEntry(sig_eff_offlineLRJ100,           "Lead. Jet E_{T} > 100 GeV (JetTagger)", "p");
    sigLegEffLRJ_jFex_LRJ_overlay->AddEntry(sig_eff_offlineLRJ100_jFexLRJ,   "Lead. Jet E_{T} > 100 GeV (jFEX LRJ)",    "p");

    sigLegEffLRJ_jFex_LRJ_overlay->AddEntry(sig_eff_offlineLRJ250,           "Lead. Jet E_{T} > 250 GeV (JetTagger)", "p");
    sigLegEffLRJ_jFex_LRJ_overlay->AddEntry(sig_eff_offlineLRJ250_jFexLRJ,   "Lead. Jet E_{T} > 250 GeV (jFEX LRJ)",    "p");

    sigLegEffLRJ_jFex_LRJ_overlay->AddEntry(sig_eff_offlineLRJ400,           "Lead. Jet E_{T} > 400 GeV (JetTagger)", "p");
    sigLegEffLRJ_jFex_LRJ_overlay->AddEntry(sig_eff_offlineLRJ400_jFexLRJ,   "Lead. Jet E_{T} > 400 GeV (jFEX LRJ)",    "p");

    sigLegEffLRJ_jFex_LRJ_overlay->Draw();

    // Save to a new file/canvas
    cSigEffLRJ_jFex_LRJ_overlay.SaveAs(modifiedOutputFileDir + "sig_overlayed_eff_LRJ_off_vs_jFex_100_250_400.pdf");

    cSigEffLRJ_gFex_LRJ_Dijet_overlay.cd();
    // ---- 100 GeV ----
    sig_eff_offlineLRJ100_Dijet->SetLineColor(col100);
    sig_eff_offlineLRJ100_Dijet->SetMarkerColor(col100);
    sig_eff_offlineLRJ100_Dijet->SetMarkerStyle(mFull);
    sig_eff_offlineLRJ100_Dijet->SetMarkerSize(1.1);

    sig_eff_offlineLRJ100_gFexLRJ_Dijet->SetLineColor(col100);
    sig_eff_offlineLRJ100_gFexLRJ_Dijet->SetMarkerColor(col100);
    sig_eff_offlineLRJ100_gFexLRJ_Dijet->SetMarkerStyle(mOpen);
    sig_eff_offlineLRJ100_gFexLRJ_Dijet->SetMarkerSize(1.1);

    // ---- 250 GeV ----
    sig_eff_offlineLRJ250_Dijet->SetLineColor(col250);
    sig_eff_offlineLRJ250_Dijet->SetMarkerColor(col250);
    sig_eff_offlineLRJ250_Dijet->SetMarkerStyle(mFull);
    sig_eff_offlineLRJ250_Dijet->SetMarkerSize(1.1);

    sig_eff_offlineLRJ250_gFexLRJ_Dijet->SetLineColor(col250);
    sig_eff_offlineLRJ250_gFexLRJ_Dijet->SetMarkerColor(col250);
    sig_eff_offlineLRJ250_gFexLRJ_Dijet->SetMarkerStyle(mOpen);
    sig_eff_offlineLRJ250_gFexLRJ_Dijet->SetMarkerSize(1.1);

    // ---- 400 GeV ----
    sig_eff_offlineLRJ400_Dijet->SetLineColor(col400);
    sig_eff_offlineLRJ400_Dijet->SetMarkerColor(col400);
    sig_eff_offlineLRJ400_Dijet->SetMarkerStyle(mFull);
    sig_eff_offlineLRJ400_Dijet->SetMarkerSize(1.1);

    sig_eff_offlineLRJ400_gFexLRJ_Dijet->SetLineColor(col400);
    sig_eff_offlineLRJ400_gFexLRJ_Dijet->SetMarkerColor(col400);
    sig_eff_offlineLRJ400_gFexLRJ_Dijet->SetMarkerStyle(mOpen);
    sig_eff_offlineLRJ400_gFexLRJ_Dijet->SetMarkerSize(1.1);

    // Draw: use one graph with "AP" to set axes; then overlay the rest
    // (If these are TGraph/TGraphAsymmErrors, "AP" is appropriate; otherwise "P" is fine.)
    sig_eff_offlineLRJ100_Dijet->Draw("P");              // sets axes
    sig_eff_offlineLRJ100_gFexLRJ_Dijet->Draw("P SAME");

    sig_eff_offlineLRJ250_Dijet->Draw("P SAME");
    sig_eff_offlineLRJ250_gFexLRJ_Dijet->Draw("P SAME");

    sig_eff_offlineLRJ400_Dijet->Draw("P SAME");
    sig_eff_offlineLRJ400_gFexLRJ_Dijet->Draw("P SAME");

    // Legend
    
    TLegend *sigLegEffLRJ_gFex_LRJ_Dijet_overlay = new TLegend(0.515,0.2,0.94,0.525);
    sigLegEffLRJ_gFex_LRJ_Dijet_overlay->SetTextSize(0.0275);

    // Group entries by threshold, showing offline (full) and gFEX (open) with same color
    sigLegEffLRJ_gFex_LRJ_Dijet_overlay->AddEntry(sig_eff_offlineLRJ100_Dijet,           "Sublead. Jet E_{T} > 100 GeV (JetTagger)", "p");
    sigLegEffLRJ_gFex_LRJ_Dijet_overlay->AddEntry(sig_eff_offlineLRJ100_gFexLRJ_Dijet,   "Sublead. Jet E_{T} > 100 GeV (gFEX LRJ)",    "p");

    sigLegEffLRJ_gFex_LRJ_Dijet_overlay->AddEntry(sig_eff_offlineLRJ250_Dijet,           "Sublead. Jet E_{T} > 250 GeV (JetTagger)", "p");
    sigLegEffLRJ_gFex_LRJ_Dijet_overlay->AddEntry(sig_eff_offlineLRJ250_gFexLRJ_Dijet,   "Sublead. Jet E_{T} > 250 GeV (gFEX LRJ)",    "p");

    sigLegEffLRJ_gFex_LRJ_Dijet_overlay->AddEntry(sig_eff_offlineLRJ400_Dijet,           "Sublead. Jet E_{T} > 400 GeV (JetTagger)", "p");
    sigLegEffLRJ_gFex_LRJ_Dijet_overlay->AddEntry(sig_eff_offlineLRJ400_gFexLRJ_Dijet,   "Sublead. Jet E_{T} > 400 GeV (gFEX LRJ)",    "p");

    //sigLegEffLRJ_gFex_LRJ_Dijet_overlay->Draw(); // TOGGLE DRAW OR DON'T DRAW

    // Save to a new file/canvas
    cSigEffLRJ_gFex_LRJ_Dijet_overlay.SaveAs(modifiedOutputFileDir + "sig_overlayed_eff_LRJ_off_vs_gFEX_Dijet_150_250_400.pdf");

    cSigEffLRJ_Mass100to150_LRJ_overlay.cd();
    // ---- 150 GeV ----
    sig_eff_offlineLRJ150->SetLineColor(col150);
    sig_eff_offlineLRJ150->SetMarkerColor(col150);
    sig_eff_offlineLRJ150->SetMarkerStyle(mFull);
    sig_eff_offlineLRJ150->SetMarkerSize(1.1);

    sig_eff_offlineLRJ150_mass100to150->SetLineColor(col150);
    sig_eff_offlineLRJ150_mass100to150->SetMarkerColor(col150);
    sig_eff_offlineLRJ150_mass100to150->SetMarkerStyle(mOpen);
    sig_eff_offlineLRJ150_mass100to150->SetMarkerSize(1.1);

    // ---- 300 GeV ----
    sig_eff_offlineLRJ300->SetLineColor(col300);
    sig_eff_offlineLRJ300->SetMarkerColor(col300);
    sig_eff_offlineLRJ300->SetMarkerStyle(mFull);
    sig_eff_offlineLRJ300->SetMarkerSize(1.1);

    sig_eff_offlineLRJ300_mass100to150->SetLineColor(col300);
    sig_eff_offlineLRJ300_mass100to150->SetMarkerColor(col300);
    sig_eff_offlineLRJ300_mass100to150->SetMarkerStyle(mOpen);
    sig_eff_offlineLRJ300_mass100to150->SetMarkerSize(1.1);

    // ---- 450 GeV ----
    sig_eff_offlineLRJ450->SetLineColor(col450);
    sig_eff_offlineLRJ450->SetMarkerColor(col450);
    sig_eff_offlineLRJ450->SetMarkerStyle(mFull);
    sig_eff_offlineLRJ450->SetMarkerSize(1.1);

    sig_eff_offlineLRJ450_mass100to150->SetLineColor(col450);
    sig_eff_offlineLRJ450_mass100to150->SetMarkerColor(col450);
    sig_eff_offlineLRJ450_mass100to150->SetMarkerStyle(mOpen);
    sig_eff_offlineLRJ450_mass100to150->SetMarkerSize(1.1);

    // Draw: use one graph with "AP" to set axes; then overlay the rest
    // (If these are TGraph/TGraphAsymmErrors, "AP" is appropriate; otherwise "P" is fine.)
    sig_eff_offlineLRJ150->Draw("P");              // sets axes
    sig_eff_offlineLRJ150_mass100to150->Draw("P SAME");

    sig_eff_offlineLRJ300->Draw("P SAME");
    sig_eff_offlineLRJ300_mass100to150->Draw("P SAME");

    sig_eff_offlineLRJ450->Draw("P SAME");
    sig_eff_offlineLRJ450_mass100to150->Draw("P SAME");

    // Legend
    
    TLegend *sigLegEffLRJ_mass100to150_LRJ_overlay = new TLegend(0.56,0.2,0.99,0.525);
    sigLegEffLRJ_mass100to150_LRJ_overlay->SetTextSize(0.0275);

    // Group entries by threshold, showing offline (full) and gFEX (open) with same color
    sigLegEffLRJ_mass100to150_LRJ_overlay->AddEntry(sig_eff_offlineLRJ150,           "Lead. Jet E_{T} > 150 GeV", "p");
    sigLegEffLRJ_mass100to150_LRJ_overlay->AddEntry(sig_eff_offlineLRJ150_mass100to150,   "Lead. Jet E_{T} > 150, 100 < m_{off.} < 150 GeV",    "p");

    sigLegEffLRJ_mass100to150_LRJ_overlay->AddEntry(sig_eff_offlineLRJ300,           "Lead. Jet E_{T} > 300 GeV", "p");
    sigLegEffLRJ_mass100to150_LRJ_overlay->AddEntry(sig_eff_offlineLRJ300_mass100to150,   "Lead. Jet E_{T} > 300, 100 < m_{off.} < 150 GeV",    "p");

    sigLegEffLRJ_mass100to150_LRJ_overlay->AddEntry(sig_eff_offlineLRJ450,           "Lead. Jet E_{T} > 450 GeV", "p");
    sigLegEffLRJ_mass100to150_LRJ_overlay->AddEntry(sig_eff_offlineLRJ450_mass100to150,   "Lead. Jet E_{T} > 450, 100 < m_{off.} < 150 GeV ",    "p");

    sigLegEffLRJ_mass100to150_LRJ_overlay->Draw(); // DRAW OR DON'T DRAW

    // Save to a new file/canvas
    cSigEffLRJ_Mass100to150_LRJ_overlay.SaveAs(modifiedOutputFileDir + "sig_overlayed_eff_LRJ_off_vs_LRJ_mass100to150_150_300_450.pdf");


    cSigEffLRJ_Overlay_1Subjet_GrEq2Subjets.cd();
    // ---- 150 GeV ----
    sig_eff_offlineLRJ100_1Subjet->SetLineColor(col100);
    sig_eff_offlineLRJ100_1Subjet->SetMarkerColor(col100);
    sig_eff_offlineLRJ100_1Subjet->SetMarkerStyle(mFull);
    sig_eff_offlineLRJ100_1Subjet->SetMarkerSize(1.1);

    sig_eff_offlineLRJ100_GrEq2Subjets->SetLineColor(col100);
    sig_eff_offlineLRJ100_GrEq2Subjets->SetMarkerColor(col100);
    sig_eff_offlineLRJ100_GrEq2Subjets->SetMarkerStyle(mOpen);
    sig_eff_offlineLRJ100_GrEq2Subjets->SetMarkerSize(1.1);

    // ---- 250 GeV ----
    sig_eff_offlineLRJ250_1Subjet->SetLineColor(col250);
    sig_eff_offlineLRJ250_1Subjet->SetMarkerColor(col250);
    sig_eff_offlineLRJ250_1Subjet->SetMarkerStyle(mFull);
    sig_eff_offlineLRJ250_1Subjet->SetMarkerSize(1.1);

    sig_eff_offlineLRJ250_GrEq2Subjets->SetLineColor(col250);
    sig_eff_offlineLRJ250_GrEq2Subjets->SetMarkerColor(col250);
    sig_eff_offlineLRJ250_GrEq2Subjets->SetMarkerStyle(mOpen);
    sig_eff_offlineLRJ250_GrEq2Subjets->SetMarkerSize(1.1);

    // ---- 400 GeV ----
    sig_eff_offlineLRJ400_1Subjet->SetLineColor(col400);
    sig_eff_offlineLRJ400_1Subjet->SetMarkerColor(col400);
    sig_eff_offlineLRJ400_1Subjet->SetMarkerStyle(mFull);
    sig_eff_offlineLRJ400_1Subjet->SetMarkerSize(1.1);

    sig_eff_offlineLRJ400_GrEq2Subjets->SetLineColor(col400);
    sig_eff_offlineLRJ400_GrEq2Subjets->SetMarkerColor(col400);
    sig_eff_offlineLRJ400_GrEq2Subjets->SetMarkerStyle(mOpen);
    sig_eff_offlineLRJ400_GrEq2Subjets->SetMarkerSize(1.1);

    // Draw: use one graph with "AP" to set axes; then overlay the rest
    // (If these are TGraph/TGraphAsymmErrors, "AP" is appropriate; otherwise "P" is fine.)
    sig_eff_offlineLRJ100_1Subjet->Draw("P");              // sets axes
    sig_eff_offlineLRJ100_GrEq2Subjets->Draw("P SAME");

    sig_eff_offlineLRJ250_1Subjet->Draw("P SAME");
    sig_eff_offlineLRJ250_GrEq2Subjets->Draw("P SAME");

    sig_eff_offlineLRJ400_1Subjet->Draw("P SAME");
    sig_eff_offlineLRJ400_GrEq2Subjets->Draw("P SAME");

    // Legend
    
    TLegend *sigLegEffLRJ_1Subjet_GrEq2Subjets_LRJ_overlay = new TLegend(0.56,0.2,0.99,0.525);
    sigLegEffLRJ_1Subjet_GrEq2Subjets_LRJ_overlay->SetTextSize(0.0275);

    // Group entries by threshold, showing offline (full) and gFEX (open) with same color
    sigLegEffLRJ_1Subjet_GrEq2Subjets_LRJ_overlay->AddEntry(sig_eff_offlineLRJ100_1Subjet,           "Lead. Jet E_{T} > 100 GeV [1 Subjet]", "p");
    sigLegEffLRJ_1Subjet_GrEq2Subjets_LRJ_overlay->AddEntry(sig_eff_offlineLRJ100_GrEq2Subjets,   "Lead. Jet E_{T} > 100 GeV [#geq 2 Subjets]",    "p");

    sigLegEffLRJ_1Subjet_GrEq2Subjets_LRJ_overlay->AddEntry(sig_eff_offlineLRJ250_1Subjet,           "Lead. Jet E_{T} > 250 GeV [1 Subjet]", "p");
    sigLegEffLRJ_1Subjet_GrEq2Subjets_LRJ_overlay->AddEntry(sig_eff_offlineLRJ250_GrEq2Subjets,   "Lead. Jet E_{T} > 250 GeV [#geq 2 Subjets]",    "p");

    sigLegEffLRJ_1Subjet_GrEq2Subjets_LRJ_overlay->AddEntry(sig_eff_offlineLRJ400_1Subjet,           "Lead. Jet E_{T} > 400 GeV [1 Subjet]", "p");
    sigLegEffLRJ_1Subjet_GrEq2Subjets_LRJ_overlay->AddEntry(sig_eff_offlineLRJ400_GrEq2Subjets,   "Lead. Jet E_{T} > 400 GeV [#geq 2 Subjets]",    "p");

    sigLegEffLRJ_1Subjet_GrEq2Subjets_LRJ_overlay->Draw(); // DRAW OR DON'T DRAW

    // Save to a new file/canvas
    cSigEffLRJ_Overlay_1Subjet_GrEq2Subjets.SaveAs(modifiedOutputFileDir + "sig_overlayed_eff_LRJ_off_vs_1Subjet_GrEq2Subjets_100_250_400.pdf");

    cBackEffLRJ_Overlay_1Subjet_GrEq2Subjets.cd();
    // ---- 100 GeV ----
    back_eff_offlineLRJ100_1Subjet->SetLineColor(col100);
    back_eff_offlineLRJ100_1Subjet->SetMarkerColor(col100);
    back_eff_offlineLRJ100_1Subjet->SetMarkerStyle(mFull);
    back_eff_offlineLRJ100_1Subjet->SetMarkerSize(1.1);

    back_eff_offlineLRJ100_GrEq2Subjets->SetLineColor(col100);
    back_eff_offlineLRJ100_GrEq2Subjets->SetMarkerColor(col100);
    back_eff_offlineLRJ100_GrEq2Subjets->SetMarkerStyle(mOpen);
    back_eff_offlineLRJ100_GrEq2Subjets->SetMarkerSize(1.1);

    // ---- 200 GeV ----
    back_eff_offlineLRJ200_1Subjet->SetLineColor(col200);
    back_eff_offlineLRJ200_1Subjet->SetMarkerColor(col200);
    back_eff_offlineLRJ200_1Subjet->SetMarkerStyle(mFull);
    back_eff_offlineLRJ200_1Subjet->SetMarkerSize(1.1);

    back_eff_offlineLRJ200_GrEq2Subjets->SetLineColor(col200);
    back_eff_offlineLRJ200_GrEq2Subjets->SetMarkerColor(col200);
    back_eff_offlineLRJ200_GrEq2Subjets->SetMarkerStyle(mOpen);
    back_eff_offlineLRJ200_GrEq2Subjets->SetMarkerSize(1.1);

    // ---- 300 GeV ----
    back_eff_offlineLRJ300_1Subjet->SetLineColor(col300);
    back_eff_offlineLRJ300_1Subjet->SetMarkerColor(col300);
    back_eff_offlineLRJ300_1Subjet->SetMarkerStyle(mFull);
    back_eff_offlineLRJ300_1Subjet->SetMarkerSize(1.1);

    back_eff_offlineLRJ300_GrEq2Subjets->SetLineColor(col300);
    back_eff_offlineLRJ300_GrEq2Subjets->SetMarkerColor(col300);
    back_eff_offlineLRJ300_GrEq2Subjets->SetMarkerStyle(mOpen);
    back_eff_offlineLRJ300_GrEq2Subjets->SetMarkerSize(1.1);

    // Draw: use one graph with "AP" to set axes; then overlay the rest
    // (If these are TGraph/TGraphAsymmErrors, "AP" is appropriate; otherwise "P" is fine.)
    back_eff_offlineLRJ100_1Subjet->Draw("P");              // sets axes
    back_eff_offlineLRJ100_GrEq2Subjets->Draw("P SAME");

    back_eff_offlineLRJ200_1Subjet->Draw("P SAME");
    back_eff_offlineLRJ200_GrEq2Subjets->Draw("P SAME");

    back_eff_offlineLRJ300_1Subjet->Draw("P SAME");
    back_eff_offlineLRJ300_GrEq2Subjets->Draw("P SAME");

    // Legend
    
    TLegend *backLegEffLRJ_1Subjet_GrEq2Subjets_LRJ_overlay = new TLegend(0.56,0.2,0.99,0.525);
    backLegEffLRJ_1Subjet_GrEq2Subjets_LRJ_overlay->SetTextSize(0.0275);

    // Group entries by threshold, showing offline (full) and gFEX (open) with same color
    backLegEffLRJ_1Subjet_GrEq2Subjets_LRJ_overlay->AddEntry(back_eff_offlineLRJ100_1Subjet,           "Lead. Jet E_{T} > 100 GeV [1 Subjet]", "p");
    backLegEffLRJ_1Subjet_GrEq2Subjets_LRJ_overlay->AddEntry(back_eff_offlineLRJ100_GrEq2Subjets,   "Lead. Jet E_{T} > 100 GeV [#geq 2 Subjets]",    "p");

    backLegEffLRJ_1Subjet_GrEq2Subjets_LRJ_overlay->AddEntry(back_eff_offlineLRJ200_1Subjet,           "Lead. Jet E_{T} > 200 GeV [1 Subjet]", "p");
    backLegEffLRJ_1Subjet_GrEq2Subjets_LRJ_overlay->AddEntry(back_eff_offlineLRJ200_GrEq2Subjets,   "Lead. Jet E_{T} > 200 GeV [#geq 2 Subjets]",    "p");

    backLegEffLRJ_1Subjet_GrEq2Subjets_LRJ_overlay->AddEntry(back_eff_offlineLRJ300_1Subjet,           "Lead. Jet E_{T} > 300 GeV [1 Subjet]", "p");
    backLegEffLRJ_1Subjet_GrEq2Subjets_LRJ_overlay->AddEntry(back_eff_offlineLRJ300_GrEq2Subjets,   "Lead. Jet E_{T} > 300 GeV [#geq 2 Subjets]",    "p");

    backLegEffLRJ_1Subjet_GrEq2Subjets_LRJ_overlay->Draw(); // DRAW OR DON'T DRAW

    // Save to a new file/canvas
    cBackEffLRJ_Overlay_1Subjet_GrEq2Subjets.SaveAs(modifiedOutputFileDir + "back_overlayed_eff_LRJ_off_vs_1Subjet_GrEq2Subjets_100_200_300.pdf");

    cBackEffLRJ_gFex_LRJ_overlay.cd();

    // ---- 100 GeV ----
    back_eff_offlineLRJ100->SetLineColor(col100);
    back_eff_offlineLRJ100->SetMarkerColor(col100);
    back_eff_offlineLRJ100->SetMarkerStyle(mFull);
    back_eff_offlineLRJ100->SetMarkerSize(1.1);

    back_eff_offlineLRJ100_gFexLRJ->SetLineColor(col100);
    back_eff_offlineLRJ100_gFexLRJ->SetMarkerColor(col100);
    back_eff_offlineLRJ100_gFexLRJ->SetMarkerStyle(mOpen);
    back_eff_offlineLRJ100_gFexLRJ->SetMarkerSize(1.1);

    // ---- 200 GeV ----
    back_eff_offlineLRJ200->SetLineColor(col200);
    back_eff_offlineLRJ200->SetMarkerColor(col200);
    back_eff_offlineLRJ200->SetMarkerStyle(mFull);
    back_eff_offlineLRJ200->SetMarkerSize(1.1);

    back_eff_offlineLRJ200_gFexLRJ->SetLineColor(col200);
    back_eff_offlineLRJ200_gFexLRJ->SetMarkerColor(col200);
    back_eff_offlineLRJ200_gFexLRJ->SetMarkerStyle(mOpen);
    back_eff_offlineLRJ200_gFexLRJ->SetMarkerSize(1.1);

    // ---- 300 GeV ----
    back_eff_offlineLRJ300->SetLineColor(col300);
    back_eff_offlineLRJ300->SetMarkerColor(col300);
    back_eff_offlineLRJ300->SetMarkerStyle(mFull);
    back_eff_offlineLRJ300->SetMarkerSize(1.1);

    back_eff_offlineLRJ300_gFexLRJ->SetLineColor(col300);
    back_eff_offlineLRJ300_gFexLRJ->SetMarkerColor(col300);
    back_eff_offlineLRJ300_gFexLRJ->SetMarkerStyle(mOpen);
    back_eff_offlineLRJ300_gFexLRJ->SetMarkerSize(1.1);

    // Draw: use one graph with "AP" to set axes; then overlay the rest
    // (If these are TGraph/TGraphAsymmErrors, "AP" is appropriate; otherwise "P" is fine.)
    back_eff_offlineLRJ100->Draw("P");              // sets axes
    back_eff_offlineLRJ100_gFexLRJ->Draw("P SAME");

    back_eff_offlineLRJ200->Draw("P SAME");
    back_eff_offlineLRJ200_gFexLRJ->Draw("P SAME");

    back_eff_offlineLRJ300->Draw("P SAME");
    back_eff_offlineLRJ300_gFexLRJ->Draw("P SAME");

    // Legend
    
    TLegend *backLegEffLRJ_gFex_LRJ_overlay = new TLegend(0.615,0.2,0.99,0.525);
    backLegEffLRJ_gFex_LRJ_overlay->SetTextSize(0.0275);

    // Group entries by threshold, showing offline (full) and gFEX (open) with same color
    backLegEffLRJ_gFex_LRJ_overlay->AddEntry(back_eff_offlineLRJ100,           "Lead. Jet E_{T} > 100 GeV (JetTagger)", "p");
    backLegEffLRJ_gFex_LRJ_overlay->AddEntry(back_eff_offlineLRJ100_gFexLRJ,   "Lead. Jet E_{T} > 100 GeV (gFEX LRJ)",    "p");

    backLegEffLRJ_gFex_LRJ_overlay->AddEntry(back_eff_offlineLRJ200,           "Lead. Jet E_{T} > 200 GeV (JetTagger)", "p");
    backLegEffLRJ_gFex_LRJ_overlay->AddEntry(back_eff_offlineLRJ200_gFexLRJ,   "Lead. Jet E_{T} > 200 GeV (gFEX LRJ)",    "p");

    backLegEffLRJ_gFex_LRJ_overlay->AddEntry(back_eff_offlineLRJ300,           "Lead. Jet E_{T} > 300 GeV (JetTagger)", "p");
    backLegEffLRJ_gFex_LRJ_overlay->AddEntry(back_eff_offlineLRJ300_gFexLRJ,   "Lead. Jet E_{T} > 300 GeV (gFEX LRJ)",    "p");

    backLegEffLRJ_gFex_LRJ_overlay->Draw();

    // Save to a new file/canvas
    cBackEffLRJ_gFex_LRJ_overlay.SaveAs(modifiedOutputFileDir + "back_overlayed_eff_LRJ_off_vs_gFEX_100_200_300.pdf");

    // jFEX
    cBackEffLRJ_jFex_LRJ_overlay.cd();

    // ---- 100 GeV ----
    back_eff_offlineLRJ100->SetLineColor(col100);
    back_eff_offlineLRJ100->SetMarkerColor(col100);
    back_eff_offlineLRJ100->SetMarkerStyle(mFull);
    back_eff_offlineLRJ100->SetMarkerSize(1.1);

    back_eff_offlineLRJ100_jFexLRJ->SetLineColor(col100);
    back_eff_offlineLRJ100_jFexLRJ->SetMarkerColor(col100);
    back_eff_offlineLRJ100_jFexLRJ->SetMarkerStyle(mOpen);
    back_eff_offlineLRJ100_jFexLRJ->SetMarkerSize(1.1);

    // ---- 200 GeV ----
    back_eff_offlineLRJ200->SetLineColor(col200);
    back_eff_offlineLRJ200->SetMarkerColor(col200);
    back_eff_offlineLRJ200->SetMarkerStyle(mFull);
    back_eff_offlineLRJ200->SetMarkerSize(1.1);

    back_eff_offlineLRJ200_jFexLRJ->SetLineColor(col200);
    back_eff_offlineLRJ200_jFexLRJ->SetMarkerColor(col200);
    back_eff_offlineLRJ200_jFexLRJ->SetMarkerStyle(mOpen);
    back_eff_offlineLRJ200_jFexLRJ->SetMarkerSize(1.1);

    // ---- 300 GeV ----
    back_eff_offlineLRJ300->SetLineColor(col300);
    back_eff_offlineLRJ300->SetMarkerColor(col300);
    back_eff_offlineLRJ300->SetMarkerStyle(mFull);
    back_eff_offlineLRJ300->SetMarkerSize(1.1);

    back_eff_offlineLRJ300_jFexLRJ->SetLineColor(col300);
    back_eff_offlineLRJ300_jFexLRJ->SetMarkerColor(col300);
    back_eff_offlineLRJ300_jFexLRJ->SetMarkerStyle(mOpen);
    back_eff_offlineLRJ300_jFexLRJ->SetMarkerSize(1.1);

    // Draw: use one graph with "AP" to set axes; then overlay the rest
    // (If these are TGraph/TGraphAsymmErrors, "AP" is appropriate; otherwise "P" is fine.)
    back_eff_offlineLRJ100->Draw("P");              // sets axes
    back_eff_offlineLRJ100_jFexLRJ->Draw("P SAME");

    back_eff_offlineLRJ200->Draw("P SAME");
    back_eff_offlineLRJ200_jFexLRJ->Draw("P SAME");

    back_eff_offlineLRJ300->Draw("P SAME");
    back_eff_offlineLRJ300_jFexLRJ->Draw("P SAME");

    // Legend
    
    TLegend *backLegEffLRJ_jFex_LRJ_overlay = new TLegend(0.615,0.2,0.99,0.525);
    backLegEffLRJ_jFex_LRJ_overlay->SetTextSize(0.0275);

    // Group entries by threshold, showing offline (full) and jFex (open) with same color
    backLegEffLRJ_jFex_LRJ_overlay->AddEntry(back_eff_offlineLRJ100,           "Lead. Jet E_{T} > 100 GeV (JetTagger)", "p");
    backLegEffLRJ_jFex_LRJ_overlay->AddEntry(back_eff_offlineLRJ100_jFexLRJ,   "Lead. Jet E_{T} > 100 GeV (jFEX LRJ)",    "p");

    backLegEffLRJ_jFex_LRJ_overlay->AddEntry(back_eff_offlineLRJ200,           "Lead. Jet E_{T} > 200 GeV (JetTagger)", "p");
    backLegEffLRJ_jFex_LRJ_overlay->AddEntry(back_eff_offlineLRJ200_jFexLRJ,   "Lead. Jet E_{T} > 200 GeV (jFEX LRJ)",    "p");

    backLegEffLRJ_jFex_LRJ_overlay->AddEntry(back_eff_offlineLRJ300,           "Lead. Jet E_{T} > 300 GeV (JetTagger)", "p");
    backLegEffLRJ_jFex_LRJ_overlay->AddEntry(back_eff_offlineLRJ300_jFexLRJ,   "Lead. Jet E_{T} > 300 GeV (jFEX LRJ)",    "p");

    //backLegEffLRJ_jFex_LRJ_overlay->Draw();

    // Save to a new file/canvas
    cBackEffLRJ_jFex_LRJ_overlay.SaveAs(modifiedOutputFileDir + "back_overlayed_eff_LRJ_off_vs_jFex_100_200_300.pdf");


    cSigEffb.cd();
    // eff. vs. avg b Et overlay
    sig_eff_b_Et50->SetLineColor(colors[0]);
    sig_eff_b_Et50->SetMarkerColor(colors[0]);
    legEffb->AddEntry(sig_eff_b_Et50, "Avg. b E_{T} > 50 GeV", "l");
    sig_eff_b_Et100->SetLineColor(colors[1]);
    sig_eff_b_Et100->SetMarkerColor(colors[1]);
    legEffb->AddEntry(sig_eff_b_Et100, "Avg. b E_{T} > 100 GeV", "l");
    sig_eff_b_Et150->SetLineColor(colors[2]);
    sig_eff_b_Et150->SetMarkerColor(colors[2]);
    legEffb->AddEntry(sig_eff_b_Et150, "Avg. b E_{T} > 150 GeV", "l");
    sig_eff_b_Et200->SetLineColor(colors[3]);
    sig_eff_b_Et200->SetMarkerColor(colors[3]);
    legEffb->AddEntry(sig_eff_b_Et200, "Avg. b E_{T} > 200 GeV", "l");
    sig_eff_b_Et250->SetLineColor(colors[4]);
    sig_eff_b_Et250->SetMarkerColor(colors[4]);
    legEffb->AddEntry(sig_eff_b_Et250, "Avg. b E_{T} > 250 GeV", "l");
    sig_eff_b_Et50->Draw("P");
    sig_eff_b_Et100->Draw("P SAME");
    sig_eff_b_Et150->Draw("P SAME");
    sig_eff_b_Et200->Draw("P SAME");
    sig_eff_b_Et250->Draw("P SAME");
    legEffb->Draw();
    cSigEffb.SaveAs(modifiedOutputFileDir + "overlayed_eff_b_Et.pdf");

    // --- Styling ---
    // --- Style background histogram (shaded) ---
    sig_h_leading_offlineLRJ_Et->SetFillColorAlpha(kGray+1, 0.35); // gray with 35% opacity
    sig_h_leading_offlineLRJ_Et->SetLineColor(kGray+2);            // slightly darker outline
    sig_h_leading_offlineLRJ_Et->SetLineWidth(1);

    // Normalize or rescale if needed to roughly fit in visible range
    sig_h_leading_offlineLRJ_Et->Scale(1.0 / sig_h_leading_offlineLRJ_Et->Integral());

    sig_eff_offlineLRJ10kHz->SetLineColor(kBlack);
    sig_eff_offlineLRJ10kHz->SetMarkerColor(kBlack);
    sig_eff_offlineLRJ10kHz->SetMarkerStyle(20);
    sig_eff_offlineLRJ10kHz->SetMarkerSize(1.0);

    sig_eff_offline_gFEX_LRJ10kHz->SetLineColor(kRed+1);
    sig_eff_offline_gFEX_LRJ10kHz->SetMarkerColor(kRed+1);
    sig_eff_offline_gFEX_LRJ10kHz->SetMarkerStyle(21);
    sig_eff_offline_gFEX_LRJ10kHz->SetMarkerSize(1.0);

    //sig_eff_offline_jFEX_LRJ10kHz->SetLineColor(kGreen+2);
    //sig_eff_offline_jFEX_LRJ10kHz->SetMarkerColor(kGreen+2);
    //sig_eff_offline_jFEX_LRJ10kHz->SetMarkerStyle(22);
    //sig_eff_offline_jFEX_LRJ10kHz->SetMarkerSize(1.0);

    // Axis range / cosmetics
    sig_eff_offlineLRJ10kHz->SetAxisRange(0.0, 1.1, "Y");
    sig_eff_offline_gFEX_LRJ10kHz->SetAxisRange(0.0, 1.1, "Y");
    //sig_eff_offline_jFEX_LRJ10kHz->SetAxisRange(0.0, 1.1, "Y");
    sig_eff_offlineLRJ10kHz->GetXaxis()->SetTitleOffset(1.1);
    sig_eff_offlineLRJ10kHz->GetYaxis()->SetTitleOffset(1.2);

    // --- Draw overlay ---
    TCanvas c_effLRJ10kHz("c_effLRJ10kHz","LRJ Efficiencies @ 10 kHz bkg",900,700);

    
    sig_eff_offlineLRJ10kHz->Draw("P");          // first: JetTagger (offline)
    sig_eff_offline_gFEX_LRJ10kHz->Draw("P SAME");
    sig_h_leading_offlineLRJ_Et->Draw("HIST SAME");
    //sig_eff_offline_jFEX_LRJ10kHz->Draw("P SAME");

    // --- Legend with proper labels and note about 10 kHz ---
    TLegend *leg_10kHz_effs = new TLegend(0.4, 0.18, 0.78, 0.38);
    leg_10kHz_effs->SetBorderSize(0);
    leg_10kHz_effs->SetFillStyle(0);
    leg_10kHz_effs->SetTextSize(0.03);
    leg_10kHz_effs->SetHeader("Cuts tuned to 10 kHz background","C"); // clearly states the rate
    leg_10kHz_effs->AddEntry(sig_eff_offlineLRJ10kHz,
        Form("JetTagger Lead. LRJ E_{T} > %.1f GeV", jetTagger_10kHz_Threshold_Leading), "lp");

    leg_10kHz_effs->AddEntry(sig_eff_offline_gFEX_LRJ10kHz,
        Form("gFEX Lead. LRJ E_{T}  > %.1f GeV", gFEX_10kHz_Threshold_Leading), "lp");

    //leg_10kHz_effs->AddEntry(sig_eff_offline_jFEX_LRJ10kHz,
    //    Form("jFEX ( > %.1f GeV)", jFEX_10kHz_Threshold_Leading), "lp");
    leg_10kHz_effs->Draw();

    // --- Save overlay ---
    c_effLRJ10kHz.SaveAs(rateVsEffFileDir + "sig_eff_offline_LRJ10kHz_overlay.pdf");

    // For mass window applied
    sig_eff_offlineLRJ10kHz_HiggsMassWindow->SetLineColor(kBlack);
    sig_eff_offlineLRJ10kHz_HiggsMassWindow->SetMarkerColor(kBlack);
    sig_eff_offlineLRJ10kHz_HiggsMassWindow->SetMarkerStyle(24); // open circle
    sig_eff_offlineLRJ10kHz_HiggsMassWindow->SetMarkerSize(1.0);

    sig_eff_offlineLRJ10kHz->SetLineColor(kBlack);
    sig_eff_offlineLRJ10kHz->SetMarkerColor(kBlack);
    sig_eff_offlineLRJ10kHz->SetMarkerStyle(20); // filled in circle
    sig_eff_offlineLRJ10kHz->SetMarkerSize(1.0);

    sig_eff_offline_gFEX_LRJ10kHz_HiggsMassWindow->SetLineColor(kRed+1);
    sig_eff_offline_gFEX_LRJ10kHz_HiggsMassWindow->SetMarkerColor(kRed+1);
    sig_eff_offline_gFEX_LRJ10kHz_HiggsMassWindow->SetMarkerStyle(25); // open square
    sig_eff_offline_gFEX_LRJ10kHz_HiggsMassWindow->SetMarkerSize(1.0);

    sig_eff_offline_gFEX_LRJ10kHz->SetLineColor(kRed+1);
    sig_eff_offline_gFEX_LRJ10kHz->SetMarkerColor(kRed+1);
    sig_eff_offline_gFEX_LRJ10kHz->SetMarkerStyle(21); // filled in square
    sig_eff_offline_gFEX_LRJ10kHz->SetMarkerSize(1.0);

    // Axis range / cosmetics
    sig_eff_offlineLRJ10kHz_HiggsMassWindow->SetAxisRange(0.0, 1.1, "Y");
    sig_eff_offline_gFEX_LRJ10kHz_HiggsMassWindow->SetAxisRange(0.0, 1.1, "Y");
    //sig_eff_offline_jFEX_LRJ10kHz->SetAxisRange(0.0, 1.1, "Y");
    sig_eff_offlineLRJ10kHz_HiggsMassWindow->GetXaxis()->SetTitleOffset(1.1);
    sig_eff_offlineLRJ10kHz_HiggsMassWindow->GetYaxis()->SetTitleOffset(1.2);

    // --- Draw overlay ---
    TCanvas c_effLRJ10kHz_HiggsMassWindow("c_effLRJ10kHz_HiggsMassWindow","LRJ Efficiencies @ 10 kHz bkg",900,700);

    
    sig_eff_offlineLRJ10kHz_HiggsMassWindow->Draw("P");          // first: JetTagger (offline)
    sig_eff_offline_gFEX_LRJ10kHz_HiggsMassWindow->Draw("P SAME");
    sig_eff_offlineLRJ10kHz->Draw("P SAME"); 
    sig_eff_offline_gFEX_LRJ10kHz->Draw("P SAME");
    sig_h_leading_offlineLRJ_Et->Draw("HIST SAME");
    //sig_eff_offline_jFEX_LRJ10kHz->Draw("P SAME");

    // --- Legend with proper labels and note about 10 kHz ---
    TLegend *leg_10kHz_effs_HiggsMassWindow = new TLegend(0.4, 0.18, 0.78, 0.38);
    leg_10kHz_effs_HiggsMassWindow->SetBorderSize(0);
    leg_10kHz_effs_HiggsMassWindow->SetFillStyle(0);
    leg_10kHz_effs_HiggsMassWindow->SetTextSize(0.025);
    leg_10kHz_effs_HiggsMassWindow->SetHeader("Cuts tuned to 10 kHz background","C"); // clearly states the rate
    leg_10kHz_effs_HiggsMassWindow->AddEntry(sig_eff_offlineLRJ10kHz,
        Form("JetTagger Lead. LRJ E_{T} > %.1f GeV", jetTagger_10kHz_Threshold_Leading), "lp");

    leg_10kHz_effs_HiggsMassWindow->AddEntry(sig_eff_offline_gFEX_LRJ10kHz,
        Form("gFEX Lead. LRJ E_{T}  > %.1f GeV", gFEX_10kHz_Threshold_Leading), "lp");

    leg_10kHz_effs_HiggsMassWindow->AddEntry(sig_eff_offlineLRJ10kHz_HiggsMassWindow,
        Form("[m_{H} Window] JetTagger Lead. LRJ E_{T} > %.1f GeV", jetTagger_10kHz_Threshold_Leading), "lp");

    leg_10kHz_effs_HiggsMassWindow->AddEntry(sig_eff_offline_gFEX_LRJ10kHz_HiggsMassWindow,
        Form("[m_{H} Window] gFEX Lead. LRJ E_{T}  > %.1f GeV", gFEX_10kHz_Threshold_Leading), "lp");

    //leg_10kHz_effs->AddEntry(sig_eff_offline_jFEX_LRJ10kHz,
    //    Form("jFEX ( > %.1f GeV)", jFEX_10kHz_Threshold_Leading), "lp");
    leg_10kHz_effs_HiggsMassWindow->Draw();

    // --- Save overlay ---
    c_effLRJ10kHz_HiggsMassWindow.SaveAs(rateVsEffFileDir + "sig_eff_offline_LRJ10kHz_overlay_HiggsMassWindow.pdf");

    // For mass window applied
    sig_eff_offlineLRJ10kHz_1Subjet->SetLineColor(kBlack);
    sig_eff_offlineLRJ10kHz_1Subjet->SetMarkerColor(kBlack);
    sig_eff_offlineLRJ10kHz_1Subjet->SetMarkerStyle(20); // filled in circle
    sig_eff_offlineLRJ10kHz_1Subjet->SetMarkerSize(1.0);

    sig_eff_offlineLRJ10kHz_GrEq2Subjets->SetLineColor(kBlack);
    sig_eff_offlineLRJ10kHz_GrEq2Subjets->SetMarkerColor(kBlack);
    sig_eff_offlineLRJ10kHz_GrEq2Subjets->SetMarkerStyle(24); // open circle
    sig_eff_offlineLRJ10kHz_GrEq2Subjets->SetMarkerSize(1.0);

    sig_eff_offline_gFEX_LRJ10kHz_1Subjet->SetLineColor(kRed+1);
    sig_eff_offline_gFEX_LRJ10kHz_1Subjet->SetMarkerColor(kRed+1);
    sig_eff_offline_gFEX_LRJ10kHz_1Subjet->SetMarkerStyle(21); // filled in square
    sig_eff_offline_gFEX_LRJ10kHz_1Subjet->SetMarkerSize(1.0);

    sig_eff_offline_gFEX_LRJ10kHz_GrEq2Subjets->SetLineColor(kRed+1);
    sig_eff_offline_gFEX_LRJ10kHz_GrEq2Subjets->SetMarkerColor(kRed+1);
    sig_eff_offline_gFEX_LRJ10kHz_GrEq2Subjets->SetMarkerStyle(25); // open square
    sig_eff_offline_gFEX_LRJ10kHz_GrEq2Subjets->SetMarkerSize(1.0);

    // Axis range / cosmetics
    sig_eff_offlineLRJ10kHz_1Subjet->SetAxisRange(0.0, 1.1, "Y");
    sig_eff_offline_gFEX_LRJ10kHz_1Subjet->SetAxisRange(0.0, 1.1, "Y");
    sig_eff_offlineLRJ10kHz_1Subjet->GetXaxis()->SetTitleOffset(1.1);
    sig_eff_offlineLRJ10kHz_1Subjet->GetYaxis()->SetTitleOffset(1.2);

    // --- Draw overlay ---
    TCanvas c_effLRJ10kHz_Subjet("c_effLRJ10kHz_Subjet","LRJ Efficiencies @ 10 kHz bkg",900,700);

    
    sig_eff_offlineLRJ10kHz_1Subjet->Draw("P");          // first: JetTagger (offline)
    sig_eff_offline_gFEX_LRJ10kHz_1Subjet->Draw("P SAME");
    sig_eff_offlineLRJ10kHz_GrEq2Subjets->Draw("P SAME"); 
    sig_eff_offline_gFEX_LRJ10kHz_GrEq2Subjets->Draw("P SAME");
    sig_h_leading_offlineLRJ_Et->Draw("HIST SAME");

    // --- Legend with proper labels and note about 10 kHz ---
    TLegend *leg_10kHz_effs_Subjets = new TLegend(0.4, 0.18, 0.78, 0.38);
    leg_10kHz_effs_Subjets->SetBorderSize(0);
    leg_10kHz_effs_Subjets->SetFillStyle(0);
    leg_10kHz_effs_Subjets->SetTextSize(0.025);
    leg_10kHz_effs_Subjets->SetHeader("Cuts tuned to 10 kHz background","C"); // clearly states the rate
    leg_10kHz_effs_Subjets->AddEntry(sig_eff_offlineLRJ10kHz_GrEq2Subjets,
        Form("[>= 2 Subjet]JetTagger Lead. LRJ E_{T} > %.1f GeV", jetTagger_10kHz_Threshold_Leading), "lp");

    leg_10kHz_effs_Subjets->AddEntry(sig_eff_offline_gFEX_LRJ10kHz_GrEq2Subjets,
        Form("[>= 2 Subjet] gFEX Lead. LRJ E_{T}  > %.1f GeV", gFEX_10kHz_Threshold_Leading), "lp");

    leg_10kHz_effs_Subjets->AddEntry(sig_eff_offlineLRJ10kHz_1Subjet,
        Form("[1 Subjet] JetTagger Lead. LRJ E_{T} > %.1f GeV", jetTagger_10kHz_Threshold_Leading), "lp");

    leg_10kHz_effs_Subjets->AddEntry(sig_eff_offline_gFEX_LRJ10kHz_1Subjet,
        Form("[1 Subjet] gFEX Lead. LRJ E_{T}  > %.1f GeV", gFEX_10kHz_Threshold_Leading), "lp");

    leg_10kHz_effs_Subjets->Draw();

    // --- Save overlay ---
    c_effLRJ10kHz_Subjet.SaveAs(rateVsEffFileDir + "sig_eff_offline_LRJ10kHz_overlay_Subjets.pdf");

    // Subleading / dijet selection rate curves @ 10 kHz

    // --- Styling ---
    // --- Style background histogram (shaded) ---
    sig_h_subleading_offlineLRJ_Et->SetFillColorAlpha(kGray+1, 0.35); // gray with 35% opacity
    sig_h_subleading_offlineLRJ_Et->SetLineColor(kGray+2);            // slightly darker outline
    sig_h_subleading_offlineLRJ_Et->SetLineWidth(1);

    // Normalize or rescale if needed to roughly fit in visible range
    sig_h_subleading_offlineLRJ_Et->Scale(1.0 / sig_h_subleading_offlineLRJ_Et->Integral());

    sig_eff_offlineLRJ10kHz_Subleading->SetLineColor(kBlack);
    sig_eff_offlineLRJ10kHz_Subleading->SetMarkerColor(kBlack);
    sig_eff_offlineLRJ10kHz_Subleading->SetMarkerStyle(20);
    sig_eff_offlineLRJ10kHz_Subleading->SetMarkerSize(1.0);

    sig_eff_offline_gFEX_LRJ10kHz_Subleading->SetLineColor(kRed+1);
    sig_eff_offline_gFEX_LRJ10kHz_Subleading->SetMarkerColor(kRed+1);
    sig_eff_offline_gFEX_LRJ10kHz_Subleading->SetMarkerStyle(21);
    sig_eff_offline_gFEX_LRJ10kHz_Subleading->SetMarkerSize(1.0);

    // Axis range / cosmetics
    sig_eff_offlineLRJ10kHz_Subleading->SetAxisRange(0.0, 1.1, "Y");
    sig_eff_offline_gFEX_LRJ10kHz_Subleading->SetAxisRange(0.0, 1.1, "Y");
    sig_eff_offlineLRJ10kHz_Subleading->GetXaxis()->SetTitleOffset(1.1);
    sig_eff_offlineLRJ10kHz_Subleading->GetYaxis()->SetTitleOffset(1.2);

    // --- Draw overlay ---
    TCanvas c_effLRJ10kHz_Subleading("c_effLRJ10kHz_Subleading","LRJ Efficiencies @ 10 kHz bkg",900,700);

    sig_eff_offlineLRJ10kHz_Subleading->Draw("P");          // first: JetTagger (offline)
    sig_eff_offline_gFEX_LRJ10kHz_Subleading->Draw("P SAME");
    sig_h_subleading_offlineLRJ_Et->Draw("HIST SAME");

    // --- Legend with proper labels and note about 10 kHz ---
    TLegend *leg_10kHz_effs_Subleading = new TLegend(0.4, 0.18, 0.78, 0.38);
    leg_10kHz_effs_Subleading->SetBorderSize(0);
    leg_10kHz_effs_Subleading->SetFillStyle(0);
    leg_10kHz_effs_Subleading->SetTextSize(0.03);
    leg_10kHz_effs_Subleading->SetHeader("Cuts tuned to 10 kHz background","C"); // clearly states the rate
    leg_10kHz_effs_Subleading->AddEntry(sig_eff_offlineLRJ10kHz_Subleading,
        Form("JetTagger Sublead. LRJ E_{T} > %.1f GeV", jetTagger_10kHz_Threshold_Subleading), "lp");

    leg_10kHz_effs_Subleading->AddEntry(sig_eff_offline_gFEX_LRJ10kHz_Subleading,
        Form("gFEX Sublead. LRJ E_{T}  > %.1f GeV", gFEX_10kHz_Threshold_Subleading), "lp");

    leg_10kHz_effs_Subleading->Draw();

    // --- Save overlay ---
    c_effLRJ10kHz_Subleading.SaveAs(rateVsEffFileDir + "sig_eff_offline_LRJ10kHz_overlay_Subleading.pdf");

    // For mass window applied
    sig_eff_offlineLRJ10kHz_HiggsMassWindow_Subleading->SetLineColor(kBlack);
    sig_eff_offlineLRJ10kHz_HiggsMassWindow_Subleading->SetMarkerColor(kBlack);
    sig_eff_offlineLRJ10kHz_HiggsMassWindow_Subleading->SetMarkerStyle(24); // open circle
    sig_eff_offlineLRJ10kHz_HiggsMassWindow_Subleading->SetMarkerSize(1.0);

    sig_eff_offlineLRJ10kHz_Subleading->SetLineColor(kBlack);
    sig_eff_offlineLRJ10kHz_Subleading->SetMarkerColor(kBlack);
    sig_eff_offlineLRJ10kHz_Subleading->SetMarkerStyle(20); // filled in circle
    sig_eff_offlineLRJ10kHz_Subleading->SetMarkerSize(1.0);

    sig_eff_offline_gFEX_LRJ10kHz_HiggsMassWindow_Subleading->SetLineColor(kRed+1);
    sig_eff_offline_gFEX_LRJ10kHz_HiggsMassWindow_Subleading->SetMarkerColor(kRed+1);
    sig_eff_offline_gFEX_LRJ10kHz_HiggsMassWindow_Subleading->SetMarkerStyle(25); // open square
    sig_eff_offline_gFEX_LRJ10kHz_HiggsMassWindow_Subleading->SetMarkerSize(1.0);

    sig_eff_offline_gFEX_LRJ10kHz_Subleading->SetLineColor(kRed+1);
    sig_eff_offline_gFEX_LRJ10kHz_Subleading->SetMarkerColor(kRed+1);
    sig_eff_offline_gFEX_LRJ10kHz_Subleading->SetMarkerStyle(21); // filled in square
    sig_eff_offline_gFEX_LRJ10kHz_Subleading->SetMarkerSize(1.0);

    // Axis range / cosmetics
    sig_eff_offlineLRJ10kHz_HiggsMassWindow_Subleading->SetAxisRange(0.0, 1.1, "Y");
    sig_eff_offline_gFEX_LRJ10kHz_HiggsMassWindow_Subleading->SetAxisRange(0.0, 1.1, "Y");
    sig_eff_offlineLRJ10kHz_HiggsMassWindow_Subleading->GetXaxis()->SetTitleOffset(1.1);
    sig_eff_offlineLRJ10kHz_HiggsMassWindow_Subleading->GetYaxis()->SetTitleOffset(1.2);

    // --- Draw overlay ---
    TCanvas c_effLRJ10kHz_HiggsMassWindow_Subleading("c_effLRJ10kHz_HiggsMassWindow_Subleading","LRJ Efficiencies @ 10 kHz bkg",900,700);

    
    sig_eff_offlineLRJ10kHz_HiggsMassWindow_Subleading->Draw("P");          // first: JetTagger (offline)
    sig_eff_offline_gFEX_LRJ10kHz_HiggsMassWindow_Subleading->Draw("P SAME");
    sig_eff_offlineLRJ10kHz_Subleading->Draw("P SAME"); 
    sig_eff_offline_gFEX_LRJ10kHz_Subleading->Draw("P SAME");
    sig_h_subleading_offlineLRJ_Et->Draw("HIST SAME");

    // --- Legend with proper labels and note about 10 kHz ---
    TLegend *leg_10kHz_effs_HiggsMassWindow_Subleading = new TLegend(0.4, 0.18, 0.78, 0.38);
    leg_10kHz_effs_HiggsMassWindow_Subleading->SetBorderSize(0);
    leg_10kHz_effs_HiggsMassWindow_Subleading->SetFillStyle(0);
    leg_10kHz_effs_HiggsMassWindow_Subleading->SetTextSize(0.025);
    leg_10kHz_effs_HiggsMassWindow_Subleading->SetHeader("Cuts tuned to 10 kHz background","C"); // clearly states the rate
    leg_10kHz_effs_HiggsMassWindow_Subleading->AddEntry(sig_eff_offlineLRJ10kHz_Subleading,
        Form("JetTagger Sublead. LRJ E_{T} > %.1f GeV", jetTagger_10kHz_Threshold_Subleading), "lp");

    leg_10kHz_effs_HiggsMassWindow_Subleading->AddEntry(sig_eff_offline_gFEX_LRJ10kHz_Subleading,
        Form("gFEX Sublead. LRJ E_{T}  > %.1f GeV", gFEX_10kHz_Threshold_Subleading), "lp");

    leg_10kHz_effs_HiggsMassWindow_Subleading->AddEntry(sig_eff_offlineLRJ10kHz_HiggsMassWindow_Subleading,
        Form("[m_{H} Window] JetTagger Sublead. LRJ E_{T} > %.1f GeV", jetTagger_10kHz_Threshold_Subleading), "lp");

    leg_10kHz_effs_HiggsMassWindow_Subleading->AddEntry(sig_eff_offline_gFEX_LRJ10kHz_HiggsMassWindow_Subleading,
        Form("[m_{H} Window] gFEX Sublead. LRJ E_{T}  > %.1f GeV", gFEX_10kHz_Threshold_Subleading), "lp");

    leg_10kHz_effs_HiggsMassWindow_Subleading->Draw();

    // --- Save overlay ---
    c_effLRJ10kHz_HiggsMassWindow_Subleading.SaveAs(rateVsEffFileDir + "sig_eff_offline_LRJ10kHz_overlay_HiggsMassWindow_Subleading.pdf");

    // For mass window applied
    sig_eff_offlineLRJ10kHz_1Subjet_Subleading->SetLineColor(kBlack);
    sig_eff_offlineLRJ10kHz_1Subjet_Subleading->SetMarkerColor(kBlack);
    sig_eff_offlineLRJ10kHz_1Subjet_Subleading->SetMarkerStyle(20); // filled in circle
    sig_eff_offlineLRJ10kHz_1Subjet_Subleading->SetMarkerSize(1.0);

    sig_eff_offlineLRJ10kHz_GrEq2Subjets_Subleading->SetLineColor(kBlack);
    sig_eff_offlineLRJ10kHz_GrEq2Subjets_Subleading->SetMarkerColor(kBlack);
    sig_eff_offlineLRJ10kHz_GrEq2Subjets_Subleading->SetMarkerStyle(24); // open circle
    sig_eff_offlineLRJ10kHz_GrEq2Subjets_Subleading->SetMarkerSize(1.0);

    sig_eff_offline_gFEX_LRJ10kHz_1Subjet_Subleading->SetLineColor(kRed+1);
    sig_eff_offline_gFEX_LRJ10kHz_1Subjet_Subleading->SetMarkerColor(kRed+1);
    sig_eff_offline_gFEX_LRJ10kHz_1Subjet_Subleading->SetMarkerStyle(21); // filled in square
    sig_eff_offline_gFEX_LRJ10kHz_1Subjet_Subleading->SetMarkerSize(1.0);

    sig_eff_offline_gFEX_LRJ10kHz_GrEq2Subjets_Subleading->SetLineColor(kRed+1);
    sig_eff_offline_gFEX_LRJ10kHz_GrEq2Subjets_Subleading->SetMarkerColor(kRed+1);
    sig_eff_offline_gFEX_LRJ10kHz_GrEq2Subjets_Subleading->SetMarkerStyle(25); // open square
    sig_eff_offline_gFEX_LRJ10kHz_GrEq2Subjets_Subleading->SetMarkerSize(1.0);

    // Axis range / cosmetics
    sig_eff_offlineLRJ10kHz_1Subjet_Subleading->SetAxisRange(0.0, 1.1, "Y");
    sig_eff_offline_gFEX_LRJ10kHz_1Subjet_Subleading->SetAxisRange(0.0, 1.1, "Y");
    sig_eff_offlineLRJ10kHz_1Subjet_Subleading->GetXaxis()->SetTitleOffset(1.1);
    sig_eff_offlineLRJ10kHz_1Subjet_Subleading->GetYaxis()->SetTitleOffset(1.2);

    // --- Draw overlay ---
    TCanvas c_effLRJ10kHz_Subjet_Subleading("c_effLRJ10kHz_Subjet_Subleading","LRJ Efficiencies @ 10 kHz bkg",900,700);

    
    sig_eff_offlineLRJ10kHz_1Subjet_Subleading->Draw("P");          // first: JetTagger (offline)
    sig_eff_offline_gFEX_LRJ10kHz_1Subjet_Subleading->Draw("P SAME");
    sig_eff_offlineLRJ10kHz_GrEq2Subjets_Subleading->Draw("P SAME"); 
    sig_eff_offline_gFEX_LRJ10kHz_GrEq2Subjets_Subleading->Draw("P SAME");
    sig_h_subleading_offlineLRJ_Et->Draw("HIST SAME");

    // --- Legend with proper labels and note about 10 kHz ---
    TLegend *leg_10kHz_effs_Subjets_Subleading = new TLegend(0.4, 0.18, 0.78, 0.38);
    leg_10kHz_effs_Subjets_Subleading->SetBorderSize(0);
    leg_10kHz_effs_Subjets_Subleading->SetFillStyle(0);
    leg_10kHz_effs_Subjets_Subleading->SetTextSize(0.025);
    leg_10kHz_effs_Subjets_Subleading->SetHeader("Cuts tuned to 10 kHz background","C"); // clearly states the rate
    leg_10kHz_effs_Subjets_Subleading->AddEntry(sig_eff_offlineLRJ10kHz_GrEq2Subjets_Subleading,
        Form("[>= 2 Subjet]JetTagger Sublead. LRJ E_{T} > %.1f GeV", jetTagger_10kHz_Threshold_Subleading), "lp");

    leg_10kHz_effs_Subjets_Subleading->AddEntry(sig_eff_offline_gFEX_LRJ10kHz_GrEq2Subjets_Subleading,
        Form("[>= 2 Subjet] gFEX Sublead. LRJ E_{T}  > %.1f GeV", gFEX_10kHz_Threshold_Subleading), "lp");

    leg_10kHz_effs_Subjets_Subleading->AddEntry(sig_eff_offlineLRJ10kHz_1Subjet_Subleading,
        Form("[1 Subjet] JetTagger Sublead. LRJ E_{T} > %.1f GeV", jetTagger_10kHz_Threshold_Subleading), "lp");

    leg_10kHz_effs_Subjets_Subleading->AddEntry(sig_eff_offline_gFEX_LRJ10kHz_1Subjet_Subleading,
        Form("[1 Subjet] gFEX Sublead. LRJ E_{T}  > %.1f GeV", gFEX_10kHz_Threshold_Subleading), "lp");

    leg_10kHz_effs_Subjets_Subleading->Draw();

    // --- Save overlay ---
    c_effLRJ10kHz_Subjet_Subleading.SaveAs(rateVsEffFileDir + "sig_eff_offline_LRJ10kHz_overlay_Subjets_Subleading.pdf");

    } // End of original loop through files

    // Do overlay plots for multiple files here

    // Need different canvases for each sets of plots when overlaying like this.... very annoying FIXME
    TCanvas c1_Log = new TCanvas("c1_Log", "Overlays (log)", 800, 600);
    c1_Log.SetLogy();

    TCanvas c2_Log = new TCanvas("c2_Log", "Overlays (log)", 800, 600);
    c2_Log.SetLogy();

    TCanvas c1_Log_Offline = new TCanvas("c1_Log_Offline", "Overlays (log)", 800, 600);
    c1_Log_Offline.SetLogy();

    TCanvas c2_Log_Offline = new TCanvas("c2_Log_Offline", "Overlays (log)", 800, 600);
    c2_Log_Offline.SetLogy();

    TCanvas c3_Log_Offline = new TCanvas("c3_Log_Offline", "Overlays (log)", 800, 600);
    //c3_Log_Offline.SetLogy();

    TCanvas c3_Log = new TCanvas("c3_Log", "Overlays (log)", 800, 600);
    c3_Log.SetLogy();

    TCanvas c4_Log = new TCanvas("c4_Log", "Overlays (log)", 800, 600);
    c4_Log.SetLogy();

    TCanvas c5_Log = new TCanvas("c5_Log", "Overlays (log)", 800, 600);
    c5_Log.SetLogy();

    TCanvas c6_Log = new TCanvas("c6_Log", "Overlays (log)", 800, 600);
    c6_Log.SetLogy();

    TCanvas c7_Log = new TCanvas("c7_Log", "Overlays (log)", 800, 600);
    c7_Log.SetLogy();

    TCanvas c8_Log = new TCanvas("c8_Log", "Overlays (log)", 800, 600);
    c8_Log.SetLogy();

    TCanvas c9_Log = new TCanvas("c8_Log", "Overlays (log)", 800, 600);
    c9_Log.SetLogy();

    TCanvas c1 = new TCanvas("c1", "Overlays (non-log)", 800, 600);
    TCanvas c2 = new TCanvas("c2", "Overlays (non-log)", 800, 600);
    TCanvas c3 = new TCanvas("c3", "Overlays (non-log)", 800, 600);
    TCanvas c4 = new TCanvas("c4", "Overlays (non-log)", 800, 600);
    TCanvas c5 = new TCanvas("c5", "Overlays (non-log)", 800, 600);
    TCanvas c6 = new TCanvas("c6", "Overlays (non-log)", 800, 600);
    TCanvas c7 = new TCanvas("c7", "Overlays (non-log)", 800, 600);
    TCanvas c8 = new TCanvas("c8", "Overlays (non-log)", 800, 600);
    TCanvas c9 = new TCanvas("c9", "Overlays (non-log)", 800, 600);
    TCanvas c10 = new TCanvas("c10", "Overlays (non-log)", 800, 600);
    TCanvas c11 = new TCanvas("c11", "Overlays (non-log)", 800, 600);
    TCanvas c12 = new TCanvas("c12", "Overlays (non-log)", 800, 600);
    TCanvas c13 = new TCanvas("c13", "Overlays (non-log)", 800, 600);

    TLegend* leg = new TLegend(0.4, 0.35, 0.68, 0.68);
    leg->SetBorderSize(0);
    leg->SetFillStyle(0);
    leg->SetTextSize(0.025);

    TLegend* leg_SampleInfoOnly = new TLegend(0.17, 0.17, 0.45, 0.5);
    leg_SampleInfoOnly->SetBorderSize(0);
    leg_SampleInfoOnly->SetFillStyle(0);
    leg_SampleInfoOnly->SetTextSize(0.025);

    TLegend* legSigOnly = new TLegend(0.3, 0.2, 0.58, 0.43);
    legSigOnly->SetBorderSize(0);
    legSigOnly->SetFillStyle(0);
    legSigOnly->SetTextSize(0.025);

    TLegend* legSigOnlyNoIOTypes = new TLegend(0.55, 0.25, 0.83, 0.58);
    legSigOnlyNoIOTypes->SetBorderSize(0);
    legSigOnlyNoIOTypes->SetFillStyle(0);
    legSigOnlyNoIOTypes->SetTextSize(0.025);

    TLegend *leg_10kHz_effs = new TLegend(0.4, 0.18, 0.78, 0.38);
    leg_10kHz_effs->SetBorderSize(0);
    leg_10kHz_effs->SetFillStyle(0);
    leg_10kHz_effs->SetTextSize(0.025);
    leg_10kHz_effs->SetHeader("Cuts tuned to 10 kHz background","C"); // state the rate

    TLegend *leg_10kHz_effs_HiggsMassWindow = new TLegend(0.4, 0.18, 0.78, 0.38);
    leg_10kHz_effs_HiggsMassWindow->SetBorderSize(0);
    leg_10kHz_effs_HiggsMassWindow->SetFillStyle(0);
    leg_10kHz_effs_HiggsMassWindow->SetTextSize(0.025);
    leg_10kHz_effs_HiggsMassWindow->SetHeader("Cuts tuned to 10 kHz background","C"); // state the rate

    TLegend *leg_10kHz_effs_Subjets = new TLegend(0.4, 0.18, 0.78, 0.38);
    leg_10kHz_effs_Subjets->SetBorderSize(0);
    leg_10kHz_effs_Subjets->SetFillStyle(0);
    leg_10kHz_effs_Subjets->SetTextSize(0.025);
    leg_10kHz_effs_Subjets->SetHeader("Cuts tuned to 10 kHz background","C"); // state the rate
    //std::cout << "looping through " << backgroundRootFileNames.size() << " background files" << "\n";
    for(unsigned int fileIt = 0; fileIt < backgroundRootFileNames.size(); fileIt++){ // FIXME move this to when fileIt == backgroundRootFileNames.size() - 1?
        //std::cout << "fileIt: " << fileIt << "\n";
        // first get information about each file to be used in the legend
        auto fileInfo = ParseFileName(backgroundRootFileNames[fileIt]);
        std::string inputObjectType = fileInfo.inputObjectType;
        std::string seedObjectType = fileInfo.seedObjectType;
        std::string rMergeValue = fileInfo.rMergeValue;
        
        unsigned int nInputObjectsAlgorithmConfiguration = 0;
        std::regex re("_IOs_(\\d+)_");
        std::smatch match;

        if (std::regex_search(signalRootFileNames[fileIt], match, re)) {
            nInputObjectsAlgorithmConfiguration = std::stoi(match[1]);  // Convert to integer
            std::cout << "Extracted number of input objects for this algorithm configuration: " << nInputObjectsAlgorithmConfiguration << std::endl;
        } else {
            std::cout << "No match found." << std::endl;
        }

        int color = fileIt + 2;   // simple mapping; can use a color array if desired

        // Leading JetTagger LRJ E_T distribution
        c1_Log.cd();
        sig_h_leading_LRJ_Et_vec[fileIt]->Scale(1.0 / sig_h_leading_LRJ_Et_vec[fileIt]->Integral());
        back_h_leading_LRJ_Et_vec[fileIt]->Scale(1.0 / back_h_leading_LRJ_Et_vec[fileIt]->Integral());


        // --- Styling ---
        sig_h_leading_LRJ_Et_vec[fileIt]->SetLineColor(color);
        sig_h_leading_LRJ_Et_vec[fileIt]->SetLineStyle(1);   // solid
        sig_h_leading_LRJ_Et_vec[fileIt]->SetLineWidth(2);

        back_h_leading_LRJ_Et_vec[fileIt]->SetLineColor(color);
        back_h_leading_LRJ_Et_vec[fileIt]->SetLineStyle(2);   // dashed
        back_h_leading_LRJ_Et_vec[fileIt]->SetLineWidth(2);

        // --- Draw ---
        if (fileIt == 0) {
            back_h_leading_LRJ_Et_vec[fileIt]->Draw("HIST"); // draw background first as spans full range of y-axis
        }
        sig_h_leading_LRJ_Et_vec[fileIt]->Draw("HIST SAME");
        
        if (inputObjectType == "ConeJets") nInputObjectsAlgorithmConfiguration = 10;
        // --- Legend entries ---
        std::string legLabelSig;
        std::string mode = getProductionMode(signalRootFileNames[fileIt]);
        std::cout << "mode: " << mode << "\n";
        if(mode == "null") std::cerr << "error, unrecognized signal mode" << "\n";
        std::string legLabelSig_SampleInfoOnly; // meant for comparing across signal types & rMergeCut values, rather than input object types
        std::string legLabelSigNoIOType_SubjetBasedCut; // meant for comparing across signal types & rMergeCut values, rather than input object types
        std::string legLabelSigNoIOType_EtCutOnly; // meant for comparing across signal types & rMergeCut values, rather than input object types
        if(mode == "VBF"){
            legLabelSig_SampleInfoOnly = "hh#rightarrow4b [VBF, c_{vv} = 0]";
            if(std::stod(rMergeValue) == 0.001){
                legLabelSigNoIOType_SubjetBasedCut = Form(
                    "Subjet-based E_{T} Cut, hh#rightarrow4b [VBF, c_{vv} = 0] with d_{search} Disabled"
                );
                legLabelSigNoIOType_EtCutOnly = Form(
                    "Lead. LRJ E_{T} Cut, hh#rightarrow4b [VBF, c_{vv} = 0] with d_{search} Disabled"
                );
                legLabelSig = Form("hh#rightarrow4b [VBF, c_{vv} = 0]: IO: %s, N_{IO} = %u",
                                    inputObjectType.c_str(),
                                    nInputObjectsAlgorithmConfiguration);
            
            }
            else{
                legLabelSigNoIOType_SubjetBasedCut = Form(
                    "Subjet-based E_{T} Cut, hh#rightarrow4b [VBF, c_{vv} = 0] with d_{search} = %s",
                    rMergeValue.c_str()
                );
                legLabelSigNoIOType_EtCutOnly = Form(
                    "Lead. LRJ E_{T} Cut, hh#rightarrow4b [VBF, c_{vv} = 0] with d_{search} = %s",
                    rMergeValue.c_str()
                );
                legLabelSig = Form("hh#rightarrow4b [VBF, c_{vv} = 0]: IO: %s, N_{IO} = %u, rMerge = %s",
                                    inputObjectType.c_str(),
                                    nInputObjectsAlgorithmConfiguration,
                                    rMergeValue.c_str());
            }
            
        }
        if(mode == "VBF_SM"){
            legLabelSig_SampleInfoOnly = "hh#rightarrow4b [VBF, c_{vv} = 1]";
            if(std::stod(rMergeValue) == 0.001){
                legLabelSigNoIOType_SubjetBasedCut = Form(
                    "Subjet-based E_{T} Cut, hh#rightarrow4b [VBF, c_{vv} = 1] with d_{search} Disabled"
                );
                legLabelSigNoIOType_EtCutOnly = Form(
                    "Lead. LRJ E_{T} Cut, hh#rightarrow4b [VBF, c_{vv} = 1] with d_{search} Disabled"
                );
                legLabelSig = Form("hh#rightarrow4b [VBF, c_{vv} = 1]: IO: %s, N_{IO} = %u",
                                    inputObjectType.c_str(),
                                    nInputObjectsAlgorithmConfiguration);
            
            }
            else{
                legLabelSigNoIOType_SubjetBasedCut = Form(
                    "Subjet-based E_{T} Cut, hh#rightarrow4b [VBF, c_{vv} = 1] with d_{search} = %s",
                    rMergeValue.c_str()
                );
                legLabelSigNoIOType_EtCutOnly = Form(
                    "Lead. LRJ E_{T} Cut, hh#rightarrow4b [VBF, c_{vv} = 1] with d_{search} = %s",
                    rMergeValue.c_str()
                );
                legLabelSig = Form("hh#rightarrow4b [VBF, c_{vv} = 1]: IO: %s, N_{IO} = %u, rMerge = %s",
                                    inputObjectType.c_str(),
                                    nInputObjectsAlgorithmConfiguration,
                                    rMergeValue.c_str());
            }
            
        }
        else if(mode == "ggF"){
            legLabelSig_SampleInfoOnly = "hh#rightarrow4b [ggF]";
            if(std::stod(rMergeValue) == 0.001){
                legLabelSigNoIOType_SubjetBasedCut = Form(
                    "Subjet-based E_{T} Cut, hh#rightarrow4b [ggF] with d_{search} Disabled"
                );
                legLabelSigNoIOType_EtCutOnly = Form(
                    "Lead. LRJ E_{T} Cut, hh#rightarrow4b [ggF] with d_{search} Disabled"
                );
                legLabelSig = Form("hh#rightarrow4b [ggF]: IO: %s, N_{IO} = %u",
                                    inputObjectType.c_str(),
                                    nInputObjectsAlgorithmConfiguration);
            }
            else{
                legLabelSigNoIOType_SubjetBasedCut = Form(
                    "Subjet-based E_{T} Cut, hh#rightarrow4b [ggF] with d_{search} = %s",
                    rMergeValue.c_str()
                );
                legLabelSigNoIOType_EtCutOnly = Form(
                    "Lead. LRJ E_{T} Cut, hh#rightarrow4b [ggF] with d_{search} = %s",
                    rMergeValue.c_str()
                );
                legLabelSig = Form("hh#rightarrow4b [ggF]: IO: %s, N_{IO} = %u, rMerge = %s",
                                    inputObjectType.c_str(),
                                    nInputObjectsAlgorithmConfiguration,
                                    rMergeValue.c_str());
            }
        }
        else if(mode == "Zprime_tthad"){
            legLabelSig_SampleInfoOnly = "Z' #rightarrow t#bar{t} [had]";
            if(std::stod(rMergeValue) == 0.001){
                legLabelSigNoIOType_SubjetBasedCut = Form(
                    "Subjet-based E_{T} cut, Z' #rightarrow t#bar{t} [had], d_{search} disabled"
                );
                legLabelSigNoIOType_EtCutOnly = Form(
                    "Lead. LRJ E_{T} Cut, Z' #rightarrow t#bar{t} [had], d_{search} disabled"
                );
                legLabelSig = Form("Z' #rightarrow t#bar{t} [had]: IO: %s, N_{IO} = %u",
                                    inputObjectType.c_str(),
                                    nInputObjectsAlgorithmConfiguration);
            }
            else{
                legLabelSigNoIOType_SubjetBasedCut = Form(
                    "Subjet-based E_{T} Cut, Z' #rightarrow t#bar{t} [had] with d_{search} = %s",
                    rMergeValue.c_str()
                );
                legLabelSigNoIOType_EtCutOnly = Form(
                    "Lead. LRJ E_{T} Cut, Z' #rightarrow t#bar{t} [had]  with d_{search} = %s",
                    rMergeValue.c_str()
                );
                legLabelSig = Form("Z' #rightarrow t#bar{t} [had]: IO: %s, N_{IO} = %u, rMerge = %s",
                                    inputObjectType.c_str(),
                                    nInputObjectsAlgorithmConfiguration,
                                    rMergeValue.c_str());
            }
        }
        else if(mode == "ZvvHbb"){
            legLabelSig_SampleInfoOnly = "Z #rightarrow #nu#bar{#nu}, H #rightarrow b#bar{b}";
            if (std::stod(rMergeValue) == 0.001) {
                legLabelSigNoIOType_SubjetBasedCut = Form(
                    "Subjet-based E_{T} cut, Z #rightarrow #nu#bar{#nu}, H #rightarrow b#bar{b}, d_{search} disabled"
                );
                legLabelSigNoIOType_EtCutOnly = Form(
                    "Lead. LRJ E_{T} cut, Z #rightarrow #nu#bar{#nu}, H #rightarrow b#bar{b}, d_{search} disabled"
                );
                legLabelSig = Form("Z #rightarrow #nu#bar{#nu}, H #rightarrow b#bar{b}: IO: %s, N_{IO} = %u",
                                    inputObjectType.c_str(),
                                    nInputObjectsAlgorithmConfiguration);
            }
            else {
                legLabelSigNoIOType_SubjetBasedCut = Form(
                    "Subjet-based E_{T} cut, Z #rightarrow #nu#bar{#nu}, H #rightarrow b#bar{b}, d_{search} = %s",
                    rMergeValue.c_str()
                );
                legLabelSigNoIOType_EtCutOnly = Form(
                    "Lead. LRJ E_{T} cut, Z #rightarrow #nu#bar{#nu}, H #rightarrow b#bar{b}, d_{search} = %s",
                    rMergeValue.c_str()
                );
                legLabelSig = Form("Z #rightarrow #nu#bar{#nu}, H #rightarrow b#bar{b}: IO: %s, N_{IO} = %u, rMerge = %s",
                                    inputObjectType.c_str(),
                                    nInputObjectsAlgorithmConfiguration,
                                    rMergeValue.c_str());
            }
        }
        else if(mode == "ttbar_had"){
            legLabelSig_SampleInfoOnly = "t#bar{t} [had]";
            if (std::stod(rMergeValue) == 0.001) {
                legLabelSigNoIOType_SubjetBasedCut = Form(
                    "Subjet-based E_{T} cut, t#bar{t} [had], d_{search} disabled"
                );
                legLabelSigNoIOType_EtCutOnly = Form(
                    "Lead. LRJ E_{T} cut, t#bar{t} [had], d_{search} disabled"
                );
                legLabelSig = Form("t#bar{t} [had]: IO: %s, N_{IO} = %u",
                                    inputObjectType.c_str(), 
                                    nInputObjectsAlgorithmConfiguration);
            }
            else {
                legLabelSigNoIOType_SubjetBasedCut = Form(
                    "Subjet-based E_{T} cut, t#bar{t} [had], d_{search} = %s",
                    rMergeValue.c_str()
                );
                legLabelSigNoIOType_EtCutOnly = Form(
                    "Lead. LRJ E_{T} cut, t#bar{t} [had], d_{search} = %s",
                    rMergeValue.c_str()
                );
                legLabelSig = Form("t#bar{t} [had]: IO: %s, N_{IO} = %u, rMerge = %s",
                                    inputObjectType.c_str(),
                                    nInputObjectsAlgorithmConfiguration,
                                    rMergeValue.c_str());
            }
        }

        std::string legLabelBkg = Form("Bkg. (dijet): IO %s, N_{IO} = %u, rMerge = %s",
                                    inputObjectType.c_str(),
                                    nInputObjectsAlgorithmConfiguration,
                                    rMergeValue.c_str());
        leg->AddEntry(sig_h_leading_LRJ_Et_vec[fileIt], legLabelSig.c_str(), "l");
        if(fileIt == 0) leg->AddEntry(back_h_leading_LRJ_Et_vec[fileIt], legLabelBkg.c_str(), "l");
        

        if(fileIt == (backgroundRootFileNames.size() - 1)){
            leg->Draw();
            c1_Log.SaveAs(overlayOutputFileDir + "leading_JetTagger_LRJ_Et.pdf");
        }
        
        // Leading Offline LRJ E_T Distributions
        c1_Log_Offline.cd();

        sig_h_leading_offline_LRJ_Et_vec[fileIt]->Scale(1.0 / sig_h_leading_offline_LRJ_Et_vec[fileIt]->Integral());
        back_h_leading_offline_LRJ_Et_vec[fileIt]->Scale(1.0 / back_h_leading_offline_LRJ_Et_vec[fileIt]->Integral());


        // --- Styling ---
        sig_h_leading_offline_LRJ_Et_vec[fileIt]->SetLineColor(color);
        sig_h_leading_offline_LRJ_Et_vec[fileIt]->SetLineStyle(1);   // solid
        sig_h_leading_offline_LRJ_Et_vec[fileIt]->SetLineWidth(2);

        back_h_leading_offline_LRJ_Et_vec[fileIt]->SetLineColor(color);
        back_h_leading_offline_LRJ_Et_vec[fileIt]->SetLineStyle(2);   // dashed
        back_h_leading_offline_LRJ_Et_vec[fileIt]->SetLineWidth(2);

        // --- Draw ---
        if (fileIt == 0) {
            back_h_leading_offline_LRJ_Et_vec[fileIt]->Draw("HIST"); // draw background first as spans full range of y-axis
        }
        sig_h_leading_offline_LRJ_Et_vec[fileIt]->Draw("HIST SAME");

        leg_SampleInfoOnly->AddEntry(sig_h_leading_offline_LRJ_Et_vec[fileIt], legLabelSig_SampleInfoOnly.c_str(), "l");
        if(fileIt == 0) leg_SampleInfoOnly->AddEntry(back_h_leading_offline_LRJ_Et_vec[fileIt], "Background (dijet)", "l");
        if(fileIt == (backgroundRootFileNames.size() - 1)){
            leg_SampleInfoOnly->Draw();
            c1_Log_Offline.SaveAs(overlayOutputFileDir + "leading_offline_LRJ_Et.pdf");
        }

        c2_Log_Offline.cd();

        sig_h_subleading_offline_LRJ_Et_vec[fileIt]->Scale(1.0 / sig_h_subleading_offline_LRJ_Et_vec[fileIt]->Integral());
        back_h_subleading_offline_LRJ_Et_vec[fileIt]->Scale(1.0 / back_h_subleading_offline_LRJ_Et_vec[fileIt]->Integral());


        // --- Styling ---
        sig_h_subleading_offline_LRJ_Et_vec[fileIt]->SetLineColor(color);
        sig_h_subleading_offline_LRJ_Et_vec[fileIt]->SetLineStyle(1);   // solid
        sig_h_subleading_offline_LRJ_Et_vec[fileIt]->SetLineWidth(2);

        back_h_subleading_offline_LRJ_Et_vec[fileIt]->SetLineColor(color);
        back_h_subleading_offline_LRJ_Et_vec[fileIt]->SetLineStyle(2);   // dashed
        back_h_subleading_offline_LRJ_Et_vec[fileIt]->SetLineWidth(2);

        // --- Draw ---
        if (fileIt == 0) {
            back_h_subleading_offline_LRJ_Et_vec[fileIt]->Draw("HIST"); // draw background first as spans full range of y-axis
        }
        sig_h_subleading_offline_LRJ_Et_vec[fileIt]->Draw("HIST SAME");

        if(fileIt == (backgroundRootFileNames.size() - 1)){
            leg_SampleInfoOnly->Draw();
            c1_Log_Offline.SaveAs(overlayOutputFileDir + "subleading_offline_LRJ_Et.pdf");
        }

        c3_Log_Offline.cd();

        sig_h_leading_offline_LRJ_Mass_vec[fileIt]->Scale(1.0 / sig_h_leading_offline_LRJ_Mass_vec[fileIt]->Integral());
        back_h_leading_offline_LRJ_Mass_vec[fileIt]->Scale(1.0 / back_h_leading_offline_LRJ_Mass_vec[fileIt]->Integral());


        // --- Styling ---
        sig_h_leading_offline_LRJ_Mass_vec[fileIt]->SetLineColor(color);
        sig_h_leading_offline_LRJ_Mass_vec[fileIt]->SetLineStyle(1);   // solid
        sig_h_leading_offline_LRJ_Mass_vec[fileIt]->SetLineWidth(2);

        back_h_leading_offline_LRJ_Mass_vec[fileIt]->SetLineColor(color);
        back_h_leading_offline_LRJ_Mass_vec[fileIt]->SetLineStyle(2);   // dashed
        back_h_leading_offline_LRJ_Mass_vec[fileIt]->SetLineWidth(2);

        // --- Draw ---
        if (fileIt == 0) {
            back_h_leading_offline_LRJ_Mass_vec[fileIt]->Draw("HIST"); // draw background first as spans full range of y-axis
        }
        sig_h_leading_offline_LRJ_Mass_vec[fileIt]->Draw("HIST SAME");

        if(fileIt == (backgroundRootFileNames.size() - 1)){
            leg_SampleInfoOnly->Draw();
            c3_Log_Offline.SaveAs(overlayOutputFileDir + "leading_offline_LRJ_Mass.pdf");
        }


        // Subleading JetTagger E_T distribution
        c2_Log.cd();
        sig_h_subleading_LRJ_Et_vec[fileIt]->Scale(1.0 / sig_h_subleading_LRJ_Et_vec[fileIt]->Integral());
        back_h_subleading_LRJ_Et_vec[fileIt]->Scale(1.0 / back_h_subleading_LRJ_Et_vec[fileIt]->Integral());


        // --- Styling ---
        sig_h_subleading_LRJ_Et_vec[fileIt]->SetLineColor(color);
        sig_h_subleading_LRJ_Et_vec[fileIt]->SetLineStyle(1);   // solid
        sig_h_subleading_LRJ_Et_vec[fileIt]->SetLineWidth(2);

        back_h_subleading_LRJ_Et_vec[fileIt]->SetLineColor(color);
        back_h_subleading_LRJ_Et_vec[fileIt]->SetLineStyle(2);   // dashed
        back_h_subleading_LRJ_Et_vec[fileIt]->SetLineWidth(2);

        if (fileIt == 0) {
            back_h_subleading_LRJ_Et_vec[fileIt]->Draw("HIST"); // draw background first as spans full range of y-axis
        }
        sig_h_subleading_LRJ_Et_vec[fileIt]->Draw("HIST SAME");

        if(fileIt == (backgroundRootFileNames.size() - 1)){
            leg->Draw();
            c2_Log.SaveAs(overlayOutputFileDir + "subleading_JetTagger_LRJ_Et.pdf");
        }

        // Psi_R leading JetTagger distribution
        c1.cd();
        sig_h_leading_LRJ_psi_R_vec[fileIt]->Scale(1.0 / sig_h_leading_LRJ_psi_R_vec[fileIt]->Integral());
        back_h_leading_LRJ_psi_R_vec[fileIt]->Scale(1.0 / back_h_leading_LRJ_psi_R_vec[fileIt]->Integral());

        // --- Styling ---
        sig_h_leading_LRJ_psi_R_vec[fileIt]->SetLineColor(color);
        sig_h_leading_LRJ_psi_R_vec[fileIt]->SetLineStyle(1);   // solid
        sig_h_leading_LRJ_psi_R_vec[fileIt]->SetLineWidth(2);

        back_h_leading_LRJ_psi_R_vec[fileIt]->SetLineColor(color);
        back_h_leading_LRJ_psi_R_vec[fileIt]->SetLineStyle(2);   // dashed
        back_h_leading_LRJ_psi_R_vec[fileIt]->SetLineWidth(2);

        if (fileIt == 0) {
            sig_h_leading_LRJ_psi_R_vec[fileIt]->Draw("HIST");
            back_h_leading_LRJ_psi_R_vec[fileIt]->Draw("HIST SAME"); 
        } else {
            sig_h_leading_LRJ_psi_R_vec[fileIt]->Draw("HIST SAME");
        }
        
        

        if(fileIt == (backgroundRootFileNames.size() - 1)){
            leg->Draw();
            c1.SaveAs(overlayOutputFileDir + "leading_JetTagger_LRJ_Psi_R.pdf");
        }

        // Psi_R Subleading JetTagger distribution
        c2.cd();
        sig_h_subleading_LRJ_psi_R_vec[fileIt]->Scale(1.0 / sig_h_subleading_LRJ_psi_R_vec[fileIt]->Integral());
        back_h_subleading_LRJ_psi_R_vec[fileIt]->Scale(1.0 / back_h_subleading_LRJ_psi_R_vec[fileIt]->Integral());


        // --- Styling ---
        sig_h_subleading_LRJ_psi_R_vec[fileIt]->SetLineColor(color);
        sig_h_subleading_LRJ_psi_R_vec[fileIt]->SetLineStyle(1);   // solid
        sig_h_subleading_LRJ_psi_R_vec[fileIt]->SetLineWidth(2);

        back_h_subleading_LRJ_psi_R_vec[fileIt]->SetLineColor(color);
        back_h_subleading_LRJ_psi_R_vec[fileIt]->SetLineStyle(2);   // dashed
        back_h_subleading_LRJ_psi_R_vec[fileIt]->SetLineWidth(2);

        if (fileIt == 0) {
            sig_h_subleading_LRJ_psi_R_vec[fileIt]->Draw("HIST");
            back_h_subleading_LRJ_psi_R_vec[fileIt]->Draw("HIST SAME");
        } else {
            sig_h_subleading_LRJ_psi_R_vec[fileIt]->Draw("HIST SAME");
        }
        
        

        if(fileIt == (backgroundRootFileNames.size() - 1)){
            leg->Draw();
            c2.SaveAs(overlayOutputFileDir + "subleading_JetTagger_LRJ_Psi_R.pdf");
        }

        // Psi_R,lead * Psi_R,sublead JetTagger distribution
        c3.cd();
        sig_h_LRJ_psi_R_squared_vec[fileIt]->Scale(1.0 / sig_h_LRJ_psi_R_squared_vec[fileIt]->Integral());
        back_h_LRJ_psi_R_squared_vec[fileIt]->Scale(1.0 / back_h_LRJ_psi_R_squared_vec[fileIt]->Integral());


        // --- Styling ---
        sig_h_LRJ_psi_R_squared_vec[fileIt]->SetLineColor(color);
        sig_h_LRJ_psi_R_squared_vec[fileIt]->SetLineStyle(1);   // solid
        sig_h_LRJ_psi_R_squared_vec[fileIt]->SetLineWidth(2);

        back_h_LRJ_psi_R_squared_vec[fileIt]->SetLineColor(color);
        back_h_LRJ_psi_R_squared_vec[fileIt]->SetLineStyle(2);   // dashed
        back_h_LRJ_psi_R_squared_vec[fileIt]->SetLineWidth(2);

        if (fileIt == 0) {
            sig_h_LRJ_psi_R_squared_vec[fileIt]->Draw("HIST");
            back_h_LRJ_psi_R_squared_vec[fileIt]->Draw("HIST SAME");
        } else {
            sig_h_LRJ_psi_R_squared_vec[fileIt]->Draw("HIST SAME");
        }
        
        

        if(fileIt == (backgroundRootFileNames.size() - 1)){
            leg->Draw();
            c3.SaveAs(overlayOutputFileDir + "JetTagger_LRJ_Psi_R_squared.pdf");
        }

        // Overlay efficiency curves
        c4.cd();

        sig_h_leading_offlineLRJ_Et->SetFillColorAlpha(kGray+1, 0.35); // gray with 35% opacity
        sig_h_leading_offlineLRJ_Et->SetLineColor(kGray+2);            // slightly darker outline
        sig_h_leading_offlineLRJ_Et->SetLineWidth(1);
        // Normalize or rescale if needed to roughly fit in visible range
        sig_h_leading_offlineLRJ_Et->Scale(1.0 / sig_h_leading_offlineLRJ_Et->Integral());

        sig_eff_offlineLRJ10kHz_vec[fileIt]->SetLineColor(color);
        sig_eff_offlineLRJ10kHz_vec[fileIt]->SetMarkerColor(color);
        sig_eff_offlineLRJ10kHz_vec[fileIt]->SetMarkerStyle(20);
        sig_eff_offlineLRJ10kHz_vec[fileIt]->SetMarkerSize(0.8);
        sig_eff_offlineLRJ10kHz_vec[fileIt]->SetAxisRange(0.0, 1.1, "Y");
        
        // --- Legend entries ---
        std::string legLabelEff_10kHz = Form(
            "Lead. LRJ E_{T} > %.1f GeV  (IO: %s, Seed: %s, N_{IO}: %u, rMerge: %s)",
            jetTagger_10kHz_Threshold_Leading_vec[fileIt],
            inputObjectType.c_str(),
            seedObjectType.c_str(),
            nInputObjectsAlgorithmConfiguration, rMergeValue.c_str()
        );
        leg_10kHz_effs->AddEntry(sig_eff_offlineLRJ10kHz_vec[fileIt],
                            legLabelEff_10kHz.c_str(),
                            "lp");
        if (fileIt == 0) {
            sig_eff_offlineLRJ10kHz_vec[fileIt]->Draw("P"); 
        } else {
            sig_eff_offlineLRJ10kHz_vec[fileIt]->Draw("P SAME");
        }
        if(fileIt == (backgroundRootFileNames.size() - 1)){
            sig_h_leading_offlineLRJ_Et->Draw("HIST SAME");
            leg_10kHz_effs->Draw();
            c4.SaveAs(overlayOutputFileDir + "sig_eff_offline_LRJ10kHz.pdf");
        }

        c5.cd();
        sig_h_leading_offlineLRJ_Et->SetFillColorAlpha(kGray+1, 0.35); // gray with 35% opacity
        sig_h_leading_offlineLRJ_Et->SetLineColor(kGray+2);            // slightly darker outline
        sig_h_leading_offlineLRJ_Et->SetLineWidth(1);
        // Normalize or rescale if needed to roughly fit in visible range
        sig_h_leading_offlineLRJ_Et->Scale(1.0 / sig_h_leading_offlineLRJ_Et->Integral());
        sig_eff_offlineLRJ10kHz_HiggsMassWindow_vec[fileIt]->SetLineColor(color);
        sig_eff_offlineLRJ10kHz_HiggsMassWindow_vec[fileIt]->SetMarkerColor(color);
        sig_eff_offlineLRJ10kHz_HiggsMassWindow_vec[fileIt]->SetMarkerStyle(4);
        sig_eff_offlineLRJ10kHz_HiggsMassWindow_vec[fileIt]->SetMarkerSize(0.8);
        sig_eff_offlineLRJ10kHz_HiggsMassWindow_vec[fileIt]->SetAxisRange(0.0, 1.1, "Y");
        
        // --- Legend entries ---
        leg_10kHz_effs_HiggsMassWindow->AddEntry(sig_eff_offlineLRJ10kHz_vec[fileIt],
                            legLabelEff_10kHz.c_str(),
                            "lp");
        std::string legLabelEff_10kHz_HiggsMassWindow = Form(
            "[m_{H} Window] Lead. LRJ E_{T} > %.1f GeV  (IO: %s, Seed: %s, N_{IO}: %u, rMerge: %s)",
            jetTagger_10kHz_Threshold_Leading_vec[fileIt],
            inputObjectType.c_str(),
            seedObjectType.c_str(),
            nInputObjectsAlgorithmConfiguration, rMergeValue.c_str()
        );
        leg_10kHz_effs_HiggsMassWindow->AddEntry(sig_eff_offlineLRJ10kHz_HiggsMassWindow_vec[fileIt],
                            legLabelEff_10kHz_HiggsMassWindow.c_str(),
                            "lp");
        if (fileIt == 0) {
            sig_eff_offlineLRJ10kHz_vec[fileIt]->Draw("P"); 
            sig_eff_offlineLRJ10kHz_HiggsMassWindow_vec[fileIt]->Draw("P SAME"); 
        } else {
            sig_eff_offlineLRJ10kHz_vec[fileIt]->Draw("P SAME"); 
            sig_eff_offlineLRJ10kHz_HiggsMassWindow_vec[fileIt]->Draw("P SAME");
        }
        if(fileIt == (backgroundRootFileNames.size() - 1)){
            sig_h_leading_offlineLRJ_Et->Draw("HIST SAME");
            leg_10kHz_effs_HiggsMassWindow->Draw();
            c5.SaveAs(overlayOutputFileDir + "sig_eff_offline_LRJ10kHz_HiggsMassWindow.pdf");
        }

        c6.cd();
        sig_h_leading_offlineLRJ_Et->SetFillColorAlpha(kGray+1, 0.35); // gray with 35% opacity
        sig_h_leading_offlineLRJ_Et->SetLineColor(kGray+2);            // slightly darker outline
        sig_h_leading_offlineLRJ_Et->SetLineWidth(1);
        // Normalize or rescale if needed to roughly fit in visible range
        sig_h_leading_offlineLRJ_Et->Scale(1.0 / sig_h_leading_offlineLRJ_Et->Integral());
        sig_eff_offlineLRJ10kHz_1Subjet_vec[fileIt]->SetLineColor(color);
        sig_eff_offlineLRJ10kHz_1Subjet_vec[fileIt]->SetMarkerColor(color);
        sig_eff_offlineLRJ10kHz_1Subjet_vec[fileIt]->SetMarkerStyle(20);
        sig_eff_offlineLRJ10kHz_1Subjet_vec[fileIt]->SetMarkerSize(0.8);
        sig_eff_offlineLRJ10kHz_1Subjet_vec[fileIt]->SetAxisRange(0.0, 1.1, "Y");

        
        sig_eff_offlineLRJ10kHz_GrEq2Subjets_vec[fileIt]->SetLineColor(color);
        sig_eff_offlineLRJ10kHz_GrEq2Subjets_vec[fileIt]->SetMarkerColor(color);
        sig_eff_offlineLRJ10kHz_GrEq2Subjets_vec[fileIt]->SetMarkerStyle(24); // open circle for subjets
        sig_eff_offlineLRJ10kHz_GrEq2Subjets_vec[fileIt]->SetMarkerSize(0.8);
        sig_eff_offlineLRJ10kHz_GrEq2Subjets_vec[fileIt]->SetAxisRange(0.0, 1.1, "Y");
        
        // --- Legend entries ---
        std::string legLabelEff_10kHz_1Subjet = Form(
            "[1 Subjet] Lead. LRJ E_{T} > %.1f GeV  (IO: %s, Seed: %s, N IO: %u, rMerge: %s)",
            jetTagger_10kHz_Threshold_Leading_vec[fileIt],
            inputObjectType.c_str(),
            seedObjectType.c_str(),
            nInputObjectsAlgorithmConfiguration, rMergeValue.c_str()
        );
        leg_10kHz_effs_Subjets->AddEntry(sig_eff_offlineLRJ10kHz_1Subjet_vec[fileIt],
                            legLabelEff_10kHz_1Subjet.c_str(),
                            "lp");
        // --- Legend entries ---
        std::string legLabelEff_10kHz_GrEq2Subjets = Form(
            "[>= Subjet] Lead. LRJ E_{T} > %.1f GeV  (IO: %s, Seed: %s, N IO: %u, rMerge: %s)",
            jetTagger_10kHz_Threshold_Leading_vec[fileIt],
            inputObjectType.c_str(),
            seedObjectType.c_str(),
            nInputObjectsAlgorithmConfiguration, rMergeValue.c_str()
        );
        leg_10kHz_effs_Subjets->AddEntry(sig_eff_offlineLRJ10kHz_GrEq2Subjets_vec[fileIt],
                            legLabelEff_10kHz_GrEq2Subjets.c_str(),
                            "lp");
        if (fileIt == 0) {
            sig_eff_offlineLRJ10kHz_1Subjet_vec[fileIt]->Draw("P"); 
            sig_eff_offlineLRJ10kHz_GrEq2Subjets_vec[fileIt]->Draw("P SAME"); 
        } else {
            sig_eff_offlineLRJ10kHz_1Subjet_vec[fileIt]->Draw("P SAME"); 
            sig_eff_offlineLRJ10kHz_GrEq2Subjets_vec[fileIt]->Draw("P SAME"); 
        }
        if(fileIt == (backgroundRootFileNames.size() - 1)){
            sig_h_leading_offlineLRJ_Et->Draw("HIST SAME");
            leg_10kHz_effs_Subjets->Draw();
            c6.SaveAs(overlayOutputFileDir + "sig_eff_offline_LRJ10kHz_Subjets.pdf");
        }

        // Eff. vs Rates, etc. plots
        c7.cd();
        lead_ET_Scan_EffVsThresh_vec[fileIt]->SetLineColor(color);
        if (fileIt == 0) {
            lead_ET_Scan_EffVsThresh_vec[fileIt]->Draw("HIST"); 
        } else {
            lead_ET_Scan_EffVsThresh_vec[fileIt]->Draw("HIST SAME"); 
        }
        legSigOnly->AddEntry(lead_ET_Scan_EffVsThresh_vec[fileIt], legLabelSig.c_str(), "l");
        
        if(fileIt == (backgroundRootFileNames.size() - 1)){
            legSigOnly->Draw(); // Use this legend when only plotting signal 
            c7.SaveAs(overlayOutputFileDir + "lead_ET_scan_EffVsThresh.pdf");
        }

        c8.cd();
        sublead_ET_Scan_EffVsThresh_vec[fileIt]->SetLineColor(color);
        if (fileIt == 0) {
            sublead_ET_Scan_EffVsThresh_vec[fileIt]->Draw("HIST"); 
        } else {
            sublead_ET_Scan_EffVsThresh_vec[fileIt]->Draw("HIST SAME"); 
        }

        if(fileIt == (backgroundRootFileNames.size() - 1)){
            legSigOnly->Draw();
            c8.SaveAs(overlayOutputFileDir + "sublead_ET_scan_EffVsThresh.pdf");
        }

        c3_Log.cd();
        lead_ET_Scan_RateVsThresh_vec[fileIt]->SetLineColor(color);
        if (fileIt == 0) {
            lead_ET_Scan_RateVsThresh_vec[fileIt]->Draw("HIST"); 
        } else {
            lead_ET_Scan_RateVsThresh_vec[fileIt]->Draw("HIST SAME"); 
        }

        if(fileIt == (backgroundRootFileNames.size() - 1)){
            legSigOnly->Draw();
            c3_Log.SaveAs(overlayOutputFileDir + "lead_ET_Scan_RateVsThresh.pdf");
        }

        c4_Log.cd();
        sublead_ET_Scan_RateVsThresh_vec[fileIt]->SetLineColor(color);
        if (fileIt == 0) {
            sublead_ET_Scan_RateVsThresh_vec[fileIt]->Draw("HIST"); 
        } else {
            sublead_ET_Scan_RateVsThresh_vec[fileIt]->Draw("HIST SAME"); 
        }

        if(fileIt == (backgroundRootFileNames.size() - 1)){
            legSigOnly->Draw();
            c4_Log.SaveAs(overlayOutputFileDir + "sublead_ET_Scan_RateVsThresh.pdf");
        }

        c5_Log.cd();
        
        lead_ET_Pmax_Scan_RatesVsEff_vec[fileIt]->SetLineColor(color);
        lead_ET_Pmax_Scan_RatesVsEff_vec[fileIt]->SetMarkerColor(color);
        lead_ET_Pmax_Scan_RatesVsEff_vec[fileIt]->SetMarkerStyle(24); // open circle for SOME clarity...
        lead_ET_Pmax_Scan_RatesVsEff_vec[fileIt]->SetMarkerSize(0.8);
        if (fileIt == 0) {
            lead_ET_Pmax_Scan_RatesVsEff_vec[fileIt]->Draw("AP"); 
            // Force visible y-range: from 1 Hz to 1 kHz
            gPad->Update();  // make sure frame histogram exists
            auto frame = lead_ET_Pmax_Scan_RatesVsEff_vec[fileIt]->GetHistogram();
            frame->SetMinimum(1e0);   // lower bound (log axis requires >0)
        } else {
            lead_ET_Pmax_Scan_RatesVsEff_vec[fileIt]->Draw("P SAME"); 
        }
        { // put this within its own scope so I can reuse...
            auto best10k = FindBestPointBelowRate(lead_ET_Pmax_Scan_RatesVsEff_vec[fileIt], 1e4);
            double bestEff  = best10k.first;
            double bestRate = best10k.second;

            double ymin = gPad->GetUymin();

            TLine *vline10k = new TLine(bestEff, ymin, bestEff, 1e4);
            vline10k->SetLineColor(color);
            vline10k->SetLineStyle(2);
            vline10k->SetLineWidth(2);
            vline10k->Draw("SAME");
        }

        if(fileIt == (backgroundRootFileNames.size() - 1)){
            // Horizontal line at 10 kHz
            double xmin = gPad->GetUxmin();
            double xmax = gPad->GetUxmax();

            TLine *hline10k = new TLine(xmin, 1e4, xmax, 1e4);
            hline10k->SetLineColor(kGray + 2);
            hline10k->SetLineStyle(2);
            hline10k->SetLineWidth(2);
            hline10k->Draw("SAME");
            legSigOnly->Draw();
            c5_Log.SaveAs(overlayOutputFileDir + "lead_ET_Pmax_Scan_RatesVsEff.pdf");
        }

        c6_Log.cd();
        
        sublead_ET_Pmax_Scan_RatesVsEff_vec[fileIt]->SetLineColor(color);
        sublead_ET_Pmax_Scan_RatesVsEff_vec[fileIt]->SetMarkerColor(color);
        sublead_ET_Pmax_Scan_RatesVsEff_vec[fileIt]->SetMarkerStyle(24); // open circle for SOME clarity...
        sublead_ET_Pmax_Scan_RatesVsEff_vec[fileIt]->SetMarkerSize(0.8);
        if (fileIt == 0) {
            sublead_ET_Pmax_Scan_RatesVsEff_vec[fileIt]->Draw("AP"); 
            gPad->Update();  // make sure frame histogram exists
            auto frame = sublead_ET_Pmax_Scan_RatesVsEff_vec[fileIt]->GetHistogram();
            frame->SetMinimum(1e0);   // lower bound (log axis requires >0)
        } else {
            sublead_ET_Pmax_Scan_RatesVsEff_vec[fileIt]->Draw("P SAME"); 
        }

        { // put this within its own scope so I can reuse...
            auto best10k = FindBestPointBelowRate(sublead_ET_Pmax_Scan_RatesVsEff_vec[fileIt], 1e4);
            double bestEff  = best10k.first;
            double bestRate = best10k.second;

            double ymin = gPad->GetUymin();

            TLine *vline10k = new TLine(bestEff, ymin, bestEff, 1e4);
            vline10k->SetLineColor(color);
            vline10k->SetLineStyle(2);
            vline10k->SetLineWidth(2);
            vline10k->Draw("SAME");
        }

        if(fileIt == (backgroundRootFileNames.size() - 1)){
            // Horizontal line at 10 kHz
            double xmin = gPad->GetUxmin();
            double xmax = gPad->GetUxmax();

            TLine *hline10k = new TLine(xmin, 1e4, xmax, 1e4);
            hline10k->SetLineColor(kGray + 2);
            hline10k->SetLineStyle(2);
            hline10k->SetLineWidth(2);
            hline10k->Draw("SAME");
            legSigOnly->Draw();
            c6_Log.SaveAs(overlayOutputFileDir + "sublead_ET_Pmax_Scan_RatesVsEff.pdf");
        }

        

        c7_Log.cd();
        
        lead_ET_Scan_RatesVsEff_vec[fileIt]->SetLineColor(color);
        lead_ET_Scan_RatesVsEff_vec[fileIt]->SetMarkerColor(color);
        lead_ET_Scan_RatesVsEff_vec[fileIt]->SetMarkerStyle(24); // open circle for SOME clarity...
        lead_ET_Scan_RatesVsEff_vec[fileIt]->SetMarkerSize(0.8);
        if (fileIt == 0) {
            lead_ET_Scan_RatesVsEff_vec[fileIt]->Draw("AP"); 
            // X axis: efficiency
            lead_ET_Scan_RatesVsEff_vec[fileIt]->GetXaxis()->SetLimits(0.0, 1.0);

            // Y axis: rate (log scale!)
            lead_ET_Scan_RatesVsEff_vec[fileIt]->GetYaxis()->SetRangeUser(50.0, 5e4);
        } else {
            lead_ET_Scan_RatesVsEff_vec[fileIt]->Draw("P SAME"); 
        }

        { // put this within its own scope so I can reuse...
            auto best10k = FindBestPointBelowRate(lead_ET_Scan_RatesVsEff_vec[fileIt], 1e4);
            double bestEff  = best10k.first;
            double bestRate = best10k.second;

            double ymin = gPad->GetUymin();

            TLine *vline10k = new TLine(bestEff, ymin, bestEff, 1e4);
            vline10k->SetLineColor(color);
            vline10k->SetLineStyle(2);
            vline10k->SetLineWidth(2);
            vline10k->Draw("SAME");
        }

        if(fileIt == (backgroundRootFileNames.size() - 1)){
            // Horizontal line at 10 kHz
            double xmin = gPad->GetUxmin();
            double xmax = gPad->GetUxmax();

            TLine *hline10k = new TLine(xmin, 1e4, xmax, 1e4);
            hline10k->SetLineColor(kGray + 2);
            hline10k->SetLineStyle(2);
            hline10k->SetLineWidth(2);
            hline10k->Draw("SAME");
            legSigOnly->Draw();
            c7_Log.SaveAs(overlayOutputFileDir + "lead_ET_Scan_RatesVsEff.pdf");
        }

        c8_Log.cd();
        
        sublead_ET_Scan_RatesVsEff_vec[fileIt]->SetLineColor(color);
        sublead_ET_Scan_RatesVsEff_vec[fileIt]->SetMarkerColor(color);
        sublead_ET_Scan_RatesVsEff_vec[fileIt]->SetMarkerStyle(24); // open circle for SOME clarity...
        sublead_ET_Scan_RatesVsEff_vec[fileIt]->SetMarkerSize(0.8);
        if (fileIt == 0) {
            sublead_ET_Scan_RatesVsEff_vec[fileIt]->Draw("AP"); 
        } else {
            sublead_ET_Scan_RatesVsEff_vec[fileIt]->Draw("P SAME"); 
        }

        { // put this within its own scope so I can reuse...
            auto best10k = FindBestPointBelowRate(sublead_ET_Scan_RatesVsEff_vec[fileIt], 1e4);
            double bestEff  = best10k.first;
            double bestRate = best10k.second;

            double ymin = gPad->GetUymin();

            TLine *vline10k = new TLine(bestEff, ymin, bestEff, 1e4);
            vline10k->SetLineColor(color);
            vline10k->SetLineStyle(2);
            vline10k->SetLineWidth(2);
            vline10k->Draw("SAME");
        }

        if(fileIt == (backgroundRootFileNames.size() - 1)){
            // Horizontal line at 10 kHz
            double xmin = gPad->GetUxmin();
            double xmax = gPad->GetUxmax();

            TLine *hline10k = new TLine(xmin, 1e4, xmax, 1e4);
            hline10k->SetLineColor(kGray + 2);
            hline10k->SetLineStyle(2);
            hline10k->SetLineWidth(2);
            hline10k->Draw("SAME");
            legSigOnly->Draw();
            c8_Log.SaveAs(overlayOutputFileDir + "sublead_ET_Scan_RatesVsEff.pdf");
        }

        c9_Log.cd();
        if(color == kYellow) color = kOrange;
        // FIXME need to fix labels to actually indicate if ggF or whatever (in-progress)
        subjetBased_ET_Scan_RatesVsEff_vec[fileIt]->SetLineColor(color);
        subjetBased_ET_Scan_RatesVsEff_vec[fileIt]->SetMarkerColor(color);
        subjetBased_ET_Scan_RatesVsEff_vec[fileIt]->SetMarkerStyle(24); // open circle for SOME clarity...
        subjetBased_ET_Scan_RatesVsEff_vec[fileIt]->SetMarkerSize(0.6);

        lead_ET_Scan_RatesVsEff_vec[fileIt]->SetLineColor(color);
        lead_ET_Scan_RatesVsEff_vec[fileIt]->SetMarkerColor(color);
        lead_ET_Scan_RatesVsEff_vec[fileIt]->SetMarkerStyle(21); // filled in square
        lead_ET_Scan_RatesVsEff_vec[fileIt]->SetMarkerSize(0.6);

        legSigOnlyNoIOTypes->AddEntry(subjetBased_ET_Scan_RatesVsEff_vec[fileIt], legLabelSigNoIOType_SubjetBasedCut.c_str(), "p");
        legSigOnlyNoIOTypes->AddEntry(lead_ET_Scan_RatesVsEff_vec[fileIt], legLabelSigNoIOType_EtCutOnly.c_str(), "p");
        if (fileIt == 0) {
            subjetBased_ET_Scan_RatesVsEff_vec[fileIt]->Draw("AP"); 
            lead_ET_Scan_RatesVsEff_vec[fileIt]->Draw("P SAME"); 
            gPad->Update();  // make sure frame histogram exists
            auto frame = subjetBased_ET_Scan_RatesVsEff_vec[fileIt]->GetHistogram();
            frame->SetMinimum(50.);   // lower bound (log axis requires >0)
            frame->SetMaximum(5.0e4);     // y-axis max (example)
            frame->GetXaxis()->SetLimits(0, 1.0);  // <-- x-axis min/max
            //auto frame2 = lead_ET_Scan_RatesVsEff_vec[fileIt]->GetHistogram();
            //frame2->SetMinimum(50.);   // lower bound (log axis requires >0)
            //frame2->SetMaximum(5.0e4);     // y-axis max (example)
            //frame2->GetXaxis()->SetLimits(0, 1.0);  // <-- x-axis min/max
            gPad->Modified();
            gPad->Update();  
        } else {
            subjetBased_ET_Scan_RatesVsEff_vec[fileIt]->Draw("P SAME"); 
            lead_ET_Scan_RatesVsEff_vec[fileIt]->Draw("P SAME"); 
        }

        { // put this within its own scope so I can reuse...
            auto best10k = FindBestPointBelowRate(subjetBased_ET_Scan_RatesVsEff_vec[fileIt], 1e4);
            double bestEff  = best10k.first;
            double bestRate = best10k.second;

            auto frame = subjetBased_ET_Scan_RatesVsEff_vec[0]->GetHistogram(); // or grab it once
            double ymin = frame->GetMinimum();  // should be 50

            TLine *vline10k = new TLine(bestEff, ymin, bestEff, 1e4);
            vline10k->SetLineColor(color);
            vline10k->SetLineStyle(2);
            vline10k->SetLineWidth(2);

            vline10k->Draw("SAME");
        }

        if(fileIt == (backgroundRootFileNames.size() - 1)){
            // Horizontal line at 10 kHz
            double xmin = gPad->GetUxmin();
            double xmax = gPad->GetUxmax();

            TLine *hline10k = new TLine(xmin, 1e4, xmax, 1e4);
            hline10k->SetLineColor(kGray + 2);
            hline10k->SetLineStyle(2);
            hline10k->SetLineWidth(2);
            hline10k->Draw("SAME");
            legSigOnlyNoIOTypes->Draw();
            c9_Log.SaveAs(overlayOutputFileDir + "subjetBased_ET_Scan_RatesVsEff.pdf");
        }

    } // Loop to overlay plots after having already filled vectors through main file loop

TString outputFileDir = "overlayLargeRJetHistograms/"; // FIXME all the following code should now be deprecated

if (overlayThreeFiles){
    // -----------------------------
    // Colors for thresholds (pick from your palette)
    // -----------------------------
    const int bcol100 = colors[1];
    const int bcol200 = colors[3];
    const int bcol300 = colors[5];

    // -----------------------------
    // Marker style by file index
    // -----------------------------
    std::vector<int> fileMarkerStyles_b = {20, 24, 25}; // filled circle, open circle, open square
    const double bmSize = 1.1;

    // -----------------------------
    // Prepare canvas + axes frame
    // -----------------------------
    TCanvas cBack("cBack","Background efficiency overlays", 900, 700);

    // Take x-range from the first available histogram (background binning is 50500 in your code)
    double bxmin = 0, bxmax = 0;
    auto pickBXRange = [&](TH1* h){
    if (h && bxmax<=bxmin) { bxmin = h->GetXaxis()->GetXmin(); bxmax = h->GetXaxis()->GetXmax(); }
    };

    for (auto* h : { (TH1*) (back_eff_100.empty()?nullptr:back_eff_100[0]),
                    (TH1*) (back_eff_200.empty()?nullptr:back_eff_200[0]),
                    (TH1*) (back_eff_300.empty()?nullptr:back_eff_300[0]) }) pickBXRange(h);

    if (bxmax<=bxmin) { bxmin = 50; bxmax = 500; } // fallback to your background binning

    TH1F* bframe = (TH1F*)gPad->DrawFrame(bxmin, 0.0, bxmax, 1.05);
    bframe->SetTitle("Emulated Trigger Efficiency (Background);Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Background)");
    bframe->GetYaxis()->CenterTitle(true);

    // -----------------------------
    // Legends
    // -----------------------------
    TLegend* bLegFiles  = new TLegend(0.54, 0.20, 0.91, 0.48); // file names (marker shapes)
    TLegend* bLegThresh = new TLegend(0.57, 0.50, 0.94, 0.70); // threshold colors
    bLegFiles->SetTextSize(0.028);
    bLegThresh->SetTextSize(0.028);

    // -----------------------------
    // Draw all files  thresholds
    // -----------------------------
    auto styleAndDrawB = [&](TH1F* h, int color, int mstyle) {
        if (!h) return;
        h->SetLineColor(color);
        h->SetMarkerColor(color);
        h->SetMarkerStyle(mstyle);
        h->SetMarkerSize(bmSize);
        h->SetLineWidth(2);
        h->Draw("P SAME");  // or "E1 P SAME" for error bars
    };

    const unsigned int nBFiles = (int)std::max({back_eff_100.size(), back_eff_200.size(), back_eff_300.size()});
    for (unsigned int fileIt = 0; fileIt < nBFiles; ++fileIt) {
    const int mstyle = fileMarkerStyles_b[fileIt % (int)fileMarkerStyles_b.size()];

    if (fileIt < back_eff_100.size()) styleAndDrawB(back_eff_100[fileIt], bcol100, mstyle);
    if (fileIt < back_eff_200.size()) styleAndDrawB(back_eff_200[fileIt], bcol200, mstyle);
    if (fileIt < back_eff_300.size()) styleAndDrawB(back_eff_300[fileIt], bcol300, mstyle);

    // Use one object to represent the file in the legend (carries the marker)
    TH1F* rep =
        (fileIt < back_eff_100.size()) ? back_eff_100[fileIt] :
        (fileIt < back_eff_200.size()) ? back_eff_200[fileIt] :
        (fileIt < back_eff_300.size()) ? back_eff_300[fileIt] : nullptr;

    if (rep) {
        const std::string label =
        legendMap.count(algorithmConfigurations[fileIt])
        ? legendMap[algorithmConfigurations[fileIt]]
        : backgroundRootFileNames[fileIt];
        auto e = bLegFiles->AddEntry((TObject*)nullptr, label.c_str(), "p");
        e->SetMarkerStyle(mstyle);   // 20, 24, 25 ...
        e->SetMarkerSize(bmSize);
        e->SetMarkerColor(kBlack);   // force black marker in legend
        e->SetLineColor(kBlack);     // (harmless for "p")
    }
    }

    // Threshold color key (line entries so color shows independent of marker shape)
    if (!back_eff_100.empty()) { auto h = back_eff_100.front(); h->SetLineColor(bcol100); bLegThresh->AddEntry(h, "E_{T} > 100 GeV", "l"); }
    if (!back_eff_200.empty()) { auto h = back_eff_200.front(); h->SetLineColor(bcol200); bLegThresh->AddEntry(h, "E_{T} > 200 GeV", "l"); }
    if (!back_eff_300.empty()) { auto h = back_eff_300.front(); h->SetLineColor(bcol300); bLegThresh->AddEntry(h, "E_{T} > 300 GeV", "l"); }

    // Draw legends
    //bLegFiles->Draw();
    //bLegThresh->Draw();

    // Save
    cBack.SaveAs(outputFileDir + "back_eff_overlay_all_files_100_200_300.pdf");


    // -----------------------------
    // Colors for thresholds
    // -----------------------------
    const int col100 = colors[1];  // match your palette
    const int col250 = colors[4];
    const int col400 = colors[7];

    // -----------------------------
    // Marker style by file index
    // (extend if you have >3 files)
    // -----------------------------
    std::vector<int> fileMarkerStyles = {20, 24, 25}; // filled circle, open circle, open square
    const double mSize = 1.1;

    // -----------------------------
    // Prepare canvas + axes frame
    // -----------------------------
    TCanvas cSig("cSig","Signal efficiency overlays", 900, 700);

    // Take x-range from the first available histogram
    double xmin = 0, xmax = 0;
    auto pickXRange = [&](TH1* h){
    if (h && xmax<=xmin) { xmin = h->GetXaxis()->GetXmin(); xmax = h->GetXaxis()->GetXmax(); }
    };

    for (auto* h : { (TH1*) (sig_eff_100.empty()?nullptr:sig_eff_100[0]),
                    (TH1*) (sig_eff_250.empty()?nullptr:sig_eff_250[0]),
                    (TH1*) (sig_eff_400.empty()?nullptr:sig_eff_400[0]) }) pickXRange(h);

    if (xmax<=xmin) { xmin = 0; xmax = 1000; } // fallback

    TH1F* frame = (TH1F*)gPad->DrawFrame(xmin, 0.0, xmax, 1.05);
    frame->SetTitle("Emulated Trigger Efficiency (Signal);Offline Leading LRJ E_{T} [GeV];Emulated Trigger Efficiency (Signal)");
    frame->GetYaxis()->CenterTitle(true);

    // -----------------------------
    // Legends
    // -----------------------------
    TLegend* legFiles   = new TLegend(0.54, 0.20, 0.91, 0.48); // shows file (marker shapes)
    TLegend* legThresh  = new TLegend(0.57, 0.50, 0.94, 0.70); // shows threshold colors
    legFiles->SetFillStyle(0);  legFiles->SetBorderSize(0);  legFiles->SetTextSize(0.028);
    legThresh->SetFillStyle(0); legThresh->SetBorderSize(0); legThresh->SetTextSize(0.028);

    // -----------------------------
    // Draw all files  thresholds
    // -----------------------------
    // Helper to style and draw one eff hist
    auto styleAndDraw = [&](TH1F* h, int color, int mstyle) {
        if (!h) return;
        h->SetLineColor(color);
        h->SetMarkerColor(color);
        h->SetMarkerStyle(mstyle);
        h->SetMarkerSize(mSize);
        h->SetLineWidth(2);
        h->Draw("P SAME");  // use "E1 P SAME" if you want error bars visible
    };

    const unsigned int nFiles = (int)std::max({sig_eff_100.size(), sig_eff_250.size(), sig_eff_400.size()});
    for (unsigned int fileIt = 0; fileIt < nFiles; ++fileIt) {
        const int mstyle = fileMarkerStyles[fileIt % (int)fileMarkerStyles.size()];

        // Style + draw the three thresholds for this file
        if (fileIt < sig_eff_100.size())  styleAndDraw(sig_eff_100[fileIt],  col100, mstyle);
        if (fileIt < sig_eff_250.size())  styleAndDraw(sig_eff_250[fileIt],  col250, mstyle);
        if (fileIt < sig_eff_400.size())  styleAndDraw(sig_eff_400[fileIt],  col400, mstyle);

        // Legend entry per file, using *one* of that file's objects so the marker matches.
        // We use the 100 GeV object for the entry (purely to carry the marker style).
        TH1F* rep = (fileIt < sig_eff_100.size()) ? sig_eff_100[fileIt]
                    : (fileIt < sig_eff_250.size()) ? sig_eff_250[fileIt]
                    : (fileIt < sig_eff_400.size()) ? sig_eff_400[fileIt]
                    : nullptr;

        if (rep) {
            const std::string label =
            legendMap.count(algorithmConfigurations[fileIt])
            ? legendMap[algorithmConfigurations[fileIt]]
            : backgroundRootFileNames[fileIt];
            
            // inside the background loop, after you choose mstyle and build `label`:

            // 2) add a legend entry that is independent of the histogram colors
            auto e = legFiles->AddEntry((TObject*)nullptr, label.c_str(), "p");
            e->SetMarkerStyle(mstyle);   // 20, 24, 25 ...
            e->SetMarkerSize(bmSize);
            e->SetMarkerColor(kBlack);   // force black marker in legend
            e->SetLineColor(kBlack);     // (harmless for "p")

        }
    }

    // Threshold color key (use first files objects if available,
    // and draw as line entries so the legend shows color, not the files marker)
    if (!sig_eff_100.empty()) { auto h = sig_eff_100.front(); h->SetLineColor(col100); legThresh->AddEntry(h, "E_{T} > 100 GeV", "l"); }
    if (!sig_eff_250.empty()) { auto h = sig_eff_250.front(); h->SetLineColor(col250); legThresh->AddEntry(h, "E_{T} > 250 GeV", "l"); }
    if (!sig_eff_400.empty()) { auto h = sig_eff_400.front(); h->SetLineColor(col400); legThresh->AddEntry(h, "E_{T} > 400 GeV", "l"); }

    // Draw legends
    legFiles->Draw();
    legThresh->Draw();

    // Save
    cSig.SaveAs(outputFileDir + "sig_eff_overlay_all_files_100_250_400.pdf");
} // Designed for 3 file overlay

} 




void largeRJetAnalysisAndRates(bool overlayThreeFiles = false){
    using clock = std::chrono::steady_clock;
    auto t0 = clock::now();

    //ROOT::EnableImplicitMT(8);   // use 8 threads - this didn't speed anything up!
    //const std::string signalLargeRJetDataFileName = "/eos/home-m/mlarson/LargeRadiusJets/MemPrints/largeRJets/mc21_14TeV_hh_bbbb_vbf_novhh_largeR.dat";
    //const std::string backgroundLargeRJetDataFileName = "/eos/home-m/mlarson/LargeRadiusJets/MemPrints/largeRJets/mc21_14TeV_jj_JZ3_largeR.dat";
    constexpr bool vbfBool = true;
    std::vector<std::string > signalRootFileNames = {
                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_FixedHSTP/mc21_14TeV_hh_bbbb_vbf_novhh_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.44_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_OR.root",
                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_FixedHSTP/mc21_14TeV_hh_bbbb_vbf_novhh_e8557_s4422_r16130_rMerge_1.5_IOs_128_Seeds_2_R2_1.44_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_OR.root",
                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_FixedHSTP/mc21_14TeV_hh_bbbb_vbf_novhh_e8557_s4422_r16130_rMerge_2_IOs_32_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_OR.root",
                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_FixedHSTP/mc21_14TeV_hh_bbbb_vbf_novhh_e8557_s4422_r16130_rMerge_2_IOs_64_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_OR.root",
                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_FixedHSTP/mc21_14TeV_hh_bbbb_vbf_novhh_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_OR.root",
                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_FixedHSTP_EtWeighted/mc21_14TeV_hh_bbbb_vbf_novhh_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_OR.root",
                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_FixedHSTP_EtWeighted/mc21_14TeV_hh_bbbb_vbf_novhh_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_OR.root",
                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_FixedHSTP_EtWeighted/mc21_14TeV_hh_bbbb_vbf_novhh_e8557_s4422_r16130_rMerge_1.5_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_OR.root",
                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_FixedHSTP/mc21_14TeV_hh_bbbb_vbf_novhh_e8557_s4422_r16130_rMerge_2.5_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_OR.root",

                                                    // NEW ggF + PU Suppression Files
                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression/mc21_14TeV_hh_bbbb_vbf_novhh_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_NoSK.root",
                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression/mc21_14TeV_HHbbbb_HLLHC_e8564_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_NoSK.root",
                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression/mc21_14TeV_HHbbbb_HLLHC_e8564_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression/mc21_14TeV_HHbbbb_HLLHC_e8564_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_NoSK.root",
                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression/mc21_14TeV_HHbbbb_HLLHC_e8564_s4422_r16130_rMerge_2.5_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression/mc21_14TeV_hh_bbbb_vbf_novhh_e8557_s4422_r16130_rMerge_2.5_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression/mc21_14TeV_HHbbbb_HLLHC_e8564_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_NoSK.root",
                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression/mc21_14TeV_hh_bbbb_vbf_novhh_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_NoSK.root",
                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression/mc21_14TeV_HHbbbb_HLLHC_e8564_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression/mc21_14TeV_hh_bbbb_vbf_novhh_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",

                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression/mc21_14TeV_HHbbbb_HLLHC_e8564_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression/mc21_14TeV_hh_bbbb_vbf_novhh_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",

                                                    

                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression_MinEtSeedPosRecalc/mc21_14TeV_ttbar_hdamp258p75_allhad_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression_MinEtSeedPosRecalc/mc21_14TeV_ZvvH125_bb_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression_MinEtSeedPosRecalc/mc21_14TeV_flatpT_Zprime_tthad_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",

                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression_MinEtSeedPosRecalc/mc21_14TeV_ttbar_hdamp258p75_allhad_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression_MinEtSeedPosRecalc/mc21_14TeV_ZvvH125_bb_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression_MinEtSeedPosRecalc/mc21_14TeV_flatpT_Zprime_tthad_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",

                                                    /*"/data/larsonma/LargeRadiusJets/outputNTuplesDev_VBFSM/mc21_14TeV_HHbbbb_HLLHC_e8564_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                    "/data/larsonma/LargeRadiusJets/outputNTuplesDev_VBFSM/mc21_14TeV_hh_bbbb_vbf_novhh_cvv0_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                    "/data/larsonma/LargeRadiusJets/outputNTuplesDev_VBFSM/mc21_14TeV_hh_bbbb_vbf_novhh_cvv1_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                    "/data/larsonma/LargeRadiusJets/outputNTuplesDev_VBFSM/mc21_14TeV_ttbar_hdamp258p75_allhad_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                    "/data/larsonma/LargeRadiusJets/outputNTuplesDev_VBFSM/mc21_14TeV_ZvvH125_bb_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                    "/data/larsonma/LargeRadiusJets/outputNTuplesDev_VBFSM/mc21_14TeV_flatpT_Zprime_tthad_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",*/
                                                    
                                                    // samples for global trigger meeting 02112026
                                                    "/data/larsonma/LargeRadiusJets/outputNTuplesDev_GlobalTriggerMeeting_02092026/mc21_14TeV_HHbbbb_HLLHC_e8564_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                    "/data/larsonma/LargeRadiusJets/outputNTuplesDev_GlobalTriggerMeeting_02092026/mc21_14TeV_hh_bbbb_vbf_novhh_cvv0_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                    "/data/larsonma/LargeRadiusJets/outputNTuplesDev_GlobalTriggerMeeting_02092026/mc21_14TeV_hh_bbbb_vbf_novhh_cvv1_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                    "/data/larsonma/LargeRadiusJets/outputNTuplesDev_GlobalTriggerMeeting_02092026/mc21_14TeV_ttbar_hdamp258p75_allhad_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                    "/data/larsonma/LargeRadiusJets/outputNTuplesDev_GlobalTriggerMeeting_02092026/mc21_14TeV_ZvvH125_bb_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                    "/data/larsonma/LargeRadiusJets/outputNTuplesDev_GlobalTriggerMeeting_02092026/mc21_14TeV_flatpT_Zprime_tthad_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",

                                                    // samples for v2 algorithm for global trigger meeting 02112026
                                                    /*"/data/larsonma/LargeRadiusJets/outputNTuplesDev_GlobalTriggerMeeting_02092026/mc21_14TeV_HHbbbb_HLLHC_e8564_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepWTAConeCellsTowersJets_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                    "/data/larsonma/LargeRadiusJets/outputNTuplesDev_GlobalTriggerMeeting_02092026/mc21_14TeV_hh_bbbb_vbf_novhh_cvv0_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepWTAConeCellsTowersJets_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                    "/data/larsonma/LargeRadiusJets/outputNTuplesDev_GlobalTriggerMeeting_02092026/mc21_14TeV_hh_bbbb_vbf_novhh_cvv1_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepWTAConeCellsTowersJets_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                    "/data/larsonma/LargeRadiusJets/outputNTuplesDev_GlobalTriggerMeeting_02092026/mc21_14TeV_ttbar_hdamp258p75_allhad_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepWTAConeCellsTowersJets_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                    "/data/larsonma/LargeRadiusJets/outputNTuplesDev_GlobalTriggerMeeting_02092026/mc21_14TeV_ZvvH125_bb_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepWTAConeCellsTowersJets_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                    "/data/larsonma/LargeRadiusJets/outputNTuplesDev_GlobalTriggerMeeting_02092026/mc21_14TeV_flatpT_Zprime_tthad_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepWTAConeCellsTowersJets_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                    */

                                                    // samples for global trigger meeting 02112026 for seed optimization comparison
                                                    /*"/data/larsonma/LargeRadiusJets/outputNTuplesDev_GlobalTriggerMeeting_02092026/mc21_14TeV_HHbbbb_HLLHC_e8564_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                    "/data/larsonma/LargeRadiusJets/outputNTuplesDev_GlobalTriggerMeeting_02092026/mc21_14TeV_hh_bbbb_vbf_novhh_cvv1_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                    "/data/larsonma/LargeRadiusJets/outputNTuplesDev_GlobalTriggerMeeting_02092026/mc21_14TeV_ttbar_hdamp258p75_allhad_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",

                                                    "/data/larsonma/LargeRadiusJets/outputNTuplesDev_GlobalTriggerMeeting_02092026/mc21_14TeV_HHbbbb_HLLHC_e8564_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                    "/data/larsonma/LargeRadiusJets/outputNTuplesDev_GlobalTriggerMeeting_02092026/mc21_14TeV_hh_bbbb_vbf_novhh_cvv1_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                    "/data/larsonma/LargeRadiusJets/outputNTuplesDev_GlobalTriggerMeeting_02092026/mc21_14TeV_ttbar_hdamp258p75_allhad_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",*/
                                                    
                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression_FixedSeedPosRecalcBug/mc21_14TeV_HHbbbb_HLLHC_e8564_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression_FixedSeedPosRecalcBug/mc21_14TeV_hh_bbbb_vbf_novhh_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression_FixedSeedPosRecalcBug/mc21_14TeV_ttbar_hdamp258p75_allhad_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression_FixedSeedPosRecalcBug/mc21_14TeV_ZvvH125_bb_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression_FixedSeedPosRecalcBug/mc21_14TeV_flatpT_Zprime_tthad_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",

                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression_MinEtSeedPosRecalc/mc21_14TeV_HHbbbb_HLLHC_e8564_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression_MinEtSeedPosRecalc/mc21_14TeV_hh_bbbb_vbf_novhh_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root"
                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression/mc21_14TeV_HHbbbb_HLLHC_e8564_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression/mc21_14TeV_hh_bbbb_vbf_novhh_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression/mc21_14TeV_HHbbbb_HLLHC_e8564_s4422_r16130_rMerge_1.75_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression/mc21_14TeV_hh_bbbb_vbf_novhh_e8557_s4422_r16130_rMerge_1.75_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression/mc21_14TeV_hh_bbbb_vbf_novhh_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                    
                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression/mc21_14TeV_HHbbbb_HLLHC_e8564_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.44_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_NoSK.root",
                                                    //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression/mc21_14TeV_HHbbbb_HLLHC_e8564_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.44_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root"
                                                        };
    std::vector<std::string > backgroundRootFileNames = {
                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_FixedHSTP/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.44_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_OR.root",
                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_FixedHSTP/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_1.5_IOs_128_Seeds_2_R2_1.44_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_OR.root",
                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_FixedHSTP/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_2_IOs_32_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_OR.root",
                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_FixedHSTP/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_2_IOs_64_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_OR.root",
                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_FixedHSTP/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_OR.root",
                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_FixedHSTP/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_OR.root",
                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_FixedHSTP/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_OR.root",
                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_FixedHSTP/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_1.5_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_OR.root",
                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_FixedHSTP/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_2.5_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_OR.root",
                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_FixedHSTP/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_2.5_IOs_128_Seeds_2_R2_1.44_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_OR.root",

                                                        // NEW PU Suppression Files
                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_NoSK.root",
                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_NoSK.root",
                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_2.5_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_2.5_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_NoSK.root",
                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_NoSK.root",
                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",

                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression_MinEtSeedPosRecalc/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression_MinEtSeedPosRecalc/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",

                                                        

                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression_MinEtSeedPosRecalc/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression_MinEtSeedPosRecalc/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression_MinEtSeedPosRecalc/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",

                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression_MinEtSeedPosRecalc/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression_MinEtSeedPosRecalc/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression_MinEtSeedPosRecalc/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root"

                                                        /*"/data/larsonma/LargeRadiusJets/outputNTuplesDev_VBFSM/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                        "/data/larsonma/LargeRadiusJets/outputNTuplesDev_VBFSM/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                        "/data/larsonma/LargeRadiusJets/outputNTuplesDev_VBFSM/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                        "/data/larsonma/LargeRadiusJets/outputNTuplesDev_VBFSM/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                        "/data/larsonma/LargeRadiusJets/outputNTuplesDev_VBFSM/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",*/

                                                        // samples for global trigger meeting 02112026
                                                        "/data/larsonma/LargeRadiusJets/outputNTuplesDev_GlobalTriggerMeeting_02092026/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                        "/data/larsonma/LargeRadiusJets/outputNTuplesDev_GlobalTriggerMeeting_02092026/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                        "/data/larsonma/LargeRadiusJets/outputNTuplesDev_GlobalTriggerMeeting_02092026/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                        "/data/larsonma/LargeRadiusJets/outputNTuplesDev_GlobalTriggerMeeting_02092026/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                        "/data/larsonma/LargeRadiusJets/outputNTuplesDev_GlobalTriggerMeeting_02092026/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                        "/data/larsonma/LargeRadiusJets/outputNTuplesDev_GlobalTriggerMeeting_02092026/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",

                                                        // samples for v2 algorithm for global trigger meeting 02112026
                                                        /*"/data/larsonma/LargeRadiusJets/outputNTuplesDev_GlobalTriggerMeeting_02092026/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepWTAConeCellsTowersJets_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                        "/data/larsonma/LargeRadiusJets/outputNTuplesDev_GlobalTriggerMeeting_02092026/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepWTAConeCellsTowersJets_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                        "/data/larsonma/LargeRadiusJets/outputNTuplesDev_GlobalTriggerMeeting_02092026/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepWTAConeCellsTowersJets_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                        "/data/larsonma/LargeRadiusJets/outputNTuplesDev_GlobalTriggerMeeting_02092026/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepWTAConeCellsTowersJets_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                        "/data/larsonma/LargeRadiusJets/outputNTuplesDev_GlobalTriggerMeeting_02092026/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepWTAConeCellsTowersJets_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                        "/data/larsonma/LargeRadiusJets/outputNTuplesDev_GlobalTriggerMeeting_02092026/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepWTAConeCellsTowersJets_Seed_gepWTAConeCellsTowersJets_SK.root",*/

                                                        // samples for global trigger meeting 02112026 for seed optimization comparison
                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_GlobalTriggerMeeting_02092026/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_GlobalTriggerMeeting_02092026/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                        /*"/data/larsonma/LargeRadiusJets/outputNTuplesDev_GlobalTriggerMeeting_02092026/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                        "/data/larsonma/LargeRadiusJets/outputNTuplesDev_GlobalTriggerMeeting_02092026/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                        "/data/larsonma/LargeRadiusJets/outputNTuplesDev_GlobalTriggerMeeting_02092026/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",

                                                        "/data/larsonma/LargeRadiusJets/outputNTuplesDev_GlobalTriggerMeeting_02092026/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                        "/data/larsonma/LargeRadiusJets/outputNTuplesDev_GlobalTriggerMeeting_02092026/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                        "/data/larsonma/LargeRadiusJets/outputNTuplesDev_GlobalTriggerMeeting_02092026/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",*/

                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression_FixedSeedPosRecalcBug/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression_FixedSeedPosRecalcBug/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression_FixedSeedPosRecalcBug/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression_FixedSeedPosRecalcBug/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression_FixedSeedPosRecalcBug/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",

                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_0.001_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_1.75_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",
                                                        //"/data/larsonma/LargeRadiusJets/outFputNTuplesDev_PUSuppression/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_1.75_IOs_128_Seeds_2_R2_1.21_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root",

                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.44_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_NoSK.root",
                                                        //"/data/larsonma/LargeRadiusJets/outputNTuplesDev_PUSuppression/mc21_14TeV_jj_JZ_e8557_s4422_r16130_rMerge_2_IOs_128_Seeds_2_R2_1.44_IO_gepCellsTowers_Seed_gepWTAConeCellsTowersJets_SK.root"
                                                        };
    TString overlayOutputFileDir = "overlayMultipleFiles/largeRJetHistograms_AllSignals_FixedSeedPosRecalcBug_CompareSearchDistances_FixedOR_25GeVSubjets/";            
    gSystem->mkdir(overlayOutputFileDir);                                    
    gErrorIgnoreLevel = kError;
    std::cout << "number of signal files: " << signalRootFileNames.size() << " number of background files: " << backgroundRootFileNames.size() << "\n";
    bool categorySubjetEtScan_8 = false;
    double subjetEtThreshold = 25.0;
    analyze_files(signalRootFileNames, backgroundRootFileNames, overlayOutputFileDir, overlayThreeFiles, subjetEtThreshold, categorySubjetEtScan_8);

    std::cout << "[TIMER] total: "
            << std::chrono::duration<double>(clock::now() - t0).count()
            << " s\n";
    gSystem->Exit(0);
}